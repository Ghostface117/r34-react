{"version":3,"sources":["components/common/Buttons.tsx","redux/actions.ts","redux/selectors.ts","hooks/useAction.tsx","components/features/CookieConfirmation.tsx","GlobalStyles.tsx","misc/theme.ts","components/common/Text.tsx","components/common/Surface.tsx","data/types.ts","misc/api.ts","data/Post.ts","data/Tag.ts","misc/prepare.ts","components/tagSelector/TagInput.tsx","components/tag/tagUtils.ts","misc/formatting.ts","hooks/useToggle.ts","components/tag/Tag.tsx","icons/Icons.tsx","icons/TypeIcon.tsx","components/tagSelector/DropdownListEntry.tsx","components/tagSelector/DropdownList.tsx","components/tagSelector/TagSelector.tsx","components/common/FlexPair.tsx","components/common/Toggle.tsx","components/common/LabeledToggle.tsx","components/features/Options.tsx","components/tag/TagWrapper.tsx","components/tag/TagName.tsx","components/tag/Alias.tsx","components/tag/AliasesList.tsx","components/tag/NewTag.tsx","components/tag/TagList.tsx","icons/R34Icon.tsx","components/common/Lines.tsx","components/features/Header.tsx","components/features/Footer.tsx","components/common/FlexColumn.tsx","components/pages/Help.tsx","components/layout/infinite/InfiniteColumn.tsx","components/post/Rating.tsx","components/post/Score.tsx","components/post/Source.tsx","components/post/Details.tsx","data/utils.ts","components/player/FlexVideo.tsx","components/styled/animations.tsx","components/player/Overlay.tsx","components/player/Video.tsx","components/player/utils.ts","components/player/FlexImage.tsx","components/player/Gif.tsx","components/player/Picture.tsx","components/player/Player.tsx","components/post/Post.tsx","components/features/SearchButton.tsx","components/features/ActiveTags.tsx","components/features/Config.tsx","components/features/KofiButton.tsx","components/layout/LayoutHeader.tsx","icons/OutOfResults.png","components/layout/LayoutOutOfItems.tsx","icons/Loading.tsx","components/layout/LayoutLoadingItem.tsx","components/common/SmallTextInput.tsx","components/layout/pages/PageNavigation.tsx","components/layout/pages/PageLayout.tsx","components/pages/Search.tsx","components/common/Centered.tsx","components/common/Select.tsx","components/common/Setting.tsx","components/pages/Settings.tsx","redux/reducers/preferences.ts","redux/reducers/results.ts","redux/reducers/tags.ts","redux/reducers/index.ts","analytics/events.ts","redux/middleware/eventLogging.ts","redux/middleware/apiRequests.ts","redux/store.ts","App.tsx","index.tsx"],"names":["TextButton","styled","button","theme","css","dimensions","blockHeight","bigSpacing","fontSizes","content","colors","accentColor","borderWidth","borderRadius","timings","longTransitionTime","InvisButton","spacing","shadow","drop","transitionTime","RedButton","backgroundColor","backgroundColor2","BlockButton","AddButton","ModifierButton","ADD_TAG","REMOVE_TAG","ADD_ALIASES","ADD_POSTS","SET_POSTS","SET_OPTION","GET_RESULTS","GET_MORE_RESULTS","ALLOW_COOKIES","addTag","tag","type","removeTag","addAliases","aliases","forTag","setOption","key","value","getResults","pageNumber","getMoreResults","allowCookiesAction","selectActiveTags","state","tags","active","selectPosts","results","posts","selectCount","count","selectPageNumber","selectPreferences","preferences","selectOriginals","originals","selectCookies","cookies","selectAliases","Object","values","flat","selectOutOfResults","keys","length","selectAliasesByTagName","tagName","useAction","actionCreator","dispatch","useDispatch","useCallback","CookieWrapper","div","text","misc","layer","gutter","StyledSpan","span","CookieConfirmation","useSelector","onClick","aria-label","createGlobalStyle","props","hugeSpacing","bodyWidth","hoverAccent","subduedText","layerBg","box","transistionTime","bigTitle","Title","h2","BigTitle","h1","SmallTitle","h3","Faded","Modifier","VIDEO","ResultLayout","RouteName","RATED","RATEDTRESHOLD","ORIGINALS","COOKIES","PRELOAD_VIDEOS","TAG_SUGGESTION_COUNT","RESULTS_LAYOUT","PAGE_SIZE","NO_OP","API","constructor","activeApi","apiUrl2","this","apiUrl1","fetch","catch","getTags","searchTerm","limit","pageSize","res","json","getPosts","minScore","buildPostUrl","getAliases","page","normalTags","filter","modifier","OR","orTags","tagString","map","encodeURIComponent","name","join","url","PostDataClass","id","score","rating","source","media_type","media_src","file_url","thumbnail_src","width","height","creator_id","creator_url","status","parent_id","has_children","has_comments","comments_url","has_notes","created_at","change","small_src","big_src","TagDataClass","types","PLUS","preparePost","post","sample_url","preview_url","Number","t","Boolean","Input","input","TagInput","setValue","onChange","event","target","placeholder","prettifyTagname","tagname","replace","formatCount","numberString","number","toFixed","formatSource","sourceString","includes","semiSanitized","substring","indexOf","formatDuration","duration","min","Math","trunc","sec","useToggle","initialValue","useState","toggleValue","resetValue","TagWrapper","collapsed","fg","bg","switchingColors","left","right","Tag","StyledIcon","i","color","size","StyledSvg","svg","IconWrapper","Icon","icon","className","prefix","CharacterIcon","attrs","ArtistIcon","CopyrightIcon","ExpandIcon","memo","ArrowIcon","ExternalLinkIcon","SourceIcon","RatingIcon","HeartIcon","TwitterIcon","LinkIcon","PlayIcon","PauseIcon","CodeBranchIcon","PixivIcon","viewBox","xmlns","fill","d","TypeIcon","find","match","EntryWrapper","Name","Count","DropdownListEntry","ListWrapper","tagSelector","offsetTop","clientHeight","offsetLeft","clientWidth","sizeAndPosition","tagSelectorRef","DropdownList","entries","entry","TagSelectorWrapper","closed","TagSelector","setModifier","suggestions","setSuggestions","tagSuggestionsCount","setTagSelectorRef","activateTag","dirtyTag","prepareTag","useEffect","handle","setTimeout","api","toLowerCase","then","newSuggestions","clearTimeout","onModifierClick","MINUS","onAddClick","trim","suggestion","s","onSuggestionClick","ref","Wrapper","FlexPair","children","Track","Thumb","Toggle","onToggle","LabeledToggle","OptionsWrapper","StyledInput","String","Options","rated","ratedTreshold","ratedInputValue","setRatedInputValue","toggleRated","setRatedThreshold","style","display","onBlur","modifierToStyle","TagNameSpan","TagName","activeTags","stopPropagation","AliasWrapper","Alias","parentRef","AliasesList","NewTag","loadAliases","toggleCollapsed","resetCollapsed","tagRef","setTagRef","isActive","newAliases","sort","a","b","filtered","alias","onMouseLeave","TagListWrapper","TagList","padding","R34Icon","useTheme","transform","cx","cy","stroke","strokeWidth","strokeMiterlimit","strokeDasharray","strokeOpacity","r","fontStyle","fontWeight","fontSize","fontFamily","letterSpacing","wordSpacing","fillOpacity","x","y","fontVariant","fontStretch","HorizontalLine","VerticalLine","HeaderWrapper","header","TitleBar","MenuBar","nav","LocationStyledLink","Link","to","current","Header","useLocation","pathname","role","href","SEARCH","HELP","SETTINGS","FotterWrapper","footer","CenteredA","Footer","FlexColumn","FlexColumnWithSpacing","FlexRow","StyledOl","ol","Help","Surface","InifinteColumn","items","LoadingItem","hasMoreRows","ItemComponent","loadMore","OutOfItems","isLoading","setLoading","listRef","setListRef","cache","useMemo","CellMeasurerCache","fixedWidth","prependedRows","rowCount","isRowLoaded","index","listener","measureAllRows","recomputeRowHeights","forceUpdateGrid","window","addEventListener","removeEventListener","rowRenderer","parent","columnIndex","rowIndex","measure","registerChild","virtualRef","onLoad","console","warn","loadMoreRows","params","Promise","reject","resolve","onRowsRendered","child","deferredMeasurementCache","overscanRowCount","rowHeight","innerWidth","innerHeight","Rating","toUpperCase","ColoredA","Source","startsWith","TwitterLink","PixivSource","DefaultLink","FallbackSource","rel","split","Bar","DetailsTagList","Details","tagsForRendering","listToMap","keyProp","reduce","result","Score","FlexVideo","video","fadeOut","keyframes","isVisible","ProgressBar","OverlayButton","FullScreenButton","OpenExternalButton","PlayButton","LengthDisplay","Overlay","onFullscreen","togglePlay","isPaused","isPlayable","currentTime","externalSrc","mediaRef","toggleVisible","isNaN","Video","src","videoRef","setVideoRef","Date","now","setTime","intervalId","setIntervalId","play","setInterval","pause","clearInterval","requestFullscreen","paused","preloadVideos","controls","loop","preload","onLoadedMetadata","FlexImage","img","Gif","setPaused","usedSource","alt","loading","Picture","getMedia","getMediaType","Player","URL","searchParams","get","media","MediaComponent","ItemWrapper","PositonWrapper","PostWrapper","Post","loadOriginal","getCorrectSource","setCollapsed","toggleDetails","details","SearchButton","search","ActiveTags","ConfigWrapper","section","Config","htmlFor","Container","AButton","Text","Image","KofiButton","label","title","Placeholder","LayoutHeader","fullNumber","toggleFullNumber","toLocaleString","LayoutOutOfItems","aliasesForRendering","outOfResultsPicture","textAlign","Loading","version","xmlnsXlink","enable-background","xmlSpace","attributeName","dur","repeatCount","begin","LayoutLoadingItem","TextInput","SmallTextInput","onSubmit","internalValue","setInternalValue","onKeyDown","PageRow","PageNumber","CurrentNumber","PageNavigation","currentPage","loadPage","lastPage","ceil","loadSpecificPage","newPage","loadFirst","loadPrevious","loadNext","loadLast","BaseFlexColumn","PageLayout","scrollAndLoadPage","document","getElementsByClassName","scrollIntoView","item","Search","hasMorePosts","resultsLayout","INFINITE_COLUMN","hasMorePages","Centered","SelectWrapper","select","Option","option","Select","options","optionKey","optionValue","Grid","Body","Control","Setting","description","layouts","PAGES","SettingsSurface","Settings","togglePreloadVideos","toggleOriginals","setTagSuggestionCount","newValue","setPageSize","setResultsLayout","reset","localStorage","clear","location","reload","initialPreferencesState","infinite","produce","draft","action","initialResultsState","addPosts","postCount","setPosts","initialTagsState","newTag","tagToRemove","combineReducers","config","apiKey","authDomain","databaseURL","projectId","storageBucket","messagingSenderId","appId","measurementId","firebaseApp","analytics","eventLogging","store","next","getState","firebase","initializeApp","payload","logEvent","page_number","active_tags","searchEvent","apiRequests","isOutOfResults","persistConfig","storage","persistedReducer","persistReducer","rootReducer","createStore","composeWithDevTools","applyMiddleware","persistor","persistStore","App","GlobalStyles","path","ReactDOM","render","getElementById"],"mappings":"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","file":"static/js/main.c6b2d26a.chunk.js","sourcesContent":["import styled, { css } from \"styled-components\";\r\n\r\nexport const TextButton = styled.button(\r\n  ({ theme }) => css`\r\n    height: ${theme.dimensions.blockHeight};\r\n    padding: 0 ${theme.dimensions.bigSpacing};\r\n    font-size: ${theme.fontSizes.content};\r\n    border: ${theme.colors.accentColor} ${theme.dimensions.borderWidth} solid;\r\n    border-radius: ${theme.dimensions.borderRadius};\r\n\r\n    transition: all ${theme.timings.longTransitionTime} ease-in-out;\r\n  `\r\n);\r\n\r\nexport const InvisButton = styled.button(\r\n  ({ theme }) => css`\r\n    background-color: transparent;\r\n    border: none;\r\n    padding: ${theme.dimensions.spacing};\r\n    filter: ${theme.shadow.drop};\r\n\r\n    svg {\r\n      transition: all ${theme.timings.transitionTime} ease-in-out;\r\n    }\r\n\r\n    :hover {\r\n      svg {\r\n        transform: scale(1.1);\r\n      }\r\n    }\r\n  `\r\n);\r\n\r\nexport const RedButton = styled(TextButton)(\r\n  ({ theme }) => css`\r\n    color: ${theme.colors.accentColor};\r\n    background: ${theme.colors.backgroundColor};\r\n\r\n    :hover {\r\n      background-color: ${theme.colors.accentColor};\r\n      color: ${theme.colors.backgroundColor};\r\n    }\r\n\r\n    :active,\r\n    :focus {\r\n      color: ${theme.colors.backgroundColor2};\r\n      border-color: ${theme.colors.backgroundColor2};\r\n    }\r\n  `\r\n);\r\n\r\nexport const BlockButton = styled(RedButton)(\r\n  ({ theme }) => css`\r\n    width: 100%;\r\n  `\r\n);\r\n\r\nexport const AddButton = styled(RedButton)(\r\n  ({ theme }) => css`\r\n    border-left-width: 0;\r\n    border-radius: 0 ${theme.dimensions.borderRadius}\r\n      ${theme.dimensions.borderRadius} 0;\r\n  `\r\n);\r\n\r\nexport const ModifierButton = styled(TextButton)(\r\n  ({ theme }) => css`\r\n    background-color: transparent;\r\n    min-width: 48px;\r\n    border: ${theme.colors.accentColor} ${theme.dimensions.borderWidth} solid;\r\n    border-right-width: 0;\r\n    border-radius: ${theme.dimensions.borderRadius} 0 0\r\n      ${theme.dimensions.borderRadius};\r\n    font-weight: bold;\r\n  `\r\n);\r\n","import { PreferenceKey } from \"../data/types\";\r\nimport TagDataClass from \"../data/Tag\";\r\nimport PostDataClass from \"../data/Post\";\r\n\r\n/////////////////////////////////////////////////////////\r\n\r\nexport const ADD_TAG = \"R34_ADD_TAG\";\r\nexport const REMOVE_TAG = \"R34_REMOVE_TAG\";\r\nexport const ADD_ALIASES = \"R34_ADD_ALIASES\";\r\nexport const ADD_POSTS = \"R34_ADD_POSTS\";\r\nexport const SET_POSTS = \"R34_SET_POSTS\";\r\nexport const SET_OPTION = \"R34_SET_OPTION\";\r\nexport const GET_RESULTS = \"R34_GET_RESULTS\";\r\nexport const GET_MORE_RESULTS = \"R34_GET_MORE_RESULTS\";\r\nexport const ALLOW_COOKIES = \"R34_ALLOW_COOKIES\";\r\n\r\n/////////////////////////////////////////////////////////\r\n\r\ninterface AddTagAction {\r\n  type: typeof ADD_TAG;\r\n  tag: TagDataClass;\r\n}\r\n\r\ninterface RemoveTagAction {\r\n  type: typeof REMOVE_TAG;\r\n  tag: TagDataClass;\r\n}\r\n\r\ninterface AddAliasesAction {\r\n  type: typeof ADD_ALIASES;\r\n  aliases: TagDataClass[];\r\n  forTag: string;\r\n}\r\n\r\ninterface AddPostsAction {\r\n  type: typeof ADD_POSTS;\r\n  posts: PostDataClass[];\r\n}\r\n\r\ninterface SetPostsAction {\r\n  type: typeof SET_POSTS;\r\n  posts: PostDataClass[];\r\n  count: string;\r\n  pageNumber?: number;\r\n}\r\n\r\ninterface SetOptionAction {\r\n  type: typeof SET_OPTION;\r\n  key: PreferenceKey;\r\n  value: any;\r\n}\r\n\r\ninterface GetResultsAction {\r\n  type: typeof GET_RESULTS;\r\n  pageNumber: number;\r\n}\r\n\r\ninterface GetMoreResultsAction {\r\n  type: typeof GET_MORE_RESULTS;\r\n}\r\n\r\ninterface AllowCookiesAction {\r\n  type: typeof ALLOW_COOKIES;\r\n  value: boolean;\r\n}\r\n\r\n/////////////////////////////////////////////////////////\r\n\r\nexport const addTag = (tag: TagDataClass) => ({\r\n  type: ADD_TAG,\r\n  tag,\r\n});\r\n\r\nexport const removeTag = (tag: TagDataClass) => ({\r\n  type: REMOVE_TAG,\r\n  tag,\r\n});\r\n\r\nexport const addAliases = (aliases: TagDataClass[], forTag: string) => ({\r\n  type: ADD_ALIASES,\r\n  aliases,\r\n  forTag,\r\n});\r\n\r\nexport const addPosts = (posts: PostDataClass[]) => ({\r\n  type: ADD_POSTS,\r\n  posts,\r\n});\r\n\r\nexport const setPosts = (\r\n  posts: PostDataClass[],\r\n  count: string,\r\n  pageNumber: number = 0\r\n) => ({\r\n  type: SET_POSTS,\r\n  posts,\r\n  count,\r\n  pageNumber,\r\n});\r\n\r\nexport const setOption = (key: PreferenceKey, value: any) => ({\r\n  type: SET_OPTION,\r\n  key,\r\n  value,\r\n});\r\n\r\nexport const getResults = (pageNumber: number = 0) => ({\r\n  type: GET_RESULTS,\r\n  pageNumber,\r\n});\r\n\r\nexport const getMoreResults = () => ({\r\n  type: GET_MORE_RESULTS,\r\n});\r\n\r\nexport const allowCookiesAction = () => ({\r\n  type: ALLOW_COOKIES,\r\n  value: true,\r\n});\r\n\r\n/////////////////////////////////////////////////////////\r\n\r\nexport type AppAction =\r\n  | AddTagAction\r\n  | RemoveTagAction\r\n  | AddAliasesAction\r\n  | AddPostsAction\r\n  | SetPostsAction\r\n  | SetOptionAction\r\n  | GetResultsAction\r\n  | GetMoreResultsAction\r\n  | AllowCookiesAction;\r\n","import { TagsState } from \"./reducers/tags\";\r\nimport { ResultsState } from \"./reducers/results\";\r\nimport { PreferencesState } from \"./reducers/preferences\";\r\n\r\ninterface RootState {\r\n  results: ResultsState;\r\n  preferences: PreferencesState;\r\n  tags: TagsState;\r\n}\r\nexport const selectActiveTags = (state: RootState) => state.tags.active;\r\nexport const selectResults = (state: RootState) => state.results;\r\nexport const selectPosts = (state: RootState) => state.results.posts;\r\nexport const selectCount = (state: RootState) => state.results.count;\r\nexport const selectPageNumber = (state: RootState) => state.results.pageNumber;\r\nexport const selectPreferences = (state: RootState) => state.preferences;\r\nexport const selectInfinite = (state: RootState) => state.preferences.infinite;\r\nexport const selectOriginals = (state: RootState) =>\r\n  state.preferences.originals;\r\nexport const selectRated = (state: RootState) => state.preferences.rated;\r\nexport const selectRatedThreshold = (state: RootState) =>\r\n  state.preferences.ratedTreshold;\r\nexport const selectCookies = (state: RootState) => state.preferences.cookies;\r\n\r\nexport const selectAliases = (state: RootState) =>\r\n  Object.values(state.tags.aliases).flat();\r\nexport const selectHasResults = (state: RootState) =>\r\n  Object.keys(state.results.posts).length !== 0;\r\nexport const selectOutOfResults = (state: RootState) =>\r\n  Object.keys(state.results.posts).length === state.results.count;\r\n\r\nexport const selectAliasesByTagName = (tagName: string) => (state: RootState) =>\r\n  state.tags.aliases[tagName];\r\n","import { useCallback } from \"react\";\r\nimport { useDispatch } from \"react-redux\";\r\nimport { AnyAction } from \"redux\";\r\n\r\nexport default function useAction(actionCreator: () => AnyAction) {\r\n  const dispatch = useDispatch();\r\n\r\n  return useCallback(() => {\r\n    dispatch(actionCreator());\r\n  }, [actionCreator, dispatch]);\r\n}\r\n","import React from \"react\";\r\nimport styled, { css } from \"styled-components\";\r\nimport { RedButton } from \"../common/Buttons\";\r\nimport { useSelector } from \"react-redux\";\r\nimport { allowCookiesAction } from \"../../redux/actions\";\r\nimport { selectCookies } from \"../../redux/selectors\";\r\nimport useAction from \"../../hooks/useAction\";\r\n\r\nconst CookieWrapper = styled.div(\r\n  ({ theme }) => css`\r\n    position: fixed;\r\n    bottom: 0;\r\n    left: 0;\r\n    width: 100%;\r\n    display: flex;\r\n    align-items: center;\r\n    justify-content: space-between;\r\n\r\n    color: ${theme.colors.text};\r\n    background: ${theme.misc.layer};\r\n\r\n    padding: ${theme.dimensions.gutter};\r\n  `\r\n);\r\n\r\nconst StyledSpan = styled.span`\r\n  height: min-content;\r\n`;\r\n\r\nexport default function CookieConfirmation() {\r\n  const cookies = useSelector(selectCookies);\r\n  const onClick = useAction(allowCookiesAction);\r\n\r\n  return cookies ? null : (\r\n    <CookieWrapper>\r\n      <StyledSpan>This website uses cookies.</StyledSpan>\r\n      <RedButton onClick={onClick} aria-label=\"Allow Cookies\">\r\n        Got it\r\n      </RedButton>\r\n    </CookieWrapper>\r\n  );\r\n}\r\n","import { createGlobalStyle, css } from \"styled-components\";\r\nimport { ThemeType } from \"./misc/theme\";\r\n\r\nexport default createGlobalStyle(\r\n  (props: { theme: ThemeType }) => css`\r\n    * {\r\n      margin: 0;\r\n      padding: 0;\r\n      box-sizing: border-box;\r\n\r\n      font-family: \"Raleway\", sans-serif;\r\n      -webkit-font-smoothing: antialiased;\r\n      -moz-osx-font-smoothing: grayscale;\r\n\r\n      :focus {\r\n        outline: none;\r\n        text-decoration: underline;\r\n      }\r\n    }\r\n\r\n    html,\r\n    body,\r\n    #app-root {\r\n      width: 100%;\r\n      height: 100%;\r\n    }\r\n\r\n    body {\r\n      font-size: ${props.theme.fontSizes.content};\r\n      color: ${props.theme.colors.backgroundColor2};\r\n      background-color: ${props.theme.colors.backgroundColor};\r\n    }\r\n\r\n    a {\r\n      color: ${props.theme.colors.accentColor};\r\n      text-decoration: none;\r\n    }\r\n  `\r\n);\r\n","const theme = {\r\n  dimensions: {\r\n    borderRadius: \"3px\",\r\n    borderWidth: \"2px\",\r\n    spacing: \"4px\",\r\n    bigSpacing: \"8px\",\r\n    hugeSpacing: \"16px\",\r\n    gutter: \"8px\",\r\n    blockHeight: \"32px\",\r\n    bodyWidth: \"1000px\",\r\n  },\r\n  colors: {\r\n    accentColor: \"#ee3344\",\r\n    hoverAccent: \"#ee3344\",\r\n    backgroundColor: \"#121212\",\r\n    backgroundColor2: \"#fff\",\r\n    subduedText: \"#ffffff80\",\r\n    layerBg: \"#ffffff11\",\r\n  },\r\n  shadow: {\r\n    box: \"box-shadow: 0 0 8px #000\",\r\n    drop: \"drop-shadow(0 0 4px #000)\",\r\n  },\r\n  timings: {\r\n    transistionTime: \"0.2s\",\r\n    longTransitionTime: \"0.2s\",\r\n  },\r\n  misc: {\r\n    layer:\r\n      \"#ffffff11; :hover { background: #ffffff16;} transition: background-color 0.2s ease-in-out\",\r\n  },\r\n  fontSizes: {\r\n    content: \"15px\",\r\n    bigTitle: \"24px\",\r\n  },\r\n};\r\n\r\nexport default theme;\r\n\r\nexport type ThemeType = typeof theme;\r\n","import styled, { css } from \"styled-components\";\r\n\r\nexport const Title = styled.h2(\r\n  ({ theme }) => css`\r\n    font-size: ${theme.fontSizes.bigTitle};\r\n    font-weight: lighter;\r\n    text-align: center;\r\n  `\r\n);\r\n\r\nexport const BigTitle = styled.h1(\r\n  ({ theme }) => css`\r\n    display: flex;\r\n    justify-content: center;\r\n    font-size: ${theme.fontSizes.bigTitle};\r\n    font-weight: lighter;\r\n    text-align: center;\r\n  `\r\n);\r\n\r\nexport const SmallTitle = styled.h3(\r\n  ({ theme }) => css`\r\n    font-size: ${theme.fontSizes.content};\r\n  `\r\n);\r\n\r\nexport const Faded = styled.span(\r\n  ({ theme }) => css`\r\n    color: ${theme.colors.subduedText};\r\n  `\r\n);\r\n","import styled, { css } from \"styled-components\";\r\n\r\nexport default styled.div(\r\n  (props) => css`\r\n    display: grid;\r\n    padding: ${props.theme.dimensions.gutter};\r\n    background: ${props.theme.misc.layer};\r\n    ${props.theme.shadow.box};\r\n    border-radius: ${props.theme.dimensions.borderRadius};\r\n    width: 100%;\r\n    gap: ${props.theme.dimensions.gutter};\r\n  `\r\n);\r\n","export const GENERAL = \"general\";\r\nexport const CHARACTER = \"character\";\r\nexport const AMBIGUOUS = \"ambiguous\";\r\nexport const ARTIST = \"artist\";\r\nexport const COPYRIGHT = \"copyright\";\r\nexport type TagType =\r\n  | typeof GENERAL\r\n  | typeof CHARACTER\r\n  | typeof AMBIGUOUS\r\n  | typeof ARTIST\r\n  | typeof COPYRIGHT;\r\n\r\nexport enum Modifier {\r\n  PLUS = \"+\",\r\n  MINUS = \"-\",\r\n  OR = \"~\",\r\n}\r\n\r\nexport const VIDEO = \"video\";\r\nexport const IMAGE = \"image\";\r\nexport type PostType = typeof VIDEO | typeof IMAGE;\r\n\r\nexport const PICTURE = \"picture\";\r\nexport const GIF = \"gif\";\r\nexport type MediaType = typeof VIDEO | typeof PICTURE | typeof GIF;\r\n\r\nexport enum ResultLayout {\r\n  INFINITE_COLUMN = \"infinite_column\",\r\n  PAGES = \"pages\",\r\n}\r\n\r\nexport enum RouteName {\r\n  SEARCH = \"/\",\r\n  HELP = \"/help\",\r\n  SETTINGS = \"/settings\",\r\n}\r\n\r\nexport const INVISIBLE = \"invisible\";\r\nexport const BLOCK = \"block\";\r\nexport const MODIFIER = \"modifier\";\r\nexport const ADD = \"add\";\r\nexport const RED = \"red\";\r\nexport type ButtonType =\r\n  | typeof INVISIBLE\r\n  | typeof BLOCK\r\n  | typeof MODIFIER\r\n  | typeof ADD\r\n  | typeof RED;\r\n\r\nexport const SAFE = \"safe\";\r\nexport const QUESTIONABLE = \"questionable\";\r\nexport const EXPLICIT = \"explicit\";\r\nexport type RatingType = typeof SAFE | typeof QUESTIONABLE | typeof EXPLICIT;\r\n\r\nexport const INFINITE = \"infinite\";\r\nexport const RATED = \"rated\";\r\nexport const RATEDTRESHOLD = \"ratedTreshold\";\r\nexport const ORIGINALS = \"originals\";\r\nexport const COOKIES = \"cookies\";\r\nexport const PRELOAD_VIDEOS = \"preload_videos\";\r\nexport const TAG_SUGGESTION_COUNT = \"tag_suggestion_count\";\r\nexport const RESULTS_LAYOUT = \"results_layout\";\r\nexport const PAGE_SIZE = \"page_size\";\r\n\r\nexport type PreferenceKey =\r\n  | typeof INFINITE\r\n  | typeof RATED\r\n  | typeof RATEDTRESHOLD\r\n  | typeof ORIGINALS\r\n  | typeof COOKIES\r\n  | typeof PRELOAD_VIDEOS\r\n  | typeof TAG_SUGGESTION_COUNT\r\n  | typeof RESULTS_LAYOUT\r\n  | typeof PAGE_SIZE;\r\n\r\nexport interface SimpleMap<V> {\r\n  [key: string]: V;\r\n}\r\n\r\nexport interface SimpleList<V> {\r\n  [key: number]: V;\r\n}\r\n\r\nexport const NO_OP = () => {};\r\n","import TagDataClass from \"../data/Tag\";\r\nimport { Modifier, SimpleMap } from \"../data/types\";\r\n\r\nexport class API {\r\n  static pageSize = 20;\r\n  static apiUrl1 = \"https://r34-json.herokuapp.com\";\r\n  static apiUrl2 = \"https://r34-api-clone.herokuapp.com\";\r\n  activeApi = API.apiUrl2;\r\n\r\n  constructor() {\r\n    this.activeApi = API.apiUrl1;\r\n\r\n    // Failover to apiUrl2\r\n    fetch(this.activeApi).catch(() => (this.activeApi = API.apiUrl2));\r\n  }\r\n\r\n  async getTags(searchTerm: string, limit: number = API.pageSize) {\r\n    const res = await fetch(\r\n      `${this.activeApi}/tags?limit=${limit}&name=${searchTerm}*&order_by=posts`\r\n    );\r\n\r\n    return await res.json();\r\n  }\r\n\r\n  async getPosts(\r\n    tags: SimpleMap<TagDataClass>,\r\n    limit: number = API.pageSize,\r\n    pageNumber = 0,\r\n    minScore = 0\r\n  ) {\r\n    const res = await fetch(\r\n      this.buildPostUrl(pageNumber, tags, minScore, limit)\r\n    );\r\n\r\n    return await res.json();\r\n  }\r\n\r\n  async getAliases(tagName: string) {\r\n    const res = await fetch(`${this.activeApi}/alias/${tagName}`);\r\n\r\n    return await res.json();\r\n  }\r\n\r\n  buildPostUrl(\r\n    page: number,\r\n    tags: SimpleMap<TagDataClass>,\r\n    minScore: number,\r\n    limit: number = API.pageSize\r\n  ) {\r\n    const normalTags = Object.values(tags).filter(\r\n      (tag) => tag.modifier !== Modifier.OR\r\n    );\r\n    const orTags = Object.values(tags).filter(\r\n      (tag) => tag.modifier === Modifier.OR\r\n    );\r\n\r\n    let tagString = normalTags\r\n      .map(\r\n        (tag) =>\r\n          `${tag.modifier === \"-\" ? \"-\" : \"\"}${encodeURIComponent(tag.name)}`\r\n      )\r\n      .join(\" + \");\r\n\r\n    if (orTags.length > 0) {\r\n      tagString +=\r\n        \"+ ( \" +\r\n        orTags.map((tag) => encodeURIComponent(tag.name)).join(\" ~ \") +\r\n        \" )\";\r\n    }\r\n\r\n    let url = `${this.activeApi}/posts?pid=${page}&limit=${limit}&tags=${tagString}`;\r\n\r\n    if (minScore > 0) {\r\n      url += `+${encodeURIComponent(\"score:>=\" + minScore)}`;\r\n    }\r\n\r\n    return url;\r\n  }\r\n}\r\n\r\nexport default new API();\r\n","import { RatingType, PostType } from \"./types\";\r\nimport TagDataClass from \"./Tag\";\r\n\r\nexport default class PostDataClass {\r\n  id: number;\r\n\r\n  score: number;\r\n  rating: RatingType;\r\n  source: string;\r\n  tags: TagDataClass[];\r\n\r\n  media_type: PostType;\r\n\r\n  thumbnail_src: string;\r\n  small_src: string;\r\n  big_src: string;\r\n\r\n  width: number;\r\n  height: number;\r\n\r\n  creator_id: number;\r\n  creator_url: string;\r\n\r\n  status: string;\r\n  parent_id: number;\r\n  has_children: boolean;\r\n  has_comments: boolean;\r\n  comments_url: string;\r\n  has_notes: boolean;\r\n  created_at: string;\r\n  change: string;\r\n\r\n  constructor(\r\n    id: number,\r\n    score: number,\r\n    rating: string,\r\n    source: string,\r\n    tags: TagDataClass[],\r\n    media_type: string,\r\n    media_src: any,\r\n    file_url: any,\r\n    thumbnail_src: string,\r\n    width: number,\r\n    height: number,\r\n    creator_id: number,\r\n    creator_url: string,\r\n    status: string,\r\n    parent_id: number,\r\n    has_children: boolean,\r\n    has_comments: boolean,\r\n    comments_url: string,\r\n    has_notes: boolean,\r\n    created_at: string,\r\n    change: string\r\n  ) {\r\n    this.id = id;\r\n\r\n    this.score = score;\r\n    this.rating = rating as RatingType;\r\n    this.source = source;\r\n    this.tags = tags;\r\n\r\n    this.media_type = media_type as PostType;\r\n    this.small_src = media_src;\r\n    this.big_src = file_url;\r\n    this.thumbnail_src = thumbnail_src;\r\n\r\n    this.width = width;\r\n    this.height = height;\r\n\r\n    this.creator_id = creator_id;\r\n    this.creator_url = creator_url;\r\n\r\n    this.status = status;\r\n    this.parent_id = parent_id;\r\n    this.has_children = has_children;\r\n    this.has_comments = has_comments;\r\n    this.comments_url = comments_url;\r\n    this.has_notes = has_notes;\r\n    this.created_at = created_at;\r\n    this.change = change;\r\n  }\r\n}\r\n","import { TagType, Modifier } from \"./types\";\r\n\r\nexport default class TagDataClass {\r\n  name: string;\r\n  count?: number | null;\r\n  types?: TagType[];\r\n  modifier?: Modifier;\r\n\r\n  constructor(\r\n    name: string,\r\n    types: TagType[] = [],\r\n    count: number | null = null,\r\n    modifier: Modifier = Modifier.PLUS\r\n  ) {\r\n    this.name = name;\r\n    this.types = types;\r\n    this.count = count;\r\n    this.modifier = modifier;\r\n  }\r\n}\r\n","import PostDataClass from \"../data/Post\";\r\nimport TagDataClass from \"../data/Tag\";\r\nimport { TagType, Modifier, RatingType } from \"../data/types\";\r\n\r\ninterface DirtyTag {\r\n  name: string;\r\n  types: string[];\r\n  count: string;\r\n  modifier: string;\r\n}\r\n\r\ninterface DirtyPost {\r\n  id: string;\r\n  type: string;\r\n  score: string;\r\n  rating: string;\r\n  source: string;\r\n  tags: string[];\r\n  file_url: string;\r\n  width: string;\r\n  height: string;\r\n  creator_id: string;\r\n  creator_url: string;\r\n  sample_url: string;\r\n  preview_url: string;\r\n  status: string;\r\n  parent_id: string;\r\n  has_children: string;\r\n  has_comments: string;\r\n  comments_url: string;\r\n  has_notes: string;\r\n  created_at: string;\r\n  change: string;\r\n}\r\n\r\nexport function prepareTag(dirtyTag: DirtyTag) {\r\n  const { name, types, count, modifier } = dirtyTag;\r\n\r\n  return new TagDataClass(\r\n    name,\r\n    types as TagType[],\r\n    Number(count),\r\n    modifier as Modifier\r\n  );\r\n}\r\n\r\nexport function preparePost(post: DirtyPost) {\r\n  const {\r\n    id,\r\n    type,\r\n    score,\r\n    rating,\r\n    source,\r\n    tags,\r\n    file_url,\r\n    width,\r\n    height,\r\n    creator_id,\r\n    creator_url,\r\n    sample_url,\r\n    preview_url,\r\n    status,\r\n    parent_id,\r\n    has_children,\r\n    has_comments,\r\n    comments_url,\r\n    has_notes,\r\n    created_at,\r\n    change,\r\n  } = post;\r\n  return new PostDataClass(\r\n    Number(id),\r\n    Number(score),\r\n    rating as RatingType,\r\n    source,\r\n    tags ? tags.map((t) => new TagDataClass(t)) : [],\r\n    type,\r\n    sample_url,\r\n    file_url,\r\n    preview_url,\r\n    Number(width),\r\n    Number(height),\r\n    Number(creator_id),\r\n    creator_url,\r\n    status,\r\n    Number(parent_id),\r\n    Boolean(has_children),\r\n    Boolean(has_comments),\r\n    comments_url,\r\n    Boolean(has_notes),\r\n    created_at,\r\n    change\r\n  );\r\n}\r\n","import React from \"react\";\r\nimport styled, { css } from \"styled-components\";\r\n\r\nconst Input = styled.input(\r\n  (props) => css`\r\n    width: 100%;\r\n    border: none;\r\n    outline: none;\r\n    background: none;\r\n    font-size: ${props.theme.fontSizes.content};\r\n    border-top: ${props.theme.colors.accentColor}\r\n      ${props.theme.dimensions.borderWidth} solid;\r\n    border-bottom: ${props.theme.colors.accentColor}\r\n      ${props.theme.dimensions.borderWidth} solid;\r\n  `\r\n);\r\n\r\ninterface TagInputProps {\r\n  value: string;\r\n  setValue: (newValue: string) => void;\r\n}\r\n\r\nexport default function TagInput(props: TagInputProps) {\r\n  const { value, setValue } = props;\r\n  return (\r\n    <Input\r\n      id=\"tag-input\"\r\n      value={value}\r\n      onChange={(event) => setValue(event.target.value)}\r\n      placeholder=\"Search for tags\"\r\n      aria-label=\"Search\"\r\n    />\r\n  );\r\n}\r\n","export function prettifyTagname(tagname: string) {\r\n  return tagname.replace(/_/g, \" \");\r\n}\r\n\r\nexport function normalizeTagname(tagname: string) {\r\n  return tagname.toLowerCase().replace(/ /g, \"_\");\r\n}\r\n","export const formatCount = (numberString: number) => {\r\n  const number = numberString;\r\n\r\n  if (number >= 1e6) {\r\n    return `${(number / 1e6).toFixed(0)}M`;\r\n  }\r\n\r\n  if (number >= 1e3) {\r\n    return `${(number / 1e3).toFixed(0)}K`;\r\n  }\r\n\r\n  return number;\r\n};\r\n\r\n/**\r\n * @param {String} sourceString\r\n */\r\nexport const formatSource = (sourceString: string) => {\r\n  if (\r\n    sourceString.includes(\"http:\") ||\r\n    sourceString.includes(\"https:\") ||\r\n    sourceString.includes(\"www.\") ||\r\n    sourceString.includes(\".com\")\r\n  ) {\r\n    let semiSanitized = sourceString\r\n      .replace(/https?:\\/\\//, \"\")\r\n      .replace(/ww[w\\d]\\./, \"\")\r\n      .replace(\".com\", \"\")\r\n      .replace(\".org\", \"\")\r\n      .replace(\".net\", \"\");\r\n\r\n    return semiSanitized.substring(0, semiSanitized.indexOf(\"/\"));\r\n  } else {\r\n    return sourceString;\r\n  }\r\n};\r\n\r\nexport function formatDuration(duration: number) {\r\n  const min = Math.trunc(duration / 60);\r\n  const sec = Math.trunc(duration % 60);\r\n\r\n  return min + \":\" + (sec < 10 ? \"0\" : \"\") + sec;\r\n}\r\n","import { useCallback, useState } from \"react\";\r\n\r\nexport default function useToggle(\r\n  initialValue = false\r\n): [boolean, () => void, () => void] {\r\n  const [value, setValue] = useState<boolean>(initialValue);\r\n  const toggleValue = useCallback(() => setValue(!value), [value]);\r\n  const resetValue = useCallback(() => setValue(initialValue), [initialValue]);\r\n\r\n  return [value, toggleValue, resetValue];\r\n}\r\n","import React, { useEffect, MouseEventHandler } from \"react\";\r\nimport styled, { css } from \"styled-components\";\r\nimport \"./Tag.css\";\r\nimport api from \"../../misc/api\";\r\nimport TypeIcon from \"../../icons/TypeIcon\";\r\nimport { ArrowIcon } from \"../../icons/Icons\";\r\nimport { prettifyTagname } from \"./tagUtils\";\r\nimport { formatCount } from \"../../misc/formatting\";\r\nimport TagDataClass from \"../../data/Tag\";\r\nimport { useDispatch, useSelector } from \"react-redux\";\r\nimport {\r\n  selectActiveTags,\r\n  selectAliasesByTagName,\r\n} from \"../../redux/selectors\";\r\nimport { addAliases, removeTag, addTag } from \"../../redux/actions\";\r\nimport { ThemeType } from \"../../misc/theme\";\r\nimport useToggle from \"../../hooks/useToggle\";\r\n\r\nconst dropdownBorderRadius = (collapsed: boolean, theme: ThemeType) =>\r\n  collapsed\r\n    ? theme.dimensions.borderRadius\r\n    : `${theme.dimensions.borderRadius} ${theme.dimensions.borderRadius} 0 0`;\r\n\r\nconst switchingColors = (active: boolean, theme: ThemeType) => {\r\n  const fg = active ? theme.colors.backgroundColor : theme.colors.accentColor;\r\n  const bg = active ? theme.colors.accentColor : theme.colors.backgroundColor;\r\n\r\n  return css`\r\n    color: ${fg};\r\n    background-color: ${bg};\r\n    border: ${theme.colors.accentColor} ${theme.dimensions.borderWidth} solid;\r\n    transition: background-color 0.4s ease-in-out;\r\n\r\n    cursor: pointer;\r\n\r\n    :hover,\r\n    :focus,\r\n    :active {\r\n      border-color: ${theme.colors.backgroundColor2};\r\n      color: ${theme.colors.backgroundColor2};\r\n\r\n      i {\r\n        color: ${theme.colors.backgroundColor2};\r\n      }\r\n    }\r\n  `;\r\n};\r\n\r\nexport const TagWrapper = styled.div(\r\n  (props: {\r\n    active: boolean;\r\n    collapsed: boolean;\r\n    onMouseLeave: MouseEventHandler;\r\n    theme: ThemeType;\r\n  }) =>\r\n    css`\r\n      display: inline-block;\r\n      padding: 0.25rem;\r\n      border-radius: ${dropdownBorderRadius(props.collapsed, props.theme)};\r\n      font-size: ${props.theme.fontSizes.content};\r\n      line-height: 1.2;\r\n      vertical-align: baseline;\r\n      margin: ${props.theme.dimensions.spacing};\r\n      ${switchingColors(props.active, props.theme)}\r\n    `\r\n);\r\n\r\nconst IconWrapper = styled.span(\r\n  (props: { left?: boolean; right?: boolean }) => css`\r\n    ${props.left ? \"margin-right: 5px;\" : \"\"}\r\n    ${props.right ? \"margin-left: 5px;\" : \"\"}\r\n  `\r\n);\r\n\r\ninterface TagProps extends TagDataClass {\r\n  loadAliases: boolean;\r\n}\r\n\r\ntype TagLike = {\r\n  name: string;\r\n  posts: number;\r\n};\r\n\r\nfunction Tag(props: TagProps) {\r\n  const { name, count, modifier, types, loadAliases } = props;\r\n  const activeTags = useSelector(selectActiveTags);\r\n  const aliases = useSelector(selectAliasesByTagName(name));\r\n  const [collapsed, toggleCollapsed, resetCollapsed] = useToggle(true);\r\n  const dispatch = useDispatch();\r\n\r\n  useEffect(() => {\r\n    if (loadAliases && activeTags[name])\r\n      api.getAliases(name).then((newAliases: TagLike[]) => {\r\n        newAliases.sort((a, b) => b.posts - a.posts);\r\n        const filtered = newAliases\r\n          .filter((alias) => !activeTags[alias.name])\r\n          .map((alias) => new TagDataClass(alias.name, [], alias.posts));\r\n        dispatch(addAliases(filtered, name));\r\n      });\r\n  }, [loadAliases, name, activeTags, dispatch]);\r\n\r\n  const isActive = Boolean(activeTags[name]);\r\n  const showAliases = loadAliases && aliases && aliases.length > 0;\r\n\r\n  return (\r\n    <TagWrapper\r\n      active={isActive}\r\n      collapsed={collapsed}\r\n      onMouseLeave={resetCollapsed}\r\n    >\r\n      <TypeIcon types={types} left />\r\n      <TagText name={name} count={count} modifier={modifier} types={types} />\r\n      {showAliases && (\r\n        <>\r\n          <IconWrapper right onClick={toggleCollapsed}>\r\n            <ArrowIcon />\r\n          </IconWrapper>\r\n          <div className={\"dropdown-list\" + (!collapsed ? \" visible\" : \"\")}>\r\n            {aliases.map(({ name: aname, count: acount }) => (\r\n              <Alias key={\"t_\" + aname} name={aname} count={acount} />\r\n            ))}\r\n          </div>\r\n        </>\r\n      )}\r\n    </TagWrapper>\r\n  );\r\n}\r\n\r\nfunction TagText(props: TagDataClass) {\r\n  const { name, count, modifier, types } = props;\r\n  const dispatch = useDispatch();\r\n  const tagname = prettifyTagname(name);\r\n  const text = count ? `${tagname} (${formatCount(count)})` : tagname;\r\n  const activeTags = useSelector(selectActiveTags);\r\n\r\n  const onClick: MouseEventHandler = (event) => {\r\n    event.stopPropagation();\r\n    if (activeTags[name])\r\n      dispatch(removeTag(new TagDataClass(name, types, count)));\r\n    else dispatch(addTag(new TagDataClass(name, types, count)));\r\n  };\r\n\r\n  return (\r\n    <span onClick={onClick}>{modifier === \"-\" ? <s>{text}</s> : text}</span>\r\n  );\r\n}\r\n\r\nfunction Alias(props: TagDataClass) {\r\n  const { name, count } = props;\r\n  return (\r\n    <div className=\"alias\">\r\n      <TagText name={name} count={count} />\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default Tag;\r\n","import React, { MouseEventHandler, memo } from \"react\";\r\nimport styled, { css } from \"styled-components\";\r\nimport { TagWrapper } from \"../components/tag/Tag\";\r\nimport { NO_OP } from \"../data/types\";\r\n\r\nimport { ThemeType } from \"../misc/theme\";\r\n\r\nexport const StyledIcon = styled.i(\r\n  (props: { color: string; size: number; theme: ThemeType }) => css`\r\n    color: ${props.color};\r\n    min-width: ${props.size}px;\r\n    height: ${props.size}px;\r\n\r\n    svg {\r\n      color: ${props.color};\r\n    }\r\n\r\n    ${TagWrapper}:hover & {\r\n      color: ${props.theme.colors.accentColor};\r\n    }\r\n\r\n    ${TagWrapper}:active & ,  ${TagWrapper}:focus & {\r\n      color: ${props.theme.colors.backgroundColor2};\r\n    }\r\n  `\r\n);\r\n\r\nconst StyledSvg = styled.svg(\r\n  (props: { size: number } & JSX.IntrinsicAttributes) => css`\r\n    width: ${props.size}px;\r\n    height: ${props.size}px;\r\n  `\r\n);\r\n\r\nconst IconWrapper = styled.span(\r\n  (props: { left: boolean; right: boolean }) => css``\r\n);\r\n\r\ninterface IconProps {\r\n  icon: string;\r\n  className?: string;\r\n  color?: string;\r\n  size?: number;\r\n  onClick?: MouseEventHandler;\r\n  left?: boolean;\r\n  right?: boolean;\r\n  prefix?: string;\r\n}\r\n\r\nconst Icon = (props: IconProps) => {\r\n  const {\r\n    icon,\r\n    className = \"\",\r\n    color = \"black\",\r\n    size = 14,\r\n    onClick = NO_OP,\r\n    left = false,\r\n    right = false,\r\n    prefix = \"fas\",\r\n  } = props;\r\n\r\n  return (\r\n    <IconWrapper onClick={onClick} left={left} right={right}>\r\n      <StyledIcon\r\n        className={`${prefix} ${icon} ${className}`}\r\n        color={color}\r\n        size={size}\r\n      />\r\n    </IconWrapper>\r\n  );\r\n};\r\n\r\nexport const CharacterIcon = styled(Icon).attrs({\r\n  icon: \"fa-user\",\r\n})``;\r\n\r\nexport const ArtistIcon = styled(Icon).attrs({\r\n  icon: \"fa-pen\",\r\n})``;\r\n\r\nexport const CopyrightIcon = styled(Icon).attrs({\r\n  icon: \"fa-copyright\",\r\n})``;\r\n\r\nexport const PlusIcon = styled(Icon).attrs({\r\n  icon: \"fa-plus-circle\",\r\n})``;\r\n\r\nexport const MinusIcon = styled(Icon).attrs({\r\n  icon: \"fa-minus-circle\",\r\n})``;\r\n\r\nexport const CloseIcon = styled(Icon).attrs({\r\n  icon: \"fa-times\",\r\n})``;\r\n\r\nexport const ExpandIcon = memo(\r\n  styled(Icon).attrs({\r\n    icon: \"fa-expand\",\r\n  })``\r\n);\r\n\r\nexport const ArrowIcon = styled(Icon).attrs({\r\n  icon: \"fa-caret-down\",\r\n})``;\r\n\r\nexport const ExternalLinkIcon = styled(Icon).attrs({\r\n  icon: \"fa-external-link-alt\",\r\n})``;\r\n\r\nexport const SourceIcon = styled(Icon).attrs({\r\n  icon: \"fa-hashtag\",\r\n})``;\r\n\r\nexport const RatingIcon = styled(Icon).attrs({\r\n  icon: \"fa-registered\",\r\n})``;\r\n\r\nexport const HeartIcon = styled(Icon).attrs({\r\n  icon: \"fa-heart\",\r\n})``;\r\n\r\nexport const TwitterIcon = styled(Icon).attrs({\r\n  prefix: \"fab\",\r\n  icon: \"fa-twitter\",\r\n})``;\r\n\r\nexport const LinkIcon = styled(Icon).attrs({\r\n  icon: \"fa-link\",\r\n})``;\r\n\r\nexport const PlayIcon = memo(\r\n  styled(Icon).attrs({\r\n    icon: \"fa-play\",\r\n  })``\r\n);\r\n\r\nexport const PauseIcon = memo(\r\n  styled(Icon).attrs({\r\n    icon: \"fa-pause\",\r\n  })``\r\n);\r\n\r\nexport const ArrowUp = styled(Icon).attrs({\r\n  icon: \"fa-caret-down\",\r\n})``;\r\n\r\nexport const ArrowDown = styled(Icon).attrs({\r\n  icon: \"fa-caret-up\",\r\n})``;\r\n\r\nexport const CodeBranchIcon = styled(Icon).attrs({\r\n  icon: \" fa-code-branch\",\r\n})``;\r\n\r\nexport const PixivIcon = (props: Omit<IconProps, \"icon\">) => {\r\n  const {\r\n    color = \"black\",\r\n    size = 14,\r\n    onClick = NO_OP,\r\n    left = false,\r\n    right = false,\r\n  } = props;\r\n\r\n  return (\r\n    <IconWrapper onClick={onClick} left={left} right={right}>\r\n      <StyledSvg\r\n        viewBox=\"0 0 24 24\"\r\n        xmlns=\"http://www.w3.org/2000/svg\"\r\n        size={size}\r\n      >\r\n        <path\r\n          fill={color}\r\n          d=\"M4.935 0A4.924 4.924 0 0 0 0 4.935v14.13A4.924 4.924 0 0 0 4.935 24h14.13A4.924 4.924 0 0 0 24 19.065V4.935A4.924 4.924 0 0 0 19.065 0zm7.81 4.547c2.181 0 4.058.676 5.399 1.847a6.118 6.118 0 0 1 2.116 4.66c.005 1.854-.88 3.476-2.257 4.563-1.375 1.092-3.225 1.697-5.258 1.697-2.314 0-4.46-.842-4.46-.842v2.718c.397.116 1.048.365.635.779H5.79c-.41-.41.19-.65.644-.779V7.666c-1.053.81-1.593 1.51-1.868 2.031.32 1.02-.284.969-.284.969l-1.09-1.73s3.868-4.39 9.553-4.39zm-.19.971c-1.423-.003-3.184.473-4.27 1.244v8.646c.988.487 2.484.832 4.26.832h.01c1.596 0 2.98-.593 3.93-1.533.952-.948 1.486-2.183 1.492-3.683-.005-1.54-.504-2.864-1.42-3.86-.918-.992-2.274-1.645-4.002-1.646Z\"\r\n        />\r\n      </StyledSvg>\r\n    </IconWrapper>\r\n  );\r\n};\r\n","import React, { MouseEventHandler } from \"react\";\r\nimport { NO_OP } from \"../data/types\";\r\nimport { CharacterIcon, CopyrightIcon, ArtistIcon } from \"./Icons\";\r\n\r\ninterface TypeIconProps {\r\n  types?: string[];\r\n  className?: string;\r\n  color?: string;\r\n  size?: number;\r\n  onClick?: MouseEventHandler;\r\n  left?: boolean;\r\n  right?: boolean;\r\n}\r\n\r\nexport default function TypeIcon(props: TypeIconProps) {\r\n  const { types = [], className = \"\", onClick = NO_OP } = props;\r\n  const interestingType = types.find((t) => !t.match(/^[general|ambiguous]$/));\r\n\r\n  switch (interestingType) {\r\n    case \"character\":\r\n      return <CharacterIcon className={className} onClick={onClick} />;\r\n    case \"copyright\":\r\n      return <CopyrightIcon className={className} onClick={onClick} />;\r\n    case \"artist\":\r\n      return <ArtistIcon className={className} onClick={onClick} />;\r\n    default:\r\n      return null;\r\n  }\r\n}\r\n","import React, { MouseEventHandler } from \"react\";\r\nimport styled, { css } from \"styled-components\";\r\nimport { TagType } from \"../../data/types\";\r\nimport TypeIcon from \"../../icons/TypeIcon\";\r\nimport { formatCount } from \"../../misc/formatting\";\r\nimport { prettifyTagname } from \"../tag/tagUtils\";\r\n\r\ninterface EntryProps {\r\n  name: string;\r\n  posts: number;\r\n  types: TagType[];\r\n  onClick: MouseEventHandler;\r\n}\r\n\r\nconst EntryWrapper = styled.div(\r\n  ({ theme }) => css`\r\n    display: grid;\r\n    grid-template-columns: 48px 1fr auto;\r\n    height: ${theme.dimensions.blockHeight};\r\n    background: white;\r\n    align-items: center;\r\n  `\r\n);\r\n\r\nconst Name = styled.span`\r\n  grid-column: 2/3;\r\n`;\r\n\r\nconst Count = styled.span`\r\n  grid-column: 3/4;\r\n`;\r\n\r\nconst Icon = styled.div`\r\n  grid-column: 1/2;\r\n  text-align: center;\r\n`;\r\n\r\nexport default function DropdownListEntry(props: EntryProps) {\r\n  const { name, posts, types, onClick } = props;\r\n\r\n  return (\r\n    <EntryWrapper onClick={onClick}>\r\n      <Icon>\r\n        <TypeIcon types={types} />\r\n      </Icon>\r\n      <Name>{prettifyTagname(name)}</Name>\r\n      <Count>{formatCount(posts)} posts</Count>\r\n    </EntryWrapper>\r\n  );\r\n}\r\n","import React from \"react\";\r\nimport styled, { css } from \"styled-components\";\r\nimport DropdownListEntry from \"./DropdownListEntry\";\r\nimport TagDataClass from \"../../data/Tag\";\r\nimport { TagType } from \"../../data/types\";\r\nimport { ThemeType } from \"../../misc/theme\";\r\n\r\nfunction sizeAndPosition(tagSelector: HTMLDivElement | null) {\r\n  if (tagSelector) {\r\n    const { offsetTop, clientHeight, offsetLeft, clientWidth } = tagSelector;\r\n\r\n    return css`\r\n      position: absolute;\r\n      top: ${offsetTop + clientHeight}px;\r\n      left: ${offsetLeft}px;\r\n      width: ${clientWidth}px;\r\n      max-height: 50vh;\r\n      overflow-y: scroll;\r\n    `;\r\n  }\r\n\r\n  return \"\";\r\n}\r\n\r\nexport const ListWrapper = styled.div(\r\n  (props: { tagSelectorRef: HTMLDivElement | null; theme: ThemeType }) => css`\r\n    display: flex;\r\n    flex-direction: column;\r\n    ${sizeAndPosition(props.tagSelectorRef)};\r\n    background: lightgrey;\r\n    gap: 1px;\r\n    box-sizing: border-box;\r\n    border: ${props.theme.dimensions.borderWidth}\r\n      ${props.theme.colors.accentColor} solid;\r\n    border-top: none;\r\n    border-radius: 0 0 3px 3px;\r\n    color: black;\r\n    z-index: 3;\r\n  `\r\n);\r\n\r\ninterface DropdownListProps {\r\n  tagSelectorRef: HTMLDivElement | null;\r\n  entries: {\r\n    name: string;\r\n    posts: number;\r\n    types: TagType[];\r\n  }[];\r\n  onClick: (entry: TagDataClass) => void;\r\n}\r\n\r\nexport default function DropdownList(props: DropdownListProps) {\r\n  const { tagSelectorRef, entries, onClick } = props;\r\n\r\n  return entries && entries.length > 0 ? (\r\n    <ListWrapper tagSelectorRef={tagSelectorRef}>\r\n      {entries.map((entry) => (\r\n        <DropdownListEntry\r\n          key={entry.name}\r\n          onClick={() => onClick(entry)}\r\n          {...entry}\r\n        />\r\n      ))}\r\n    </ListWrapper>\r\n  ) : null;\r\n}\r\n","import React, { useState, useEffect, useCallback } from \"react\";\r\nimport styled, { css } from \"styled-components\";\r\nimport api from \"../../misc/api\";\r\nimport { prepareTag } from \"../../misc/prepare\";\r\nimport { AddButton, ModifierButton } from \"../common/Buttons\";\r\nimport TagInput from \"./TagInput\";\r\nimport DropdownList from \"./DropdownList\";\r\nimport { normalizeTagname } from \"../tag/tagUtils\";\r\nimport { useDispatch, useSelector } from \"react-redux\";\r\nimport { addTag } from \"../../redux/actions\";\r\nimport { ThemeType } from \"../../misc/theme\";\r\nimport { selectPreferences } from \"../../redux/selectors\";\r\nimport { MODIFIER, Modifier } from \"../../data/types\";\r\n\r\nexport const TagSelectorWrapper = styled.div(\r\n  (props: {\r\n    closed: boolean;\r\n    ref: (ref: HTMLInputElement) => void;\r\n    theme: ThemeType;\r\n  }) => css`\r\n    display: flex;\r\n    background: white;\r\n    ${props.closed\r\n      ? css`\r\n          border-radius: ${props.theme.dimensions.borderRadius};\r\n        `\r\n      : css`\r\n          border-radius: ${props.theme.dimensions.borderRadius}\r\n            ${props.theme.dimensions.borderRadius} 0 0;\r\n\r\n          > ${AddButton} {\r\n            border-radius: 0 ${props.theme.dimensions.borderRadius} 0 0;\r\n          }\r\n\r\n          > ${ModifierButton} {\r\n            border-radius: ${props.theme.dimensions.borderRadius} 0 0 0;\r\n          }\r\n        `}\r\n  `\r\n);\r\n\r\nexport default function TagSelector() {\r\n  const dispatch = useDispatch();\r\n  const [value, setValue] = useState(\"\");\r\n  const [modifier, setModifier] = useState(Modifier.PLUS);\r\n  const [suggestions, setSuggestions] = useState([]);\r\n  const { tagSuggestionsCount } = useSelector(selectPreferences);\r\n\r\n  const [tagSelectorRef, setTagSelectorRef] = useState<HTMLDivElement | null>(\r\n    null\r\n  );\r\n\r\n  const activateTag = useCallback(\r\n    ({ name, posts, types }) => {\r\n      dispatch(\r\n        addTag(\r\n          prepareTag({\r\n            name,\r\n            types,\r\n            modifier,\r\n            count: posts,\r\n          })\r\n        )\r\n      );\r\n\r\n      setValue(\"\");\r\n      setSuggestions([]);\r\n    },\r\n    [dispatch, modifier]\r\n  );\r\n\r\n  useEffect(() => {\r\n    const handle = setTimeout(() => {\r\n      if (!value) {\r\n        setSuggestions([]);\r\n        return;\r\n      }\r\n\r\n      api\r\n        .getTags(normalizeTagname(value), tagSuggestionsCount)\r\n        .then((newSuggestions) => {\r\n          setSuggestions(newSuggestions);\r\n        });\r\n    }, 300);\r\n\r\n    return () => clearTimeout(handle);\r\n  }, [tagSuggestionsCount, value]);\r\n\r\n  const onModifierClick = useCallback(\r\n    () =>\r\n      setModifier(\r\n        modifier === Modifier.PLUS\r\n          ? Modifier.MINUS\r\n          : modifier === Modifier.MINUS\r\n          ? Modifier.OR\r\n          : Modifier.PLUS\r\n      ),\r\n    [modifier, setModifier]\r\n  );\r\n\r\n  const onAddClick = useCallback(() => {\r\n    if (value && value.trim() !== \"\") {\r\n      const suggestion =\r\n        suggestions.find((s: { name: string }) => s.name === value) || {};\r\n      activateTag({ ...suggestion, name: value });\r\n    }\r\n  }, [value, activateTag, suggestions]);\r\n\r\n  const onSuggestionClick = useCallback((entry) => activateTag(entry), [\r\n    activateTag,\r\n  ]);\r\n\r\n  return (\r\n    <TagSelectorWrapper\r\n      ref={setTagSelectorRef}\r\n      closed={suggestions.length === 0}\r\n    >\r\n      <ModifierButton onClick={onModifierClick} aria-label=\"Tag Modifier\">\r\n        {modifier}\r\n      </ModifierButton>\r\n      <TagInput value={value} setValue={setValue} />\r\n      <AddButton onClick={onAddClick} aria-label=\"Add Tag\">\r\n        Add\r\n      </AddButton>\r\n      {suggestions.length > 0 && (\r\n        <DropdownList\r\n          tagSelectorRef={tagSelectorRef}\r\n          entries={suggestions}\r\n          onClick={onSuggestionClick}\r\n        />\r\n      )}\r\n    </TagSelectorWrapper>\r\n  );\r\n}\r\n","import React from \"react\";\r\nimport styled, { css } from \"styled-components\";\r\n\r\ninterface FlexPairProps {\r\n  children: [JSX.Element, JSX.Element];\r\n}\r\n\r\nconst Wrapper = styled.div(\r\n  ({ theme }) => css`\r\n    display: flex;\r\n    align-items: center;\r\n    gap: ${theme.dimensions.spacing};\r\n  `\r\n);\r\n\r\nexport default function FlexPair({ children }: FlexPairProps) {\r\n  return <Wrapper>{children}</Wrapper>;\r\n}\r\n","import React, { MouseEventHandler } from \"react\";\r\nimport styled, { css } from \"styled-components\";\r\nimport { ThemeType } from \"../../misc/theme\";\r\n\r\nconst Track = styled.div(\r\n  (props) => css`\r\n    border-radius: 30px;\r\n    width: 50px;\r\n    border: ${props.theme.dimensions.borderWidth} solid\r\n      ${props.theme.colors.accentColor};\r\n    background-color: ${props.theme.colors.backgroundColor};\r\n    transition: transform ${props.theme.timings.longTransitionTime} ease-in-out;\r\n  `\r\n);\r\n\r\nconst Thumb = styled.div(\r\n  (props: { value: boolean; theme: ThemeType }) => css`\r\n    width: 20px;\r\n    height: 20px;\r\n    background-color: ${props.value\r\n      ? props.theme.colors.accentColor\r\n      : props.theme.colors.backgroundColor2};\r\n    border-radius: 50%;\r\n    transition: all 0.2s ease-in-out;\r\n    transform: translate(${props.value ? \"30px\" : \"0px\"});\r\n  `\r\n);\r\n\r\ninterface ToggleProps {\r\n  value: boolean;\r\n  onToggle: MouseEventHandler;\r\n}\r\n\r\nexport default function Toggle(props: ToggleProps) {\r\n  const { value, onToggle } = props;\r\n\r\n  return (\r\n    <Track onClick={onToggle}>\r\n      <Thumb value={value} />\r\n    </Track>\r\n  );\r\n}\r\n","import React, { MouseEventHandler } from \"react\";\r\nimport FlexPair from \"./FlexPair\";\r\nimport Toggle from \"./Toggle\";\r\n\r\ninterface LabeledToggleProps {\r\n  children: JSX.Element | string;\r\n  value: boolean;\r\n  onToggle: MouseEventHandler;\r\n}\r\n\r\nexport default function LabeledToggle(props: LabeledToggleProps) {\r\n  const { children, value, onToggle } = props;\r\n\r\n  return (\r\n    <FlexPair>\r\n      <Toggle value={value} onToggle={onToggle} />\r\n      <span>{children}</span>\r\n    </FlexPair>\r\n  );\r\n}\r\n","import React, { useCallback, useState } from \"react\";\r\nimport styled, { css } from \"styled-components\";\r\nimport LabeledToggle from \"../common/LabeledToggle\";\r\nimport { useDispatch, useSelector } from \"react-redux\";\r\nimport { selectPreferences } from \"../../redux/selectors\";\r\nimport { setOption } from \"../../redux/actions\";\r\nimport { ThemeType } from \"../../misc/theme\";\r\nimport { RATED, RATEDTRESHOLD } from \"../../data/types\";\r\n\r\nconst OptionsWrapper = styled.div(\r\n  ({ theme }) => css`\r\n    display: grid;\r\n    gap: ${theme.dimensions.gutter};\r\n  `\r\n);\r\n\r\nconst StyledInput = styled.input(\r\n  (props: { value: number; theme: ThemeType }) => css`\r\n    background: none;\r\n    border: none;\r\n    outline: none;\r\n    color: ${props.theme.colors.accentColor};\r\n    width: ${0.65 * String(props.value).length}em;\r\n    text-align: right;\r\n    font-size: ${props.theme.fontSizes.content};\r\n    margin: -1px 0.2em 0 0.2em;\r\n\r\n    ::-webkit-inner-spin-button,\r\n    ::-webkit-outer-spin-button {\r\n      -webkit-appearance: none;\r\n      margin: 0;\r\n    }\r\n    -moz-appearance: textfield;\r\n  `\r\n);\r\n\r\nexport default function Options() {\r\n  const dispatch = useDispatch();\r\n  const { rated, ratedTreshold } = useSelector(selectPreferences);\r\n\r\n  const [ratedInputValue, setRatedInputValue] = useState(ratedTreshold);\r\n\r\n  const toggleRated = useCallback(() => dispatch(setOption(RATED, !rated)), [\r\n    dispatch,\r\n    rated,\r\n  ]);\r\n\r\n  const setRatedThreshold = useCallback(\r\n    () => dispatch(setOption(RATEDTRESHOLD, ratedInputValue)),\r\n    [dispatch, ratedInputValue]\r\n  );\r\n\r\n  return (\r\n    <OptionsWrapper>\r\n      <LabeledToggle value={rated} onToggle={toggleRated}>\r\n        {rated ? (\r\n          <div style={{ display: \"flex\" }}>\r\n            <span>More than</span>\r\n            <StyledInput\r\n              type=\"number\"\r\n              value={ratedInputValue}\r\n              onChange={(event) =>\r\n                setRatedInputValue(Number(event.target.value))\r\n              }\r\n              onBlur={setRatedThreshold}\r\n            />\r\n            <span>likes</span>\r\n          </div>\r\n        ) : (\r\n          \"Only show Rated Posts\"\r\n        )}\r\n      </LabeledToggle>\r\n    </OptionsWrapper>\r\n  );\r\n}\r\n","import { MouseEventHandler } from \"react\";\r\nimport styled, { css } from \"styled-components\";\r\n\r\nimport { ThemeType } from \"../../misc/theme\";\r\n\r\nconst dropdownBorderRadius = (collapsed: boolean, theme: ThemeType) =>\r\n  collapsed\r\n    ? theme.dimensions.borderRadius\r\n    : `${theme.dimensions.borderRadius} ${theme.dimensions.borderRadius} 0 0`;\r\n\r\nconst switchingColors = (active: boolean, theme: ThemeType) => {\r\n  const fg = active ? theme.colors.backgroundColor : theme.colors.accentColor;\r\n  const bg = active ? theme.colors.accentColor : theme.colors.backgroundColor;\r\n\r\n  return css`\r\n    color: ${fg};\r\n    background-color: ${bg};\r\n    border: ${theme.colors.accentColor} ${theme.dimensions.borderWidth} solid;\r\n    transition: background-color 0.4s ease-in-out;\r\n\r\n    cursor: pointer;\r\n\r\n    :hover,\r\n    :focus,\r\n    :active {\r\n      border-color: ${theme.colors.backgroundColor2};\r\n      color: ${theme.colors.backgroundColor2};\r\n\r\n      svg {\r\n        color: ${theme.colors.backgroundColor2} !important;\r\n      }\r\n    }\r\n  `;\r\n};\r\n\r\nconst TagWrapper = styled.div(\r\n  (props: {\r\n    active: boolean;\r\n    collapsed: boolean;\r\n    onMouseLeave: MouseEventHandler;\r\n    theme: ThemeType;\r\n  }) =>\r\n    css`\r\n      display: flex;\r\n      padding: 0 ${props.theme.dimensions.spacing};\r\n      gap: ${props.theme.dimensions.spacing};\r\n      align-items: center;\r\n      height: ${props.theme.dimensions.blockHeight};\r\n      border-radius: ${dropdownBorderRadius(props.collapsed, props.theme)};\r\n      font-size: ${props.theme.fontSizes.content};\r\n      ${switchingColors(props.active, props.theme)}\r\n    `\r\n);\r\n\r\nexport default TagWrapper;\r\n","import { MouseEventHandler } from \"react\";\r\nimport { useDispatch, useSelector } from \"react-redux\";\r\nimport styled, { css } from \"styled-components\";\r\nimport TagDataClass from \"../../data/Tag\";\r\nimport { Modifier, TagType } from \"../../data/types\";\r\nimport { formatCount } from \"../../misc/formatting\";\r\nimport { removeTag, addTag } from \"../../redux/actions\";\r\nimport { selectActiveTags } from \"../../redux/selectors\";\r\n\r\ninterface TagNameProps {\r\n  modifier: Modifier;\r\n  name: string;\r\n  count?: number | null;\r\n  types?: TagType[];\r\n}\r\n\r\nconst modifierToStyle = {\r\n  [Modifier.PLUS]: css``,\r\n  [Modifier.MINUS]: css`\r\n    text-decoration: line-through;\r\n  `,\r\n  [Modifier.OR]: css`\r\n    font-style: italic;\r\n  `,\r\n};\r\n\r\nconst TagNameSpan = styled.span(\r\n  ({ modifier = Modifier.PLUS }: Pick<TagNameProps, \"modifier\">) => css`\r\n    ${modifierToStyle[modifier]};\r\n  `\r\n);\r\n\r\nexport default function TagName(props: TagNameProps) {\r\n  const { modifier, name, count, types = [] } = props;\r\n  const text = count ? `${name} (${formatCount(count)})` : name;\r\n\r\n  const dispatch = useDispatch();\r\n  const activeTags = useSelector(selectActiveTags);\r\n\r\n  const toggleTag: MouseEventHandler = (event) => {\r\n    event.stopPropagation();\r\n    const tag = new TagDataClass(name, types, count, modifier);\r\n\r\n    if (activeTags[name]) {\r\n      dispatch(removeTag(tag));\r\n    } else {\r\n      dispatch(addTag(tag));\r\n    }\r\n  };\r\n\r\n  return (\r\n    <TagNameSpan modifier={modifier} onClick={toggleTag}>\r\n      {text}\r\n    </TagNameSpan>\r\n  );\r\n}\r\n","import React from \"react\";\r\nimport styled, { css } from \"styled-components\";\r\nimport { Modifier } from \"../../data/types\";\r\nimport TagName from \"./TagName\";\r\n\r\ninterface AliasProps {\r\n  modifier: Modifier;\r\n  name: string;\r\n  count?: number | null;\r\n}\r\n\r\nconst AliasWrapper = styled.div(\r\n  ({ theme }) => css`\r\n    display: flex;\r\n    padding: 0 ${theme.dimensions.bigSpacing};\r\n    gap: ${theme.dimensions.spacing};\r\n    align-items: center;\r\n    height: ${theme.dimensions.blockHeight};\r\n    font-size: ${theme.fontSizes.content};\r\n  `\r\n);\r\n\r\nexport default function Alias(props: AliasProps) {\r\n  const { modifier, name, count } = props;\r\n\r\n  return (\r\n    <AliasWrapper>\r\n      <TagName modifier={modifier} name={name} count={count} />\r\n    </AliasWrapper>\r\n  );\r\n}\r\n","import React from \"react\";\r\nimport styled, { css } from \"styled-components\";\r\nimport TagDataClass from \"../../data/Tag\";\r\nimport { Modifier } from \"../../data/types\";\r\nimport Alias from \"./Alias\";\r\nimport { ThemeType } from \"../../misc/theme\";\r\n\r\nconst ListWrapper = styled.div(\r\n  ({\r\n    theme,\r\n    parentRef,\r\n  }: {\r\n    theme: ThemeType;\r\n    parentRef: HTMLDivElement;\r\n  }) => css`\r\n    position: absolute;\r\n    top: ${parentRef.offsetTop + parentRef.clientHeight + 4}px;\r\n    left: ${parentRef.offsetLeft}px;\r\n    width: ${parentRef.clientWidth + 4}px;\r\n\r\n    display: flex;\r\n    flex-direction: column;\r\n\r\n    border-bottom-left-radius: ${theme.dimensions.borderRadius};\r\n    border-bottom-right-radius: ${theme.dimensions.borderRadius};\r\n    border: ${theme.dimensions.borderWidth} solid ${theme.colors.accentColor};\r\n    border-top: none;\r\n\r\n    background: ${theme.colors.backgroundColor};\r\n    z-index: 3;\r\n    color: ${theme.colors.accentColor};\r\n\r\n    > :not(:last-child) {\r\n      border-bottom: ${theme.dimensions.borderWidth} solid\r\n        ${theme.colors.accentColor};\r\n    }\r\n  `\r\n);\r\n\r\ninterface AliasesListProps {\r\n  aliases: TagDataClass[];\r\n  modifier: Modifier;\r\n  parentRef: HTMLDivElement;\r\n}\r\n\r\nexport default function AliasesList(props: AliasesListProps) {\r\n  const { aliases, modifier, parentRef } = props;\r\n\r\n  return (\r\n    <ListWrapper parentRef={parentRef}>\r\n      {aliases.map(({ name, count }) => (\r\n        <Alias\r\n          key={\"a_\" + name}\r\n          modifier={modifier}\r\n          name={name}\r\n          count={count}\r\n        />\r\n      ))}\r\n    </ListWrapper>\r\n  );\r\n}\r\n","import React, { useEffect, MouseEventHandler, useState } from \"react\";\r\nimport \"./Tag.css\";\r\nimport api from \"../../misc/api\";\r\nimport TypeIcon from \"../../icons/TypeIcon\";\r\nimport { ArrowIcon } from \"../../icons/Icons\";\r\nimport { formatCount } from \"../../misc/formatting\";\r\nimport TagDataClass from \"../../data/Tag\";\r\nimport { useDispatch, useSelector } from \"react-redux\";\r\nimport {\r\n  selectActiveTags,\r\n  selectAliasesByTagName,\r\n} from \"../../redux/selectors\";\r\nimport { addAliases, removeTag, addTag } from \"../../redux/actions\";\r\nimport useToggle from \"../../hooks/useToggle\";\r\nimport TagWrapper from \"./TagWrapper\";\r\nimport TagName from \"./TagName\";\r\nimport { Modifier } from \"../../data/types\";\r\nimport AliasesList from \"./AliasesList\";\r\n\r\n/**\r\n * Same data as a tag but different names\r\n */\r\ntype TagLike = {\r\n  name: string;\r\n  posts: number;\r\n};\r\n\r\ninterface TagProps extends TagDataClass {\r\n  loadAliases: boolean;\r\n}\r\n\r\nexport default function NewTag(props: TagProps) {\r\n  const { name, count, modifier = Modifier.PLUS, types, loadAliases } = props;\r\n  const dispatch = useDispatch();\r\n  const activeTags = useSelector(selectActiveTags);\r\n  const [collapsed, toggleCollapsed, resetCollapsed] = useToggle(true);\r\n  const aliases = useSelector(selectAliasesByTagName(name));\r\n  const [tagRef, setTagRef] = useState<HTMLDivElement | null>(null);\r\n\r\n  const isActive = Boolean(activeTags[name]);\r\n\r\n  useEffect(() => {\r\n    if (loadAliases && activeTags[name])\r\n      api.getAliases(name).then((newAliases: TagLike[]) => {\r\n        newAliases.sort((a, b) => b.posts - a.posts);\r\n        const filtered = newAliases\r\n          .filter((alias) => !activeTags[alias.name])\r\n          .map((alias) => new TagDataClass(alias.name, [], alias.posts));\r\n        dispatch(addAliases(filtered, name));\r\n      });\r\n  }, [loadAliases, name, activeTags, dispatch]);\r\n\r\n  return (\r\n    <TagWrapper\r\n      active={isActive}\r\n      collapsed={collapsed}\r\n      onMouseLeave={resetCollapsed}\r\n      ref={setTagRef}\r\n    >\r\n      <TypeIcon types={types} />\r\n      <TagName modifier={modifier} name={name} count={count} />\r\n      {loadAliases && aliases?.length > 0 && (\r\n        <>\r\n          <ArrowIcon onClick={toggleCollapsed} />\r\n          {!collapsed && tagRef && (\r\n            <AliasesList\r\n              aliases={aliases}\r\n              modifier={modifier}\r\n              parentRef={tagRef}\r\n            />\r\n          )}\r\n        </>\r\n      )}\r\n    </TagWrapper>\r\n  );\r\n}\r\n","import React from \"react\";\r\nimport styled, { css } from \"styled-components\";\r\nimport TagDataClass from \"../../data/Tag\";\r\nimport { SimpleMap } from \"../../data/types\";\r\nimport { ThemeType } from \"../../misc/theme\";\r\nimport NewTag from \"./NewTag\";\r\n\r\nexport const TagListWrapper = styled.div(\r\n  (props: { padding: boolean; theme: ThemeType }) => css`\r\n    display: inline-flex;\r\n    flex-wrap: wrap;\r\n    gap: ${props.theme.dimensions.gutter};\r\n  `\r\n);\r\n\r\ninterface TagListProps {\r\n  tags: SimpleMap<TagDataClass>;\r\n  loadAliases?: boolean;\r\n  padding?: boolean;\r\n}\r\n\r\nexport default function TagList(props: TagListProps) {\r\n  const { tags, loadAliases = false, padding = false } = props;\r\n\r\n  return (\r\n    <div>\r\n      <TagListWrapper padding={padding}>\r\n        {Object.entries(tags).map(([key, tag]) => (\r\n          <NewTag key={key} {...tag} loadAliases={loadAliases} />\r\n        ))}\r\n      </TagListWrapper>\r\n    </div>\r\n  );\r\n}\r\n","import React from \"react\";\r\nimport { ThemeType } from \"../misc/theme\";\r\nimport { useTheme } from \"styled-components\";\r\n\r\nexport default function R34Icon(props: { size: number }) {\r\n  const theme = useTheme() as ThemeType;\r\n\r\n  return (\r\n    <svg\r\n      xmlns=\"http://www.w3.org/2000/svg\"\r\n      width={props.size}\r\n      height={props.size}\r\n      viewBox=\"0 0 12.7 12.7\"\r\n    >\r\n      <g transform=\"translate(0,-284.3)\">\r\n        <circle\r\n          id=\"path18\"\r\n          cx=\"6.3499999\"\r\n          cy=\"290.65002\"\r\n          fill=\"none\"\r\n          stroke={theme.colors.accentColor}\r\n          strokeWidth=\"0.50848764\"\r\n          strokeMiterlimit=\"4\"\r\n          strokeDasharray=\"none\"\r\n          strokeOpacity=\"1\"\r\n          r=\"6.0957561\"\r\n        />\r\n        <text\r\n          fontStyle=\"normal\"\r\n          fontWeight=\"normal\"\r\n          fontSize=\"8.3113203px\"\r\n          fontFamily=\"sansSerif\"\r\n          letterSpacing=\"0px\"\r\n          wordSpacing=\"0px\"\r\n          fill={theme.colors.accentColor}\r\n          fillOpacity=\"1\"\r\n          x=\"2.1363549\"\r\n          y=\"289.02704\"\r\n          id=\"text4533\"\r\n          transform=\"scale(0.98538224,1.0148346)\"\r\n        >\r\n          <tspan\r\n            id=\"tspan4531\"\r\n            x=\"2\"\r\n            y=\"289.1\"\r\n            fontStyle=\"normal\"\r\n            fontVariant=\"normal\"\r\n            fontWeight=\"300\"\r\n            fontStretch=\"normal\"\r\n            fontFamily=\"Calibri\"\r\n            fill={theme.colors.accentColor}\r\n            fillOpacity=\"1\"\r\n          >\r\n            34\r\n          </tspan>\r\n        </text>\r\n      </g>\r\n    </svg>\r\n  );\r\n}\r\n","import styled, { css } from \"styled-components\";\r\n\r\nexport const HorizontalLine = styled.div(\r\n  (props) => css`\r\n    align-self: stretch;\r\n    height: 1px;\r\n    background: ${props.theme.misc.layer};\r\n  `\r\n);\r\n\r\nexport const VerticalLine = styled.div(\r\n  (props) => css`\r\n    width: 1px;\r\n    align-self: stretch;\r\n    background: ${props.theme.misc.layer};\r\n  `\r\n);\r\n","import React, { RefAttributes } from \"react\";\r\nimport { Link, LinkProps, useLocation } from \"react-router-dom\";\r\nimport styled, { css, ThemeProps } from \"styled-components\";\r\nimport { RouteName } from \"../../data/types\";\r\nimport R34Icon from \"../../icons/R34Icon\";\r\nimport { VerticalLine } from \"../common/Lines\";\r\nimport { BigTitle } from \"../common/Text\";\r\n\r\nconst HeaderWrapper = styled.header(\r\n  ({ theme }) => css`\r\n    display: flex;\r\n    flex-direction: column;\r\n    gap: ${theme.dimensions.bigSpacing};\r\n  `\r\n);\r\n\r\nconst TitleBar = styled.div(\r\n  ({ theme }) => css`\r\n    display: flex;\r\n    gap: ${theme.dimensions.bigSpacing};\r\n    align-items: center;\r\n    justify-content: center;\r\n    background: ${theme.misc.layer};\r\n    padding: ${theme.dimensions.gutter} 0;\r\n    ${theme.shadow.box};\r\n  `\r\n);\r\n\r\nconst MenuBar = styled.nav(\r\n  ({ theme }) => css`\r\n    display: flex;\r\n    justify-content: center;\r\n    padding: ${theme.dimensions.bigSpacing};\r\n    gap: ${theme.dimensions.hugeSpacing};\r\n  `\r\n);\r\n\r\ntype LocationStyledLinkProps = LinkProps<unknown> &\r\n  RefAttributes<HTMLAnchorElement> &\r\n  ThemeProps<any> & { current: string };\r\n\r\nconst LocationStyledLink = styled(Link)(\r\n  ({ to, current, theme }: LocationStyledLinkProps) => css`\r\n    color: ${to === current\r\n      ? theme.colors.accentColor\r\n      : theme.colors.backgroundColor2};\r\n  `\r\n);\r\n\r\nexport default function Header() {\r\n  const current = useLocation().pathname;\r\n\r\n  return (\r\n    <HeaderWrapper role=\"cell\">\r\n      <TitleBar>\r\n        <R34Icon size={32} />\r\n        <VerticalLine />\r\n        <BigTitle>\r\n          Browse <a href=\"https://rule34.xxx\">Rule34</a>\r\n        </BigTitle>\r\n      </TitleBar>\r\n\r\n      <MenuBar role=\"cell\">\r\n        <LocationStyledLink current={current} to={RouteName.SEARCH}>\r\n          Search\r\n        </LocationStyledLink>\r\n        <VerticalLine />\r\n        <LocationStyledLink current={current} to={RouteName.HELP}>\r\n          Help\r\n        </LocationStyledLink>\r\n        <VerticalLine />\r\n        <LocationStyledLink current={current} to={RouteName.SETTINGS}>\r\n          Settings\r\n        </LocationStyledLink>\r\n      </MenuBar>\r\n    </HeaderWrapper>\r\n  );\r\n}\r\n","import React from \"react\";\r\nimport styled, { css } from \"styled-components\";\r\nimport { VerticalLine } from \"../common/Lines\";\r\n\r\nconst FotterWrapper = styled.footer(\r\n  (props) => css`\r\n    display: grid;\r\n    grid-template-columns: 1fr 1px 1fr 1px 1fr;\r\n    justify-content: space-around;\r\n    padding: ${props.theme.dimensions.spacing};\r\n  `\r\n);\r\n\r\nconst CenteredA = styled.a`\r\n  text-align: center;\r\n`;\r\n\r\nexport default function Footer() {\r\n  return (\r\n    <FotterWrapper>\r\n      <CenteredA href=\"https://github.com/kurozenzen/r34-react/issues/new?template=bug_report.md\">\r\n        Report a bug\r\n      </CenteredA>\r\n      <VerticalLine />\r\n      <CenteredA href=\"https://github.com/kurozenzen/r34-react\">\r\n        Github\r\n      </CenteredA>\r\n      <VerticalLine />\r\n      <CenteredA href=\"https://github.com/kurozenzen/r34-react/issues/new?template=feature_request.md\">\r\n        Feature request\r\n      </CenteredA>\r\n    </FotterWrapper>\r\n  );\r\n}\r\n","import styled, { css } from \"styled-components\";\r\n\r\nconst FlexColumn = styled.div`\r\n  display: flex;\r\n  flex-direction: column;\r\n  width: 100%;\r\n  min-height: 100%;\r\n`;\r\n\r\nexport default FlexColumn;\r\n\r\nexport const FlexColumnWithSpacing = styled(FlexColumn)(\r\n  ({ theme }) => css`\r\n    gap: ${theme.dimensions.gutter};\r\n    padding: ${theme.dimensions.gutter};\r\n  `\r\n);\r\n","import React from \"react\";\r\nimport { Title } from \"../common/Text\";\r\nimport Surface from \"../common/Surface\";\r\nimport TagSelector from \"../tagSelector/TagSelector\";\r\nimport Options from \"../features/Options\";\r\nimport TagList from \"../tag/TagList\";\r\nimport Header from \"../features/Header\";\r\nimport Footer from \"../features/Footer\";\r\nimport FlexColumn, { FlexColumnWithSpacing } from \"../common/FlexColumn\";\r\nimport styled, { css } from \"styled-components\";\r\nimport { HorizontalLine } from \"../common/Lines\";\r\nimport { Modifier } from \"../../data/types\";\r\n\r\nconst FlexRow = styled.div(\r\n  ({ theme }) => css`\r\n    display: flex;\r\n    gap: ${theme.dimensions.bigSpacing};\r\n    justify-content: center;\r\n    padding: ${theme.dimensions.spacing};\r\n  `\r\n);\r\n\r\nconst StyledOl = styled.ol(\r\n  ({ theme }) => css`\r\n    padding-left: 1rem;\r\n    display: flex;\r\n    flex-direction: column;\r\n    gap: ${theme.dimensions.spacing};\r\n  `\r\n);\r\n\r\nexport default function Help() {\r\n  return (\r\n    <FlexColumn>\r\n      <Header />\r\n      <FlexColumnWithSpacing>\r\n        <Title>Help</Title>\r\n        <FlexRow>\r\n          <a href=\"https://github.com/kurozenzen/r34-react/issues/new?template=bug_report.md\">\r\n            Report a bug\r\n          </a>\r\n          or\r\n          <a href=\"https://github.com/kurozenzen/r34-react/issues/new?template=feature_request.md\">\r\n            Request a feature\r\n          </a>\r\n        </FlexRow>\r\n        <Surface>\r\n          <Title>Searching for Tags</Title>\r\n          <HorizontalLine />\r\n          <TagSelector />\r\n          <HorizontalLine />\r\n          <p>\r\n            You can use the Tag Selector to look for tags you like.The Tag\r\n            Selector has 4 parts.\r\n          </p>\r\n          <StyledOl>\r\n            <li>\r\n              The modifier (left) determines wether posts must match a tag or\r\n              not. Putting \"-\" will hide all posts with this tag\r\n            </li>\r\n            <li>\r\n              The Search Box (center) allows you to search for tags. As soon as\r\n              you start typing the Tag Selector will show you relevant tags to\r\n              choose from (4).\r\n            </li>\r\n            <li>\r\n              The Add Button (right) Allows you to add any tag to the current\r\n              filter. Usefull when using wildcards.\r\n            </li>\r\n            <li>\r\n              The Tag Dropdown (left) automatically shows tags that start with\r\n              your input. It also includes The number of posts tagged, to allow\r\n              you to weigh tags against each other.\r\n            </li>\r\n          </StyledOl>\r\n        </Surface>\r\n        <Surface>\r\n          <Title>Options</Title>\r\n          <HorizontalLine />\r\n          <Options />\r\n          <HorizontalLine />\r\n          <p>\r\n            Options allow you to customize your experience in various ways.\r\n            There are 3 options available\r\n          </p>\r\n          <StyledOl>\r\n            <li>\r\n              Infinite Scrolling automatically loads new posts when you get\r\n              close to the bottom of the page.\r\n            </li>\r\n            <li>\r\n              Only show Rated posts filters out posts below the specified amount\r\n              of posts.\r\n            </li>\r\n            <li>\r\n              Load original sizes always loads the highest quality of an image.\r\n              This can easily cause extreme data consumption. Don't use with\r\n              mobile data.\r\n            </li>\r\n          </StyledOl>\r\n        </Surface>\r\n        <Surface>\r\n          <Title>Tags</Title>\r\n          <HorizontalLine />\r\n          <TagList\r\n            tags={{\r\n              \"Tag 1\": { name: \"Tag 1\" },\r\n              \"Tag 2\": { name: \"Tag 2\", types: [\"character\"] },\r\n              \"Tag 3\": {\r\n                name: \"Tag 3\",\r\n                modifier: Modifier.MINUS,\r\n                types: [\"copyright\"],\r\n                count: 1020,\r\n              },\r\n            }}\r\n          />\r\n          <HorizontalLine />\r\n          <p>\r\n            This whole application is based on tags. Every Post has multiple\r\n            tags. Usually you can enable/disable a tag just by tapping it. If a\r\n            tag is red it means its active. The icons next to the name show what\r\n            type of tag it is. Not every tag has a type. The number on the right\r\n            shows how many posts there are with that tag.\r\n          </p>\r\n        </Surface>\r\n      </FlexColumnWithSpacing>\r\n\r\n      <Footer />\r\n    </FlexColumn>\r\n  );\r\n}\r\n","import React, { useCallback, useEffect, useMemo, useState } from \"react\";\r\nimport {\r\n  CellMeasurer,\r\n  CellMeasurerCache,\r\n  IndexRange,\r\n  InfiniteLoader,\r\n  List,\r\n} from \"react-virtualized\";\r\nimport LayoutElementProps from \"../LayoutElementProps\";\r\n\r\ninterface InfiniteColumnProps<T> {\r\n  Header?: (props: LayoutElementProps) => JSX.Element;\r\n  OutOfItems?: (props: LayoutElementProps) => JSX.Element;\r\n  items?: T[];\r\n  LoadingItem: (props: LayoutElementProps) => JSX.Element;\r\n  hasMoreRows: boolean;\r\n  loadMore: () => void;\r\n  ItemComponent: (props: T & LayoutElementProps) => JSX.Element;\r\n  isLoading: boolean;\r\n  setLoading: (value: boolean) => void;\r\n}\r\n\r\nexport default function InifinteColumn<T>(props: InfiniteColumnProps<T>) {\r\n  const {\r\n    Header,\r\n    items = [],\r\n    LoadingItem,\r\n    hasMoreRows,\r\n    ItemComponent,\r\n    loadMore,\r\n    OutOfItems,\r\n    isLoading,\r\n    setLoading,\r\n  } = props;\r\n\r\n  const [listRef, setListRef] = useState<List | null>(null);\r\n\r\n  const cache = useMemo(\r\n    () =>\r\n      new CellMeasurerCache({\r\n        fixedWidth: true,\r\n      }),\r\n    []\r\n  );\r\n\r\n  const prependedRows = Header ? 1 : 0;\r\n  const loadingRows = 1;\r\n\r\n  const rowCount = items.length + prependedRows + loadingRows;\r\n\r\n  const isRowLoaded = useCallback(\r\n    ({ index }: { index: number }) =>\r\n      index < prependedRows + items.length + (hasMoreRows ? 0 : 1),\r\n    [hasMoreRows, items.length, prependedRows]\r\n  );\r\n\r\n  useEffect(() => {\r\n    if (listRef) {\r\n      const listener = () => {\r\n        listRef.measureAllRows();\r\n        listRef.recomputeRowHeights();\r\n        listRef.forceUpdateGrid();\r\n      };\r\n\r\n      window.addEventListener(\"resize\", listener);\r\n\r\n      return () => {\r\n        window.removeEventListener(\"resize\", listener);\r\n      };\r\n    }\r\n  }, [listRef]);\r\n\r\n  const rowRenderer = useCallback(\r\n    ({\r\n      index,\r\n      key,\r\n      parent,\r\n      style,\r\n    }: {\r\n      index: number;\r\n      key: any;\r\n      parent: any;\r\n      style: any;\r\n    }) => {\r\n      return (\r\n        <CellMeasurer\r\n          cache={cache}\r\n          columnIndex={0}\r\n          key={key}\r\n          rowIndex={index}\r\n          parent={parent}\r\n        >\r\n          {({ measure, registerChild }) => {\r\n            // Index 0\r\n            if (Header && index < prependedRows) {\r\n              return (\r\n                <Header\r\n                  style={style}\r\n                  virtualRef={registerChild}\r\n                  onLoad={measure}\r\n                />\r\n              );\r\n            }\r\n\r\n            // Index 1\r\n            if (index < prependedRows + items.length) {\r\n              return (\r\n                <ItemComponent\r\n                  style={style}\r\n                  virtualRef={registerChild}\r\n                  onLoad={measure}\r\n                  {...items[index - prependedRows]}\r\n                />\r\n              );\r\n            }\r\n\r\n            // Index 2\r\n            if (index < prependedRows + items.length + loadingRows) {\r\n              return hasMoreRows || isLoading ? (\r\n                <LoadingItem\r\n                  style={style}\r\n                  virtualRef={registerChild}\r\n                  onLoad={measure}\r\n                />\r\n              ) : OutOfItems && items.length > 0 ? (\r\n                <OutOfItems\r\n                  style={style}\r\n                  virtualRef={registerChild}\r\n                  onLoad={measure}\r\n                />\r\n              ) : (\r\n                <div></div>\r\n              );\r\n            }\r\n\r\n            console.warn(\"index not found / out of bounds. INDEX:\", index);\r\n            return null;\r\n          }}\r\n        </CellMeasurer>\r\n      );\r\n    },\r\n    [\r\n      cache,\r\n      Header,\r\n      prependedRows,\r\n      items,\r\n      ItemComponent,\r\n      hasMoreRows,\r\n      isLoading,\r\n      LoadingItem,\r\n      OutOfItems,\r\n    ]\r\n  );\r\n\r\n  const loadMoreRows = (params: IndexRange) => {\r\n    if (isLoading || !hasMoreRows) {\r\n      return Promise.reject(0);\r\n    }\r\n\r\n    setLoading(true);\r\n    loadMore();\r\n\r\n    return new Promise((resolve) => {\r\n      setTimeout(() => {\r\n        setLoading(false);\r\n        resolve(1);\r\n      }, 1000);\r\n    });\r\n  };\r\n\r\n  return (\r\n    <InfiniteLoader\r\n      isRowLoaded={isRowLoaded}\r\n      loadMoreRows={loadMoreRows}\r\n      rowCount={rowCount}\r\n    >\r\n      {({ onRowsRendered, registerChild }) => {\r\n        const registerChildHereAswell = (child: List) => {\r\n          setListRef(child);\r\n          registerChild(child);\r\n        };\r\n        return (\r\n          <List\r\n            ref={registerChildHereAswell}\r\n            onRowsRendered={onRowsRendered}\r\n            rowRenderer={rowRenderer}\r\n            deferredMeasurementCache={cache}\r\n            overscanRowCount={10}\r\n            rowCount={items.length + prependedRows + loadingRows}\r\n            rowHeight={cache.rowHeight}\r\n            width={window.innerWidth}\r\n            height={window.innerHeight}\r\n          />\r\n        );\r\n      }}\r\n    </InfiniteLoader>\r\n  );\r\n}\r\n","import { RatingType } from \"../../data/types\";\r\nimport React from \"react\";\r\nimport { RatingIcon } from \"../../icons/Icons\";\r\nimport FlexPair from \"../common/FlexPair\";\r\n\r\nexport default function Rating(props: { value: RatingType }) {\r\n  return (\r\n    <FlexPair>\r\n      <RatingIcon color=\"white\" />\r\n      <span>{props.value[0].toUpperCase()}</span>\r\n    </FlexPair>\r\n  );\r\n}\r\n","import React from \"react\";\r\nimport { HeartIcon } from \"../../icons/Icons\";\r\nimport FlexPair from \"../common/FlexPair\";\r\n\r\nexport default (props: { value: number }) => (\r\n  <FlexPair>\r\n    <HeartIcon color=\"white\" />\r\n    <span>{props.value}</span>\r\n  </FlexPair>\r\n);\r\n","import React from \"react\";\r\nimport styled, { css } from \"styled-components\";\r\nimport {\r\n  LinkIcon,\r\n  PixivIcon,\r\n  SourceIcon,\r\n  TwitterIcon,\r\n} from \"../../icons/Icons\";\r\nimport { formatSource } from \"../../misc/formatting\";\r\nimport FlexPair from \"../common/FlexPair\";\r\n\r\nconst ColoredA = styled.a(\r\n  (props) => css`\r\n    color: ${props.color} !important;\r\n    display: flex;\r\n    gap: ${props.theme.dimensions.spacing};\r\n  `\r\n);\r\n\r\ninterface SourceProps {\r\n  value: string;\r\n}\r\n\r\nexport default function Source({ value }: SourceProps) {\r\n  if (value.startsWith(\"http\")) {\r\n    if (value.includes(\"twitter\")) {\r\n      return <TwitterLink value={value} />;\r\n    }\r\n\r\n    if (value.includes(\"pixiv\")) {\r\n      return <PixivSource value={value} />;\r\n    }\r\n\r\n    return <DefaultLink value={value} />;\r\n  }\r\n\r\n  return <FallbackSource value={value} />;\r\n}\r\n\r\nconst FallbackSource = ({ value }: SourceProps) => {\r\n  return (\r\n    <FlexPair>\r\n      <SourceIcon color=\"white\" left />\r\n      <span>{value}</span>\r\n    </FlexPair>\r\n  );\r\n};\r\n\r\nconst DefaultLink = ({ value }: SourceProps) => {\r\n  return (\r\n    <a\r\n      href={value}\r\n      target=\"_blank\"\r\n      rel=\"noopener noreferrer\"\r\n      className=\"source\"\r\n    >\r\n      <LinkIcon color=\"red\" left />\r\n      {formatSource(value)}\r\n    </a>\r\n  );\r\n};\r\n\r\nconst TwitterLink = ({ value }: SourceProps) => {\r\n  return (\r\n    <ColoredA\r\n      href={value}\r\n      target=\"_blank\"\r\n      rel=\"noopener noreferrer\"\r\n      className=\"source\"\r\n      color=\"rgb(29, 161, 242)\"\r\n    >\r\n      <TwitterIcon color=\"rgb(29, 161, 242)\" left />\r\n      {value.split(\"twitter.com/\")[1].split(\" \")[0].split(\"?\")[0].split(\"/\")[0]}\r\n    </ColoredA>\r\n  );\r\n};\r\n\r\nconst PixivSource = ({ value }: SourceProps) => {\r\n  return (\r\n    <ColoredA\r\n      href={value}\r\n      target=\"_blank\"\r\n      rel=\"noopener noreferrer\"\r\n      className=\"source\"\r\n      color=\"rgb(29, 161, 242)\"\r\n    >\r\n      <PixivIcon color=\"rgb(29, 161, 242)\" left />\r\n      <span>Pixiv</span>\r\n    </ColoredA>\r\n  );\r\n};\r\n","import React, { useMemo } from \"react\";\r\nimport styled, { css } from \"styled-components\";\r\nimport TagList from \"../tag/TagList\";\r\nimport { RatingType } from \"../../data/types\";\r\nimport TagDataClass from \"../../data/Tag\";\r\nimport { listToMap } from \"../../data/utils\";\r\nimport Rating from \"./Rating\";\r\nimport Score from \"./Score\";\r\nimport Source from \"./Source\";\r\n\r\nconst Bar = styled.div(\r\n  ({ theme: { dimensions, misc, shadow } }) => css`\r\n    grid-row: 2/3;\r\n    display: flex;\r\n    flex-wrap: wrap;\r\n    justify-content: space-between;\r\n    background: ${misc.layer};\r\n    padding: ${dimensions.bigSpacing};\r\n    ${shadow.box};\r\n    border-radius: 0 0 ${dimensions.borderRadius} ${dimensions.borderRadius};\r\n  `\r\n);\r\n\r\nconst DetailsTagList = styled(TagList)`\r\n  grid-row: 3/4;\r\n`;\r\n\r\ninterface DetailsProps {\r\n  rating: RatingType;\r\n  score: number;\r\n  source: string;\r\n  tags: TagDataClass[];\r\n}\r\n\r\nexport default function Details(props: DetailsProps) {\r\n  const { rating, score, source, tags } = props;\r\n  const tagsForRendering = useMemo(() => listToMap(tags, \"name\"), [tags]);\r\n\r\n  return (\r\n    <>\r\n      <Bar>\r\n        {!!rating && <Rating value={rating} />}\r\n        {!!score && <Score value={score} />}\r\n        {!!source && <Source value={source} />}\r\n      </Bar>\r\n      <DetailsTagList tags={tagsForRendering} padding loadAliases={false} />\r\n    </>\r\n  );\r\n}\r\n","import { SimpleMap } from \"./types\";\r\n\r\nexport const listToMap = <T>(list: T[], keyProp: string): SimpleMap<T> => {\r\n  return list.reduce((result: SimpleMap<T>, current: any) => {\r\n    result[current[keyProp]] = current;\r\n    return result;\r\n  }, {});\r\n};\r\n","import styled from \"styled-components\";\r\n\r\nconst FlexVideo = styled.video`\r\n  width: 100%;\r\n  height: 100%;\r\n  display: block;\r\n  object-fit: contain;\r\n  grid-area: 1/1/2/2;\r\n`;\r\n\r\nexport default FlexVideo;\r\n","import { keyframes } from \"styled-components\";\r\n\r\nexport const fadeOut = keyframes`\r\n  from {\r\n    opacity: 1;\r\n  }\r\n\r\n  to {\r\n    opacity: 0;\r\n  }\r\n`;\r\n\r\nexport const kofiWiggle = keyframes`\r\n  0% {\r\n    transform: rotate(0) scale(1);\r\n  }\r\n  60% {\r\n    transform: rotate(0) scale(1);\r\n  }\r\n  75% {\r\n    transform: rotate(0) scale(1.12);\r\n  }\r\n  80% {\r\n    transform: rotate(0) scale(1.1);\r\n  }\r\n  84% {\r\n    transform: rotate(-10deg) scale(1.1);\r\n  }\r\n  88% {\r\n    transform: rotate(10deg) scale(1.1);\r\n  }\r\n  92% {\r\n    transform: rotate(-10deg) scale(1.1);\r\n  }\r\n  96% {\r\n    transform: rotate(10deg) scale(1.1);\r\n  }\r\n  100% {\r\n    transform: rotate(0) scale(1);\r\n  }\r\n`;\r\n","import React, { MouseEventHandler } from \"react\";\r\n\r\nimport {\r\n  ExpandIcon,\r\n  PlayIcon,\r\n  PauseIcon,\r\n  ExternalLinkIcon,\r\n} from \"../../icons/Icons\";\r\nimport styled, { css } from \"styled-components\";\r\nimport useToggle from \"../../hooks/useToggle\";\r\nimport { fadeOut } from \"../styled/animations\";\r\nimport { InvisButton } from \"../common/Buttons\";\r\nimport { NO_OP } from \"../../data/types\";\r\nimport { formatDuration } from \"../../misc/formatting\";\r\n\r\nconst Wrapper = styled.div(\r\n  (props: { isVisible: boolean }) => css`\r\n    grid-area: 1/1/2/2;\r\n    display: grid;\r\n    grid-template-columns: repeat(3, 1fr);\r\n    grid-template-rows: auto 1fr auto auto;\r\n    z-index: 1;\r\n\r\n    ${!props.isVisible\r\n      ? css`\r\n          opacity: 0;\r\n          animation: ${fadeOut} 0.4s ease-in-out;\r\n        `\r\n      : \"\"};\r\n  `\r\n);\r\n\r\nconst ProgressBar = styled.div(\r\n  (props) => css`\r\n    grid-area: 4/1/4/4;\r\n    height: 5px;\r\n    background-color: ${props.theme.colors.accentColor};\r\n  `\r\n);\r\n\r\nconst OverlayButton = styled(InvisButton)(\r\n  (props) => css`\r\n    width: max-content;\r\n    height: max-content;\r\n    padding: ${props.theme.dimensions.bigSpacing};\r\n  `\r\n);\r\n\r\nconst FullScreenButton = styled(OverlayButton)`\r\n  grid-area: 1/1/2/2;\r\n  place-self: start start;\r\n`;\r\n\r\nconst OpenExternalButton = styled(OverlayButton)`\r\n  grid-area: 3/1/4/1;\r\n  place-self: end start;\r\n`;\r\n\r\nconst PlayButton = styled(OverlayButton)`\r\n  grid-area: 2/2/3/3;\r\n  place-self: center center;\r\n`;\r\n\r\nconst LengthDisplay = styled.span(\r\n  (props) => css`\r\n    grid-area: 3/3/4/4;\r\n    place-self: end end;\r\n    background: #00000080;\r\n    border-radius: 4px;\r\n    padding: ${props.theme.dimensions.spacing};\r\n    margin: ${props.theme.dimensions.spacing};\r\n  `\r\n);\r\n\r\ninterface OverlayProps {\r\n  onFullscreen?: MouseEventHandler;\r\n  externalSrc: string;\r\n  togglePlay?: MouseEventHandler;\r\n  isPaused?: boolean;\r\n  isPlayable: boolean;\r\n  currentTime?: number;\r\n  duration?: number;\r\n  mediaRef?: HTMLVideoElement | null;\r\n}\r\n\r\nfunction Overlay(props: OverlayProps) {\r\n  const {\r\n    onFullscreen = NO_OP,\r\n    togglePlay = NO_OP,\r\n    isPaused = true,\r\n    isPlayable = false,\r\n    currentTime = 0,\r\n    duration = null,\r\n    externalSrc,\r\n    mediaRef,\r\n  } = props;\r\n\r\n  const [isVisible, toggleVisible] = useToggle();\r\n\r\n  return (\r\n    <Wrapper isVisible={isPaused || isVisible} onClick={toggleVisible}>\r\n      {onFullscreen && (\r\n        <FullScreenButton onClick={onFullscreen} aria-label=\"Open Fullscreen\">\r\n          <ExpandIcon color=\"white\" />\r\n        </FullScreenButton>\r\n      )}\r\n\r\n      <OpenExternalButton>\r\n        <a\r\n          href={externalSrc}\r\n          target=\"_blank\"\r\n          rel=\"noopener noreferrer\"\r\n          aria-label=\"Open In New Tab\"\r\n        >\r\n          <ExternalLinkIcon color=\"white\" />\r\n        </a>\r\n      </OpenExternalButton>\r\n\r\n      {isPlayable && (\r\n        <>\r\n          <PlayButton onClick={togglePlay} aria-label=\"Play/Pause\">\r\n            {isPaused ? (\r\n              <PlayIcon color=\"white\" size={50} />\r\n            ) : (\r\n              <PauseIcon color=\"white\" size={50} />\r\n            )}\r\n          </PlayButton>\r\n          {!!duration && !!currentTime && (\r\n            <ProgressBar\r\n              style={{ width: `${(currentTime / duration) * 100}%` }}\r\n            />\r\n          )}\r\n\r\n          {mediaRef && !isNaN(mediaRef.duration) && (\r\n            <LengthDisplay>{formatDuration(mediaRef.duration)}</LengthDisplay>\r\n          )}\r\n          {externalSrc.includes(\".gif\") && <LengthDisplay>gif</LengthDisplay>}\r\n        </>\r\n      )}\r\n    </Wrapper>\r\n  );\r\n}\r\n\r\nexport default Overlay;\r\n","import React, { useState, useCallback, MouseEventHandler } from \"react\";\r\nimport { useSelector } from \"react-redux\";\r\nimport { selectPreferences } from \"../../redux/selectors\";\r\nimport FlexVideo from \"./FlexVideo\";\r\nimport Overlay from \"./Overlay\";\r\nimport { openFullscreen } from \"./utils\";\r\n\r\ninterface VideoProps {\r\n  src: string;\r\n  thumbnail_src: string;\r\n  onLoad: () => void;\r\n  externalSrc: string;\r\n}\r\n\r\nexport default function Video(props: VideoProps) {\r\n  const { src, onLoad, externalSrc } = props;\r\n\r\n  const [videoRef, setVideoRef] = useState<HTMLVideoElement | null>(null);\r\n\r\n  const [, setTime] = useState(Date.now());\r\n  const [intervalId, setIntervalId] = useState<NodeJS.Timeout | null>(null);\r\n\r\n  const play = useCallback(() => {\r\n    videoRef && videoRef.play();\r\n\r\n    // ~30 fps\r\n    const id = setInterval(() => {\r\n      setTime(Date.now());\r\n    }, 34);\r\n\r\n    setIntervalId(id);\r\n  }, [videoRef]);\r\n\r\n  const pause = useCallback(() => {\r\n    videoRef && videoRef.pause();\r\n    clearInterval(intervalId as NodeJS.Timeout);\r\n    setIntervalId(null);\r\n  }, [videoRef, intervalId]);\r\n\r\n  const onFullscreen: MouseEventHandler = useCallback(\r\n    (event) => {\r\n      event.stopPropagation();\r\n      if (videoRef) {\r\n        openFullscreen(videoRef);\r\n      }\r\n    },\r\n    [videoRef]\r\n  );\r\n\r\n  const togglePlay = useCallback(\r\n    (event) => {\r\n      event.stopPropagation();\r\n      videoRef && (videoRef.paused ? play() : pause());\r\n    },\r\n    [videoRef, play, pause]\r\n  );\r\n\r\n  const { preloadVideos } = useSelector(selectPreferences);\r\n\r\n  return (\r\n    <>\r\n      <FlexVideo\r\n        controls={false}\r\n        loop\r\n        preload={preloadVideos ? \"auto\" : \"metadata\"}\r\n        ref={setVideoRef}\r\n        onLoadedMetadata={onLoad}\r\n      >\r\n        <source src={src} />\r\n      </FlexVideo>\r\n      <Overlay\r\n        mediaRef={videoRef}\r\n        isPaused={videoRef ? videoRef.paused : true}\r\n        currentTime={videoRef?.currentTime}\r\n        duration={videoRef?.duration}\r\n        onFullscreen={onFullscreen}\r\n        togglePlay={togglePlay}\r\n        externalSrc={externalSrc}\r\n        isPlayable\r\n      />\r\n    </>\r\n  );\r\n}\r\n","import { PostType, VIDEO, GIF, PICTURE } from \"../../data/types\";\r\n\r\nexport const openFullscreen = (elem: HTMLVideoElement) => {\r\n  elem.requestFullscreen();\r\n};\r\n\r\nexport const getMediaType = (type: PostType, src: string) => {\r\n  if (type === VIDEO) {\r\n    return VIDEO;\r\n  }\r\n\r\n  // can't use .endsWith because of queryString\r\n  if (src.includes(\".gif\")) {\r\n    return GIF;\r\n  }\r\n\r\n  return PICTURE;\r\n};\r\n","import styled from \"styled-components\";\r\n\r\nconst FlexImage = styled.img`\r\n  width: 100%;\r\n  height: 100%;\r\n  display: block;\r\n  object-fit: contain;\r\n  grid-area: 1/1/2/2;\r\n`;\r\n\r\nexport default FlexImage;\r\n","import React, { useState } from \"react\";\r\nimport FlexImage from \"./FlexImage\";\r\nimport Overlay from \"./Overlay\";\r\n\r\ninterface GifProps {\r\n  src: string;\r\n  thumbnail_src: string;\r\n  onLoad: () => void;\r\n  externalSrc: string;\r\n}\r\n\r\nexport default function Gif(props: GifProps) {\r\n  const { src, thumbnail_src, onLoad, externalSrc } = props;\r\n\r\n  const [isPaused, setPaused] = useState(true);\r\n  const usedSource = isPaused ? thumbnail_src : src;\r\n\r\n  return (\r\n    <>\r\n      <FlexImage\r\n        src={usedSource}\r\n        alt={usedSource}\r\n        loading=\"lazy\"\r\n        onLoad={onLoad}\r\n      />\r\n      <Overlay\r\n        isPlayable\r\n        isPaused={isPaused}\r\n        togglePlay={(event) => {\r\n          event.stopPropagation();\r\n          setPaused(!isPaused);\r\n        }}\r\n        externalSrc={externalSrc}\r\n      />\r\n    </>\r\n  );\r\n}\r\n","import React from \"react\";\r\nimport FlexImage from \"./FlexImage\";\r\nimport Overlay from \"./Overlay\";\r\n\r\ninterface PictureProps {\r\n  src: string;\r\n  onLoad: () => void;\r\n  externalSrc: string;\r\n}\r\n\r\nexport default function Picture(props: PictureProps) {\r\n  const { src, onLoad, externalSrc } = props;\r\n\r\n  return (\r\n    <>\r\n      <FlexImage src={src} alt={src} onLoad={onLoad} loading=\"lazy\" />\r\n      <Overlay isPlayable={false} externalSrc={externalSrc} />\r\n    </>\r\n  );\r\n}\r\n","import React, { useMemo } from \"react\";\r\nimport Video from \"./Video\";\r\nimport Gif from \"./Gif\";\r\nimport Picture from \"./Picture\";\r\n\r\nimport { getMediaType } from \"./utils\";\r\nimport { GIF, PostType, VIDEO } from \"../../data/types\";\r\n\r\ninterface PlayerProps {\r\n  type: PostType;\r\n  src: string;\r\n  thumbnail_src: string;\r\n  onLoad: () => void;\r\n}\r\n\r\nconst getMedia = (type: PostType, src: string) => {\r\n  switch (getMediaType(type, src)) {\r\n    case VIDEO:\r\n      return Video;\r\n    case GIF:\r\n      return Gif;\r\n    default:\r\n      return Picture;\r\n  }\r\n};\r\n\r\nexport default function Player(props: PlayerProps) {\r\n  const { type, src, thumbnail_src, onLoad } = props;\r\n\r\n  const externalSrc = new URL(src).searchParams.get(\"url\") || \"\";\r\n\r\n  const media = useMemo(() => {\r\n    const MediaComponent = getMedia(type, src);\r\n    return (\r\n      <MediaComponent\r\n        src={src}\r\n        thumbnail_src={thumbnail_src}\r\n        onLoad={onLoad}\r\n        externalSrc={externalSrc}\r\n      />\r\n    );\r\n  }, [type, src, thumbnail_src, onLoad, externalSrc]);\r\n\r\n  return <>{media}</>;\r\n}\r\n","import React, { useState, useCallback, useMemo } from \"react\";\r\nimport styled, { css } from \"styled-components\";\r\nimport Details from \"./Details\";\r\nimport Player from \"../player/Player\";\r\nimport { useSelector } from \"react-redux\";\r\nimport { selectOriginals } from \"../../redux/selectors\";\r\nimport PostDataClass from \"../../data/Post\";\r\nimport LayoutElementProps from \"../layout/LayoutElementProps\";\r\nimport { NO_OP } from \"../../data/types\";\r\n\r\nconst ItemWrapper = styled.div(\r\n  ({ theme }) => css`\r\n    padding-top: ${theme.dimensions.gutter};\r\n  `\r\n);\r\n\r\nconst PositonWrapper = styled.div(\r\n  ({ theme }) => css`\r\n    padding: 0 ${theme.dimensions.gutter};\r\n    width: 100%;\r\n    max-width: ${theme.dimensions.bodyWidth};\r\n    margin: auto;\r\n  `\r\n);\r\n\r\nconst PostWrapper = styled.div(\r\n  ({ theme }) => css`\r\n    display: grid;\r\n    grid-template-columns: 1fr;\r\n    grid-template-rows: auto auto auto;\r\n    border-radius: ${theme.dimensions.borderRadius};\r\n    overflow: hidden;\r\n    background: ${theme.misc.layer};\r\n  `\r\n);\r\n\r\nexport function getCorrectSource(\r\n  loadOriginal: boolean,\r\n  big_src: string,\r\n  small_src: string\r\n) {\r\n  return loadOriginal ? big_src : small_src;\r\n}\r\n\r\nexport default function Post(props: PostDataClass & LayoutElementProps) {\r\n  const {\r\n    media_type,\r\n    small_src,\r\n    big_src,\r\n    thumbnail_src,\r\n    rating,\r\n    score,\r\n    source,\r\n    tags,\r\n    style,\r\n    onLoad,\r\n    virtualRef,\r\n  } = props;\r\n  const originals = useSelector(selectOriginals);\r\n  const media_src = getCorrectSource(originals, big_src, small_src);\r\n  const [collapsed, setCollapsed] = useState(true);\r\n\r\n  const toggleDetails = useCallback(() => {\r\n    setCollapsed(!collapsed);\r\n    onLoad && setTimeout(onLoad, 100);\r\n  }, [collapsed, onLoad]);\r\n\r\n  const details = useMemo(\r\n    () => <Details rating={rating} score={score} source={source} tags={tags} />,\r\n    [rating, score, source, tags]\r\n  );\r\n\r\n  return (\r\n    <ItemWrapper style={style} ref={virtualRef} className=\"list-div\">\r\n      <PositonWrapper>\r\n        <PostWrapper onClick={toggleDetails} role=\"row\">\r\n          <Player\r\n            onLoad={onLoad || NO_OP}\r\n            type={media_type}\r\n            src={media_src}\r\n            thumbnail_src={thumbnail_src}\r\n          />\r\n          {!collapsed && details}\r\n        </PostWrapper>\r\n      </PositonWrapper>\r\n    </ItemWrapper>\r\n  );\r\n}\r\n","import React from \"react\";\r\nimport useAction from \"../../hooks/useAction\";\r\nimport { getResults } from \"../../redux/actions\";\r\nimport { BlockButton } from \"../common/Buttons\";\r\n\r\nexport default function SearchButton() {\r\n  const search = useAction(getResults);\r\n\r\n  return (\r\n    <BlockButton onClick={search} aria-label=\"Search\">\r\n      Search\r\n    </BlockButton>\r\n  );\r\n}\r\n","import React, { useEffect } from \"react\";\r\nimport { useSelector } from \"react-redux\";\r\nimport { selectActiveTags } from \"../../redux/selectors\";\r\nimport TagList from \"../tag/TagList\";\r\n\r\nexport default function ActiveTags({ onChange }: { onChange: () => void }) {\r\n  const activeTags = useSelector(selectActiveTags);\r\n\r\n  useEffect(() => {\r\n    onChange();\r\n  }, [onChange, activeTags]);\r\n\r\n  return Object.keys(activeTags).length > 0 ? (\r\n    <TagList tags={activeTags} loadAliases />\r\n  ) : null;\r\n}\r\n","import React from \"react\";\r\nimport styled, { css } from \"styled-components\";\r\nimport TagSelector from \"../tagSelector/TagSelector\";\r\nimport Options from \"./Options\";\r\nimport { Title } from \"../common/Text\";\r\nimport Surface from \"../common/Surface\";\r\nimport SearchButton from \"./SearchButton\";\r\nimport ActiveTags from \"./ActiveTags\";\r\n\r\nconst ConfigWrapper = styled.section(\r\n  ({ theme }) => css`\r\n    display: flex;\r\n    flex-direction: column;\r\n    gap: ${theme.dimensions.gutter};\r\n    padding: ${theme.dimensions.gutter};\r\n    width: 100%;\r\n    max-width: ${theme.dimensions.bodyWidth};\r\n    margin: auto;\r\n  `\r\n);\r\n\r\nexport default function Config(props: { onLoad: () => void }) {\r\n  const { onLoad } = props;\r\n\r\n  return (\r\n    <ConfigWrapper>\r\n      <Title>\r\n        <label htmlFor=\"tag-input\">Search</label>\r\n      </Title>\r\n      <Surface>\r\n        <TagSelector />\r\n        <ActiveTags onChange={onLoad} />\r\n        <Options />\r\n        <SearchButton />\r\n      </Surface>\r\n    </ConfigWrapper>\r\n  );\r\n}\r\n","import React from \"react\";\r\nimport styled, { css } from \"styled-components\";\r\n\r\nconst Container = styled.div`\r\n  display: inline-block;\r\n  white-space: nowrap;\r\n  min-width: 160px;\r\n`;\r\n\r\nconst AButton = styled.a(\r\n  ({ theme }) => css`\r\n    box-shadow: 1px 1px 0px rgba(0, 0, 0, 0.2);\r\n    line-height: 36px !important;\r\n    min-width: 150px;\r\n    display: inline-block !important;\r\n    background-color: ${theme.colors.layerBg};\r\n    padding: 2px 12px !important;\r\n    text-align: center !important;\r\n    border-radius: 3px;\r\n    color: #fff;\r\n    cursor: pointer;\r\n    overflow-wrap: break-word;\r\n    vertical-align: middle;\r\n    border: 0 none #fff !important;\r\n    font-family: \"Quicksand\", Helvetica, Century Gothic, sans-serif !important;\r\n    text-decoration: none;\r\n    text-shadow: none;\r\n    font-weight: 700 !important;\r\n    font-size: 14px !important;\r\n\r\n    :visited {\r\n      color: #fff !important;\r\n      text-decoration: none !important;\r\n    }\r\n\r\n    :hover {\r\n      opacity: 0.85;\r\n      color: #f5f5f5 !important;\r\n      text-decoration: none !important;\r\n    }\r\n\r\n    :active {\r\n      color: #f5f5f5 !important;\r\n      text-decoration: none !important;\r\n    }\r\n  `\r\n);\r\n\r\nconst Text = styled.span`\r\n  color: #fff !important;\r\n  letter-spacing: -0.15px !important;\r\n  vertical-align: middle;\r\n  line-height: 33px !important;\r\n  padding: 0;\r\n  text-align: center;\r\n  text-decoration: none !important;\r\n  text-shadow: 0 1px 1px rgba(34, 34, 34, 0.05);\r\n\r\n  a {\r\n    color: #fff !important;\r\n    text-decoration: none !important;\r\n  }\r\n\r\n  a:hover {\r\n    color: #fff !important;\r\n    text-decoration: none;\r\n  }\r\n`;\r\n\r\nconst Image = styled.img`\r\n  display: initial !important;\r\n  vertical-align: middle;\r\n  height: 13px !important;\r\n  width: 20px !important;\r\n  padding-top: 0;\r\n  padding-bottom: 0;\r\n  border: none;\r\n  margin-top: 0;\r\n  margin-right: 5px;\r\n  margin-left: 0;\r\n  margin-bottom: 3px;\r\n  content: url(\"https://ko-fi.com/img/cup-border.png\");\r\n\r\n  :after {\r\n    vertical-align: middle;\r\n    height: 25px;\r\n    padding-top: 0;\r\n    padding-bottom: 0;\r\n    border: none;\r\n    margin-top: 0;\r\n    margin-right: 6px;\r\n    margin-left: 0;\r\n    margin-bottom: 4px !important;\r\n    content: url(\"https://ko-fi.com/img/whitelogo.svg\");\r\n\r\n    height: 15px !important;\r\n    width: 22px !important;\r\n    display: initial;\r\n    animation: kofi-wiggle 3s infinite;\r\n  }\r\n`;\r\n\r\ninterface KofiButtonProps {\r\n  id: string;\r\n  label: string;\r\n}\r\n\r\nexport default function KofiButton(props: KofiButtonProps) {\r\n  const { id, label } = props;\r\n\r\n  return (\r\n    <Container>\r\n      <AButton\r\n        title={label}\r\n        href={\"https://ko-fi.com/\" + id}\r\n        target=\"_blank\"\r\n        rel=\"noopener noreferrer\"\r\n      >\r\n        <Text>\r\n          <Image\r\n            src=\"https://ko-fi.com/img/cup-border.png\"\r\n            className=\"kofiimg\"\r\n            alt=\"Ko-Fi button\"\r\n          />\r\n          {label}\r\n        </Text>\r\n      </AButton>\r\n    </Container>\r\n  );\r\n}\r\n","import React, { useEffect } from \"react\";\r\nimport { useSelector } from \"react-redux\";\r\nimport { formatCount } from \"../../misc/formatting\";\r\nimport useToggle from \"../../hooks/useToggle\";\r\nimport { selectCount } from \"../../redux/selectors\";\r\nimport { Title } from \"../common/Text\";\r\nimport Config from \"../features/Config\";\r\nimport Header from \"../features/Header\";\r\nimport LayoutElementProps from \"./LayoutElementProps\";\r\nimport KofiButton from \"../features/KofiButton\";\r\nimport styled, { css } from \"styled-components\";\r\nimport { NO_OP } from \"../../data/types\";\r\n\r\nconst Placeholder = styled.div(\r\n  ({ theme }) => css`\r\n    display: grid;\r\n    gap: ${theme.dimensions.gutter};\r\n    place-items: center;\r\n  `\r\n);\r\n\r\nexport default function LayoutHeader({\r\n  onLoad = NO_OP,\r\n  virtualRef,\r\n  style,\r\n}: LayoutElementProps) {\r\n  const [fullNumber, toggleFullNumber] = useToggle();\r\n  const count = useSelector(selectCount);\r\n\r\n  useEffect(() => {\r\n    if (count > 0) onLoad();\r\n  }, [count, onLoad]);\r\n\r\n  return (\r\n    <div onLoad={onLoad} ref={virtualRef} style={style} role=\"row\">\r\n      <Header />\r\n      <Config onLoad={onLoad} />\r\n      {count > 0 ? (\r\n        <Title onClick={toggleFullNumber}>\r\n          {(fullNumber ? count.toLocaleString() : formatCount(count)) +\r\n            \" results\"}\r\n        </Title>\r\n      ) : (\r\n        <Placeholder>\r\n          <KofiButton id=\"V7V73PWW9\" label=\"Support Me on Ko-fi\" />\r\n        </Placeholder>\r\n      )}\r\n    </div>\r\n  );\r\n}\r\n","export default __webpack_public_path__ + \"static/media/OutOfResults.9c71691c.png\";","import React, { useMemo } from \"react\";\r\nimport Surface from \"../common/Surface\";\r\nimport { Title } from \"../common/Text\";\r\nimport TagList from \"../tag/TagList\";\r\nimport outOfResultsPicture from \"../../icons/OutOfResults.png\";\r\nimport { useSelector } from \"react-redux\";\r\nimport { selectAliases } from \"../../redux/selectors\";\r\nimport TagDataClass from \"../../data/Tag\";\r\nimport { NO_OP, SimpleMap } from \"../../data/types\";\r\nimport LayoutElementProps from \"./LayoutElementProps\";\r\nimport { HorizontalLine } from \"../common/Lines\";\r\n\r\nexport default function LayoutOutOfItems({\r\n  onLoad = NO_OP,\r\n  virtualRef,\r\n  style,\r\n}: LayoutElementProps) {\r\n  const aliases = useSelector(selectAliases);\r\n  const aliasesForRendering = useMemo(\r\n    () =>\r\n      aliases.reduce((result: SimpleMap<TagDataClass>, alias) => {\r\n        result[alias.name] = alias;\r\n        return result;\r\n      }, {}),\r\n    [aliases]\r\n  );\r\n\r\n  return (\r\n    <div style={style} ref={virtualRef} onLoad={onLoad} role=\"row\">\r\n      <Surface>\r\n        <img\r\n          src={outOfResultsPicture}\r\n          alt={outOfResultsPicture}\r\n          style={{ width: \"100%\" }}\r\n        />\r\n        <HorizontalLine />\r\n        <Title>You have reached the end!</Title>\r\n        <p style={{ textAlign: \"center\" }}>Go look for something else!</p>\r\n        {aliases.length > 0 && (\r\n          <>\r\n            <p style={{ textAlign: \"center\" }}>How about some of these?</p>\r\n            <TagList tags={aliasesForRendering} padding />\r\n          </>\r\n        )}\r\n      </Surface>\r\n    </div>\r\n  );\r\n}\r\n","import React from \"react\";\r\nimport styled, { css } from \"styled-components\";\r\n\r\nconst StyledSvg = styled.svg(\r\n  ({ theme }) => css`\r\n    height: ${theme.dimensions.blockHeight};\r\n    padding: ${theme.dimensions.bigSpacing};\r\n  `\r\n);\r\n\r\nexport default function Loading() {\r\n  return (\r\n    <StyledSvg\r\n      version=\"1.1\"\r\n      xmlns=\"http://www.w3.org/2000/svg\"\r\n      xmlnsXlink=\"http://www.w3.org/1999/xlink\"\r\n      viewBox=\"0 0 50 20\"\r\n      enable-background=\"new 0 0 0 0\"\r\n      xmlSpace=\"preserve\"\r\n    >\r\n      <circle fill=\"#fff\" stroke=\"none\" cx=\"6\" cy=\"10\" r=\"6\">\r\n        <animate\r\n          attributeName=\"opacity\"\r\n          dur=\"1s\"\r\n          values=\"0;1;0\"\r\n          repeatCount=\"indefinite\"\r\n          begin=\"0.1\"\r\n        />\r\n      </circle>\r\n      <circle fill=\"#fff\" stroke=\"none\" cx=\"26\" cy=\"10\" r=\"6\">\r\n        <animate\r\n          attributeName=\"opacity\"\r\n          dur=\"1s\"\r\n          values=\"0;1;0\"\r\n          repeatCount=\"indefinite\"\r\n          begin=\"0.2\"\r\n        />\r\n      </circle>\r\n      <circle fill=\"#fff\" stroke=\"none\" cx=\"46\" cy=\"10\" r=\"6\">\r\n        <animate\r\n          attributeName=\"opacity\"\r\n          dur=\"1s\"\r\n          values=\"0;1;0\"\r\n          repeatCount=\"indefinite\"\r\n          begin=\"0.3\"\r\n        />\r\n      </circle>\r\n    </StyledSvg>\r\n  );\r\n}\r\n","import React from \"react\";\r\nimport LayoutElementProps from \"./LayoutElementProps\";\r\nimport LoadingIcon from \"../../icons/Loading\";\r\nimport styled from \"styled-components\";\r\nimport { NO_OP } from \"../../data/types\";\r\n\r\nconst Wrapper = styled.div`\r\n  display: grid;\r\n  place-items: center;\r\n`;\r\n\r\nexport default function LayoutLoadingItem({\r\n  onLoad = NO_OP,\r\n  virtualRef,\r\n  style,\r\n}: LayoutElementProps) {\r\n  return (\r\n    <Wrapper onLoad={onLoad} ref={virtualRef} style={style} role=\"row\">\r\n      <LoadingIcon />\r\n    </Wrapper>\r\n  );\r\n}\r\n","import React, {\r\n  ChangeEventHandler,\r\n  KeyboardEventHandler,\r\n  useCallback,\r\n  useEffect,\r\n  useState,\r\n} from \"react\";\r\nimport styled, { css } from \"styled-components\";\r\n\r\nconst TextInput = styled.input(\r\n  ({ theme }) => css`\r\n    width: 50px;\r\n    border: ${theme.dimensions.borderWidth} solid ${theme.colors.accentColor};\r\n    background-color: ${theme.colors.backgroundColor2};\r\n    padding: ${theme.dimensions.spacing};\r\n    border-radius: ${theme.dimensions.borderRadius};\r\n    text-align: center;\r\n    height: ${theme.dimensions.blockHeight};\r\n  `\r\n);\r\n\r\ninterface SmallTextInputProps {\r\n  value: string | number;\r\n  onSubmit: (value: string | number) => void;\r\n}\r\n\r\nexport default function SmallTextInput(props: SmallTextInputProps) {\r\n  const { value, onSubmit } = props;\r\n  const [internalValue, setInternalValue] = useState(value);\r\n\r\n  useEffect(() => {\r\n    setInternalValue(value);\r\n  }, [value]);\r\n\r\n  const onChange: ChangeEventHandler<HTMLInputElement> = useCallback(\r\n    (event) => {\r\n      setInternalValue(event.target.value);\r\n    },\r\n    []\r\n  );\r\n\r\n  const onBlur = useCallback(() => {\r\n    onSubmit(internalValue);\r\n  }, [internalValue, onSubmit]);\r\n\r\n  const onKeyDown: KeyboardEventHandler = useCallback(\r\n    (event) => {\r\n      if (event.key === \"Enter\") {\r\n        onSubmit(internalValue);\r\n      }\r\n    },\r\n    [internalValue, onSubmit]\r\n  );\r\n\r\n  return (\r\n    <TextInput\r\n      type=\"text\"\r\n      value={internalValue}\r\n      onChange={onChange}\r\n      onBlur={onBlur}\r\n      onKeyDown={onKeyDown}\r\n    />\r\n  );\r\n}\r\n","import React, { MouseEventHandler, useCallback } from \"react\";\r\nimport { useSelector } from \"react-redux\";\r\nimport styled, { css } from \"styled-components\";\r\nimport { API } from \"../../../misc/api\";\r\nimport { selectCount } from \"../../../redux/selectors\";\r\nimport { RedButton } from \"../../common/Buttons\";\r\nimport SmallTextInput from \"../../common/SmallTextInput\";\r\n\r\nconst PageRow = styled.div(\r\n  ({ theme }) => css`\r\n    display: grid;\r\n    grid-template-columns: repeat(5, 1fr);\r\n    justify-content: center;\r\n    place-items: center;\r\n    gap: ${theme.dimensions.gutter};\r\n    padding: ${theme.dimensions.gutter};\r\n    padding-bottom: 0;\r\n    max-width: ${theme.dimensions.bodyWidth};\r\n    margin: auto;\r\n  `\r\n);\r\n\r\ninterface PageNavigationProps {\r\n  currentPage: number;\r\n  loadPage: (pageNumber: number) => void;\r\n}\r\n\r\nconst PageNumber = styled(RedButton)``;\r\n\r\nconst CurrentNumber = styled(SmallTextInput)``;\r\n\r\nexport default function PageNavigation(props: PageNavigationProps) {\r\n  const { currentPage, loadPage } = props;\r\n  const pageSize = API.pageSize;\r\n  const count = useSelector(selectCount);\r\n\r\n  const lastPage = Math.ceil(count / pageSize) - 1;\r\n\r\n  const loadSpecificPage = useCallback(\r\n    (newPage: number | string) => {\r\n      loadPage(Number(newPage));\r\n    },\r\n    [loadPage]\r\n  );\r\n\r\n  const loadFirst: MouseEventHandler<HTMLButtonElement> = useCallback(\r\n    (event) => {\r\n      loadPage(0);\r\n    },\r\n    [loadPage]\r\n  );\r\n\r\n  const loadPrevious: MouseEventHandler<HTMLButtonElement> = useCallback(\r\n    (event) => {\r\n      loadPage(currentPage - 1);\r\n    },\r\n    [currentPage, loadPage]\r\n  );\r\n\r\n  const loadNext: MouseEventHandler<HTMLButtonElement> = useCallback(\r\n    (event) => {\r\n      loadPage(currentPage + 1);\r\n    },\r\n    [currentPage, loadPage]\r\n  );\r\n\r\n  const loadLast: MouseEventHandler<HTMLButtonElement> = useCallback(\r\n    (event) => {\r\n      loadPage(lastPage);\r\n    },\r\n    [loadPage, lastPage]\r\n  );\r\n\r\n  return (\r\n    <PageRow className=\"page-navigation\">\r\n      {currentPage > 1 ? (\r\n        <PageNumber onClick={loadFirst}>0</PageNumber>\r\n      ) : (\r\n        <div></div>\r\n      )}\r\n      {currentPage > 0 ? (\r\n        <PageNumber onClick={loadPrevious}>{currentPage - 1}</PageNumber>\r\n      ) : (\r\n        <div></div>\r\n      )}\r\n      <CurrentNumber value={currentPage} onSubmit={loadSpecificPage} />\r\n      {currentPage < lastPage ? (\r\n        <PageNumber onClick={loadNext}>{currentPage + 1}</PageNumber>\r\n      ) : (\r\n        <div></div>\r\n      )}\r\n      {currentPage < lastPage - 1 ? (\r\n        <PageNumber onClick={loadLast}>{lastPage}</PageNumber>\r\n      ) : (\r\n        <div></div>\r\n      )}\r\n    </PageRow>\r\n  );\r\n}\r\n","import React, { useCallback } from \"react\";\r\nimport styled, { css } from \"styled-components\";\r\nimport PostDataClass from \"../../../data/Post\";\r\nimport BaseFlexColumn from \"../../common/FlexColumn\";\r\nimport PageNavigation from \"./PageNavigation\";\r\n\r\nconst FlexColumn = styled(BaseFlexColumn)(\r\n  ({ theme }) => css`\r\n    padding-bottom: ${theme.dimensions.gutter};\r\n  `\r\n);\r\n\r\ninterface PageLayoutProps<T> {\r\n  header?: JSX.Element;\r\n  outOfItems?: JSX.Element;\r\n  items?: T[];\r\n  pageSize: number;\r\n  currentPage: number;\r\n  hasMorePages: boolean;\r\n  loadPage: (pageNumber: number) => void;\r\n  ItemComponent: (props: T) => JSX.Element;\r\n  isLoading: boolean;\r\n  setLoading: (value: boolean) => void;\r\n}\r\n\r\nexport default function PageLayout(props: PageLayoutProps<PostDataClass>) {\r\n  const {\r\n    header,\r\n    items,\r\n    ItemComponent,\r\n    pageSize,\r\n    currentPage,\r\n    loadPage,\r\n  } = props;\r\n\r\n  const scrollAndLoadPage = useCallback(\r\n    (value: number) => {\r\n      loadPage(value);\r\n      document.getElementsByClassName(\"page-navigation\")[0].scrollIntoView();\r\n    },\r\n    [loadPage]\r\n  );\r\n\r\n  return (\r\n    <FlexColumn>\r\n      {header}\r\n      {items && items.length > 0 && (\r\n        <>\r\n          <PageNavigation currentPage={currentPage} loadPage={loadPage} />\r\n          {items?.map((item) => (\r\n            <ItemComponent key={item.id} {...item} />\r\n          ))}\r\n          <PageNavigation\r\n            currentPage={currentPage}\r\n            loadPage={scrollAndLoadPage}\r\n          />\r\n        </>\r\n      )}\r\n    </FlexColumn>\r\n  );\r\n}\r\n","import React, { useCallback, useState } from \"react\";\r\nimport { useDispatch, useSelector } from \"react-redux\";\r\nimport InifinteColumn from \"../layout/infinite/InfiniteColumn\";\r\nimport Post from \"../post/Post\";\r\nimport { getMoreResults, getResults } from \"../../redux/actions\";\r\nimport {\r\n  selectOutOfResults,\r\n  selectPageNumber,\r\n  selectPosts,\r\n  selectPreferences,\r\n} from \"../../redux/selectors\";\r\nimport LayoutHeader from \"../layout/LayoutHeader\";\r\nimport LayoutOutOfItems from \"../layout/LayoutOutOfItems\";\r\nimport LayoutLoadingItem from \"../layout/LayoutLoadingItem\";\r\nimport useAction from \"../../hooks/useAction\";\r\nimport { ResultLayout } from \"../../data/types\";\r\nimport PageLayout from \"../layout/pages/PageLayout\";\r\nimport { API } from \"../../misc/api\";\r\n\r\nexport default function Search() {\r\n  const dispatch = useDispatch();\r\n  const posts = useSelector(selectPosts);\r\n  const hasMorePosts = !useSelector(selectOutOfResults);\r\n  const loadMore = useAction(getMoreResults);\r\n  const loadPage = useCallback(\r\n    (index: number) => {\r\n      dispatch(getResults(index));\r\n    },\r\n    [dispatch]\r\n  );\r\n  const [isLoading, setLoading] = useState(false);\r\n  const { resultsLayout } = useSelector(selectPreferences);\r\n  const pageNumber = useSelector(selectPageNumber);\r\n\r\n  return resultsLayout === ResultLayout.INFINITE_COLUMN ? (\r\n    <InifinteColumn\r\n      Header={LayoutHeader}\r\n      OutOfItems={LayoutOutOfItems}\r\n      items={posts}\r\n      LoadingItem={LayoutLoadingItem}\r\n      hasMoreRows={hasMorePosts}\r\n      ItemComponent={Post}\r\n      loadMore={loadMore}\r\n      isLoading={isLoading}\r\n      setLoading={setLoading}\r\n    />\r\n  ) : (\r\n    <PageLayout\r\n      header={<LayoutHeader />}\r\n      pageSize={API.pageSize}\r\n      currentPage={pageNumber}\r\n      hasMorePages={hasMorePosts}\r\n      loadPage={loadPage}\r\n      ItemComponent={Post}\r\n      isLoading={isLoading}\r\n      setLoading={setLoading}\r\n      items={posts}\r\n    />\r\n  );\r\n}\r\n","import styled from \"styled-components\";\r\n\r\nconst Centered = styled.div`\r\n  margin: auto;\r\n`;\r\n\r\nexport default Centered;\r\n","import React, { ChangeEventHandler } from \"react\";\r\nimport styled, { css } from \"styled-components\";\r\n\r\nconst SelectWrapper = styled.select(\r\n  ({ theme }) => css`\r\n    width: 100px;\r\n    border: ${theme.dimensions.borderWidth} solid ${theme.colors.accentColor};\r\n    background-color: ${theme.colors.backgroundColor2};\r\n    padding: ${theme.dimensions.spacing};\r\n    border-radius: ${theme.dimensions.borderRadius};\r\n    height: ${theme.dimensions.blockHeight};\r\n  `\r\n);\r\n\r\nconst Option = styled.option(\r\n  ({ theme }) => css`\r\n    border: ${theme.dimensions.borderWidth} solid ${theme.colors.accentColor};\r\n    background-color: ${theme.colors.backgroundColor2};\r\n    padding: ${theme.dimensions.spacing};\r\n    border-radius: ${theme.dimensions.borderRadius};\r\n    text-align: center;\r\n  `\r\n);\r\n\r\ninterface SelectProps {\r\n  options: Record<string, string>;\r\n  value: string;\r\n  onChange: ChangeEventHandler;\r\n}\r\n\r\nexport default function Select(props: SelectProps) {\r\n  const { options, value, onChange } = props;\r\n  return (\r\n    <SelectWrapper value={value} onChange={onChange}>\r\n      {Object.entries(options).map(([optionKey, optionValue]) => (\r\n        <Option key={optionKey} value={optionKey}>\r\n          {optionValue}\r\n        </Option>\r\n      ))}\r\n    </SelectWrapper>\r\n  );\r\n}\r\n","import React from \"react\";\r\nimport styled, { css } from \"styled-components\";\r\nimport { SmallTitle, Faded } from \"./Text\";\r\n\r\nconst Grid = styled.div(\r\n  ({ theme }) => css`\r\n    display: grid;\r\n    grid-template-columns: 1fr auto;\r\n    grid-template-rows: auto auto;\r\n    gap: ${theme.dimensions.spacing};\r\n  `\r\n);\r\n\r\nconst Title = styled(SmallTitle)(\r\n  ({ theme }) => css`\r\n    grid-column: 1/2;\r\n    grid-row: 1/2;\r\n  `\r\n);\r\n\r\nconst Body = styled(Faded)(\r\n  ({ theme }) => css`\r\n    grid-column: 1/2;\r\n    grid-row: 2/3;\r\n  `\r\n);\r\n\r\nconst Control = styled.div(\r\n  ({ theme }) => css`\r\n    grid-column: 2/3;\r\n    grid-row: 1/3;\r\n  `\r\n);\r\n\r\ninterface SettingProps {\r\n  title: string;\r\n  description: string;\r\n  children: JSX.Element;\r\n}\r\n\r\nexport default function Setting({\r\n  title,\r\n  description,\r\n  children,\r\n}: SettingProps) {\r\n  return (\r\n    <Grid>\r\n      <Title>{title}</Title>\r\n      <Body>{description}</Body>\r\n      <Control>{children}</Control>\r\n    </Grid>\r\n  );\r\n}\r\n","import React, { useCallback } from \"react\";\r\nimport { useDispatch, useSelector } from \"react-redux\";\r\nimport styled, { css, useTheme } from \"styled-components\";\r\nimport {\r\n  ORIGINALS,\r\n  PAGE_SIZE,\r\n  PRELOAD_VIDEOS,\r\n  ResultLayout,\r\n  RESULTS_LAYOUT,\r\n  TAG_SUGGESTION_COUNT,\r\n} from \"../../data/types\";\r\nimport { CodeBranchIcon } from \"../../icons/Icons\";\r\nimport { ThemeType } from \"../../misc/theme\";\r\nimport { setOption } from \"../../redux/actions\";\r\nimport { selectPreferences } from \"../../redux/selectors\";\r\nimport { BlockButton } from \"../common/Buttons\";\r\nimport Centered from \"../common/Centered\";\r\nimport FlexColumn, { FlexColumnWithSpacing } from \"../common/FlexColumn\";\r\nimport { HorizontalLine } from \"../common/Lines\";\r\nimport Select from \"../common/Select\";\r\nimport Setting from \"../common/Setting\";\r\nimport SmallTextInput from \"../common/SmallTextInput\";\r\nimport Surface from \"../common/Surface\";\r\nimport { Faded, Title } from \"../common/Text\";\r\nimport Toggle from \"../common/Toggle\";\r\nimport Header from \"../features/Header\";\r\n\r\nconst layouts = {\r\n  [ResultLayout.INFINITE_COLUMN]: \"Infinite\",\r\n  [ResultLayout.PAGES]: \"Pages\",\r\n};\r\n\r\nconst SettingsSurface = styled(Surface)(\r\n  ({ theme }) => css`\r\n    padding: ${theme.dimensions.hugeSpacing};\r\n    gap: ${theme.dimensions.hugeSpacing};\r\n  `\r\n);\r\n\r\nexport default function Settings() {\r\n  const dispatch = useDispatch();\r\n  const {\r\n    preloadVideos,\r\n    tagSuggestionsCount,\r\n    originals,\r\n    resultsLayout,\r\n    pageSize,\r\n  } = useSelector(selectPreferences);\r\n\r\n  const togglePreloadVideos = useCallback(\r\n    () => dispatch(setOption(PRELOAD_VIDEOS, !preloadVideos)),\r\n    [dispatch, preloadVideos]\r\n  );\r\n\r\n  const toggleOriginals = useCallback(\r\n    () => dispatch(setOption(ORIGINALS, !originals)),\r\n    [dispatch, originals]\r\n  );\r\n\r\n  const setTagSuggestionCount = useCallback(\r\n    (newValue: string | number) =>\r\n      dispatch(setOption(TAG_SUGGESTION_COUNT, Number(newValue))),\r\n    [dispatch]\r\n  );\r\n\r\n  const setPageSize = useCallback(\r\n    (newValue: string | number) =>\r\n      dispatch(setOption(PAGE_SIZE, Number(newValue))),\r\n    [dispatch]\r\n  );\r\n\r\n  const setResultsLayout = useCallback(\r\n    (event) => dispatch(setOption(RESULTS_LAYOUT, event.target.value)),\r\n    [dispatch]\r\n  );\r\n\r\n  const reset = useCallback(() => {\r\n    localStorage.clear();\r\n    window.location.reload();\r\n  }, []);\r\n\r\n  return (\r\n    <FlexColumn>\r\n      <Header />\r\n      <FlexColumnWithSpacing>\r\n        <SettingsSurface>\r\n          <Title>General</Title>\r\n          <HorizontalLine />\r\n          <Setting\r\n            title=\"Results Layout\"\r\n            description=\"Choose how your results are displayed.\"\r\n          >\r\n            <Select\r\n              options={layouts}\r\n              value={resultsLayout}\r\n              onChange={setResultsLayout}\r\n            />\r\n          </Setting>\r\n\r\n          <Setting\r\n            title=\"Preload Videos\"\r\n            description=\"Start loading videos immediately instead of just-in-time. This can improve the viewing experience but will consume a LOT of data. Only use with WIFI.\"\r\n          >\r\n            <Toggle value={preloadVideos} onToggle={togglePreloadVideos} />\r\n          </Setting>\r\n\r\n          <Setting\r\n            title=\"Load original sizes\"\r\n            description=\"Display images and videos at their original resolution. This will consume more data but provides a nicer experience.\"\r\n          >\r\n            <Toggle value={originals} onToggle={toggleOriginals} />\r\n          </Setting>\r\n          <Setting\r\n            title=\"Number of Tag suggestions\"\r\n            description=\"Controls the number of tags displayed when searching. Increase this when searching for niche tags.\"\r\n          >\r\n            <SmallTextInput\r\n              value={tagSuggestionsCount}\r\n              onSubmit={setTagSuggestionCount}\r\n            />\r\n          </Setting>\r\n          <Setting\r\n            title=\"Page size\"\r\n            description=\"Controls the number of posts loaded at once.\"\r\n          >\r\n            <SmallTextInput value={pageSize} onSubmit={setPageSize} />\r\n          </Setting>\r\n          <Title>Developer</Title>\r\n          <HorizontalLine />\r\n          <BlockButton onClick={reset}>Reset Application</BlockButton>\r\n        </SettingsSurface>\r\n        <Centered>\r\n          <CodeBranchIcon\r\n            color={(useTheme() as ThemeType).colors.subduedText}\r\n          />{\" \"}\r\n          <Faded>Version 2.2.1</Faded>\r\n        </Centered>\r\n      </FlexColumnWithSpacing>\r\n    </FlexColumn>\r\n  );\r\n}\r\n","import produce from \"immer\";\r\nimport {\r\n  PreferenceKey,\r\n  INFINITE,\r\n  RATED,\r\n  RATEDTRESHOLD,\r\n  ORIGINALS,\r\n  COOKIES,\r\n  PRELOAD_VIDEOS,\r\n  TAG_SUGGESTION_COUNT,\r\n  RESULTS_LAYOUT,\r\n  ResultLayout,\r\n  PAGE_SIZE,\r\n} from \"../../data/types\";\r\nimport { AppAction, SET_OPTION, ALLOW_COOKIES } from \"../actions\";\r\n\r\nexport interface PreferencesState {\r\n  infinite: boolean;\r\n  rated: boolean;\r\n  ratedTreshold: number;\r\n  originals: boolean;\r\n  cookies: boolean;\r\n  preloadVideos: boolean;\r\n  tagSuggestionsCount: number;\r\n  resultsLayout: ResultLayout;\r\n  pageSize: number;\r\n}\r\n\r\nexport const initialPreferencesState: PreferencesState = {\r\n  infinite: true,\r\n  rated: false,\r\n  ratedTreshold: 1,\r\n  originals: false,\r\n  cookies: false,\r\n  preloadVideos: false,\r\n  tagSuggestionsCount: 20,\r\n  resultsLayout: ResultLayout.INFINITE_COLUMN,\r\n  pageSize: 20,\r\n};\r\n\r\nconst setOption = (state: PreferencesState, key: PreferenceKey, value: any) =>\r\n  produce(state, (draft) => {\r\n    switch (key) {\r\n      case INFINITE:\r\n        draft.infinite = value;\r\n        break;\r\n      case RATED:\r\n        draft.rated = value;\r\n        break;\r\n      case RATEDTRESHOLD:\r\n        draft.ratedTreshold = value;\r\n        break;\r\n      case ORIGINALS:\r\n        draft.originals = value;\r\n        break;\r\n      case COOKIES:\r\n        draft.cookies = value;\r\n        break;\r\n      case PRELOAD_VIDEOS:\r\n        draft.preloadVideos = value;\r\n        break;\r\n      case TAG_SUGGESTION_COUNT:\r\n        draft.tagSuggestionsCount = value;\r\n        break;\r\n      case RESULTS_LAYOUT:\r\n        draft.resultsLayout = value;\r\n        break;\r\n      case PAGE_SIZE:\r\n        draft.pageSize = value;\r\n        break;\r\n    }\r\n  });\r\n\r\nconst preferences = (\r\n  state: PreferencesState = initialPreferencesState,\r\n  action: AppAction\r\n): PreferencesState => {\r\n  switch (action.type) {\r\n    case SET_OPTION:\r\n      return setOption(state, action.key, action.value);\r\n    case ALLOW_COOKIES:\r\n      return setOption(state, COOKIES, action.value);\r\n    default:\r\n      return state;\r\n  }\r\n};\r\n\r\nexport default preferences;\r\n","import produce from \"immer\";\r\nimport PostDataClass from \"../../data/Post\";\r\nimport { SET_POSTS, ADD_POSTS, AppAction } from \"../actions\";\r\n\r\nexport interface ResultsState {\r\n  posts: PostDataClass[];\r\n  pageNumber: number;\r\n  count: number;\r\n}\r\n\r\nexport const initialResultsState: ResultsState = {\r\n  posts: [],\r\n  pageNumber: 0,\r\n  count: 0,\r\n};\r\n\r\nconst addPosts = (state: ResultsState, posts: PostDataClass[]) =>\r\n  produce(state, (draft) => {\r\n    draft.posts = [...state.posts, ...posts];\r\n    draft.pageNumber = state.pageNumber + 1;\r\n\r\n    //@ts-expect-error\r\n    window.posts = draft.posts;\r\n  });\r\n\r\nconst setPosts = (\r\n  state: ResultsState,\r\n  posts: PostDataClass[],\r\n  postCount: string,\r\n  pageNumber: number = 0\r\n) =>\r\n  produce(state, (draft) => {\r\n    draft.posts = posts;\r\n    draft.count = Number(postCount);\r\n    draft.pageNumber = pageNumber;\r\n  });\r\n\r\nconst results = (\r\n  state: ResultsState = initialResultsState,\r\n  action: AppAction\r\n): ResultsState => {\r\n  switch (action.type) {\r\n    case ADD_POSTS:\r\n      return addPosts(state, action.posts);\r\n    case SET_POSTS:\r\n      return setPosts(state, action.posts, action.count, action.pageNumber);\r\n    default:\r\n      return state;\r\n  }\r\n};\r\n\r\nexport default results;\r\n","import produce from \"immer\";\r\nimport TagDataClass from \"../../data/Tag\";\r\nimport { SimpleMap } from \"../../data/types\";\r\nimport { ADD_TAG, AppAction, REMOVE_TAG, ADD_ALIASES } from \"../actions\";\r\n\r\nexport interface TagsState {\r\n  active: SimpleMap<TagDataClass>;\r\n  aliases: SimpleMap<TagDataClass[]>;\r\n}\r\n\r\nexport const initialTagsState: TagsState = {\r\n  active: {},\r\n  aliases: {},\r\n};\r\n\r\nconst addTag = (state: TagsState, newTag: TagDataClass) =>\r\n  produce(state, (draft) => {\r\n    draft.active[newTag.name] = { ...state.active[newTag.name], ...newTag };\r\n  });\r\n\r\nconst addAliases = (\r\n  state: TagsState,\r\n  aliases: TagDataClass[],\r\n  forTag: string\r\n) =>\r\n  produce(state, (draft) => {\r\n    draft.aliases[forTag] = aliases;\r\n  });\r\n\r\nconst removeTag = (state: TagsState, tagToRemove: TagDataClass) =>\r\n  produce(state, (draft) => {\r\n    delete draft.active[tagToRemove.name];\r\n    delete draft.aliases[tagToRemove.name];\r\n  });\r\n\r\nconst tags = (\r\n  state: TagsState = initialTagsState,\r\n  action: AppAction\r\n): TagsState => {\r\n  switch (action.type) {\r\n    case ADD_TAG:\r\n      return addTag(state, action.tag);\r\n    case REMOVE_TAG:\r\n      return removeTag(state, action.tag);\r\n    case ADD_ALIASES:\r\n      return addAliases(state, action.aliases, action.forTag);\r\n    default:\r\n      return state;\r\n  }\r\n};\r\n\r\nexport default tags;\r\n","import { combineReducers } from \"redux\";\r\nimport preferences from \"./preferences\";\r\nimport results from \"./results\";\r\nimport tags from \"./tags\";\r\n\r\nexport default combineReducers({ tags, results, preferences });\r\n","import { Modifier, SimpleMap } from \"../data/types\";\r\nimport TagDataClass from \"../data/Tag\";\r\nimport { PreferencesState } from \"../redux/reducers/preferences\";\r\n\r\nconst SEARCH = \"r34_search\";\r\nconst ADD_TAG = \"r34_add_tag\";\r\n\r\ninterface SearchEvent {\r\n  id: typeof SEARCH;\r\n  payload: {\r\n    tags: string[];\r\n  };\r\n}\r\n\r\ninterface TagActivateEvent {\r\n  id: typeof ADD_TAG;\r\n  payload: {\r\n    name: string;\r\n    modifier: Modifier | undefined;\r\n  };\r\n}\r\n\r\nexport const searchEvent = (\r\n  activeTags: SimpleMap<TagDataClass>,\r\n  page_number: number,\r\n  preferences: PreferencesState\r\n) => ({\r\n  id: SEARCH,\r\n  payload: {\r\n    active_tags: Object.values(activeTags)\r\n      .map((tag) => `${tag.modifier}${tag.name}`)\r\n      .sort(),\r\n    page_number,\r\n    preferences,\r\n  },\r\n});\r\n\r\nexport const addTagEvent = (tag: TagDataClass) => ({\r\n  id: ADD_TAG,\r\n  payload: {\r\n    name: tag.name,\r\n    modifier: tag.modifier,\r\n  },\r\n});\r\n\r\nexport type EventType = SearchEvent | TagActivateEvent;\r\n","import { ADD_TAG, AppAction, SET_POSTS, ADD_POSTS } from \"../actions\";\r\nimport firebase from \"firebase/app\";\r\nimport \"firebase/analytics\";\r\nimport { addTagEvent, searchEvent } from \"../../analytics/events\";\r\nimport {\r\n  selectActiveTags,\r\n  selectPreferences,\r\n  selectPageNumber,\r\n  selectCookies,\r\n} from \"../selectors\";\r\nimport { MiddlewareAPI, Dispatch } from \"redux\";\r\n\r\nconst config = {\r\n  apiKey: \"AIzaSyBHdepwE7M4Byu2lFtX2s__9COcMdvXu7Q\",\r\n  authDomain: \"r34-react.firebaseapp.com\",\r\n  databaseURL: \"https://r34-react.firebaseio.com\",\r\n  projectId: \"r34-react\",\r\n  storageBucket: \"r34-react.appspot.com\",\r\n  messagingSenderId: \"844749417844\",\r\n  appId: \"1:844749417844:web:11fa1fda0e14f1ac2dd021\",\r\n  measurementId: \"G-27J3QXZ8YR\",\r\n};\r\n\r\nlet firebaseApp: firebase.app.App;\r\nlet analytics: firebase.analytics.Analytics;\r\n\r\nconst eventLogging = (store: MiddlewareAPI<any>) => (\r\n  next: Dispatch<AppAction>\r\n) => (action: AppAction) => {\r\n  const cookies = selectCookies(store.getState());\r\n\r\n  if (cookies) {\r\n    if (!firebaseApp) {\r\n      firebaseApp = firebase.initializeApp(config);\r\n      analytics = firebaseApp.analytics();\r\n    }\r\n\r\n    if (action.type === ADD_TAG) {\r\n      const { id, payload } = addTagEvent(action.tag);\r\n      analytics.logEvent<typeof id>(id, payload);\r\n    }\r\n\r\n    if (action.type === ADD_POSTS || action.type === SET_POSTS) {\r\n      const activeTags = selectActiveTags(store.getState());\r\n      const pageNumber = selectPageNumber(store.getState());\r\n      const preferences = selectPreferences(store.getState());\r\n      const { id, payload } = searchEvent(\r\n        activeTags,\r\n        action.type === SET_POSTS ? 0 : pageNumber + 1,\r\n        preferences\r\n      );\r\n      analytics.logEvent<typeof id>(id, payload);\r\n    }\r\n  }\r\n\r\n  next(action);\r\n};\r\n\r\nexport default eventLogging;\r\n","import { MiddlewareAPI } from \"redux\";\r\nimport { Dispatch } from \"react\";\r\nimport {\r\n  AppAction,\r\n  GET_RESULTS,\r\n  GET_MORE_RESULTS,\r\n  addPosts,\r\n  setPosts,\r\n} from \"../actions\";\r\nimport api from \"../../misc/api\";\r\nimport { preparePost } from \"../../misc/prepare\";\r\nimport {\r\n  selectActiveTags,\r\n  selectPreferences,\r\n  selectPageNumber,\r\n  selectOutOfResults,\r\n} from \"../selectors\";\r\n\r\nconst apiRequests = (store: MiddlewareAPI<any>) => (\r\n  next: Dispatch<AppAction>\r\n) => (action: AppAction) => {\r\n  if (action.type === GET_RESULTS) {\r\n    const activeTags = selectActiveTags(store.getState());\r\n    const { pageSize } = selectPreferences(store.getState());\r\n    const { rated, ratedTreshold } = selectPreferences(store.getState());\r\n\r\n    api\r\n      .getPosts(\r\n        activeTags,\r\n        pageSize,\r\n        action.pageNumber,\r\n        rated ? ratedTreshold : 0\r\n      )\r\n      .then((res) => {\r\n        store.dispatch(\r\n          setPosts(res.posts.map(preparePost), res.count, action.pageNumber)\r\n        );\r\n      });\r\n  }\r\n\r\n  const isOutOfResults = selectOutOfResults(store.getState());\r\n  if (action.type === GET_MORE_RESULTS && !isOutOfResults) {\r\n    const activeTags = selectActiveTags(store.getState());\r\n    const { pageSize } = selectPreferences(store.getState());\r\n    const pageNumber = selectPageNumber(store.getState());\r\n    const { rated, ratedTreshold } = selectPreferences(store.getState());\r\n\r\n    api\r\n      .getPosts(activeTags, pageSize, pageNumber + 1, rated ? ratedTreshold : 0)\r\n      .then((res) => {\r\n        store.dispatch(addPosts(res.posts.map(preparePost)));\r\n      });\r\n  }\r\n\r\n  next(action);\r\n};\r\n\r\nexport default apiRequests;\r\n","import { createStore, applyMiddleware } from \"redux\";\r\nimport { persistStore, persistReducer } from \"redux-persist\";\r\nimport storage from \"redux-persist/lib/storage\";\r\nimport rootReducer from \"./reducers\";\r\nimport eventLogging from \"./middleware/eventLogging\";\r\nimport apiRequests from \"./middleware/apiRequests\";\r\nimport { composeWithDevTools } from \"redux-devtools-extension\";\r\n\r\nconst persistConfig = {\r\n  key: \"appstate\",\r\n  storage,\r\n};\r\n\r\nconst persistedReducer = persistReducer(persistConfig, rootReducer);\r\n\r\nexport const store = createStore(\r\n  persistedReducer,\r\n  composeWithDevTools(applyMiddleware(eventLogging, apiRequests))\r\n);\r\n\r\nexport const persistor = persistStore(store);\r\n","import React from \"react\";\r\nimport { Provider } from \"react-redux\";\r\nimport { HashRouter, Route, Switch } from \"react-router-dom\";\r\nimport { PersistGate } from \"redux-persist/integration/react\";\r\nimport { ThemeProvider } from \"styled-components\";\r\nimport CookieConfirmation from \"./components/features/CookieConfirmation\";\r\nimport GlobalStyles from \"./GlobalStyles\";\r\nimport theme from \"./misc/theme\";\r\nimport Help from \"./components/pages/Help\";\r\nimport Search from \"./components/pages/Search\";\r\nimport Settings from \"./components/pages/Settings\";\r\nimport { persistor, store } from \"./redux/store\";\r\nimport { RouteName } from \"./data/types\";\r\n\r\nexport default function App() {\r\n  return (\r\n    <Provider store={store}>\r\n      <PersistGate loading={null} persistor={persistor}>\r\n        <ThemeProvider theme={theme}>\r\n          <GlobalStyles />\r\n          <HashRouter>\r\n            <Switch>\r\n              <Route path={RouteName.HELP}>\r\n                <Help />\r\n              </Route>\r\n              <Route path={RouteName.SETTINGS}>\r\n                <Settings />\r\n              </Route>\r\n              <Route path={RouteName.SEARCH}>\r\n                <Search />\r\n              </Route>\r\n            </Switch>\r\n            <CookieConfirmation />\r\n          </HashRouter>\r\n        </ThemeProvider>\r\n      </PersistGate>\r\n    </Provider>\r\n  );\r\n}\r\n","import React from \"react\";\r\nimport ReactDOM from \"react-dom\";\r\nimport App from \"./App\";\r\n\r\nReactDOM.render(<App />, document.getElementById(\"app-root\"));\r\n"],"sourceRoot":""}