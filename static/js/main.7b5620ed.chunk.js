(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{29:function(e,t,a){e.exports=a(78)},34:function(e,t,a){},36:function(e,t,a){},38:function(e,t,a){},66:function(e,t,a){},76:function(e,t,a){},78:function(e,t,a){"use strict";a.r(t);var n=a(0),s=a.n(n),r=a(24),c=a.n(r),i=(a(34),a(1)),o=a(2),l=a(4),u=a(3),m=a(5),h=a(28),p=a(6),d=a(9),g=(a(36),[]),f=function(e){g.push(e)},b=function(e){g.splice(g.indexOf(e),1)},v=function(e){return g.includes(e)},E=function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(l.a)(this,Object(u.a)(t).call(this,e))).state={name:e.name,count:e.count,modifier:e.modifier},a.onClick=e.onClick,a}return Object(m.a)(t,e),Object(o.a)(t,[{key:"render",value:function(){return s.a.createElement("span",{className:"badge badge-tag"+(v(this.state.name)?" active":" ")+("-"===this.state.modifier?" exclude":" "),onClick:this.onClick,onTouchEnd:this.releaseFocus},this.state.count?this.state.name+" ("+this.state.count+")":this.state.name)}}]),t}(n.Component);function k(e){return s.a.createElement("div",{className:"tag-list"},e.tags.map(function(t){return s.a.createElement(E,{key:"t_"+t.name,name:t.name,count:t.posts,modifier:t.modifier,onClick:function(){return e.onClick(t)}})}))}a(38);var j=function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(l.a)(this,Object(u.a)(t).call(this,e))).state={id:e.id,media_type:e.media_type,media_src:e.media_src,rating:e.rating,score:e.score,source:e.source,tags:e.tags,collapsed:!0},a.onTagClick=e.onTagClick,a.toggleDetails=a.toggleDetails.bind(Object(p.a)(Object(p.a)(a))),a}return Object(m.a)(t,e),Object(o.a)(t,[{key:"toggleDetails",value:function(e){this.setState({collapsed:!this.state.collapsed})}},{key:"render",value:function(){return s.a.createElement("li",{id:this.state.id,className:"list-group-item post gray"},s.a.createElement(O,{type:this.state.media_type,src:this.state.media_src,onClick:this.toggleDetails}),s.a.createElement("div",{className:"details collapse"+(this.state.collapsed?"":".show")},s.a.createElement("div",{className:"d-flex justify-content-between info-bar"},s.a.createElement(N,{value:this.state.rating}),s.a.createElement(C,{value:this.state.score}),s.a.createElement(S,{value:this.state.source})),s.a.createElement("div",{className:"pl-1"},s.a.createElement(k,{tags:this.state.tags,onClick:this.onTagClick}))))}}]),t}(s.a.Component);function y(e){return s.a.createElement("ul",{className:"list-group list-group-flush post-list"},e.posts.map(function(t){return s.a.createElement(j,{key:"p_"+t.id,id:t.id,media_type:t.type,media_src:t.sample_url,rating:t.rating,score:t.score,source:t.source,tags:t.tags,onTagClick:e.onTagClick})}))}function O(e){var t=!1;return"image"===e.type?s.a.createElement("img",{src:e.src,alt:e.src,className:"img-fluid",onClick:e.onClick}):"video"===e.type?s.a.createElement("video",{controls:!0,loop:!0,src:e.src,alt:e.src,className:"img-fluid",onClick:e.onClick,onTouchMove:function(e){t=!0},onTouchEnd:function(a){t||e.onClick(a),t=!1}}):null}function N(e){return s.a.createElement("span",{className:"rating"},e.value[0].toUpperCase())}function C(e){return s.a.createElement("span",{className:"score"},e.value)}function S(e){return e.value?e.value.startsWith("http")?s.a.createElement("a",{href:e.value,target:"_blank",rel:"noopener noreferrer",className:"source"},"Source"):s.a.createElement("span",{className:"source"},e.value):null}var T=a(16),w=a.n(T),x=a(17),_=a(18),P=a.n(_),R=function(e){return P.a.parse(e).tags.split("+").map(function(e){var t="",a=e;return"-"===e[0]&&(t=e[0],a=a.substr(1)),{name:a,modifier:t}})},D=function(e){return P.a.stringify({tags:e.map(function(e){return(e.modifier?e.modifier:"")+e.name}).join("+")})},M="https://custom-r34-api.herokuapp.com",q=M;fetch(M).then(function(){return q=M}).catch(function(){return q="https://r34-api-clone.herokuapp.com"});var z={getTags:function(){var e=Object(x.a)(w.a.mark(function e(t){var a;return w.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch(q+"/tags?limit=20&name="+t+"*&order_by=posts");case 2:return a=e.sent,e.next=5,a.json();case 5:return e.abrupt("return",e.sent);case 6:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}(),getPosts:function(){var e=Object(x.a)(w.a.mark(function e(t){var a,n,s=arguments;return w.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a=s.length>1&&void 0!==s[1]?s[1]:1,e.next=3,fetch(q+"/posts?pid="+a+"&limit=20&"+D(t));case 3:return n=e.sent,e.next=6,n.json();case 6:return e.abrupt("return",e.sent);case 7:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},F=a(25),A=a.n(F);a(66);function B(e){return e.name}function L(e){return s.a.createElement("span",null,e.name)}var V=function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(l.a)(this,Object(u.a)(t).call(this))).onValueChange=function(e,t){var n=t.newValue;t.method;a.setState({value:n})},a.onModifierChange=function(e){a.setState({modifier:e.target.value})},a.onSuggestionsFetchRequested=function(e){var t=e.value;z.getTags(t.replace(a.state.modifier,"")).then(function(e){a.setState({suggestions:e})})},a.onSuggestionsClearRequested=function(){a.setState({cachedSuggestions:a.state.suggestions,suggestions:[]})},a.state={value:"",modifier:"",suggestions:[],cachedSuggestions:[],onSubmit:function(t){e.onSubmit({name:a.state.value,modifier:a.state.modifier}),a.setState({value:""}),t.preventDefault()}},a}return Object(m.a)(t,e),Object(o.a)(t,[{key:"render",value:function(){var e=this.state,t=e.value,a=e.suggestions,n={placeholder:"Search for tags",value:t,onChange:this.onValueChange};return s.a.createElement("form",{onSubmit:this.state.onSubmit,className:"d-flex input-group tag-selector"},s.a.createElement("div",{className:"input-group-prepend left-append"},s.a.createElement("select",{className:"form-control select-modifier",value:this.state.modifier,onChange:this.onModifierChange},s.a.createElement("option",null,"+"),s.a.createElement("option",null,"-"))),s.a.createElement(A.a,{suggestions:a,onSuggestionsFetchRequested:this.onSuggestionsFetchRequested,onSuggestionsClearRequested:this.onSuggestionsClearRequested,getSuggestionValue:B,renderSuggestion:L,inputProps:n}),s.a.createElement("div",{className:"input-group-append right-append"},s.a.createElement("input",{type:"submit",value:"Add",className:"btn btn-red btn-add-tag"})))}}]),t}(n.Component),G=function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(l.a)(this,Object(u.a)(t).call(this,e))).state={tags:[],suggestions:[],posts:[],searchTerm:"",pageNumber:1},a.handleAddTag=a.handleAddTag.bind(Object(p.a)(Object(p.a)(a))),a.handleSearch=a.handleSearch.bind(Object(p.a)(Object(p.a)(a))),a.handleToggleTag=a.handleToggleTag.bind(Object(p.a)(Object(p.a)(a))),a.handleLoadMore=a.handleLoadMore.bind(Object(p.a)(Object(p.a)(a))),a}return Object(m.a)(t,e),Object(o.a)(t,[{key:"componentDidMount",value:function(){window.onpopstate=this.handleBack.bind(this),this.refreshPage()}},{key:"refreshPage",value:function(){this.getTagsFromUrl(),this.state.tags.length>0&&this.updatePosts()}},{key:"getTagsFromUrl",value:function(){if(this.props.location.search){var e=R(this.props.location.search)||[];e.forEach(function(e){return f(e.name)}),this.setState({tags:e})}}},{key:"handleBack",value:function(e){console.log("back"),this.refreshPage()}},{key:"handleAddTag",value:function(e){var t=this.state;t.tags.some(function(t){return t.name===e.name})?t.tags.find(function(t){return t.name===e.name}).modifier=e.modifier:(t.tags.push(e),f(e.name),this.setState(t))}},{key:"handleToggleTag",value:function(e){var t=this.state;t.tags.some(function(t){return t.name===e.name})?(t.tags.splice(t.tags.indexOf(e),1),b(e.name)):(t.tags.push(e),f(e.name)),this.setState(t)}},{key:"handleSearch",value:function(e){this.updatePosts(),e.preventDefault()}},{key:"handleLoadMore",value:function(e){this.addPosts(),e.preventDefault()}},{key:"updatePosts",value:function(){var e=this;z.getPosts(this.state.tags).then(function(t){var a=e.state;a.posts=t.map(function(e){var t=e;return t.tags=e.tags.map(function(e){return{name:e}}),t}),a.pageNumber=1,e.props.history.push(e.props.location.pathname+"?"+D(e.state.tags)),e.setState(a)})}},{key:"addPosts",value:function(){var e=this,t=this.state.pageNumber+1;z.getPosts(this.state.tags,t).then(function(a){var n,s=e.state,r=a.map(function(e){var t=e;return t.tags=e.tags.map(function(e){return{name:e}}),t});(n=s.posts).push.apply(n,Object(h.a)(r)),s.pageNumber=t,e.setState(s)})}},{key:"render",value:function(){return s.a.createElement("main",null,s.a.createElement("section",{className:"search"},s.a.createElement("h3",{className:"centered"},"Search"),s.a.createElement(V,{onSubmit:this.handleAddTag,className:"centered"}),this.state.tags.length>0?s.a.createElement("label",null,"Tags:",s.a.createElement(k,{tags:this.state.tags,onClick:this.handleToggleTag})):s.a.createElement("div",{className:"mb-1"}),s.a.createElement("form",{onSubmit:this.handleSearch},s.a.createElement("input",{type:"submit",value:"Search",className:"btn btn-block btn-red"}))),this.state.posts.length>0?s.a.createElement("section",{className:"results"},s.a.createElement("h3",{className:"centered"},"Results"),s.a.createElement(y,{posts:this.state.posts,onTagClick:this.handleToggleTag}),s.a.createElement("form",{className:"mt-3",onSubmit:this.handleLoadMore},s.a.createElement("input",{type:"submit",value:"Load more",className:"btn btn-block btn-red"}))):null)}}]),t}(n.Component),H=Object(d.e)(G),U=function(e){function t(){return Object(i.a)(this,t),Object(l.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(o.a)(t,[{key:"render",value:function(){return s.a.createElement("div",{className:"app"},s.a.createElement("main",null,s.a.createElement("p",null,"Helpful things")))}}]),t}(n.Component),W=function(e){function t(){return Object(i.a)(this,t),Object(l.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(o.a)(t,[{key:"render",value:function(){return s.a.createElement("div",{className:"app"},s.a.createElement("header",null,s.a.createElement("h1",null,"404 - not found")),s.a.createElement("main",null,s.a.createElement("p",null,"Go away")))}}]),t}(n.Component),J=a(15),I=(a(74),a(76),function(e){function t(){return Object(i.a)(this,t),Object(l.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(o.a)(t,[{key:"render",value:function(){return s.a.createElement(J.a,{basename:"/r34-react"},s.a.createElement("header",{className:"centered"},s.a.createElement("h1",{className:"centered"},"Browse ",s.a.createElement("a",{href:"https://rule34.xxx"},"Rule34")),s.a.createElement("div",{className:"container d-flex justify-content-center menu-bar"},s.a.createElement(J.b,{to:"/",className:"menu-item"},"Search"),s.a.createElement(J.b,{to:"/help",className:"menu-item"},"Help"))),s.a.createElement(d.c,null,s.a.createElement(d.a,{exact:!0,path:"/",component:H}),s.a.createElement(d.a,{exact:!0,path:"/help",component:U}),s.a.createElement(d.a,{component:W})),s.a.createElement("div",{className:"spacer"}),s.a.createElement("footer",null,s.a.createElement("small",null,s.a.createElement("div",{className:"d-flex justify-content-center"},s.a.createElement("p",null,s.a.createElement("a",{href:"https://github.com/kurozenzen/r34"},"Github Repository"))),s.a.createElement("div",{className:"d-flex justify-content-center"},s.a.createElement("p",null,"Please, if you notice ",s.a.createElement("a",{href:"https://github.com/kurozenzen/r34/issues/new?template=bug_report.md"}," something isn't right"),", or you ",s.a.createElement("a",{href:"https://github.com/kurozenzen/r34/issues/new?template=feature_request.md"},"want a feature")," to be implemented take the time to let me know.")),s.a.createElement("div",{className:"d-flex justify-content-center"},s.a.createElement("p",null,"Hosted with Github Pages.")))))}}]),t}(n.Component));Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));c.a.render(s.a.createElement(I,null),document.getElementById("app-root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})}},[[29,2,1]]]);
//# sourceMappingURL=main.7b5620ed.chunk.js.map