{"version":3,"sources":["data/types.ts","redux/actions.ts","styled/mixins.tsx","redux/selectors.ts","icons/FontAwesomeIcons.ts","firebase/analytics.ts","firebase/signIn.ts","data/encryption.ts","firebase/genericConverter.ts","firebase/storage.ts","firebase/index.ts","components/common/Buttons.tsx","misc/formatting.ts","data/TagDataClass.ts","components/common/Text.tsx","data/utils.ts","components/common/Lines.tsx","data/browserUtils.ts","data/PostDataClass.ts","misc/prepare.ts","components/common/Surface.tsx","hooks/useFirebaseAuthState.tsx","icons/TypeIcon.tsx","components/common/FlexColumn.tsx","hooks/usePreference.tsx","components/features/Header.tsx","hooks/useToggle.ts","hooks/useAction.tsx","components/tag/TagWrapper.tsx","components/tag/TagName.tsx","components/tag/Alias.tsx","components/tag/AliasesList.tsx","components/tag/Tag.tsx","components/tag/TagList.tsx","components/common/FlexImage.tsx","hooks/useToggleTag.tsx","hooks/useModifier.tsx","components/tagSelector/DropdownListEntry.tsx","components/tagSelector/DropdownList.tsx","components/tagSelector/TagInput.tsx","components/tagSelector/TagSelector.tsx","components/widgets/ResetButton.tsx","icons/OutOfResults.png","icons/Loading.tsx","icons/R34Icon.tsx","components/widgets/ActiveTags.tsx","components/features/ErrorBoundary.tsx","styled/themes/dark.ts","styled/themes/light.ts","styled/themes/coffee.ts","styled/themes/electric.ts","styled/themes/index.ts","GlobalStyles.tsx","components/pages/ErrorScreen.tsx","components/pages/LoadingScreen.tsx","components/widgets/CookieConfirmation.tsx","analytics/events.ts","redux/middleware/persistence.ts","redux/middleware/analytics.ts","misc/api.ts","data/CommentDataClass.ts","redux/middleware/requests.ts","redux/middleware/index.ts","redux/reducers/preferences.ts","redux/reducers/results.ts","redux/reducers/tags.ts","redux/reducers/reader.ts","redux/reducers/likes.ts","redux/reducers/modals.ts","redux/reducers/suggestions.ts","redux/reducers/index.ts","redux/store.ts","components/pages/Terms.tsx","components/widgets/SupertagModal.tsx","App.tsx","index.tsx"],"names":["TagType","Modifier","PostType","MediaType","ResultLayout","ThemeId","RouteName","RatingType","PreferenceKey","SortType","ModalIds","NO_OP","ADD_ALIASES","ADD_POSTS","ADD_TAG","CLOSE_MODAL","ENTER_FULLSCREEN","EXIT_FULLSCREEN","FETCH_COMMENTS","FETCH_PREFERENCES","FETCH_SUGGESTIONS","GET_MORE_RESULTS","GET_RESULTS","LIKE_POST","OPEN_MODAL","REMOVE_TAG","SAVE_PREFERENCES","SET_COMMENTS","SET_FULLSCREEN_POST","SET_POSTS","SET_PREFERENCE","SET_PREFERENCES","SET_SUGGESTIONS","addTag","tag","type","removeTag","addAliases","aliases","forTag","addPosts","posts","setPosts","count","pageNumber","setComments","postId","comments","fetchComments","setPreference","key","value","setPreferences","preferences","getResults","getMoreResults","enterFullscreen","exitFullscreen","setFullScreenPost","likePost","openModal","modalId","closeModal","setSuggestions","suggestions","fetchSuggestions","fetchPreferences","savePreferences","defaultBorder","theme","css","colors","accentColor","dimensions","borderWidth","borderRadius","layer","layerBg","boxShadow","primaryHover","backgroundColor","backgroundColor2","flexColumn","flexColumnWithGap","flexColumnGap","gutter","gridWithGap","gap","flexRowWithGap","flexRowGap","amount","supportsGap","supportsFlexGap","centeredMaxWidth","bodyWidth","defaultBlock","blockHeight","flexMedia","preserveAspectRatio","width","height","supportsAspectRatio","shadow","radius","color","dropShadow","mediaStyle","selectActiveTags","state","tags","active","selectPosts","results","selectCount","selectPageNumber","selectPreferences","selectResultsLayout","resultsLayout","selectPreloadVideos","selectOriginals","originals","selectCookies","cookies","selectFullsceenState","reader","isEnabled","selectAliases","selectPageSize","pageSize","selectTagSuggestionCount","tagSuggestionsCount","selectUseCorsProxy","useCorsProxy","selectShowMetadata","showMetadata","selectShowComments","showComments","selectSort","sort","selectSuggestions","entries","selectActiveThemeId","themeId","selectAutoPlay","autoPlay","selectHideSeen","hideSeen","selectNumberOfActiveTags","createSelector","Object","keys","length","selectAliasesAsList","values","flat","selectOutOfResults","selectHasMoreResults","outOfResults","selectLastPage","Math","ceil","selectFullScreenPost","fullScreenPostId","find","post","id","selectFullScreenIndex","fullScreenPost","indexOf","selectMinRating","rated","ratedThreshold","selectNextIndex","selectedIndex","undefined","selectPreviousIndex","selectSupertagModalOpen","modals","CREATE_SUPERTAG","selectPostById","defaultMemoize","selectAliasesByTagName","tagName","selectLikedByPostId","likes","CharacterIcon","styled","FontAwesomeIcon","attrs","icon","faUser","ArtistIcon","faPen","CopyrightIcon","faCopyright","MetaDataIcon","faInfoCircle","CloseIcon","faTimes","ExpandIcon","faExpand","ExternalLinkIcon","faExternalLinkAlt","DownloadIcon","faDownload","SourceIcon","faHashtag","RatingIcon","faRegistered","HeartIcon","faHeart","LinkIcon","faLink","ArrowDown","faCaretDown","CodeBranchIcon","faCodeBranch","GithubIcon","faGithub","PatreonIcon","faPatreon","TwitterIcon","faTwitter","DeviantArtIcon","faDeviantart","DiscordIcon","faDiscord","TumblrIcon","faTumblr","CalendarIcon","faCalendarDay","CheckIcon","faCheckSquare","ImageIcon","faImage","GoogleIcon","faGoogle","WrenchIcon","faWrench","SearchIcon","faSearch","SupertagIcon","faTags","FailedIcon","faTimesCircle","SuccessIcon","faCheckCircle","PlusIcon","faPlus","SignOutIcon","faSignOutAlt","UndoIcon","faUndoAlt","logEvent","event","a","firebase","analytics","payload","googleAuthProvider","auth","GoogleAuthProvider","signIn","signInWithPopup","catch","error","console","code","message","signOut","sha256","msgBuffer","TextEncoder","encode","crypto","subtle","digest","hashBuffer","hashArray","Array","from","Uint8Array","hashHex","map","b","toString","padStart","join","GenericConverter","data","snapshot","options","userConverter","getUserDoc","currentUser","email","userDoc","firestore","collection","doc","getUserData","withConverter","get","userSnap","userData","getPreferences","set","resetSeenPosts","log","getSupertags","snap","result","forEach","addSupertag","name","description","removeSupertag","delete","setTagsOfSupertag","update","useSupertags","useState","supertags","setSupertags","setCollection","useFirebaseAuthState","userInfo","useEffect","then","hash","col","docs","reduce","unsubscribe","onSnapshot","initializeApp","apiKey","authDomain","databaseURL","projectId","storageBucket","messagingSenderId","appId","measurementId","TextButton","button","bigSpacing","fontSizes","content","timings","longTransitionTime","RedButton","transitionTime","BlockButton","AddButton","ModifierButton","formatCount","numberString","number","toFixed","formatSource","source","url","parseUrl","host","formatDuration","duration","min","trunc","sec","formatTagname","tagname","replace","serializeTagname","toLowerCase","formatTagnameAndCount","formatDateTime","date","toLocaleDateString","toLocaleTimeString","formatTime","milliseconds","formatUnit","unitSize","unit","unitString","TagDataClass","types","modifier","PLUS","this","Title","h2","bigTitle","BigTitle","h1","SmallTitle","h3","Faded","span","subduedText","getMediaType","VIDEO","small_src","includes","big_src","GIF","PICTURE","listToMap","list","keyProp","current","tagsToString","URL","err","versionToNumber","majorMinorPatch","Number","split","download","filename","pop","fetch","headers","Headers","Origin","window","location","origin","mode","response","blob","document","createElement","href","createObjectURL","body","appendChild","click","remove","e","getVersion","process","REACT_APP_VERSION","getVersionString","version","getCorrectSource","loadOriginal","getCorrectSourceOrigin","searchParams","boolToNumber","HorizontalLine","div","props","VerticalLine","flex","style","display","flexDirection","rowGap","isSupported","scrollHeight","parentNode","removeChild","supportsObjectFit","supportsFullscreen","fullscreenEnabled","openFullscreen","element","requestFullscreen","webkitRequestFullscreen","msRequestFullscreen","PostDataClass","score","rating","media_type","media_src","file_url","thumbnail_src","creator_id","creator_url","status","parent_id","has_children","has_comments","comments_url","has_notes","created_at","change","Date","parse","prepareTag","dirtyTag","preparePost","sample_url","preview_url","t","Boolean","authState","setAuthState","user","setUser","onAuthStateChanged","TypeIcon","className","onClick","useMemo","match","CHARACTER","COPYRIGHT","ARTIST","RATING","SOURCE","METADATA","SUPERTAG","FlexColumn","FlexColumnWithSpacing","usePreference","dispatch","useDispatch","useSelector","setValue","useCallback","HeaderWrapper","header","TitleBar","layerBgSolid","MenuBar","nav","hugeSpacing","LocationStyledLink","Link","to","text","Header","useLocation","pathname","role","size","SEARCH","SETTINGS","ABOUT","useToggle","initialValue","toggleValue","resetValue","useAction","actionCreator","TagWrapper","fg","bg","switchingColors","collapsed","modifierToStyle","MINUS","OR","TagNameSpan","TagName","tabIndex","AliasWrapper","Alias","handleClick","stopPropagation","ListWrapper","parentRef","offsetTop","clientHeight","offsetLeft","clientWidth","AliasesList","DropdownArrow","$collapsed","Tag","detailed","tagRef","setTagRef","toggleCollapsed","resetCollapsed","activeTags","filteredAliases","filter","alias","isActive","hasAliases","handleArrowClick","handleEnter","onKeyDown","onMouseLeave","ref","TagListWrapper","TagList","children","onTagClick","FlexImage","img","useToggleTag","order","EntryWrapper","Name","Count","Icon","DropdownListEntry","tagSelectorRef","tagSelector","sizeAndPosition","DropdownList","entry","Input","input","TagInput","onSubmit","handleChange","target","onChange","placeholder","aria-label","TagSelectorWrapper","closed","TagSelector","setTagSelectorRef","setModifier","nextModifier","currentIndex","useModifier","activateTag","useThrottledEffect","handleAddClick","trim","sanitizedTagname","suggestion","s","ResetButton","reset","localStorage","clear","reload","StyledSvg","svg","Loading","xmlns","xmlnsXlink","viewBox","enable-background","xmlSpace","fill","stroke","cx","cy","r","attributeName","dur","repeatCount","begin","R34Icon","useTheme","transform","strokeWidth","strokeMiterlimit","strokeDasharray","strokeOpacity","fontStyle","fontWeight","fontSize","fontFamily","letterSpacing","wordSpacing","fillOpacity","x","y","fontVariant","fontStretch","ActiveTags","offerSupertags","numberOfActiveTags","openSupertagModal","toggleTag","title","ErrorBoundary","hasError","fallback","React","Component","dark","spacing","layerBgHighlight","hoverAccent","liked","positive","negative","light","coffee","electric","themes","DARK","LIGHT","COFFEE","ELECTRIC","defaultThemeId","createGlobalStyle","FullScreenCentered","ErrorScreen","GlobalStyles","src","outOfResultsPicture","alt","LoadingScreen","CookieWrapper","StyledSpan","CookieConfirmation","COOKIES","setCookies","handleAccept","AnalyticsEventId","saveTimeout","eventLogging","store","next","action","getState","page_number","active_tags","searchEvent","persistence","clearTimeout","setTimeout","firebaseFunctions","sourceTags","ratingTags","API","activeApi","setActiveApi","apiLocal","apiUrl1","apiUrl2","searchTerm","limit","defaultPageSize","json","matchingSupertags","details","startsWith","matchingRating","matchingSourceTags","minScore","DATE","getIdToken","idToken","buildPostUrl","Authorization","res","rawPost","encodeURIComponent","page","tagList","normalTags","orTags","tagParts","push","parseComment","rawComment","CommentDataClass","creator","apiRequests","hasMoreResults","minRating","api","getPosts","getAliases","sanitizedAliases","getTags","warn","rawComments","middleware","composeWithDevTools","applyMiddleware","requests","initialPreferencesState","preloadVideos","INFINITE_COLUMN","produce","draft","assign","initialResultsState","postCount","postIndex","findIndex","p","initialTagsState","newTag","tagToRemove","initialReaderState","setPostId","now","initialModalsState","setOpenModal","combineReducers","persistConfig","storage","persistedReducer","persistReducer","rootReducer","createStore","persistor","persistStore","SectionBody","Surface","Section","Terms","Wrapper","ModalSurface","StyledInput","SupertagModal","onClose","setName","desc","setDesc","handleCreateTagList","Settings","lazy","Search","About","Privacy","App","loading","ThemedApp","isSupertagModalOpen","isSignedIn","onCloseModals","exact","path","PRIVACY","TERMS","ReactDOM","render","getElementById"],"mappings":"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","file":"static/js/main.7122dc49.chunk.js","sourcesContent":["/**\r\n * Metadata. Describes the kind of tag.\r\n */\r\nexport enum TagType {\r\n  GENERAL = 'general',\r\n  CHARACTER = 'character',\r\n  AMBIGUOUS = 'ambiguous',\r\n  ARTIST = 'artist',\r\n  COPYRIGHT = 'copyright',\r\n  RATING = 'rating',\r\n  SOURCE = 'source',\r\n  METADATA = 'metadata',\r\n  SUPERTAG = 'supertag',\r\n}\r\n\r\n/**\r\n * Describes how the tag should influence the search.\r\n */\r\nexport enum Modifier {\r\n  PLUS = '+',\r\n  MINUS = '-',\r\n  OR = '~',\r\n}\r\n\r\n/**\r\n * Type of a post according to the backend.\r\n */\r\nexport enum PostType {\r\n  VIDEO = 'video',\r\n  IMAGE = 'image',\r\n}\r\n\r\n/**\r\n * Derived form PostType. On the frontend I split PostType.IMAGE into GIF and PICTURE.\r\n */\r\nexport enum MediaType {\r\n  VIDEO = 'video',\r\n  PICTURE = 'picture',\r\n  GIF = 'gif',\r\n}\r\n\r\n/**\r\n * The possible layouts.\r\n */\r\nexport enum ResultLayout {\r\n  INFINITE_COLUMN = 'infinite_column',\r\n  PAGES = 'pages',\r\n}\r\n\r\n/**\r\n * The possible themes.\r\n */\r\nexport enum ThemeId {\r\n  DARK = 'dark',\r\n  LIGHT = 'light',\r\n  COFFEE = 'coffee',\r\n  ELECTRIC = 'electric',\r\n}\r\n\r\n/**\r\n * All routes of the app.\r\n */\r\nexport enum RouteName {\r\n  SEARCH = '/',\r\n  SETTINGS = '/settings',\r\n  ABOUT = '/about',\r\n  PRIVACY = '/privacy',\r\n  TERMS = '/terms',\r\n}\r\n\r\n/**\r\n * Explicity rating as provided by the backend.\r\n */\r\nexport enum RatingType {\r\n  SAFE = 'safe',\r\n  QUESTIONABLE = 'questionable',\r\n  EXPLICIT = 'explicit',\r\n}\r\n\r\n/**\r\n * All preferences.\r\n */\r\n\r\nexport enum PreferenceKey {\r\n  RATED = 'rated',\r\n  RATED_THRESHOLD = 'ratedThreshold',\r\n  ORIGINALS = 'originals',\r\n  COOKIES = 'cookies',\r\n  PRELOAD_VIDEOS = 'preloadVideos',\r\n  TAG_SUGGESTIONS_COUNT = 'tagSuggestionsCount',\r\n  RESULTS_LAYOUT = 'resultsLayout',\r\n  PAGE_SIZE = 'pageSize',\r\n  USE_CORS_PROXY = 'useCorsProxy',\r\n  SHOW_METADATA = 'showMetadata',\r\n  SHOW_COMMENTS = 'showComments',\r\n  SORT = 'sort',\r\n  THEME_ID = 'themeId',\r\n  AUTO_PLAY = 'autoPlay',\r\n  HIDE_SEEN = 'hideSeen',\r\n}\r\n\r\n/**\r\n * All available sort types.\r\n */\r\nexport enum SortType {\r\n  DATE = 'date',\r\n  SCORE = 'score',\r\n}\r\n\r\n/**\r\n * One-time definition of an empty function. Reusing this improves React's performance as it does not break memoization.\r\n */\r\nexport const NO_OP = () => {}\r\n\r\n/**\r\n * Same data as a tag but different names\r\n */\r\nexport type TagLike = {\r\n  name: string\r\n  posts?: number\r\n  count?: number\r\n  types: TagType[]\r\n}\r\n\r\nexport type ActiveTab = 'tags' | 'comments' | 'metadata'\r\n\r\nexport enum ModalIds {\r\n  CREATE_SUPERTAG,\r\n}\r\n","import { ModalIds, PreferenceKey, TagLike } from '../data/types'\nimport TagDataClass from '../data/TagDataClass'\nimport PostDataClass from '../data/PostDataClass'\nimport CommentDataClass from '../data/CommentDataClass'\n\n// Action Names\nexport const ADD_ALIASES = `r34-react/ADD_ALIASES`\nexport const ADD_POSTS = `r34-react/ADD_POSTS`\nexport const ADD_TAG = `r34-react/ADD_TAG`\nexport const CLOSE_MODAL = `r34-react/CLOSE_MODAL`\nexport const ENTER_FULLSCREEN = `r34-react/ENTER_FULLSCREEN`\nexport const EXIT_FULLSCREEN = 'r34-react/EXIT_FULLSCREEN'\nexport const FETCH_COMMENTS = `r34-react/FETCH_COMMENTS`\nexport const FETCH_PREFERENCES = `r34-react/FETCH_PREFERENCES`\nexport const FETCH_SUGGESTIONS = `r34-react/FETCH_SUGGESTIONS`\nexport const GET_MORE_RESULTS = `r34-react/GET_MORE_RESULTS`\nexport const GET_RESULTS = `r34-react/GET_RESULTS`\nexport const LIKE_POST = `r34-react/LIKE_POST`\nexport const OPEN_MODAL = `r34-react/OPEN_MODAL`\nexport const REMOVE_TAG = `r34-react/REMOVE_TAG`\nexport const SAVE_PREFERENCES = 'r34-react/SAVE_PREFERENCES'\nexport const SET_COMMENTS = `r34-react/SET_COMMENTS`\nexport const SET_FULLSCREEN_POST = `r34-react/SET_FULLSCREEN_POST`\nexport const SET_POSTS = `r34-react/SET_POSTS`\nexport const SET_PREFERENCE = `r34-react/SET_PREFERENCE`\nexport const SET_PREFERENCES = `r34-react/SET_PREFERENCES`\nexport const SET_SUGGESTIONS = `r34-react/SET_SUGGESTIONS`\n\n// Action Types\ninterface AddTagAction {\n  type: typeof ADD_TAG\n  tag: TagDataClass\n}\n\ninterface RemoveTagAction {\n  type: typeof REMOVE_TAG\n  tag: TagDataClass\n}\n\ninterface AddAliasesAction {\n  type: typeof ADD_ALIASES\n  aliases: TagDataClass[]\n  forTag: string\n}\n\nexport interface AddPostsAction {\n  type: typeof ADD_POSTS\n  posts: PostDataClass[]\n}\n\nexport interface SetPostsAction {\n  type: typeof SET_POSTS\n  posts: PostDataClass[]\n  count: number\n  pageNumber?: number\n}\n\ninterface SetCommentsAction {\n  type: typeof SET_COMMENTS\n  postId: number\n  comments: CommentDataClass[]\n}\n\ninterface FetchCommentsAction {\n  type: typeof FETCH_COMMENTS\n  postId: number\n}\n\ninterface SetPreferenceAction {\n  type: typeof SET_PREFERENCE\n  key: PreferenceKey\n  value: any\n}\n\ninterface SetPreferencesAction {\n  type: typeof SET_PREFERENCES\n  preferences: Partial<Record<PreferenceKey, any>>\n}\n\ninterface GetResultsAction {\n  type: typeof GET_RESULTS\n  pageNumber: number\n}\n\ninterface GetMoreResultsAction {\n  type: typeof GET_MORE_RESULTS\n}\n\ninterface EnterFullcreenAction {\n  type: typeof ENTER_FULLSCREEN\n  postId: number\n}\n\ninterface SetFullScreenPostAction {\n  type: typeof SET_FULLSCREEN_POST\n  postId: number\n}\n\ninterface ExitFullscreenAction {\n  type: typeof EXIT_FULLSCREEN\n}\n\ninterface LikePostAction {\n  type: typeof LIKE_POST\n  postId: number\n}\n\ninterface OpenModalAction {\n  type: typeof OPEN_MODAL\n  modalId: ModalIds\n}\n\ninterface CloseModalAction {\n  type: typeof CLOSE_MODAL\n}\n\ninterface SetSuggestionsAction {\n  type: typeof SET_SUGGESTIONS\n  suggestions: TagLike[]\n}\n\ninterface FetchSuggestionsAction {\n  type: typeof FETCH_SUGGESTIONS\n  value: string\n}\n\ninterface FetchPreferencesAction {\n  type: typeof FETCH_PREFERENCES\n}\n\ninterface SavePreferencesAction {\n  type: typeof SAVE_PREFERENCES\n}\n\nexport type AppAction =\n  | AddAliasesAction\n  | AddPostsAction\n  | AddTagAction\n  | CloseModalAction\n  | EnterFullcreenAction\n  | ExitFullscreenAction\n  | FetchCommentsAction\n  | FetchPreferencesAction\n  | FetchSuggestionsAction\n  | GetMoreResultsAction\n  | GetResultsAction\n  | LikePostAction\n  | OpenModalAction\n  | RemoveTagAction\n  | SavePreferencesAction\n  | SetCommentsAction\n  | SetFullScreenPostAction\n  | SetPostsAction\n  | SetPreferenceAction\n  | SetPreferencesAction\n  | SetSuggestionsAction\n\n// Action Creators\nexport function addTag(tag: TagDataClass): AddTagAction {\n  return {\n    type: ADD_TAG,\n    tag,\n  }\n}\n\nexport function removeTag(tag: TagDataClass): RemoveTagAction {\n  return {\n    type: REMOVE_TAG,\n    tag,\n  }\n}\n\nexport function addAliases(aliases: TagDataClass[], forTag: string): AddAliasesAction {\n  return {\n    type: ADD_ALIASES,\n    aliases,\n    forTag,\n  }\n}\n\nexport function addPosts(posts: PostDataClass[]): AddPostsAction {\n  return {\n    type: ADD_POSTS,\n    posts,\n  }\n}\n\nexport function setPosts(posts: PostDataClass[], count: number, pageNumber: number = 0): SetPostsAction {\n  return {\n    type: SET_POSTS,\n    posts,\n    count,\n    pageNumber,\n  }\n}\n\nexport function setComments(postId: number, comments: CommentDataClass[]): SetCommentsAction {\n  return {\n    type: SET_COMMENTS,\n    postId,\n    comments,\n  }\n}\n\nexport function fetchComments(postId: number): FetchCommentsAction {\n  return {\n    type: FETCH_COMMENTS,\n    postId,\n  }\n}\n\nexport function setPreference(key: PreferenceKey, value: any): SetPreferenceAction {\n  return {\n    type: SET_PREFERENCE,\n    key,\n    value,\n  }\n}\n\nexport function setPreferences(preferences: Partial<Record<PreferenceKey, any>>): SetPreferencesAction {\n  return {\n    type: SET_PREFERENCES,\n    preferences,\n  }\n}\n\nexport function getResults(pageNumber: number = 0): GetResultsAction {\n  return {\n    type: GET_RESULTS,\n    pageNumber,\n  }\n}\n\nexport function getMoreResults(): GetMoreResultsAction {\n  return {\n    type: GET_MORE_RESULTS,\n  }\n}\n\nexport function enterFullscreen(postId: number): EnterFullcreenAction {\n  return {\n    type: ENTER_FULLSCREEN,\n    postId,\n  }\n}\n\nexport function exitFullscreen(): ExitFullscreenAction {\n  return {\n    type: EXIT_FULLSCREEN,\n  }\n}\n\nexport function setFullScreenPost(postId: number): SetFullScreenPostAction {\n  return {\n    type: SET_FULLSCREEN_POST,\n    postId,\n  }\n}\n\nexport function likePost(postId: number): LikePostAction {\n  return {\n    type: LIKE_POST,\n    postId,\n  }\n}\n\nexport function openModal(modalId: ModalIds): OpenModalAction {\n  return {\n    type: OPEN_MODAL,\n    modalId,\n  }\n}\n\nexport function closeModal(): CloseModalAction {\n  return {\n    type: CLOSE_MODAL,\n  }\n}\n\nexport function setSuggestions(suggestions: TagLike[]): SetSuggestionsAction {\n  return {\n    type: SET_SUGGESTIONS,\n    suggestions,\n  }\n}\n\nexport function fetchSuggestions(value: string): FetchSuggestionsAction {\n  return {\n    type: FETCH_SUGGESTIONS,\n    value,\n  }\n}\n\nexport function fetchPreferences(): FetchPreferencesAction {\n  return {\n    type: FETCH_PREFERENCES,\n  }\n}\n\nexport function savePreferences(): SavePreferencesAction {\n  return {\n    type: SAVE_PREFERENCES,\n  }\n}\n","import { css, DefaultTheme } from 'styled-components'\r\nimport { supportsAspectRatio, supportsFlexGap, supportsGap } from '../data/browserUtils'\r\n\r\nexport interface PropsWithTheme {\r\n  theme: DefaultTheme\r\n}\r\n\r\n/**\r\n * Gives elements a border TODO: rename to defaultborder\r\n */\r\nexport function defaultBorder({ theme }: PropsWithTheme) {\r\n  return css`\r\n    border-color: ${theme.colors.accentColor};\r\n    border-width: ${theme.dimensions.borderWidth};\r\n    ${borderRadius({ theme })}\r\n    border-style: solid;\r\n  `\r\n}\r\n\r\n/**\r\n * Element will look like a new layer\r\n */\r\nexport function layer({ theme }: PropsWithTheme) {\r\n  return css`\r\n    background-color: ${theme.colors.layerBg};\r\n    ${boxShadow({ theme })}\r\n  `\r\n}\r\n\r\n/**\r\n * Element becomes accentColor on hover, and is highlighted when active/focused\r\n */\r\nexport function primaryHover({ theme }: PropsWithTheme) {\r\n  return css`\r\n    color: ${theme.colors.accentColor};\r\n    background: ${theme.colors.backgroundColor};\r\n\r\n    :hover {\r\n      background-color: ${theme.colors.accentColor};\r\n      color: ${theme.colors.backgroundColor};\r\n    }\r\n\r\n    :active,\r\n    :focus {\r\n      color: ${theme.colors.backgroundColor2};\r\n      border-color: ${theme.colors.backgroundColor2};\r\n    }\r\n  `\r\n}\r\n\r\nexport function flexColumn() {\r\n  return css`\r\n    display: flex;\r\n    flex-direction: column;\r\n  `\r\n}\r\n\r\nexport function flexColumnWithGap({ theme }: PropsWithTheme) {\r\n  return css`\r\n    display: flex;\r\n    flex-direction: column;\r\n    ${flexColumnGap(theme.dimensions.gutter)};\r\n  `\r\n}\r\n\r\nexport function gridWithGap({ theme }: PropsWithTheme) {\r\n  return css`\r\n    display: grid;\r\n    ${gap(theme.dimensions.gutter)}\r\n  `\r\n}\r\n\r\nexport function flexRowWithGap({ theme }: PropsWithTheme) {\r\n  return css`\r\n    display: flex;\r\n    align-items: center;\r\n    ${flexRowGap(theme.dimensions.gutter)};\r\n  `\r\n}\r\n\r\nexport function gap(amount: string) {\r\n  return supportsGap\r\n    ? css`\r\n        gap: ${amount};\r\n      `\r\n    : css`\r\n        > :not(:last-child) {\r\n          margin-right: ${amount};\r\n          margin-bottom: ${amount};\r\n        }\r\n      `\r\n}\r\n\r\nexport function flexRowGap(amount: string) {\r\n  return supportsFlexGap\r\n    ? css`\r\n        gap: ${amount};\r\n      `\r\n    : css`\r\n        > :not(:last-child) {\r\n          margin-right: ${amount};\r\n        }\r\n      `\r\n}\r\n\r\nexport function flexColumnGap(amount: string) {\r\n  return supportsFlexGap\r\n    ? css`\r\n        gap: ${amount};\r\n      `\r\n    : css`\r\n        > :not(:last-child) {\r\n          margin-bottom: ${amount};\r\n        }\r\n      `\r\n}\r\n\r\n/**\r\n * Default spacing for grid and flex\r\n */\r\nexport function gutter({ theme }: PropsWithTheme) {\r\n  return css`\r\n    ${gap(theme.dimensions.gutter)};\r\n    padding: ${theme.dimensions.gutter};\r\n  `\r\n}\r\n\r\n/**\r\n * Limits content to a maximum width and centers it\r\n */\r\nexport function centeredMaxWidth({ theme }: PropsWithTheme) {\r\n  return css`\r\n    width: 100%;\r\n    max-width: ${theme.dimensions.bodyWidth};\r\n    margin-left: auto;\r\n    margin-right: auto;\r\n  `\r\n}\r\n\r\n/**\r\n * Fixed height and padding\r\n */\r\nexport function defaultBlock({ theme }: PropsWithTheme) {\r\n  return css`\r\n    height: ${theme.dimensions.blockHeight};\r\n    padding: 0 ${theme.dimensions.gutter};\r\n  `\r\n}\r\n\r\n/**\r\n * Preserves aspect ratio of the element and ensures it is displayed as big as possible\r\n */\r\nexport function flexMedia() {\r\n  return css`\r\n    width: 100%;\r\n    height: 100%;\r\n    display: block;\r\n    object-fit: contain;\r\n  `\r\n}\r\n\r\ninterface Size {\r\n  width: number\r\n  height: number\r\n}\r\n\r\nexport function preserveAspectRatio({ width, height }: Partial<Size>) {\r\n  if (!width || !height) {\r\n    return ''\r\n  }\r\n\r\n  return supportsAspectRatio\r\n    ? css`\r\n        aspect-ratio: ${width} / ${height};\r\n      `\r\n    : css`\r\n        max-width: 100%;\r\n        height: auto;\r\n      `\r\n}\r\n\r\nexport function borderRadius({ theme }: PropsWithTheme) {\r\n  return css`\r\n    border-radius: ${theme.dimensions.borderRadius};\r\n  `\r\n}\r\n\r\nexport function boxShadow({ theme }: PropsWithTheme) {\r\n  return css`\r\n    box-shadow: 0 1px ${theme.shadow.radius} ${theme.shadow.color};\r\n  `\r\n}\r\n\r\nexport function dropShadow({ theme }: PropsWithTheme) {\r\n  return css`\r\n    filter: drop-shadow(0 1px ${theme.shadow.radius} ${theme.shadow.color});\r\n  `\r\n}\r\n\r\nexport function mediaStyle() {\r\n  return css`\r\n    ${borderRadius}\r\n    ${boxShadow}\r\n    grid-area: 1/1/2/2;\r\n    z-index: 1;\r\n  `\r\n}\r\n","import { createSelector, defaultMemoize } from 'reselect'\r\nimport { ModalIds } from '../data/types'\r\nimport { DefaultRootState } from '../react-redux'\r\n\r\n// Simple selectors\r\nexport const selectActiveTags = (state: DefaultRootState) => state.tags.active\r\nexport const selectResults = (state: DefaultRootState) => state.results\r\nexport const selectPosts = (state: DefaultRootState) => state.results.posts\r\nexport const selectCount = (state: DefaultRootState) => state.results.count\r\nexport const selectPageNumber = (state: DefaultRootState) => state.results.pageNumber\r\nexport const selectPreferences = (state: DefaultRootState) => state.preferences\r\nexport const selectResultsLayout = (state: DefaultRootState) => state.preferences.resultsLayout\r\nexport const selectPreloadVideos = (state: DefaultRootState) => state.preferences.resultsLayout\r\nexport const selectOriginals = (state: DefaultRootState) => state.preferences.originals\r\nexport const selectRated = (state: DefaultRootState) => state.preferences.rated\r\nexport const selectRatedThreshold = (state: DefaultRootState) => state.preferences.ratedThreshold\r\nexport const selectCookies = (state: DefaultRootState) => state.preferences.cookies\r\nexport const selectFullsceenState = (state: DefaultRootState) => state.reader.isEnabled\r\nexport const selectFullsceenPostId = (state: DefaultRootState) => state.reader.postId\r\nexport const selectAliases = (state: DefaultRootState) => state.tags.aliases\r\nexport const selectPageSize = (state: DefaultRootState) => state.preferences.pageSize\r\nexport const selectTagSuggestionCount = (state: DefaultRootState) => state.preferences.tagSuggestionsCount\r\nexport const selectUseCorsProxy = (state: DefaultRootState) => state.preferences.useCorsProxy\r\nexport const selectShowMetadata = (state: DefaultRootState) => state.preferences.showMetadata\r\nexport const selectShowComments = (state: DefaultRootState) => state.preferences.showComments\r\nexport const selectSort = (state: DefaultRootState) => state.preferences.sort\r\nexport const selectSuggestions = (state: DefaultRootState) => state.suggestions.entries\r\nexport const selectActiveThemeId = (state: DefaultRootState) => state.preferences.themeId\r\nexport const selectAutoPlay = (state: DefaultRootState) => state.preferences.autoPlay\r\nexport const selectHideSeen = (state: DefaultRootState) => state.preferences.hideSeen\r\nexport const selectOpenModalId = (state: DefaultRootState) => state.modals.openModal\r\n\r\n// Memoized selectors\r\nexport const selectNumberOfActiveTags = createSelector(selectActiveTags, (tags) => Object.keys(tags).length)\r\nexport const selectAliasesAsList = createSelector(selectAliases, (aliases) => Object.values(aliases).flat())\r\nexport const selectHasResults = createSelector(selectPosts, (posts) => posts.length !== 0)\r\nexport const selectOutOfResults = createSelector(selectPosts, selectCount, (posts, count) => posts.length === count)\r\nexport const selectHasMoreResults = createSelector(selectOutOfResults, (outOfResults) => !outOfResults)\r\nexport const selectLastPage = createSelector(\r\n  selectCount,\r\n  selectPageSize,\r\n  (count, pageSize) => Math.ceil(count / pageSize) - 1\r\n)\r\nexport const selectFullScreenPost = createSelector(selectPosts, selectFullsceenPostId, (posts, fullScreenPostId) =>\r\n  posts.find((post) => post.id === fullScreenPostId)\r\n)\r\nexport const selectFullScreenIndex = createSelector(selectPosts, selectFullScreenPost, (posts, fullScreenPost) =>\r\n  fullScreenPost ? posts.indexOf(fullScreenPost) : -1\r\n)\r\nexport const selectMinRating = createSelector(selectRated, selectRatedThreshold, (rated, ratedThreshold) =>\r\n  rated ? ratedThreshold : 0\r\n)\r\nexport const selectNextIndex = createSelector(selectPosts, selectFullScreenIndex, (posts, selectedIndex) =>\r\n  selectedIndex + 1 < posts.length ? selectedIndex + 1 : undefined\r\n)\r\nexport const selectPreviousIndex = createSelector(selectFullScreenIndex, (selectedIndex) =>\r\n  selectedIndex > 0 ? selectedIndex - 1 : undefined\r\n)\r\nexport const selectSupertagModalOpen = createSelector(\r\n  selectOpenModalId,\r\n  (modalId) => modalId === ModalIds.CREATE_SUPERTAG\r\n)\r\n\r\n// Parameterized selectors\r\nexport const selectPostById = defaultMemoize((id: number) => {\r\n  return createSelector(selectPosts, (posts) => {\r\n    return posts.find((post) => post.id === id)\r\n  })\r\n})\r\n\r\nexport const selectAliasesByTagName = defaultMemoize((tagName: string) => {\r\n  return createSelector(selectAliases, (aliases) => {\r\n    return aliases[tagName]\r\n  })\r\n})\r\n\r\nexport const selectLikedByPostId = defaultMemoize((id: number) => (state: DefaultRootState) => id in state.likes)\r\n","import {\r\n  faDeviantart,\r\n  faDiscord,\r\n  faGithub,\r\n  faGoogle,\r\n  faPatreon,\r\n  faTumblr,\r\n  faTwitter,\r\n} from '@fortawesome/free-brands-svg-icons'\r\nimport {\r\n  faCalendarDay,\r\n  faCaretDown,\r\n  faCheckCircle,\r\n  faCheckSquare,\r\n  faCodeBranch,\r\n  faCopyright,\r\n  faDownload,\r\n  faExpand,\r\n  faExternalLinkAlt,\r\n  faHashtag,\r\n  faHeart,\r\n  faImage,\r\n  faInfoCircle,\r\n  faLink,\r\n  faPen,\r\n  faPlus,\r\n  faRegistered,\r\n  faSearch,\r\n  faSignOutAlt,\r\n  faTags,\r\n  faTimes,\r\n  faTimesCircle,\r\n  faUndoAlt,\r\n  faUser,\r\n  faWrench,\r\n} from '@fortawesome/free-solid-svg-icons'\r\nimport { FontAwesomeIcon } from '@fortawesome/react-fontawesome'\r\nimport styled from 'styled-components'\r\n\r\nexport const CharacterIcon = styled(FontAwesomeIcon).attrs({\r\n  icon: faUser,\r\n})``\r\n\r\nexport const ArtistIcon = styled(FontAwesomeIcon).attrs({\r\n  icon: faPen,\r\n})``\r\n\r\nexport const CopyrightIcon = styled(FontAwesomeIcon).attrs({\r\n  icon: faCopyright,\r\n})``\r\n\r\nexport const MetaDataIcon = styled(FontAwesomeIcon).attrs({\r\n  icon: faInfoCircle,\r\n})``\r\n\r\nexport const CloseIcon = styled(FontAwesomeIcon).attrs({\r\n  icon: faTimes,\r\n})``\r\n\r\nexport const ExpandIcon = styled(FontAwesomeIcon).attrs({\r\n  icon: faExpand,\r\n})``\r\n\r\nexport const ExternalLinkIcon = styled(FontAwesomeIcon).attrs({\r\n  icon: faExternalLinkAlt,\r\n})``\r\n\r\nexport const DownloadIcon = styled(FontAwesomeIcon).attrs({\r\n  icon: faDownload,\r\n})``\r\n\r\nexport const SourceIcon = styled(FontAwesomeIcon).attrs({\r\n  icon: faHashtag,\r\n})``\r\n\r\nexport const RatingIcon = styled(FontAwesomeIcon).attrs({\r\n  icon: faRegistered,\r\n})``\r\n\r\nexport const HeartIcon = styled(FontAwesomeIcon).attrs({\r\n  icon: faHeart,\r\n})``\r\n\r\nexport const LinkIcon = styled(FontAwesomeIcon).attrs({\r\n  icon: faLink,\r\n})``\r\n\r\nexport const ArrowDown = styled(FontAwesomeIcon).attrs({\r\n  icon: faCaretDown,\r\n})``\r\n\r\nexport const CodeBranchIcon = styled(FontAwesomeIcon).attrs({\r\n  icon: faCodeBranch,\r\n})``\r\n\r\nexport const GithubIcon = styled(FontAwesomeIcon).attrs({\r\n  icon: faGithub,\r\n})``\r\n\r\nexport const PatreonIcon = styled(FontAwesomeIcon).attrs({\r\n  icon: faPatreon,\r\n})``\r\n\r\nexport const TwitterIcon = styled(FontAwesomeIcon).attrs({\r\n  icon: faTwitter,\r\n})``\r\n\r\nexport const DeviantArtIcon = styled(FontAwesomeIcon).attrs({\r\n  icon: faDeviantart,\r\n})``\r\n\r\nexport const DiscordIcon = styled(FontAwesomeIcon).attrs({\r\n  icon: faDiscord,\r\n})``\r\n\r\nexport const TumblrIcon = styled(FontAwesomeIcon).attrs({\r\n  icon: faTumblr,\r\n})``\r\n\r\nexport const CalendarIcon = styled(FontAwesomeIcon).attrs({\r\n  icon: faCalendarDay,\r\n})``\r\n\r\nexport const CheckIcon = styled(FontAwesomeIcon).attrs({\r\n  icon: faCheckSquare,\r\n})``\r\n\r\nexport const ImageIcon = styled(FontAwesomeIcon).attrs({\r\n  icon: faImage,\r\n})``\r\n\r\nexport const GoogleIcon = styled(FontAwesomeIcon).attrs({\r\n  icon: faGoogle,\r\n})``\r\n\r\nexport const WrenchIcon = styled(FontAwesomeIcon).attrs({\r\n  icon: faWrench,\r\n})``\r\n\r\nexport const SearchIcon = styled(FontAwesomeIcon).attrs({\r\n  icon: faSearch,\r\n})``\r\n\r\nexport const SupertagIcon = styled(FontAwesomeIcon).attrs({\r\n  icon: faTags,\r\n})``\r\n\r\nexport const FailedIcon = styled(FontAwesomeIcon).attrs({\r\n  icon: faTimesCircle,\r\n})``\r\n\r\nexport const SuccessIcon = styled(FontAwesomeIcon).attrs({\r\n  icon: faCheckCircle,\r\n})``\r\n\r\nexport const PlusIcon = styled(FontAwesomeIcon).attrs({\r\n  icon: faPlus,\r\n})``\r\n\r\nexport const SignOutIcon = styled(FontAwesomeIcon).attrs({\r\n  icon: faSignOutAlt,\r\n})``\r\n\r\nexport const UndoIcon = styled(FontAwesomeIcon).attrs({\r\n  icon: faUndoAlt,\r\n})``\r\n","import firebase from 'firebase/app'\r\nimport 'firebase/analytics'\r\nimport { SearchEvent } from '../analytics/events'\r\n\r\nexport async function logEvent(event: SearchEvent) {\r\n  firebase.analytics().logEvent<typeof event.id>(event.id, event.payload)\r\n}\r\n","import firebase from 'firebase/app'\r\nimport 'firebase/auth'\r\n\r\nconst googleAuthProvider = new firebase.auth.GoogleAuthProvider()\r\n\r\nexport function signIn() {\r\n  firebase\r\n    .auth()\r\n    .signInWithPopup(googleAuthProvider)\r\n    .catch((error) => {\r\n      console.error('Sign in failed:', error.code, error.message)\r\n    })\r\n}\r\n\r\nexport async function signOut() {\r\n  return await firebase.auth().signOut()\r\n}\r\n","export async function sha256(message: string) {\r\n  const msgBuffer = new TextEncoder().encode(message)\r\n  const hashBuffer = await crypto.subtle.digest('SHA-256', msgBuffer)\r\n  const hashArray = Array.from(new Uint8Array(hashBuffer))\r\n  const hashHex = hashArray.map((b) => b.toString(16).padStart(2, '0')).join('')\r\n\r\n  return hashHex\r\n}\r\n","import firebase from 'firebase/app'\r\n\r\nexport class GenericConverter<T> {\r\n  toFirestore(data: T): firebase.firestore.DocumentData {\r\n    return data\r\n  }\r\n  fromFirestore(snapshot: firebase.firestore.QueryDocumentSnapshot, options: firebase.firestore.SnapshotOptions): T {\r\n    const data = snapshot.data(options)!\r\n    return data as T\r\n  }\r\n}\r\n","import firebase from 'firebase/app'\r\nimport 'firebase/auth'\r\nimport 'firebase/firestore'\r\nimport { sha256 } from '../data/encryption'\r\nimport { User, SupertagDetails } from './types'\r\nimport { PreferencesState } from '../redux/reducers/preferences'\r\nimport { GenericConverter } from './genericConverter'\r\nimport { Modifier } from '../data/types'\r\nimport { useEffect, useState } from 'react'\r\nimport useFirebaseAuthState from '../hooks/useFirebaseAuthState'\r\n\r\nconst userConverter = new GenericConverter<User>()\r\n\r\nasync function getUserDoc() {\r\n  const { currentUser } = firebase.auth()\r\n  const email = currentUser?.email\r\n\r\n  if (email) {\r\n    const key = await sha256(email)\r\n    const userDoc = firebase.firestore().collection('users').doc(key)\r\n    return userDoc\r\n  }\r\n\r\n  return undefined\r\n}\r\n\r\nasync function getUserData() {\r\n  const userDoc = await getUserDoc()\r\n\r\n  if (userDoc) {\r\n    let userSnap = await userDoc.withConverter(userConverter).get()\r\n\r\n    const userData = userSnap.data()\r\n    return userData\r\n  }\r\n\r\n  return undefined\r\n}\r\n\r\nexport async function getPreferences() {\r\n  const userData = await getUserData()\r\n  if (userData) {\r\n    return userData.preferences\r\n  }\r\n\r\n  return undefined\r\n}\r\n\r\nexport async function setPreferences(preferences: PreferencesState) {\r\n  const userDoc = await getUserDoc()\r\n\r\n  if (userDoc) {\r\n    await userDoc.set({ preferences: preferences })\r\n  }\r\n}\r\n\r\nexport async function getSeenPosts() {\r\n  const userDoc = await getUserDoc()\r\n\r\n  if (userDoc) {\r\n    const snap = await userDoc.collection('seenposts').get()\r\n    const result: Record<string, {}> = {}\r\n\r\n    snap.forEach((doc) => {\r\n      const posstId = doc.id as string\r\n      result[posstId] = doc.data() as SupertagDetails\r\n    })\r\n\r\n    return result\r\n  }\r\n\r\n  return undefined\r\n}\r\n\r\nexport async function resetSeenPosts() {\r\n  const userDoc = await getUserDoc()\r\n\r\n  if (userDoc) {\r\n    console.log('broken')\r\n  }\r\n}\r\n\r\nexport async function getSupertags() {\r\n  const userDoc = await getUserDoc()\r\n\r\n  if (userDoc) {\r\n    const snap = await userDoc.collection('supertags').get()\r\n    const result: Record<string, SupertagDetails> = {}\r\n\r\n    snap.forEach((doc) => {\r\n      result[doc.id] = doc.data() as SupertagDetails\r\n    })\r\n\r\n    return result\r\n  }\r\n\r\n  return undefined\r\n}\r\n\r\nexport async function addSupertag(name: string, description: string, tags: Record<string, Modifier>) {\r\n  const userDoc = await getUserDoc()\r\n\r\n  if (userDoc) {\r\n    userDoc.collection('supertags').doc(name).set({ description, tags })\r\n  }\r\n}\r\n\r\nexport async function removeSupertag(name: string) {\r\n  const userDoc = await getUserDoc()\r\n\r\n  if (userDoc) {\r\n    userDoc.collection('supertags').doc(name).delete()\r\n  }\r\n}\r\n\r\nexport async function setTagsOfSupertag(name: string, tags: Record<string, Modifier>) {\r\n  const userDoc = await getUserDoc()\r\n\r\n  if (userDoc) {\r\n    userDoc.collection('supertags').doc(name).update({ tags })\r\n  }\r\n}\r\n\r\nexport function useSupertags() {\r\n  const [supertags, setSupertags] = useState<Record<string, SupertagDetails>>({})\r\n  const [collection, setCollection] = useState<firebase.firestore.CollectionReference>()\r\n\r\n  // eslint-disable-next-line @typescript-eslint/no-unused-vars\r\n  const [_, userInfo] = useFirebaseAuthState()\r\n\r\n  useEffect(() => {\r\n    if (userInfo?.email) {\r\n      sha256(userInfo.email)\r\n        .then((hash) => {\r\n          const col = firebase.firestore().collection(`users/${hash}/supertags`)\r\n          setCollection(col)\r\n          return col.get()\r\n        })\r\n        .then((snapshot) => {\r\n          const result = snapshot.docs.reduce((result, doc) => {\r\n            result[doc.id] = doc.data() as SupertagDetails\r\n            return result\r\n          }, {} as Record<string, SupertagDetails>)\r\n\r\n          setSupertags(result)\r\n        })\r\n    }\r\n  }, [userInfo?.email])\r\n\r\n  useEffect(() => {\r\n    if (collection) {\r\n      const unsubscribe = collection.onSnapshot((snapshot) => {\r\n        const result = snapshot.docs.reduce((result, doc) => {\r\n          const userSupertags = doc\r\n          result[userSupertags.id] = doc.data() as SupertagDetails\r\n          return result\r\n        }, {} as Record<string, SupertagDetails>)\r\n\r\n        setSupertags(result)\r\n      })\r\n\r\n      return () => {\r\n        unsubscribe()\r\n      }\r\n    }\r\n  }, [collection])\r\n\r\n  return supertags\r\n}\r\n","import firebase from 'firebase/app'\r\nimport 'firebase/analytics'\r\nimport 'firebase/auth'\r\nimport 'firebase/firestore'\r\n\r\nconst firebaseConfig = {\r\n  apiKey: 'AIzaSyBHdepwE7M4Byu2lFtX2s__9COcMdvXu7Q',\r\n  authDomain: 'r34-react.firebaseapp.com',\r\n  databaseURL: 'https://r34-react.firebaseio.com',\r\n  projectId: 'r34-react',\r\n  storageBucket: 'r34-react.appspot.com',\r\n  messagingSenderId: '844749417844',\r\n  appId: '1:844749417844:web:11fa1fda0e14f1ac2dd021',\r\n  measurementId: 'G-27J3QXZ8YR',\r\n}\r\n\r\nfirebase.initializeApp(firebaseConfig)\r\n\r\nexport * from './analytics'\r\nexport * from './signIn'\r\nexport * from './storage'\r\n","import styled, { css } from 'styled-components'\nimport { defaultBorder, dropShadow, primaryHover } from '../../styled/mixins'\n\nconst TextButton = styled.button(\n  ({ theme }) => css`\n    height: ${theme.dimensions.blockHeight};\n    padding: 0 ${theme.dimensions.bigSpacing};\n    font-size: ${theme.fontSizes.content};\n    ${defaultBorder({ theme })}\n    display: inline-flex;\n    gap: ${theme.dimensions.gutter};\n    align-items: center;\n    place-content: center;\n\n    transition: all ${theme.timings.longTransitionTime} ease-out;\n  `\n)\n\nexport const InvisButton = styled.button(\n  ({ theme }) => css`\n    background-color: transparent;\n    border: none;\n    padding: ${theme.dimensions.gutter};\n    ${dropShadow({ theme })}\n\n    svg {\n      transition: all ${theme.timings.transitionTime} ease-out;\n    }\n\n    :active {\n      svg {\n        transform: scale(1.1);\n      }\n    }\n  `\n)\n\nexport const RedButton = styled(TextButton)`\n  ${primaryHover}\n`\n\nexport const BlockButton = styled(RedButton)`\n  width: 100%;\n\n  :active {\n    transform: scaleX(1.03) scaleY(1.1);\n  }\n`\n\nexport const AddButton = styled(RedButton)(\n  ({ theme }) => css`\n    border-radius: 0 ${theme.dimensions.borderRadius} ${theme.dimensions.borderRadius} 0;\n  `\n)\n\nexport const ModifierButton = styled(TextButton)(\n  ({ theme }) => css`\n    background-color: transparent;\n    min-width: 48px;\n    font-weight: bold;\n\n    ${defaultBorder({ theme })}\n    border-right-width: 0;\n    border-radius: ${theme.dimensions.borderRadius} 0 0 ${theme.dimensions.borderRadius};\n  `\n)\n","import { parseUrl } from '../data/utils'\n\n/**\n * Transforms a number into a shortened version for rendering.\n * Useful as it takes up less space.\n */\nexport const formatCount = (numberString: number) => {\n  const number = numberString\n\n  if (number >= 1e6) {\n    return `${(number / 1e6).toFixed(0)}M`\n  }\n\n  if (number >= 1e3) {\n    return `${(number / 1e3).toFixed(0)}K`\n  }\n\n  return number\n}\n\n/**\n * Formats source strings for rendering\n */\nexport const formatSource = (source: string) => {\n  const url = parseUrl(source)\n  return url ? url.host : source\n}\n\n/**\n * Seconds to mm:ss formatter\n */\nexport function formatDuration(duration: number) {\n  const min = Math.trunc(duration / 60)\n  const sec = Math.trunc(duration % 60)\n\n  return min + ':' + (sec < 10 ? '0' : '') + sec\n}\n\n/**\n * Formats tag names for rendering.\n */\nexport function formatTagname(tagname: string) {\n  return tagname\n    .replace(/_/g, ' ')\n    .replace(/source:/g, ' ')\n    .replace(/rating:/g, ' ')\n}\n\n/**\n * Serializes tag names for use in api requests.\n */\nexport function serializeTagname(tagname: string) {\n  return tagname.toLowerCase().replace(/ /g, '_')\n}\n\n/**\n * Formats tags with their count if possible\n */\nexport function formatTagnameAndCount(name: string, count?: number | null) {\n  return count ? `${formatTagname(name)} (${formatCount(count)})` : formatTagname(name)\n}\n\nexport function formatDateTime(date: Date) {\n  return `${date.toLocaleDateString()} ${date.toLocaleTimeString()}`\n}\n\nexport function formatTime(milliseconds: number) {\n  if (milliseconds >= 315576e5) {\n    return formatUnit(milliseconds, 315576e5, 'year')\n  }\n  if (milliseconds >= 26297568e2) {\n    return formatUnit(milliseconds, 26297568e2, 'month')\n  }\n\n  if (milliseconds >= 6048e5) {\n    return formatUnit(milliseconds, 6048e5, 'week')\n  }\n\n  if (milliseconds >= 854e5) {\n    return formatUnit(milliseconds, 854e5, 'day')\n  }\n\n  if (milliseconds >= 36e5) {\n    return formatUnit(milliseconds, 36e5, 'hour')\n  }\n\n  if (milliseconds >= 6e4) {\n    return formatUnit(milliseconds, 6e4, 'minute')\n  }\n\n  if (milliseconds >= 1e3) {\n    return formatUnit(milliseconds, 1e3, 'second')\n  }\n\n  return `${milliseconds} ms`\n}\n\nfunction formatUnit(value: number, unitSize: number, unit: string) {\n  const result = (value / unitSize).toFixed(0)\n\n  const unitString = result === '1' ? unit : `${unit}s`\n\n  return `${result} ${unitString}`\n}\n","import { TagType, Modifier } from './types'\n\nexport default class TagDataClass {\n  name: string\n  count?: number | null\n  types?: TagType[]\n  modifier?: Modifier\n\n  constructor(name: string, types: TagType[] = [], count: number | null = null, modifier: Modifier = Modifier.PLUS) {\n    this.name = name\n    this.types = types\n    this.count = count\n    this.modifier = modifier\n  }\n}\n","import styled, { css } from 'styled-components'\nimport { flexRowWithGap } from '../../styled/mixins'\n\nexport const Title = styled.h2(\n  ({ theme }) => css`\n    font-size: ${theme.fontSizes.bigTitle};\n    font-weight: lighter;\n    text-align: center;\n  `\n)\n\nexport const BigTitle = styled.h1(\n  ({ theme }) => css`\n    ${flexRowWithGap({ theme })}\n\n    justify-content: center;\n    font-size: ${theme.fontSizes.bigTitle};\n    font-weight: lighter;\n    text-align: center;\n  `\n)\n\nexport const SmallTitle = styled.h3(\n  ({ theme }) => css`\n    font-size: ${theme.fontSizes.content};\n  `\n)\n\nexport const Faded = styled.span(\n  ({ theme }) => css`\n    color: ${theme.colors.subduedText};\n  `\n)\n","import PostDataClass from './PostDataClass'\nimport TagDataClass from './TagDataClass'\nimport { PostType, MediaType } from './types'\n\nexport const getMediaType = (type: PostType, post: PostDataClass) => {\n  if (type === PostType.VIDEO) {\n    return MediaType.VIDEO\n  }\n\n  // can't use .endsWith because of queryString\n  if (post.small_src.includes('.gif') || post.big_src.includes('.gif')) {\n    return MediaType.GIF\n  }\n\n  return MediaType.PICTURE\n}\n\nexport function getUrlParameter(src: string) {\n  return new URL(src).searchParams.get('url') || ''\n}\n\n/**\n * Converts a list of objects into a map.\n * @param list The original list\n * @param keyProp The keyProp parameter defines which property of the objects will be used as the index for the map\n */\nexport const listToMap = <T>(list: T[], keyProp: string): Record<string, T> => {\n  return list.reduce((result: Record<string, T>, current: any) => {\n    result[current[keyProp]] = current\n    return result\n  }, {})\n}\n\n/**\n * Joins tags together for analytics event\n */\nexport function tagsToString(tags: Record<string, TagDataClass>) {\n  return Object.values(tags)\n    .map((tag) => `${tag.modifier}${tag.name}`)\n    .sort()\n}\n\n/**\n * Returns a URL object when the value is a hyperlink. Else undefined\n */\nexport function parseUrl(value: string) {\n  try {\n    return new URL(value)\n  } catch (err) {\n    return undefined\n  }\n}\n\n/**\n * converts a version like \"1.2.7\" into 127\n */\nexport function versionToNumber(majorMinorPatch: string) {\n  return Number(majorMinorPatch.split('.').join(''))\n}\n\n/**\n * Hacky ass way to download images cross origin. Could solve this by hosting both the app and the api on the same domain.\n */\nexport function download(url: string) {\n  const filename = url.split('/').pop() || ''\n\n  fetch(url, {\n    headers: new Headers({\n      Origin: window.location.origin,\n    }),\n    mode: 'cors',\n  })\n    .then((response) => response.blob())\n    .then((blob) => {\n      var a = document.createElement('a')\n      a.download = filename\n      a.href = window.URL.createObjectURL(blob)\n      document.body.appendChild(a)\n      a.click()\n      a.remove()\n    })\n    .catch((e) => console.error(e))\n}\n\n/**\n * Returns the current version of the project\n */\nexport function getVersion() {\n  // Some browsers fail to get environment variables. In that case return unknown.\n  if (process?.env?.REACT_APP_VERSION) {\n    return process.env.REACT_APP_VERSION\n  }\n\n  return 'unknown'\n}\n\n/**\n * Render ready version.\n */\nexport function getVersionString() {\n  const version = getVersion()\n\n  return version === 'unknown' ? 'Latest Release' : `Version ${version}`\n}\n\n/**\n * Returns the correct source based on preferences\n */\nexport function getCorrectSource(loadOriginal: boolean, useCorsProxy: boolean, big_src: string, small_src: string) {\n  const source = loadOriginal ? big_src : small_src\n  return getCorrectSourceOrigin(useCorsProxy, source)\n}\n\n/**\n * Returns the proxy source or direct depending on prefererence\n */\nexport function getCorrectSourceOrigin(useCorsProxy: boolean, source: string) {\n  return useCorsProxy ? source : getUrlParameter(source)\n}\n\nexport function boolToNumber(value: boolean) {\n  return value ? 1 : 0\n}\n","import styled, { css } from 'styled-components'\n\nexport const HorizontalLine = styled.div(\n  (props) => css`\n    align-self: stretch;\n    height: 1px;\n    background: ${props.theme.colors.layerBg};\n  `\n)\n\nexport const VerticalLine = styled.div(\n  (props) => css`\n    width: 1px;\n    align-self: stretch;\n    background: ${props.theme.colors.layerBg};\n  `\n)\n","export const supportsFlexGap = (() => {\r\n  // create flex container with row-gap set\r\n  var flex = document.createElement('div')\r\n  flex.style.display = 'flex'\r\n  flex.style.flexDirection = 'column'\r\n  flex.style.rowGap = '1px'\r\n\r\n  // create two, elements inside it\r\n  flex.appendChild(document.createElement('div'))\r\n  flex.appendChild(document.createElement('div'))\r\n\r\n  // append to the DOM (needed to obtain scrollHeight)\r\n  document.body.appendChild(flex)\r\n  var isSupported = flex.scrollHeight === 1 // flex container should be 1px high from the row-gap\r\n  //@ts-expect-error\r\n  flex.parentNode.removeChild(flex)\r\n\r\n  return isSupported\r\n})()\r\n\r\nexport const supportsGap = 'gap' in document.body.style\r\nexport const supportsAspectRatio = 'aspect-ratio' in document.body.style\r\nexport const supportsObjectFit = 'object-fit' in document.body.style\r\nexport const supportsFullscreen = document.fullscreenEnabled\r\n\r\nexport function openFullscreen(element: Element) {\r\n  if (element.requestFullscreen) {\r\n    element.requestFullscreen()\r\n    //@ts-expect-error\r\n  } else if (element.webkitRequestFullscreen) {\r\n    //@ts-expect-error\r\n    element.webkitRequestFullscreen()\r\n    //@ts-expect-error\r\n  } else if (element.msRequestFullscreen) {\r\n    //@ts-expect-error\r\n    element.msRequestFullscreen()\r\n  }\r\n}\r\n\r\nexport function closeFullscreen() {\r\n  if (document.exitFullscreen) {\r\n    document.exitFullscreen()\r\n    //@ts-expect-error\r\n  } else if (document.webkitExitFullscreen) {\r\n    //@ts-expect-error\r\n    document.webkitExitFullscreen()\r\n    //@ts-expect-error\r\n  } else if (document.msExitFullscreen) {\r\n    //@ts-expect-error\r\n    document.msExitFullscreen()\r\n  }\r\n}\r\n","import { RatingType, PostType } from './types'\nimport TagDataClass from './TagDataClass'\nimport CommentDataClass from './CommentDataClass'\n\nexport default class PostDataClass {\n  id: number\n\n  score: number\n  rating: RatingType\n  source: string\n  tags: TagDataClass[]\n\n  media_type: PostType\n\n  thumbnail_src: string\n  small_src: string\n  big_src: string\n\n  width: number\n  height: number\n\n  creator_id: number\n  creator_url: string\n\n  status: string\n  parent_id: number\n  has_children: boolean\n  has_comments: boolean\n  comments_url: string\n  has_notes: boolean\n  created_at: number\n  change: string\n\n  comments?: CommentDataClass[]\n\n  constructor(\n    id: number,\n    score: number,\n    rating: RatingType,\n    source: string,\n    tags: TagDataClass[],\n    media_type: PostType,\n    media_src: any,\n    file_url: any,\n    thumbnail_src: string,\n    width: number,\n    height: number,\n    creator_id: number,\n    creator_url: string,\n    status: string,\n    parent_id: number,\n    has_children: boolean,\n    has_comments: boolean,\n    comments_url: string,\n    has_notes: boolean,\n    created_at: string,\n    change: string\n  ) {\n    this.id = id\n\n    this.score = score\n    this.rating = rating\n    this.source = source\n    this.tags = tags\n\n    this.media_type = media_type\n    this.small_src = media_src\n    this.big_src = file_url\n    this.thumbnail_src = thumbnail_src\n\n    this.width = width\n    this.height = height\n\n    this.creator_id = creator_id\n    this.creator_url = creator_url\n\n    this.status = status\n    this.parent_id = parent_id\n    this.has_children = has_children\n    this.has_comments = has_comments\n    this.comments_url = comments_url\n    this.has_notes = has_notes\n    this.created_at = Date.parse(created_at)\n    this.change = change\n  }\n}\n","import PostDataClass from '../data/PostDataClass'\nimport TagDataClass from '../data/TagDataClass'\nimport { TagType, Modifier, RatingType, PostType } from '../data/types'\n\n/**\n * A tag as received from the backend.\n * All strings\n */\ninterface DirtyTag {\n  name: string\n  types: string[]\n  count: string\n  modifier: string\n}\n\n/**\n * A post as received from the backend.\n * All strings\n */\nexport interface DirtyPost {\n  id: string\n  type: string\n  score: string\n  rating: string\n  source: string\n  tags: string[]\n  file_url: string\n  width: string\n  height: string\n  creator_id: string\n  creator_url: string\n  sample_url: string\n  preview_url: string\n  status: string\n  parent_id: string\n  has_children: string\n  has_comments: string\n  comments_url: string\n  has_notes: string\n  created_at: string\n  change: string\n}\n\n/**\n * Introduce types for nicer use later\n */\nexport function prepareTag(dirtyTag: DirtyTag) {\n  const { name, types, count, modifier } = dirtyTag\n\n  return new TagDataClass(name, types as TagType[], Number(count), modifier as Modifier)\n}\n\n/**\n * Introduce types for nicer use later and parse tag names to tag objects.\n */\nexport function preparePost(post: DirtyPost) {\n  const {\n    id,\n    type,\n    score,\n    rating,\n    source,\n    tags,\n    file_url,\n    width,\n    height,\n    creator_id,\n    creator_url,\n    sample_url,\n    preview_url,\n    status,\n    parent_id,\n    has_children,\n    has_comments,\n    comments_url,\n    has_notes,\n    created_at,\n    change,\n  } = post\n  return new PostDataClass(\n    Number(id),\n    Number(score),\n    rating as RatingType,\n    source,\n    tags ? tags.map((t) => new TagDataClass(t)) : [],\n    type as PostType,\n    sample_url,\n    file_url,\n    preview_url,\n    Number(width),\n    Number(height),\n    Number(creator_id),\n    creator_url,\n    status,\n    Number(parent_id),\n    Boolean(has_children),\n    Boolean(has_comments),\n    comments_url,\n    Boolean(has_notes),\n    created_at,\n    change\n  )\n}\n","import styled from 'styled-components'\nimport { borderRadius, gutter, layer } from '../../styled/mixins'\n\nexport default styled.div`\n  display: grid;\n  ${gutter}\n  ${layer}\n  ${borderRadius}\n  width: 100%;\n`\n","import firebase from 'firebase/app'\r\nimport 'firebase/auth'\r\nimport { useEffect, useState } from 'react'\r\n\r\n/**\r\n * A hook that provides the firebase authentication status for use in functional components.\r\n */\r\nexport default function useFirebaseAuthState() {\r\n  const [authState, setAuthState] = useState(false)\r\n  const [user, setUser] = useState<firebase.User | null>(null)\r\n\r\n  useEffect(() => {\r\n    const unsubscribe = firebase.auth().onAuthStateChanged((user) => {\r\n      if (user) {\r\n        setAuthState(true)\r\n        setUser(user)\r\n      } else {\r\n        setAuthState(false)\r\n        setUser(null)\r\n      }\r\n    })\r\n    return () => {\r\n      unsubscribe()\r\n    }\r\n  }, [])\r\n\r\n  return [authState, user] as const\r\n}\r\n","import React, { MouseEventHandler, useMemo } from 'react'\nimport { NO_OP, TagType } from '../data/types'\nimport {\n  CharacterIcon,\n  CopyrightIcon,\n  ArtistIcon,\n  RatingIcon,\n  SourceIcon,\n  MetaDataIcon,\n  SupertagIcon,\n} from './FontAwesomeIcons'\n\ninterface TypeIconProps {\n  types?: string[]\n  className?: string\n  color?: string\n  size?: number\n  onClick?: MouseEventHandler\n  left?: boolean\n  right?: boolean\n}\n\nexport default function TypeIcon(props: TypeIconProps) {\n  const { types = [], className = '', onClick = NO_OP } = props\n  const interestingType = useMemo(() => types.find((t) => !t.match(/^[general|ambiguous]$/)), [types])\n\n  switch (interestingType) {\n    case TagType.CHARACTER:\n      return <CharacterIcon className={className} onClick={onClick} />\n    case TagType.COPYRIGHT:\n      return <CopyrightIcon className={className} onClick={onClick} />\n    case TagType.ARTIST:\n      return <ArtistIcon className={className} onClick={onClick} />\n    case TagType.RATING:\n      return <RatingIcon className={className} onClick={onClick} />\n    case TagType.SOURCE:\n      return <SourceIcon className={className} onClick={onClick} />\n    case TagType.METADATA:\n      return <MetaDataIcon className={className} onClick={onClick} />\n    case TagType.SUPERTAG:\n      return <SupertagIcon className={className} onClick={onClick} />\n    default:\n      return null\n  }\n}\n","import styled from 'styled-components'\nimport { flexColumn, gutter, centeredMaxWidth } from '../../styled/mixins'\n\nconst FlexColumn = styled.div`\n  ${flexColumn}\n  width: 100%;\n  min-height: 100%;\n`\n\nexport default FlexColumn\n\nexport const FlexColumnWithSpacing = styled(FlexColumn)`\n  ${gutter}\n  ${centeredMaxWidth}\n`\n","import { useCallback } from 'react'\nimport { useDispatch, useSelector } from 'react-redux'\nimport { PreferenceKey } from '../data/types'\nimport { setPreference } from '../redux/actions'\nimport { PreferencesState } from '../redux/reducers/preferences'\nimport { selectPreferences } from '../redux/selectors'\n\n/**\n * useState for preferences using redux instead of local state.\n */\nexport default function usePreference<T extends PreferenceKey>(\n  key: T\n): [PreferencesState[T], (value: PreferencesState[T]) => void] {\n  const dispatch = useDispatch()\n  const preferences = useSelector(selectPreferences)\n  const setValue = useCallback((value: any) => dispatch(setPreference(key, value)), [dispatch, key])\n\n  return [preferences[key], setValue]\n}\n","import React, { RefAttributes } from 'react'\nimport { Link, LinkProps, useLocation } from 'react-router-dom'\nimport styled, { css, ThemeProps } from 'styled-components'\nimport { RouteName } from '../../data/types'\nimport R34Icon from '../../icons/R34Icon'\nimport { boxShadow, flexColumn, flexColumnGap, flexRowGap, flexRowWithGap } from '../../styled/mixins'\nimport { VerticalLine } from '../common/Lines'\nimport { BigTitle } from '../common/Text'\n\nconst HeaderWrapper = styled.header(\n  ({ theme }) => css`\n    ${flexColumn()}\n    ${flexColumnGap(theme.dimensions.bigSpacing)}\n  `\n)\n\nconst TitleBar = styled.div(\n  ({ theme }) => css`\n    ${flexRowWithGap({ theme })}\n    justify-content: center;\n    background: ${theme.colors.layerBgSolid};\n    padding: ${theme.dimensions.gutter} 0;\n    ${boxShadow({ theme })}\n  `\n)\n\nconst MenuBar = styled.nav(\n  ({ theme }) => css`\n    display: flex;\n    justify-content: center;\n    padding: ${theme.dimensions.bigSpacing};\n    ${flexRowGap(theme.dimensions.hugeSpacing)}\n  `\n)\n\ntype LocationStyledLinkProps = LinkProps<unknown> &\n  RefAttributes<HTMLAnchorElement> &\n  ThemeProps<any> & { current: string }\n\nconst LocationStyledLink = styled(Link)(\n  ({ to, current, theme }: LocationStyledLinkProps) => css`\n    color: ${to === current ? theme.colors.accentColor : theme.colors.text};\n  `\n)\n\nexport default function Header() {\n  const current = useLocation().pathname\n\n  return (\n    <HeaderWrapper role='cell'>\n      <TitleBar>\n        <R34Icon size={32} />\n        <VerticalLine />\n        <BigTitle>\n          <span>Browse</span> <a href='https://rule34.xxx'>Rule34</a>\n        </BigTitle>\n      </TitleBar>\n\n      <MenuBar>\n        <LocationStyledLink current={current} to={RouteName.SEARCH}>\n          Search\n        </LocationStyledLink>\n        <VerticalLine />\n        <LocationStyledLink current={current} to={RouteName.SETTINGS}>\n          Settings\n        </LocationStyledLink>\n        <VerticalLine />\n        <LocationStyledLink current={current} to={RouteName.ABOUT}>\n          About\n        </LocationStyledLink>\n      </MenuBar>\n    </HeaderWrapper>\n  )\n}\n","import { useCallback, useState } from 'react'\n\n/**\n * A small wrapper for a useState<boolean> that is primarily used for toggling.\n * Saves me a few useCallbacks.\n */\nexport default function useToggle(initialValue = false): [boolean, () => void, () => void] {\n  const [value, setValue] = useState<boolean>(initialValue)\n  const toggleValue = useCallback(() => setValue(!value), [value])\n  const resetValue = useCallback(() => setValue(initialValue), [initialValue])\n\n  return [value, toggleValue, resetValue]\n}\n","import { useCallback } from 'react'\nimport { useDispatch } from 'react-redux'\nimport { AnyAction } from 'redux'\n\n/**\n * A hook that simplifies usage of simple (unparameterized) Redux actions\n */\nexport default function useAction<T extends () => AnyAction>(actionCreator: T) {\n  const dispatch = useDispatch()\n\n  // eslint-disable-next-line react-hooks/exhaustive-deps\n  return useCallback(() => dispatch(actionCreator()), [actionCreator, dispatch])\n}\n","import { MouseEventHandler } from 'react'\nimport styled, { css, DefaultTheme } from 'styled-components'\nimport { flexRowWithGap } from '../../styled/mixins'\n\nconst dropdownBorderRadius = (collapsed: boolean, theme: DefaultTheme) =>\n  collapsed ? theme.dimensions.borderRadius : `${theme.dimensions.borderRadius} ${theme.dimensions.borderRadius} 0 0`\n\nconst switchingColors = (active: boolean, theme: DefaultTheme) => {\n  const fg = active ? theme.colors.backgroundColor : theme.colors.accentColor\n  const bg = active ? theme.colors.accentColor : theme.colors.backgroundColor\n\n  return css`\n    color: ${fg};\n    background-color: ${bg};\n    border: ${theme.colors.accentColor} ${theme.dimensions.borderWidth} solid;\n    transition: all ${theme.timings.transitionTime} ease-out;\n\n    svg {\n      color: ${fg};\n    }\n\n    cursor: pointer;\n\n    :hover,\n    :focus,\n    :active {\n      border-color: ${theme.colors.backgroundColor2};\n      color: ${theme.colors.backgroundColor2};\n\n      svg {\n        color: ${theme.colors.backgroundColor2};\n      }\n    }\n\n    :active {\n      transform: scale(1.05);\n    }\n  `\n}\n\nconst TagWrapper = styled.div(\n  (props: { active: boolean; collapsed: boolean; onMouseLeave: MouseEventHandler; theme: DefaultTheme }) =>\n    css`\n      ${flexRowWithGap({ theme: props.theme })}\n      ${switchingColors(props.active, props.theme)}\n      padding: 0 ${props.theme.dimensions.gutter};\n      height: ${props.theme.dimensions.blockHeight};\n      border-radius: ${dropdownBorderRadius(props.collapsed, props.theme)};\n      font-size: ${props.theme.fontSizes.content};\n    `\n)\n\nexport default TagWrapper\n","import styled, { css } from 'styled-components'\nimport { Modifier, TagType } from '../../data/types'\nimport { formatTagnameAndCount } from '../../misc/formatting'\n\ninterface TagNameProps {\n  modifier: Modifier\n  name: string\n  count?: number | null\n  types?: TagType[]\n}\n\nconst modifierToStyle = {\n  [Modifier.PLUS]: css``,\n  [Modifier.MINUS]: css`\n    text-decoration: line-through;\n  `,\n  [Modifier.OR]: css`\n    font-style: italic;\n  `,\n}\n\nconst TagNameSpan = styled.span(\n  ({ modifier = Modifier.PLUS }: Pick<TagNameProps, 'modifier'>) => modifierToStyle[modifier]\n)\n\nexport default function TagName(props: TagNameProps) {\n  const { modifier, name, count } = props\n\n  const text = formatTagnameAndCount(name, count)\n\n  return (\n    <TagNameSpan modifier={modifier} tabIndex={0}>\n      {text}\n    </TagNameSpan>\n  )\n}\n","import React, { MouseEventHandler, useCallback } from 'react'\nimport { useDispatch } from 'react-redux'\nimport styled, { css } from 'styled-components'\nimport TagDataClass from '../../data/TagDataClass'\nimport { Modifier } from '../../data/types'\nimport { addTag } from '../../redux/actions'\nimport { flexRowWithGap } from '../../styled/mixins'\nimport TagName from './TagName'\n\ninterface AliasProps {\n  modifier: Modifier\n  name: string\n  count?: number | null\n}\n\nconst AliasWrapper = styled.div(\n  ({ theme }) => css`\n    ${flexRowWithGap({ theme })}\n    padding: 0 ${theme.dimensions.bigSpacing};\n    height: ${theme.dimensions.blockHeight};\n    font-size: ${theme.fontSizes.content};\n  `\n)\n\nexport default function Alias(props: AliasProps) {\n  const { modifier, name, count } = props\n\n  const dispatch = useDispatch()\n\n  const handleClick: MouseEventHandler = useCallback(\n    (event) => {\n      event.stopPropagation()\n      const tag = new TagDataClass(name, [], count, modifier)\n\n      dispatch(addTag(tag))\n    },\n    [count, dispatch, modifier, name]\n  )\n\n  return (\n    <AliasWrapper onClick={handleClick}>\n      <TagName modifier={modifier} name={name} count={count} />\n    </AliasWrapper>\n  )\n}\n","import React from 'react'\nimport styled, { css, DefaultTheme } from 'styled-components'\nimport TagDataClass from '../../data/TagDataClass'\nimport { Modifier } from '../../data/types'\nimport Alias from './Alias'\n\nconst ListWrapper = styled.div(\n  ({ theme, parentRef }: { theme: DefaultTheme; parentRef: HTMLDivElement }) => css`\n    position: absolute;\n    top: ${parentRef.offsetTop + parentRef.clientHeight + 4}px;\n    left: ${parentRef.offsetLeft}px;\n    width: ${parentRef.clientWidth + 5}px;\n\n    display: flex;\n    flex-direction: column;\n\n    border-bottom-left-radius: ${theme.dimensions.borderRadius};\n    border-bottom-right-radius: ${theme.dimensions.borderRadius};\n    border: ${theme.dimensions.borderWidth} solid ${theme.colors.accentColor};\n    border-top: none;\n\n    background: ${theme.colors.backgroundColor};\n    z-index: 3;\n    color: ${theme.colors.accentColor};\n\n    > :not(:last-child) {\n      border-bottom: ${theme.dimensions.borderWidth} solid ${theme.colors.accentColor};\n    }\n  `\n)\n\ninterface AliasesListProps {\n  aliases: TagDataClass[]\n  modifier: Modifier\n  parentRef: HTMLDivElement\n}\n\nexport default function AliasesList(props: AliasesListProps) {\n  const { aliases, modifier, parentRef } = props\n\n  return (\n    <ListWrapper parentRef={parentRef}>\n      {aliases.map(({ name, count }) => (\n        <Alias key={'a_' + name} modifier={modifier} name={name} count={count} />\n      ))}\n    </ListWrapper>\n  )\n}\n","import React, { KeyboardEventHandler, MouseEventHandler, useCallback, useMemo, useState } from 'react'\r\nimport TypeIcon from '../../icons/TypeIcon'\r\nimport { ArrowDown } from '../../icons/FontAwesomeIcons'\r\nimport TagDataClass from '../../data/TagDataClass'\r\nimport { useSelector } from 'react-redux'\r\nimport { selectActiveTags, selectAliasesByTagName } from '../../redux/selectors'\r\nimport useToggle from '../../hooks/useToggle'\r\nimport TagWrapper from './TagWrapper'\r\nimport TagName from './TagName'\r\nimport { Modifier } from '../../data/types'\r\nimport AliasesList from './AliasesList'\r\nimport styled, { css, DefaultTheme } from 'styled-components'\r\n\r\nconst DropdownArrow = styled(ArrowDown)(\r\n  ({ $collapsed, theme }: { $collapsed: boolean; theme: DefaultTheme }) => css`\r\n    transition: all ${theme.timings.transitionTime} ease-out;\r\n    height: 32px;\r\n    width: 32px !important;\r\n    padding: 8px;\r\n    margin: 0 -8px;\r\n    ${$collapsed\r\n      ? css``\r\n      : css`\r\n          transform: rotate(180deg);\r\n        `}\r\n  `\r\n)\r\n\r\ninterface TagProps extends TagDataClass {\r\n  detailed: boolean\r\n  onClick: (tag: TagDataClass) => void\r\n}\r\n\r\nexport default function Tag(props: TagProps) {\r\n  const { name, count, modifier = Modifier.PLUS, types, detailed, onClick } = props\r\n\r\n  const [tagRef, setTagRef] = useState<HTMLDivElement | null>(null)\r\n  const [collapsed, toggleCollapsed, resetCollapsed] = useToggle(true)\r\n\r\n  const activeTags = useSelector(selectActiveTags)\r\n  const aliases = useSelector(selectAliasesByTagName(name))\r\n\r\n  const filteredAliases = useMemo(\r\n    () => (aliases ? aliases.filter((alias) => !(alias.name in activeTags)) : []),\r\n    [activeTags, aliases]\r\n  )\r\n\r\n  const isActive = name in activeTags\r\n  const hasAliases = filteredAliases?.length > 0\r\n\r\n  const handleClick = useCallback(\r\n    (event: React.MouseEvent | React.KeyboardEvent) => {\r\n      event.stopPropagation()\r\n      const tag = new TagDataClass(name, types, count, modifier)\r\n\r\n      onClick(tag)\r\n    },\r\n    [count, modifier, name, onClick, types]\r\n  )\r\n\r\n  const handleArrowClick: MouseEventHandler = useCallback(\r\n    (event) => {\r\n      event.stopPropagation()\r\n      toggleCollapsed()\r\n    },\r\n    [toggleCollapsed]\r\n  )\r\n\r\n  const handleEnter: KeyboardEventHandler = useCallback(\r\n    (event) => {\r\n      if (event.key === 'Enter') {\r\n        handleClick(event)\r\n      }\r\n    },\r\n    [handleClick]\r\n  )\r\n\r\n  return (\r\n    <TagWrapper\r\n      active={isActive}\r\n      collapsed={collapsed}\r\n      onClick={handleClick}\r\n      onKeyDown={handleEnter}\r\n      onMouseLeave={resetCollapsed}\r\n      ref={setTagRef}\r\n    >\r\n      {detailed && <TypeIcon types={types} />}\r\n      <TagName modifier={modifier} name={name} count={count} />\r\n      {detailed && hasAliases && (\r\n        <>\r\n          <DropdownArrow onClick={handleArrowClick} $collapsed={collapsed} />\r\n          {!collapsed && tagRef && <AliasesList aliases={filteredAliases} modifier={modifier} parentRef={tagRef} />}\r\n        </>\r\n      )}\r\n    </TagWrapper>\r\n  )\r\n}\r\n","import React from 'react'\r\nimport styled, { css } from 'styled-components'\r\nimport TagDataClass from '../../data/TagDataClass'\r\nimport { flexRowGap, flexColumnGap } from '../../styled/mixins'\r\nimport Tag from './Tag'\r\n\r\nconst TagListWrapper = styled.div(\r\n  ({ theme }) => css`\r\n    display: inline-flex;\r\n    flex-wrap: wrap;\r\n    ${flexRowGap(theme.dimensions.gutter)}\r\n    ${flexColumnGap(theme.dimensions.gutter)}\r\n  `\r\n)\r\n\r\ninterface TagListProps {\r\n  /**\r\n   * The entries of the list. Must be a map to avoid duplicates\r\n   */\r\n  tags: Record<string, TagDataClass>\r\n  /**\r\n   * Passthrough classname for styling from outside\r\n   */\r\n  className?: string\r\n  /**\r\n   * Setting detailed to true displays a type for some tags and provides the ability to add aliases.\r\n   */\r\n  detailed: boolean\r\n  /**\r\n   * Children will be added at the end of the list. Here you can provide additional functionality or information\r\n   */\r\n  children?: React.ReactNode\r\n\r\n  onTagClick: (tag: TagDataClass) => void\r\n}\r\n\r\n/**\r\n * This component can be used to display multiple tags in a list of chips/badges.\r\n *\r\n */\r\nexport default function TagList(props: TagListProps) {\r\n  const { tags, className, detailed, children = null, onTagClick } = props\r\n\r\n  return (\r\n    <TagListWrapper className={className}>\r\n      {Object.entries(tags).map(([key, tag]) => (\r\n        <Tag key={key} detailed={detailed} {...tag} onClick={onTagClick} />\r\n      ))}\r\n      {children}\r\n    </TagListWrapper>\r\n  )\r\n}\r\n","import styled from 'styled-components'\nimport { preserveAspectRatio, flexMedia } from '../../styled/mixins'\n\nconst FlexImage = styled.img`\n  ${flexMedia}\n  ${preserveAspectRatio}\n`\n\nexport default FlexImage\n","import { useCallback } from 'react'\r\nimport { useDispatch, useSelector } from 'react-redux'\r\nimport TagDataClass from '../data/TagDataClass'\r\nimport { removeTag, addTag } from '../redux/actions'\r\nimport { selectActiveTags } from '../redux/selectors'\r\n\r\n/**\r\n * This hook allows you to add a tag to your search or remove it based on its current status.\r\n */\r\nexport default function useToggleTag() {\r\n  const dispatch = useDispatch()\r\n  const activeTags = useSelector(selectActiveTags)\r\n  const toggleTag = useCallback(\r\n    (tag: TagDataClass) => {\r\n      if (tag.name in activeTags) {\r\n        dispatch(removeTag(tag))\r\n      } else {\r\n        dispatch(addTag(tag))\r\n      }\r\n    },\r\n    [activeTags, dispatch]\r\n  )\r\n\r\n  return toggleTag\r\n}\r\n","import { useCallback, useState } from 'react'\nimport { Modifier } from '../data/types'\n\nconst order = [Modifier.PLUS, Modifier.MINUS, Modifier.OR]\n\n/**\n * Small utility hook to abstract the rotating modifier away\n */\nexport default function useModifier(initialValue: Modifier = Modifier.PLUS): [Modifier, () => void] {\n  const [modifier, setModifier] = useState(initialValue)\n\n  const nextModifier = useCallback(() => {\n    const currentIndex = order.indexOf(modifier)\n    const nextIndex = currentIndex + 1\n\n    // make the value rotate\n    setModifier(order[nextIndex % order.length])\n  }, [modifier])\n\n  return [modifier, nextModifier]\n}\n","import React, { MouseEventHandler } from 'react'\nimport styled, { css } from 'styled-components'\nimport { TagType } from '../../data/types'\nimport TypeIcon from '../../icons/TypeIcon'\nimport { formatCount, formatTagname } from '../../misc/formatting'\n\ninterface EntryProps {\n  name: string\n  posts: number\n  types: TagType[]\n  onClick: MouseEventHandler\n}\n\nconst EntryWrapper = styled.div(\n  ({ theme }) => css`\n    display: grid;\n    grid-template-columns: 48px 1fr auto;\n    min-height: ${theme.dimensions.blockHeight}; // COMPAT: Kiwi Browser\n    height: ${theme.dimensions.blockHeight};\n    background: white;\n    align-items: center;\n    cursor: pointer;\n  `\n)\n\nconst Name = styled.span`\n  grid-column: 2/3;\n`\n\nconst Count = styled.span(\n  ({ theme }) => css`\n    grid-column: 3/4;\n    padding-right: ${theme.dimensions.bigSpacing};\n  `\n)\n\nconst Icon = styled.div`\n  grid-column: 1/2;\n  text-align: center;\n`\n\nexport default function DropdownListEntry(props: EntryProps) {\n  const { name, posts, types, onClick } = props\n\n  const unit = types.includes(TagType.SUPERTAG) ? 'tags' : 'posts'\n\n  return (\n    <EntryWrapper onClick={onClick}>\n      <Icon>\n        <TypeIcon types={types} />\n      </Icon>\n      <Name>{formatTagname(name)}</Name>\n      <Count>\n        {formatCount(posts)} {unit}\n      </Count>\n    </EntryWrapper>\n  )\n}\n","import React from 'react'\nimport styled, { css, DefaultTheme } from 'styled-components'\nimport DropdownListEntry from './DropdownListEntry'\nimport { TagLike } from '../../data/types'\nimport { flexColumn, flexColumnGap } from '../../styled/mixins'\n\nfunction sizeAndPosition(tagSelector: HTMLDivElement | null) {\n  if (tagSelector) {\n    const { offsetTop, clientHeight, offsetLeft, clientWidth } = tagSelector\n\n    return css`\n      position: absolute;\n      top: ${offsetTop + clientHeight}px;\n      left: ${offsetLeft}px;\n      width: ${clientWidth}px;\n      max-height: 50vh;\n    `\n  }\n\n  return ''\n}\n\nconst ListWrapper = styled.div(\n  ({ theme, tagSelectorRef }: { tagSelectorRef: HTMLDivElement | null; theme: DefaultTheme }) => css`\n    ${flexColumn()}\n    ${flexColumnGap('1px')}\n    ${sizeAndPosition(tagSelectorRef)};\n    background: lightgrey;\n    box-sizing: border-box;\n    border: ${theme.dimensions.borderWidth} ${theme.colors.accentColor} solid;\n    border-top: none;\n    border-radius: 0 0 3px 3px;\n    color: black;\n    overflow-y: auto;\n    z-index: 3;\n\n    ::-webkit-scrollbar {\n      width: 8px;\n\n      :hover {\n        background: ${theme.colors.layerBg};\n      }\n    }\n\n    /* Track */\n    ::-webkit-scrollbar-track {\n      background: ${theme.colors.backgroundColor2};\n      border-left: 1px lightgray solid;\n    }\n\n    /* Handle */\n    :hover {\n      ::-webkit-scrollbar {\n        background: ${theme.colors.backgroundColor}20;\n      }\n    }\n\n    ::-webkit-scrollbar-thumb {\n      background: ${theme.colors.backgroundColor}40;\n      border-radius: 1000px;\n\n      :hover {\n        background: ${theme.colors.backgroundColor}30;\n      }\n    }\n  `\n)\n\ninterface DropdownListProps {\n  tagSelectorRef: HTMLDivElement | null\n  entries: TagLike[]\n  onClick: (entry: TagLike) => void\n}\n\nexport default function DropdownList(props: DropdownListProps) {\n  const { tagSelectorRef, entries, onClick } = props\n\n  return entries && entries.length > 0 ? (\n    <ListWrapper tagSelectorRef={tagSelectorRef}>\n      {entries.map((entry) => (\n        <DropdownListEntry\n          key={entry.name}\n          onClick={() => onClick(entry)}\n          name={entry.name}\n          types={entry.types}\n          posts={entry.count || entry.posts || 0}\n        />\n      ))}\n    </ListWrapper>\n  ) : null\n}\n","import React, { ChangeEventHandler, KeyboardEventHandler, useCallback } from 'react'\nimport styled, { css } from 'styled-components'\n\nconst Input = styled.input(\n  (props) => css`\n    width: 100%;\n    border: none;\n    outline: none;\n    background: none;\n    font-size: ${props.theme.fontSizes.content};\n    border-top: ${props.theme.colors.accentColor} ${props.theme.dimensions.borderWidth} solid;\n    border-bottom: ${props.theme.colors.accentColor} ${props.theme.dimensions.borderWidth} solid;\n  `\n)\n\ninterface TagInputProps {\n  value: string\n  setValue: (newValue: string) => void\n  onSubmit: () => void\n}\n\nexport default function TagInput(props: TagInputProps) {\n  const { value, setValue, onSubmit } = props\n\n  const handleChange: ChangeEventHandler<HTMLInputElement> = useCallback(\n    (event) => {\n      setValue(event.target.value)\n    },\n    [setValue]\n  )\n\n  const handleEnter: KeyboardEventHandler = useCallback(\n    (event: React.KeyboardEvent) => {\n      if (event.key === 'Enter') {\n        onSubmit()\n      }\n    },\n    [onSubmit]\n  )\n\n  return (\n    <Input\n      id='tag-input'\n      value={value}\n      onChange={handleChange}\n      onKeyDown={handleEnter}\n      placeholder='Search for tags'\n      aria-label='Search'\n    />\n  )\n}\n","import React, { useCallback, useState } from 'react'\nimport { useDispatch, useSelector } from 'react-redux'\nimport styled, { css, DefaultTheme } from 'styled-components'\nimport useThrottledEffect from 'use-throttled-effect'\nimport { getSupertags } from '../../firebase'\nimport { TagLike, TagType, Modifier } from '../../data/types'\nimport useModifier from '../../hooks/useModifier'\nimport { serializeTagname } from '../../misc/formatting'\nimport { prepareTag } from '../../misc/prepare'\nimport { addTag, fetchSuggestions, setSuggestions } from '../../redux/actions'\nimport { selectSuggestions } from '../../redux/selectors'\nimport { AddButton, ModifierButton } from '../common/Buttons'\nimport DropdownList from './DropdownList'\nimport TagInput from './TagInput'\nimport TagDataClass from '../../data/TagDataClass'\nimport { PlusIcon } from '../../icons/FontAwesomeIcons'\n\nconst TagSelectorWrapper = styled.div(\n  (props: { closed: boolean; ref: (ref: HTMLInputElement) => void; theme: DefaultTheme }) => css`\n    display: flex;\n    background: white;\n    ${props.closed\n      ? css`\n          border-radius: ${props.theme.dimensions.borderRadius};\n        `\n      : css`\n          border-radius: ${props.theme.dimensions.borderRadius} ${props.theme.dimensions.borderRadius} 0 0;\n\n          > ${AddButton} {\n            border-radius: 0 ${props.theme.dimensions.borderRadius} 0 0;\n          }\n\n          > ${ModifierButton} {\n            border-radius: ${props.theme.dimensions.borderRadius} 0 0 0;\n          }\n        `}\n  `\n)\n\ninterface TagSelectorProps {\n  onSubmit?: (tag: TagDataClass) => void\n}\n\nexport default function TagSelector(props: TagSelectorProps) {\n  const { onSubmit } = props\n\n  const dispatch = useDispatch()\n\n  const [value, setValue] = useState('')\n  const [tagSelectorRef, setTagSelectorRef] = useState<HTMLDivElement | null>(null)\n  const [modifier, nextModifier] = useModifier()\n\n  const suggestions = useSelector(selectSuggestions)\n\n  const activateTag = useCallback(\n    ({ name, posts, count, types }: TagLike) => {\n      if (types?.includes(TagType.SUPERTAG)) {\n        getSupertags().then((supertags) => {\n          if (supertags) {\n            Object.entries(supertags[name].tags).forEach(([name, modifier]) => {\n              const tag = prepareTag({\n                name,\n                types: [],\n                count: '0',\n                modifier: modifier as Modifier,\n              })\n\n              if (onSubmit) {\n                onSubmit(tag)\n              } else {\n                dispatch(addTag(tag))\n              }\n            })\n          }\n        })\n      } else {\n        const tag = prepareTag({\n          name,\n          types,\n          modifier,\n          count: (count || posts || 0).toString(),\n        })\n\n        if (onSubmit) {\n          onSubmit(tag)\n        } else {\n          dispatch(addTag(tag))\n        }\n      }\n\n      setValue('')\n      dispatch(setSuggestions([]))\n    },\n    [dispatch, modifier, onSubmit]\n  )\n\n  // This effect fetches suggestions for the input value if the value\n  //is empty, it ensures the suggestions are as well\n  useThrottledEffect(\n    () => {\n      if (value === '') {\n        if (suggestions.length > 0) {\n          // Reset Suggestions\n          dispatch(setSuggestions([]))\n        }\n      } else {\n        // Fetch Suggestions\n        dispatch(fetchSuggestions(value))\n      }\n    },\n    300,\n    [value]\n  )\n\n  const handleAddClick = useCallback(() => {\n    if (value && value.trim()) {\n      const sanitizedTagname = serializeTagname(value)\n      const suggestion: TagLike | undefined = suggestions.find((s) => s.name === sanitizedTagname)\n\n      if (suggestion) {\n        activateTag(suggestion)\n      }\n    }\n  }, [value, activateTag, suggestions])\n\n  return (\n    <TagSelectorWrapper ref={setTagSelectorRef} closed={suggestions.length === 0}>\n      <ModifierButton onClick={nextModifier} aria-label='Tag Modifier'>\n        {modifier}\n      </ModifierButton>\n      <TagInput value={value} setValue={setValue} onSubmit={handleAddClick} />\n      <AddButton onClick={handleAddClick} aria-label='Add Tag'>\n        <PlusIcon />\n      </AddButton>\n      {suggestions.length > 0 && value.length > 0 && (\n        <DropdownList tagSelectorRef={tagSelectorRef} entries={suggestions} onClick={activateTag} />\n      )}\n    </TagSelectorWrapper>\n  )\n}\n","import React, { useCallback } from 'react'\r\nimport { signOut } from '../../firebase'\r\nimport { UndoIcon } from '../../icons/FontAwesomeIcons'\r\nimport { BlockButton } from '../common/Buttons'\r\n\r\nexport default function ResetButton(props: any) {\r\n  const reset = useCallback(async () => {\r\n    localStorage.clear()\r\n    await signOut()\r\n    window.location.hash = ''\r\n    window.location.reload()\r\n  }, [])\r\n\r\n  return (\r\n    <BlockButton onClick={reset} {...props}>\r\n      <UndoIcon /> Reset Application\r\n    </BlockButton>\r\n  )\r\n}\r\n","export default __webpack_public_path__ + \"static/media/OutOfResults.9c71691c.png\";","import React from 'react'\nimport styled from 'styled-components'\n\n// Don't use theme here so the loadingScreen is independent\nconst StyledSvg = styled.svg`\n  height: 32px;\n  padding: 8px;\n`\n\nexport default function Loading() {\n  return (\n    <StyledSvg\n      xmlns='http://www.w3.org/2000/svg'\n      xmlnsXlink='http://www.w3.org/1999/xlink'\n      viewBox='0 0 50 20'\n      enable-background='new 0 0 0 0'\n      xmlSpace='preserve'\n    >\n      <circle fill='#fff' stroke='none' cx='6' cy='10' r='6'>\n        <animate attributeName='opacity' dur='1s' values='0;1;0' repeatCount='indefinite' begin='0.1' />\n      </circle>\n      <circle fill='#fff' stroke='none' cx='25' cy='10' r='6'>\n        <animate attributeName='opacity' dur='1s' values='0;1;0' repeatCount='indefinite' begin='0.2' />\n      </circle>\n      <circle fill='#fff' stroke='none' cx='44' cy='10' r='6'>\n        <animate attributeName='opacity' dur='1s' values='0;1;0' repeatCount='indefinite' begin='0.3' />\n      </circle>\n    </StyledSvg>\n  )\n}\n","import { useTheme } from 'styled-components'\n\nexport default function R34Icon(props: { size: number; className?: string }) {\n  const theme = useTheme()\n\n  return (\n    <svg\n      xmlns='http://www.w3.org/2000/svg'\n      width={props.size}\n      height={props.size}\n      viewBox='0 0 12.7 12.7'\n      className={props.className}\n    >\n      <g transform='translate(0,-284.3)'>\n        <circle\n          id='path18'\n          cx='6.3499999'\n          cy='290.65002'\n          fill='none'\n          stroke={theme.colors.accentColor}\n          strokeWidth='0.50848764'\n          strokeMiterlimit='4'\n          strokeDasharray='none'\n          strokeOpacity='1'\n          r='6.0957561'\n        />\n        <text\n          fontStyle='normal'\n          fontWeight='normal'\n          fontSize='8.3113203px'\n          fontFamily='sansSerif'\n          letterSpacing='0px'\n          wordSpacing='0px'\n          fill={theme.colors.accentColor}\n          fillOpacity='1'\n          x='2.1363549'\n          y='289.02704'\n          id='text4533'\n          transform='scale(0.98538224,1.0148346)'\n        >\n          <tspan\n            id='tspan4531'\n            x='2'\n            y='289.1'\n            fontStyle='normal'\n            fontVariant='normal'\n            fontWeight='300'\n            fontStretch='normal'\n            fontFamily='Calibri'\n            fill={theme.colors.accentColor}\n            fillOpacity='1'\n          >\n            34\n          </tspan>\n        </text>\n      </g>\n    </svg>\n  )\n}\n","import React, { useCallback, useEffect } from 'react'\nimport { useDispatch, useSelector } from 'react-redux'\nimport { ModalIds, NO_OP } from '../../data/types'\nimport useToggleTag from '../../hooks/useToggleTag'\nimport { SupertagIcon } from '../../icons/FontAwesomeIcons'\nimport { openModal } from '../../redux/actions'\nimport { selectActiveTags, selectNumberOfActiveTags } from '../../redux/selectors'\nimport { RedButton } from '../common/Buttons'\nimport TagList from '../tag/TagList'\n\ninterface ActiveTagsProps {\n  onChange?: () => void\n  offerSupertags?: boolean\n}\n\nexport default function ActiveTags(props: ActiveTagsProps) {\n  const { onChange = NO_OP, offerSupertags = false } = props\n\n  const dispatch = useDispatch()\n\n  const activeTags = useSelector(selectActiveTags)\n  const numberOfActiveTags = useSelector(selectNumberOfActiveTags)\n  const openSupertagModal = useCallback(() => dispatch(openModal(ModalIds.CREATE_SUPERTAG)), [dispatch])\n\n  const toggleTag = useToggleTag()\n\n  // Fire change event when tags change\n  // This is used to re-measure the height\n  useEffect(() => onChange(), [onChange, activeTags])\n\n  return numberOfActiveTags > 0 ? (\n    <TagList tags={activeTags} detailed={true} onTagClick={toggleTag}>\n      {offerSupertags && Object.keys(activeTags).length > 1 && (\n        <RedButton onClick={openSupertagModal} title='Create a supertag'>\n          <SupertagIcon />\n        </RedButton>\n      )}\n    </TagList>\n  ) : null\n}\n","import React, { ReactNode } from 'react'\r\n\r\ninterface ErrorBoundaryProps {\r\n  fallback: ReactNode\r\n  children: ReactNode\r\n}\r\n\r\ninterface ErrorBoundaryState {\r\n  hasError: boolean\r\n}\r\n\r\nexport default class ErrorBoundary extends React.Component<ErrorBoundaryProps, ErrorBoundaryState> {\r\n  constructor(props: ErrorBoundaryProps) {\r\n    super(props)\r\n    this.state = { hasError: false }\r\n  }\r\n\r\n  static getDerivedStateFromError(error: Error) {\r\n    return { hasError: true }\r\n  }\r\n\r\n  render() {\r\n    if (this.state.hasError) {\r\n      return this.props.fallback\r\n    }\r\n\r\n    return this.props.children\r\n  }\r\n}\r\n","const dark = {\r\n  dimensions: {\r\n    borderRadius: '3px',\r\n    borderWidth: '2px',\r\n    spacing: '4px',\r\n    bigSpacing: '8px',\r\n    hugeSpacing: '16px',\r\n    gutter: '8px',\r\n    blockHeight: '32px',\r\n    bodyWidth: '1000px',\r\n  },\r\n  colors: {\r\n    //basic\r\n    text: '#fff',\r\n    backgroundColor: '#121212',\r\n    backgroundColor2: '#fff',\r\n    subduedText: '#ffffff80',\r\n    layerBg: '#ffffff11',\r\n    layerBgSolid: '#222222',\r\n    layerBgHighlight: '#ffffff22',\r\n\r\n    // theme\r\n    accentColor: '#ee3344',\r\n    hoverAccent: '#ee3344',\r\n\r\n    // semantic\r\n    liked: '#ff0d50',\r\n    positive: '#40ee40',\r\n    negative: '#dd1010',\r\n  },\r\n  shadow: {\r\n    radius: '4px',\r\n    color: '#00000060',\r\n  },\r\n  timings: {\r\n    transitionTime: '0.2s',\r\n    longTransitionTime: '0.2s',\r\n  },\r\n  fontSizes: {\r\n    content: '15px',\r\n    bigTitle: '24px',\r\n  },\r\n}\r\n\r\nexport default dark\r\n","import dark from './dark'\r\n\r\nconst light = {\r\n  ...dark,\r\n  colors: {\r\n    ...dark.colors,\r\n    text: '#000',\r\n    backgroundColor: '#fff',\r\n    backgroundColor2: '#fff',\r\n    subduedText: '#00000080',\r\n    layerBg: '#00000011',\r\n    layerBgSolid: '#dddddd',\r\n    layerBgHighlight: '#00000022',\r\n  },\r\n}\r\n\r\nexport default light\r\n","import dark from './dark'\r\n\r\nconst coffee = {\r\n  ...dark,\r\n  colors: {\r\n    ...dark.colors,\r\n    backgroundColor: '#161410',\r\n    backgroundColor2: '#fff',\r\n    layerBg: '#ffffff11',\r\n    layerBgSolid: '#262420',\r\n    layerBgHighlight: '#ffffff22',\r\n  },\r\n}\r\n\r\nexport default coffee\r\n","import dark from './dark'\r\n\r\nconst electric = {\r\n  ...dark,\r\n  colors: {\r\n    ...dark.colors,\r\n    accentColor: '#2ae',\r\n    hoverAccent: '#2ae',\r\n  },\r\n}\r\n\r\nexport default electric\r\n","import { DefaultTheme } from 'styled-components'\r\nimport { ThemeId } from '../../data/types'\r\nimport light from './light'\r\nimport dark from './dark'\r\nimport coffee from './coffee'\r\nimport electric from './electric'\r\n\r\nconst themes: Record<ThemeId, DefaultTheme> = {\r\n  [ThemeId.DARK]: dark,\r\n  [ThemeId.LIGHT]: light,\r\n  [ThemeId.COFFEE]: coffee,\r\n  [ThemeId.ELECTRIC]: electric,\r\n}\r\n\r\nexport default themes\r\n\r\nexport const defaultThemeId = ThemeId.DARK\r\n","import { createGlobalStyle, css } from 'styled-components'\n\nexport default createGlobalStyle(\n  ({ theme }) => css`\n    * {\n      margin: 0;\n      padding: 0;\n      box-sizing: border-box;\n\n      font-family: 'Raleway', sans-serif;\n      -webkit-font-smoothing: antialiased;\n      -moz-osx-font-smoothing: grayscale;\n\n      :focus {\n        outline: none;\n      }\n    }\n\n    html,\n    body,\n    #app-root {\n      width: 100%;\n      height: 100%;\n    }\n\n    body {\n      font-size: ${theme.fontSizes.content};\n      color: ${theme.colors.text};\n      background-color: ${theme.colors.backgroundColor};\n      transition: color 0.4s, background-color 0.4s;\n    }\n\n    a {\n      color: ${theme.colors.accentColor};\n      text-decoration: none;\n    }\n\n    // Not a touch device\n    // Touch devices have nice scrollbars by default\n    @media (pointer: fine) {\n      // Underline stuff that is focused on non-touch devices\n      // makes keyboard navigation clearer\n      :focus {\n        text-decoration: underline;\n      }\n\n      ::-webkit-scrollbar {\n        height: 8px;\n        transition: all ${theme.timings.transitionTime} ease-in-out;\n\n        :hover {\n          background: ${theme.colors.layerBg};\n        }\n      }\n\n      /* Track */\n      ::-webkit-scrollbar-track {\n        background: transparent;\n      }\n\n      /* Handle */\n      :hover {\n        ::-webkit-scrollbar {\n          background: ${theme.colors.layerBg};\n        }\n      }\n\n      ::-webkit-scrollbar-thumb {\n        background: ${theme.colors.layerBg};\n        border-radius: 1000px;\n\n        :hover {\n          background: ${theme.colors.layerBgHighlight};\n        }\n      }\n    }\n  `\n)\n","import React from 'react'\r\nimport styled from 'styled-components'\r\nimport ResetButton from '../widgets/ResetButton'\r\nimport outOfResultsPicture from '../../icons/OutOfResults.png'\r\nimport FlexImage from '../common/FlexImage'\r\nimport themes, { defaultThemeId } from '../../styled/themes'\r\nimport GlobalStyles from '../../GlobalStyles'\r\n\r\nconst FullScreenCentered = styled.div`\r\n  height: 100vh;\r\n  width: 100%;\r\n  display: grid;\r\n  place-items: center;\r\n  align-content: center;\r\n  padding: 30px;\r\n  background: ${({ theme }) => theme.colors.backgroundColor};\r\n\r\n  > * {\r\n    margin-bottom: 10px;\r\n  }\r\n`\r\n\r\nexport default function ErrorScreen() {\r\n  const theme = themes[defaultThemeId]\r\n  return (\r\n    <FullScreenCentered theme={theme}>\r\n      <GlobalStyles theme={theme} />\r\n      <FlexImage src={outOfResultsPicture} alt='Shironeko does not understand' />\r\n      <h1>Sorry about that...</h1>\r\n      <ResetButton theme={theme} />\r\n    </FullScreenCentered>\r\n  )\r\n}\r\n","import React from 'react'\r\nimport styled from 'styled-components'\r\nimport Loading from '../../icons/Loading'\r\n\r\nconst FullScreenCentered = styled.div`\r\n  height: 100%;\r\n  width: 100%;\r\n  display: grid;\r\n  place-items: center;\r\n`\r\n\r\nexport default function LoadingScreen() {\r\n  return (\r\n    <FullScreenCentered>\r\n      <Loading />\r\n    </FullScreenCentered>\r\n  )\r\n}\r\n","import React, { useCallback } from 'react'\nimport styled, { css } from 'styled-components'\nimport { RedButton } from '../common/Buttons'\nimport usePreference from '../../hooks/usePreference'\nimport { PreferenceKey } from '../../data/types'\n\nconst CookieWrapper = styled.div(\n  ({ theme }) => css`\n    position: fixed;\n    bottom: 0;\n    left: 0;\n    width: 100%;\n    display: flex;\n    align-items: center;\n    justify-content: space-between;\n    color: ${theme.colors.text};\n    background: ${theme.colors.layerBgSolid};\n    padding: ${theme.dimensions.gutter};\n    z-index: 100;\n  `\n)\n\nconst StyledSpan = styled.span`\n  height: min-content;\n`\n\nexport default function CookieConfirmation() {\n  const [cookies, setCookies] = usePreference(PreferenceKey.COOKIES)\n\n  const handleAccept = useCallback(() => setCookies(true), [setCookies])\n\n  return cookies ? null : (\n    <CookieWrapper>\n      <StyledSpan>This website uses cookies.</StyledSpan>\n      <RedButton onClick={handleAccept} aria-label='Allow Cookies'>\n        Okay\n      </RedButton>\n    </CookieWrapper>\n  )\n}\n","import TagDataClass from '../data/TagDataClass'\nimport { tagsToString } from '../data/utils'\nimport { PreferencesState } from '../redux/reducers/preferences'\n\nenum AnalyticsEventId {\n  SEARCH = 'r34_search',\n}\n\nexport type SearchEvent = {\n  id: AnalyticsEventId.SEARCH\n  payload: {\n    active_tags: string[]\n    page_number: number\n    preferences: PreferencesState\n  }\n}\n\n/**\n * Should be called whenever a new search is started.\n */\nexport const searchEvent = (\n  activeTags: Record<string, TagDataClass>,\n  page_number: number,\n  preferences: PreferencesState\n): SearchEvent => ({\n  id: AnalyticsEventId.SEARCH,\n  payload: {\n    active_tags: tagsToString(activeTags),\n    page_number,\n    preferences,\n  },\n})\n","import { MiddlewareAPI } from 'redux'\r\nimport { Dispatch } from 'react'\r\nimport {\r\n  AppAction,\r\n  FETCH_PREFERENCES,\r\n  savePreferences,\r\n  SAVE_PREFERENCES,\r\n  setPreferences,\r\n  SET_PREFERENCE,\r\n} from '../actions'\r\nimport * as firebaseFunctions from '../../firebase'\r\n\r\nlet saveTimeout: NodeJS.Timeout\r\n\r\nconst persistence = (store: MiddlewareAPI) => (next: Dispatch<AppAction>) => async (action: AppAction) => {\r\n  if (action.type === SET_PREFERENCE) {\r\n    if (saveTimeout) {\r\n      clearTimeout(saveTimeout)\r\n    }\r\n\r\n    saveTimeout = setTimeout(() => {\r\n      store.dispatch(savePreferences())\r\n    }, 10000)\r\n  }\r\n\r\n  if (action.type === FETCH_PREFERENCES) {\r\n    const preferences = await firebaseFunctions.getPreferences()\r\n\r\n    if (preferences) {\r\n      store.dispatch(setPreferences(preferences))\r\n    }\r\n  }\r\n\r\n  if (action.type === SAVE_PREFERENCES) {\r\n    const { preferences } = store.getState()\r\n    firebaseFunctions.setPreferences(preferences)\r\n  }\r\n\r\n  next(action)\r\n}\r\n\r\nexport default persistence\r\n","import { AppAction, SET_POSTS, ADD_POSTS } from '../actions'\r\n\r\nimport { searchEvent } from '../../analytics/events'\r\nimport { selectActiveTags, selectPreferences, selectPageNumber, selectCookies } from '../selectors'\r\nimport { MiddlewareAPI, Dispatch } from 'redux'\r\nimport { logEvent } from '../../firebase'\r\n\r\nconst eventLogging = (store: MiddlewareAPI<any>) => (next: Dispatch<AppAction>) => (action: AppAction) => {\r\n  const state = store.getState()\r\n  const cookies = selectCookies(state)\r\n\r\n  // Only send analytics if the user consented\r\n  if (cookies) {\r\n    if (action.type === ADD_POSTS || action.type === SET_POSTS) {\r\n      const activeTags = selectActiveTags(state)\r\n      const pageNumber = selectPageNumber(state)\r\n      const preferences = selectPreferences(state)\r\n      logEvent(searchEvent(activeTags, pageNumber, preferences))\r\n    }\r\n  }\r\n\r\n  next(action)\r\n}\r\n\r\nexport default eventLogging\r\n","import firebase from 'firebase/app'\nimport 'firebase/auth'\nimport { getSupertags } from '../firebase'\nimport PostDataClass from '../data/PostDataClass'\nimport TagDataClass from '../data/TagDataClass'\nimport { Modifier, SortType, TagLike, TagType } from '../data/types'\nimport { DirtyPost, preparePost } from './prepare'\n\nconst sourceTags: TagLike[] = [\n  { name: 'source:*patreon*', posts: 12711, types: [TagType.SOURCE] },\n  { name: 'source:*twitter*', posts: 99927, types: [TagType.SOURCE] },\n  { name: 'source:*pixiv*', posts: 185080, types: [TagType.SOURCE] },\n]\n\nconst ratingTags: TagLike[] = [\n  { name: 'rating:safe', posts: 14293, types: [TagType.RATING] },\n  { name: 'rating:questionable', posts: 219552, types: [TagType.RATING] },\n  { name: 'rating:explicit', posts: 3821144, types: [TagType.RATING] },\n]\n\nclass API {\n  static defaultPageSize = 20\n  static apiLocal = 'http://localhost:8080'\n  static apiUrl1 = 'https://r34-json.herokuapp.com'\n  static apiUrl2 = 'https://r34-api-clone.herokuapp.com'\n\n  private target: 'local' | 'live' = 'live'\n  private version: 'v1' | 'v2' = 'v2'\n  private activeApi!: string\n\n  constructor() {\n    this.setActiveApi()\n  }\n\n  setTarget(target: 'live' | 'local') {\n    this.target = target\n    this.setActiveApi()\n  }\n\n  setVersion(version: 'v1' | 'v2') {\n    this.version = version\n    this.setActiveApi()\n  }\n\n  setActiveApi() {\n    if (this.target === 'local') {\n      this.activeApi = `${API.apiLocal}/${this.version}`\n    } else {\n      this.activeApi = `${API.apiUrl1}/${this.version}`\n\n      // Failover to apiUrl2\n      fetch(this.activeApi).catch(() => (this.activeApi = `${API.apiUrl2}/${this.version}`))\n    }\n  }\n\n  async getTags(searchTerm: string, limit: number = API.defaultPageSize) {\n    let tags: TagLike[] = await (\n      await fetch(`${this.activeApi}/tags?limit=${limit}&name=${searchTerm}*&order_by=posts`)\n    ).json()\n\n    try {\n      const supertags = await getSupertags()\n      if (supertags) {\n        const matchingSupertags = Object.entries(supertags)\n          .filter(([name, details]) => name.toLowerCase().includes(searchTerm.toLowerCase()))\n          .map(([name, details]) => ({ name, count: Object.keys(details.tags).length, types: ['supertag'] } as TagLike))\n        tags = [...matchingSupertags, ...tags]\n      }\n    } catch {\n      // do nothing as supertags are optional\n    }\n\n    // HACKY: Inject suggestions for ratings and some sources\n    if (searchTerm.startsWith('rating:')) {\n      const matchingRating = ratingTags.filter((tag) => tag.name.includes(searchTerm.replace('rating:', '')))\n      return [...matchingRating, ...tags]\n    }\n\n    if (searchTerm.startsWith('source:')) {\n      const matchingSourceTags = sourceTags.filter((tag) => tag.name.includes(searchTerm.replace('source:', '')))\n      return [...tags, ...matchingSourceTags]\n    }\n\n    return tags\n  }\n\n  async getPosts(\n    tags: Record<string, TagDataClass>,\n    limit: number = API.defaultPageSize,\n    pageNumber = 0,\n    minScore = 0,\n    sort: SortType = SortType.DATE,\n    hideSeen = false\n  ) {\n    const idToken = await firebase.auth().currentUser?.getIdToken()\n    const res = await (\n      await fetch(this.buildPostUrl(pageNumber, tags, minScore, limit, sort, hideSeen), {\n        headers: {\n          Authorization: 'Bearer ' + idToken,\n        },\n      })\n    ).json()\n    const count = Number(res.count)\n    const posts = res.posts.map((rawPost: DirtyPost) => {\n      return preparePost(rawPost)\n    }) as PostDataClass[]\n\n    return {\n      posts,\n      count,\n    }\n  }\n\n  async getAliases(tagName: string) {\n    const aliases: TagLike[] = await (await fetch(`${this.activeApi}/alias/${encodeURIComponent(tagName)}`)).json()\n\n    return aliases\n  }\n\n  buildPostUrl(\n    page: number,\n    tags: Record<string, TagDataClass>,\n    minScore: number,\n    limit: number = API.defaultPageSize,\n    sort: SortType,\n    hideSeen: boolean\n  ) {\n    const tagList = Object.values(tags)\n    const normalTags = tagList.filter((tag) => tag.modifier !== Modifier.OR)\n    const orTags = tagList.filter((tag) => tag.modifier === Modifier.OR)\n\n    let url = `${this.activeApi}/posts?pid=${page}&limit=${limit}`\n\n    if (hideSeen) {\n      url += '&hideSeen=true'\n    }\n\n    const tagParts = [...normalTags.map((tag) => `${tag.modifier === '-' ? '-' : ''}${encodeURIComponent(tag.name)}`)]\n\n    if (orTags.length > 0) {\n      tagParts.push('( ' + orTags.map((tag) => encodeURIComponent(tag.name)).join(' ~ ') + ' )')\n    }\n\n    if (minScore > 0) {\n      tagParts.push(encodeURIComponent('score:>=' + minScore))\n    }\n\n    if (sort !== SortType.DATE) {\n      tagParts.push(encodeURIComponent('sort:' + sort + ':desc'))\n    }\n\n    if (tagParts.length > 0) {\n      url += `&tags=${tagParts.join(' + ')}`\n    }\n\n    return url\n  }\n}\n\nexport default new API()\n","interface RawComment {\r\n  created_at: string\r\n  body: string\r\n  creator: string\r\n  id: string\r\n  creator_id: string\r\n}\r\n\r\nexport function parseComment(rawComment: RawComment) {\r\n  return new CommentDataClass(\r\n    rawComment.created_at,\r\n    rawComment.body,\r\n    rawComment.creator,\r\n    rawComment.id,\r\n    rawComment.creator_id\r\n  )\r\n}\r\n\r\nexport default class CommentDataClass {\r\n  created_at: number\r\n  body: string\r\n  creator: string\r\n  id: number\r\n  creator_id: number\r\n\r\n  constructor(created_at: string, body: string, creator: string, id: string, creator_id: string) {\r\n    this.created_at = Date.parse(created_at)\r\n    this.body = body\r\n    this.creator = creator\r\n    this.id = Number(id)\r\n    this.creator_id = Number(creator_id)\r\n  }\r\n}\r\n","import { MiddlewareAPI } from 'redux'\nimport { Dispatch } from 'react'\nimport {\n  AppAction,\n  GET_RESULTS,\n  GET_MORE_RESULTS,\n  addPosts,\n  setPosts,\n  ADD_TAG,\n  addAliases,\n  LIKE_POST,\n  FETCH_SUGGESTIONS,\n  setSuggestions,\n  FETCH_COMMENTS,\n  setComments,\n} from '../actions'\nimport api from '../../misc/api'\nimport {\n  selectActiveTags,\n  selectPageNumber,\n  selectHasMoreResults,\n  selectMinRating,\n  selectPageSize,\n  selectSort,\n  selectTagSuggestionCount,\n  selectPostById,\n  selectHideSeen,\n} from '../selectors'\nimport TagDataClass from '../../data/TagDataClass'\nimport { serializeTagname } from '../../misc/formatting'\nimport { parseComment } from '../../data/CommentDataClass'\n\nconst apiRequests = (store: MiddlewareAPI) => (next: Dispatch<AppAction>) => async (action: AppAction) => {\n  const state = store.getState()\n  const hasMoreResults = selectHasMoreResults(state)\n\n  if (action.type === GET_RESULTS) {\n    const activeTags = selectActiveTags(state)\n    const pageSize = selectPageSize(state)\n    const minRating = selectMinRating(state)\n    const sort = selectSort(state)\n    const hideSeen = selectHideSeen(state)\n\n    const result = await api.getPosts(activeTags, pageSize, action.pageNumber, minRating, sort, hideSeen)\n\n    store.dispatch(setPosts(result.posts, result.count, action.pageNumber))\n  }\n\n  if (action.type === GET_MORE_RESULTS && hasMoreResults) {\n    const activeTags = selectActiveTags(state)\n    const pageNumber = selectPageNumber(state)\n    const pageSize = selectPageSize(state)\n    const minRating = selectMinRating(state)\n    const sort = selectSort(state)\n    const hideSeen = selectHideSeen(state)\n    console.log('hide seen', hideSeen)\n\n    const res = await api.getPosts(activeTags, pageSize, pageNumber + 1, minRating, sort, hideSeen)\n\n    store.dispatch(addPosts(res.posts))\n  }\n\n  if (action.type === ADD_TAG) {\n    const activeTags = selectActiveTags(state)\n    const aliases = await api.getAliases(action.tag.name)\n\n    const sanitizedAliases = aliases\n      .sort((a, b) => (b.posts || b.count || 0) - (a.posts || a.count || 0))\n      .filter((alias) => !(alias.name in activeTags))\n      .map((alias) => new TagDataClass(alias.name, [], alias.posts))\n\n    store.dispatch(addAliases(sanitizedAliases, action.tag.name))\n\n    // Request types for newly added tag\n    if (action.tag.types?.length === 0) {\n      const tags = await api.getTags(action.tag.name)\n      const tag = tags.find((tag) => tag.name === action.tag.name)\n\n      if (tag) {\n        action.tag.types = tag.types\n        action.tag.count = tag.posts\n      }\n    }\n  }\n\n  if (action.type === LIKE_POST) {\n    fetch(`https://rule34.xxx/index.php?page=post&s=vote&id=${action.postId}&type=up`, { mode: 'no-cors' })\n      .then(() => {\n        // nothing to do, I update the state in advance\n      })\n      .catch((err) => {\n        console.warn('Upvote rejected', err)\n      })\n  }\n\n  if (action.type === FETCH_SUGGESTIONS) {\n    const limit = selectTagSuggestionCount(state)\n    const suggestions = await api.getTags(serializeTagname(action.value), limit)\n\n    store.dispatch(setSuggestions(suggestions))\n  }\n\n  if (action.type === FETCH_COMMENTS) {\n    const post = selectPostById(action.postId)(state)\n\n    if (post) {\n      const rawComments = (await (await fetch(post.comments_url)).json()) as any[]\n      const comments = rawComments.map(parseComment)\n\n      store.dispatch(setComments(action.postId, comments))\n    }\n  }\n\n  next(action)\n}\n\nexport default apiRequests\n","import { applyMiddleware } from 'redux'\r\nimport analytics from './analytics'\r\nimport persistence from './persistence'\r\nimport requests from './requests'\r\nimport { composeWithDevTools } from 'redux-devtools-extension'\r\n\r\nconst middleware = composeWithDevTools(applyMiddleware(analytics, requests, persistence))\r\n\r\nexport default middleware\r\n","import produce from 'immer'\r\nimport { PreferenceKey, ResultLayout, SortType, ThemeId } from '../../data/types'\r\nimport { AppAction, SET_PREFERENCE, SET_PREFERENCES } from '../actions'\r\n\r\nexport interface PreferencesState {\r\n  rated: boolean\r\n  ratedThreshold: number\r\n  originals: boolean\r\n  cookies: boolean\r\n  preloadVideos: boolean\r\n  tagSuggestionsCount: number\r\n  resultsLayout: ResultLayout\r\n  pageSize: number\r\n  useCorsProxy: boolean\r\n  showMetadata: boolean\r\n  showComments: boolean\r\n  sort: SortType\r\n  themeId: ThemeId\r\n  autoPlay: boolean\r\n  hideSeen: boolean\r\n}\r\n\r\nconst initialPreferencesState: PreferencesState = {\r\n  rated: false,\r\n  ratedThreshold: 1,\r\n  originals: false,\r\n  cookies: false,\r\n  preloadVideos: false,\r\n  tagSuggestionsCount: 20,\r\n  resultsLayout: ResultLayout.INFINITE_COLUMN,\r\n  pageSize: 20,\r\n  useCorsProxy: false,\r\n  showMetadata: false,\r\n  showComments: false,\r\n  sort: SortType.DATE,\r\n  themeId: ThemeId.DARK,\r\n  autoPlay: false,\r\n  hideSeen: false,\r\n}\r\n\r\nfunction setPreference<T extends PreferenceKey>(state: PreferencesState, key: T, value: PreferencesState[T]) {\r\n  return produce(state, (draft) => {\r\n    draft[key] = value\r\n  })\r\n}\r\n\r\nfunction setPreferences(state: PreferencesState, preferences: Partial<Record<PreferenceKey, any>>) {\r\n  return produce(state, (draft) => {\r\n    Object.assign(draft, preferences)\r\n  })\r\n}\r\n\r\nconst preferences = (state: PreferencesState = initialPreferencesState, action: AppAction): PreferencesState => {\r\n  switch (action.type) {\r\n    case SET_PREFERENCE:\r\n      return setPreference(state, action.key, action.value)\r\n    case SET_PREFERENCES:\r\n      return setPreferences(state, action.preferences)\r\n    default:\r\n      return state\r\n  }\r\n}\r\n\r\nexport default preferences\r\n","import produce from 'immer'\nimport CommentDataClass from '../../data/CommentDataClass'\nimport PostDataClass from '../../data/PostDataClass'\nimport { SET_POSTS, ADD_POSTS, SET_COMMENTS, AppAction } from '../actions'\n\nexport interface ResultsState {\n  posts: PostDataClass[]\n  pageNumber: number\n  count: number\n}\n\nconst initialResultsState: ResultsState = {\n  posts: [],\n  pageNumber: 0,\n  count: 0,\n}\n\nconst addPosts = (state: ResultsState, posts: PostDataClass[]) =>\n  produce(state, (draft) => {\n    draft.posts = [...state.posts, ...posts]\n    draft.pageNumber = state.pageNumber + 1\n  })\n\nconst setPosts = (state: ResultsState, posts: PostDataClass[], postCount: number, pageNumber: number = 0) =>\n  produce(state, (draft) => {\n    draft.posts = posts\n    draft.count = postCount\n    draft.pageNumber = pageNumber\n  })\n\nconst setComments = (state: ResultsState, postId: number, comments: CommentDataClass[]) =>\n  produce(state, (draft) => {\n    const postIndex = state.posts.findIndex((p) => p.id === postId)\n    if (postIndex >= 0) {\n      draft.posts[postIndex].comments = comments\n    }\n  })\n\nconst results = (state: ResultsState = initialResultsState, action: AppAction): ResultsState => {\n  switch (action.type) {\n    case ADD_POSTS:\n      return addPosts(state, action.posts)\n    case SET_POSTS:\n      return setPosts(state, action.posts, action.count, action.pageNumber)\n    case SET_COMMENTS:\n      return setComments(state, action.postId, action.comments)\n    default:\n      return state\n  }\n}\n\nexport default results\n","import produce from 'immer'\nimport TagDataClass from '../../data/TagDataClass'\nimport { ADD_TAG, AppAction, REMOVE_TAG, ADD_ALIASES } from '../actions'\n\nexport interface TagsState {\n  active: Record<string, TagDataClass>\n  aliases: Record<string, TagDataClass[]>\n}\n\nconst initialTagsState: TagsState = {\n  active: {},\n  aliases: {},\n}\n\nconst addTag = (state: TagsState, newTag: TagDataClass) =>\n  produce(state, (draft) => {\n    draft.active[newTag.name] = { ...state.active[newTag.name], ...newTag }\n  })\n\nconst addAliases = (state: TagsState, aliases: TagDataClass[], forTag: string) =>\n  produce(state, (draft) => {\n    draft.aliases[forTag] = aliases\n  })\n\nconst removeTag = (state: TagsState, tagToRemove: TagDataClass) =>\n  produce(state, (draft) => {\n    delete draft.active[tagToRemove.name]\n    delete draft.aliases[tagToRemove.name]\n  })\n\nconst tags = (state: TagsState = initialTagsState, action: AppAction): TagsState => {\n  switch (action.type) {\n    case ADD_TAG:\n      return addTag(state, action.tag)\n    case REMOVE_TAG:\n      return removeTag(state, action.tag)\n    case ADD_ALIASES:\n      return addAliases(state, action.aliases, action.forTag)\n    default:\n      return state\n  }\n}\n\nexport default tags\n","import produce from 'immer'\nimport { ENTER_FULLSCREEN, EXIT_FULLSCREEN, SET_FULLSCREEN_POST, AppAction } from '../actions'\n\nexport interface ReaderState {\n  isEnabled: boolean\n  postId: number\n}\n\nconst initialReaderState: ReaderState = {\n  isEnabled: false,\n  postId: 0,\n}\n\nconst enterFullscreen = (state: ReaderState, postId: number) =>\n  produce(state, (draft) => {\n    draft.isEnabled = true\n    draft.postId = postId\n  })\n\nconst exitFullscreen = (state: ReaderState) =>\n  produce(state, (draft) => {\n    draft.isEnabled = false\n  })\n\nconst setPostId = (state: ReaderState, value: number) =>\n  produce(state, (draft) => {\n    draft.postId = value\n  })\n\nconst reader = (state: ReaderState = initialReaderState, action: AppAction): ReaderState => {\n  switch (action.type) {\n    case ENTER_FULLSCREEN:\n      return enterFullscreen(state, action.postId)\n    case SET_FULLSCREEN_POST:\n      return setPostId(state, action.postId)\n    case EXIT_FULLSCREEN:\n      return exitFullscreen(state)\n    default:\n      return state\n  }\n}\n\nexport default reader\n","import produce from 'immer'\r\nimport { AppAction, LIKE_POST } from '../actions'\r\n\r\n/**\r\n * Key is postId, Value is time of like\r\n */\r\nexport type LikesState = Record<number, number>\r\n\r\nconst initialReaderState: LikesState = {}\r\n\r\nconst likePost = (state: LikesState, postId: number) =>\r\n  produce(state, (draft) => {\r\n    if (!(postId in state)) {\r\n      draft[postId] = Date.now()\r\n    }\r\n\r\n    // NOTE: Might need to introduce a cap here...\r\n    // Like 1000 likes max, delete oldest when more are added?\r\n  })\r\n\r\nconst likes = (state: LikesState = initialReaderState, action: AppAction): LikesState => {\r\n  switch (action.type) {\r\n    case LIKE_POST:\r\n      return likePost(state, action.postId)\r\n    default:\r\n      return state\r\n  }\r\n}\r\n\r\nexport default likes\r\n","import produce from 'immer'\r\nimport { ModalIds } from '../../data/types'\r\nimport { AppAction, CLOSE_MODAL, OPEN_MODAL } from '../actions'\r\n\r\n/**\r\n * Key is postId, Value is time of like\r\n */\r\nexport interface ModalsState {\r\n  openModal: ModalIds | null\r\n}\r\n\r\nconst initialModalsState: ModalsState = {\r\n  openModal: null,\r\n}\r\n\r\nconst setOpenModal = (state: ModalsState, modalId: ModalIds | null) =>\r\n  produce(state, (draft) => {\r\n    draft.openModal = modalId\r\n  })\r\n\r\nconst modals = (state: ModalsState = initialModalsState, action: AppAction): ModalsState => {\r\n  switch (action.type) {\r\n    case OPEN_MODAL:\r\n      return setOpenModal(state, action.modalId)\r\n    case CLOSE_MODAL:\r\n      return setOpenModal(state, null)\r\n    default:\r\n      return state\r\n  }\r\n}\r\n\r\nexport default modals\r\n","import produce from 'immer'\r\nimport { TagLike } from '../../data/types'\r\nimport { AppAction, SET_SUGGESTIONS } from '../actions'\r\n\r\n/**\r\n * Key is postId, Value is time of like\r\n */\r\nexport interface SuggestionsState {\r\n  entries: TagLike[]\r\n}\r\n\r\nconst initialReaderState: SuggestionsState = {\r\n  entries: [],\r\n}\r\n\r\nconst setSuggestions = (state: SuggestionsState, suggestions: TagLike[]) =>\r\n  produce(state, (draft) => {\r\n    draft.entries = suggestions\r\n  })\r\n\r\nconst suggestions = (state: SuggestionsState = initialReaderState, action: AppAction): SuggestionsState => {\r\n  switch (action.type) {\r\n    case SET_SUGGESTIONS:\r\n      return setSuggestions(state, action.suggestions)\r\n    default:\r\n      return state\r\n  }\r\n}\r\n\r\nexport default suggestions\r\n","import { combineReducers } from 'redux'\nimport preferences from './preferences'\nimport results from './results'\nimport tags from './tags'\nimport reader from './reader'\nimport likes from './likes'\nimport modals from './modals'\nimport suggestions from './suggestions'\n\nexport default combineReducers({ tags, results, preferences, reader, likes, suggestions, modals })\n","import { createStore } from 'redux'\nimport { persistReducer, persistStore } from 'redux-persist'\nimport storage from 'redux-persist/lib/storage'\nimport { getVersion, versionToNumber } from '../data/utils'\nimport middleware from './middleware'\nimport rootReducer from './reducers'\n\nconst version = getVersion()\n\nconst persistConfig = {\n  key: 'appstate',\n  version: versionToNumber(version),\n  storage,\n}\n\nconst persistedReducer = persistReducer(persistConfig, rootReducer)\n\nexport const store = createStore(persistedReducer, middleware)\n\nexport const persistor = persistStore(store)\n","import styled, { css } from 'styled-components'\r\nimport { gap } from '../../styled/mixins'\r\nimport FlexColumn, { FlexColumnWithSpacing } from '../common/FlexColumn'\r\nimport Surface from '../common/Surface'\r\nimport { Faded, Title } from '../common/Text'\r\nimport Header from '../features/Header'\r\n\r\nconst SectionBody = styled(Surface)(\r\n  ({ theme }) => css`\r\n    padding: ${theme.dimensions.hugeSpacing};\r\n    ${gap(theme.dimensions.hugeSpacing)};\r\n  `\r\n)\r\n\r\nconst Section = styled(FlexColumnWithSpacing)`\r\n  flex-grow: 1;\r\n`\r\n\r\nexport default function Terms() {\r\n  document.title = 'R34 React - Terms of Service'\r\n\r\n  return (\r\n    <FlexColumn>\r\n      <Header />\r\n      <Section>\r\n        <Title>Terms of Service</Title>\r\n        <SectionBody>\r\n          <p>\r\n            This website does not impose any additional terms on you. However, terms for the technologies this app uses\r\n            still apply. Therefore, you should read the following terms.\r\n          </p>\r\n          <a href='https://policies.google.com/terms'>Google - Privacy & Terms</a>\r\n          <a href='https://rule34.xxx/tos.php'>Rule34 - Terms of Serivce</a>\r\n          <Faded>If you have any questions feel free to contact me via Discord. See \"about\" section.</Faded>\r\n        </SectionBody>\r\n      </Section>\r\n    </FlexColumn>\r\n  )\r\n}\r\n","import React, { useCallback, useState } from 'react'\r\nimport { useSelector } from 'react-redux'\r\nimport styled, { css } from 'styled-components'\r\nimport { Modifier } from '../../data/types'\r\nimport { addSupertag } from '../../firebase'\r\nimport { selectActiveTags } from '../../redux/selectors'\r\nimport { defaultBlock, defaultBorder } from '../../styled/mixins'\r\nimport { BlockButton } from '../common/Buttons'\r\nimport { HorizontalLine } from '../common/Lines'\r\nimport Surface from '../common/Surface'\r\nimport { Title } from '../common/Text'\r\nimport TagSelector from '../tagSelector/TagSelector'\r\nimport ActiveTags from './ActiveTags'\r\n\r\nconst Wrapper = styled.div`\r\n  position: fixed;\r\n  display: grid;\r\n  place-items: center;\r\n\r\n  bottom: 0;\r\n  left: 0;\r\n  width: 100vw;\r\n  height: 100vh;\r\n  padding: 20px;\r\n\r\n  z-index: 1000;\r\n\r\n  background: #000000d0;\r\n`\r\n\r\nconst ModalSurface = styled(Surface)`\r\n  max-width: 500px;\r\n  background-color: ${(props) => props.theme.colors.layerBgSolid};\r\n`\r\n\r\nconst StyledInput = styled.input(\r\n  ({ theme }) => css`\r\n    ${defaultBorder}\r\n    background-color: ${theme.colors.backgroundColor2};\r\n    ${defaultBlock}\r\n    text-align: left;\r\n  `\r\n)\r\n\r\ninterface SupertagModalProps {\r\n  onClose: () => void\r\n}\r\n\r\nexport default function SupertagModal(props: SupertagModalProps) {\r\n  const { onClose } = props\r\n  const [name, setName] = useState('')\r\n  const [desc, setDesc] = useState('')\r\n  const activeTags = useSelector(selectActiveTags)\r\n\r\n  const tags: Record<string, Modifier> = Object.entries(activeTags).reduce(\r\n    (result, [name, tag]) => ({ ...result, [name]: tag.modifier }),\r\n    {}\r\n  )\r\n\r\n  const handleCreateTagList = useCallback(() => {\r\n    addSupertag(name, desc, tags)\r\n    onClose()\r\n  }, [desc, name, onClose, tags])\r\n\r\n  return (\r\n    <Wrapper onClick={onClose}>\r\n      <ModalSurface onClick={(e) => e.stopPropagation()}>\r\n        <Title>Create Supertag</Title>\r\n        <HorizontalLine />\r\n        <StyledInput type='text' placeholder='Name' value={name} onChange={(e) => setName(e.target.value)} />\r\n        <StyledInput type='text' placeholder='Description' value={desc} onChange={(e) => setDesc(e.target.value)} />\r\n        <TagSelector />\r\n        <ActiveTags />\r\n        <BlockButton onClick={handleCreateTagList}>Create</BlockButton>\r\n      </ModalSurface>\r\n    </Wrapper>\r\n  )\r\n}\r\n","import React, { Suspense, useEffect } from 'react'\nimport { Provider, useDispatch, useSelector } from 'react-redux'\nimport { HashRouter, Route, Switch } from 'react-router-dom'\nimport { PersistGate } from 'redux-persist/integration/react'\nimport { ThemeProvider } from 'styled-components'\nimport ErrorBoundary from './components/features/ErrorBoundary'\nimport ErrorScreen from './components/pages/ErrorScreen'\nimport LoadingScreen from './components/pages/LoadingScreen'\nimport CookieConfirmation from './components/widgets/CookieConfirmation'\nimport { RouteName } from './data/types'\nimport GlobalStyles from './GlobalStyles'\nimport themes, { defaultThemeId } from './styled/themes'\nimport { selectActiveThemeId, selectSupertagModalOpen } from './redux/selectors'\nimport { persistor, store } from './redux/store'\nimport Terms from './components/pages/Terms'\nimport useFirebaseAuthState from './hooks/useFirebaseAuthState'\nimport { closeModal, fetchPreferences } from './redux/actions'\nimport SupertagModal from './components/widgets/SupertagModal'\n\n// init firebase immediately\nimport './firebase'\nimport useAction from './hooks/useAction'\n\nconst Settings = React.lazy(() => import('./components/pages/Settings'))\nconst Search = React.lazy(() => import('./components/pages/Search'))\nconst About = React.lazy(() => import('./components/pages/About'))\nconst Privacy = React.lazy(() => import('./components/pages/Privacy'))\n\nexport default function App() {\n  return (\n    <ErrorBoundary fallback={<ErrorScreen />}>\n      <Provider store={store}>\n        <PersistGate loading={<LoadingScreen />} persistor={persistor}>\n          <ThemedApp />\n        </PersistGate>\n      </Provider>\n    </ErrorBoundary>\n  )\n}\n\nfunction ThemedApp() {\n  const dispatch = useDispatch()\n  const themeId = useSelector(selectActiveThemeId)\n  const isSupertagModalOpen = useSelector(selectSupertagModalOpen)\n  const [isSignedIn] = useFirebaseAuthState()\n  const onCloseModals = useAction(closeModal)\n\n  useEffect(() => {\n    if (isSignedIn) {\n      dispatch(fetchPreferences())\n    }\n  }, [dispatch, isSignedIn])\n\n  return (\n    <ThemeProvider theme={themes[themeId] || defaultThemeId}>\n      <GlobalStyles />\n      <HashRouter>\n        <Suspense fallback={<LoadingScreen />}>\n          <Switch>\n            <Route exact path={RouteName.SETTINGS}>\n              <Settings />\n            </Route>\n            <Route exact path={RouteName.ABOUT}>\n              <About />\n            </Route>\n            <Route exact path={RouteName.PRIVACY}>\n              <Privacy />\n            </Route>\n            <Route exact path={RouteName.TERMS}>\n              <Terms />\n            </Route>\n            <Route path={RouteName.SEARCH}>\n              <Search />\n            </Route>\n          </Switch>\n        </Suspense>\n\n        {isSupertagModalOpen && <SupertagModal onClose={onCloseModals} />}\n        <CookieConfirmation />\n      </HashRouter>\n    </ThemeProvider>\n  )\n}\n","// Polyfills\nimport 'whatwg-fetch'\n\nimport React from 'react'\nimport ReactDOM from 'react-dom'\nimport App from './App'\n\nReactDOM.render(<App />, document.getElementById('app-root'))\n"],"sourceRoot":""}