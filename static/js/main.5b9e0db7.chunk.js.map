{"version":3,"sources":["redux/actions.ts","styled/mixins.tsx","redux/selectors.ts","data/tagUtils.ts","icons/FontAwesomeIcons.tsx","data/types.ts","components/common/Buttons.tsx","firebase/analytics.ts","firebase/signIn.ts","data/encryption.ts","firebase/storage.ts","firebase/genericConverter.ts","firebase/index.ts","components/common/Text.tsx","components/common/Lines.tsx","data/utils.ts","misc/formatting.ts","data/browserUtils.ts","components/common/Surface.tsx","hooks/useFirebaseAuthState.tsx","icons/TypeIcon.tsx","components/common/FlexColumn.tsx","hooks/usePreference.tsx","components/features/Header.tsx","hooks/useToggle.ts","hooks/useAction.tsx","components/common/ModifierStyledText.tsx","components/tag/TagName.tsx","components/tag/Alias.tsx","components/tag/AliasesList.tsx","components/tag/ChipWrapper.tsx","components/tag/TagChip.tsx","components/tag/Supertag.tsx","components/tag/BiasedTag.tsx","components/tag/Tag.tsx","components/tag/TagList.tsx","components/common/FlexImage.tsx","hooks/useToggleTag.tsx","hooks/useModifier.tsx","components/tagSelector/DropdownListEntry.tsx","components/tagSelector/DropdownList.tsx","components/tagSelector/TagInput.tsx","components/tagSelector/TagSelector.tsx","components/widgets/ResetButton.tsx","icons/OutOfResults.png","icons/Loading.tsx","icons/R34Icon.tsx","components/widgets/ActiveTags.tsx","hooks/useCheckIsActive.ts","hooks/useActivateTag.ts","components/features/ErrorBoundary.tsx","styled/themes/dark.ts","styled/themes/index.ts","styled/themes/light.ts","styled/themes/coffee.ts","styled/themes/electric.ts","styled/themes/deepsea.ts","GlobalStyles.tsx","components/pages/ErrorScreen.tsx","components/pages/LoadingScreen.tsx","components/widgets/CookieConfirmation.tsx","analytics/events.ts","redux/middleware/persistence.ts","redux/middleware/analytics.ts","misc/api.ts","redux/middleware/requests.ts","redux/middleware/index.ts","redux/reducers/preferences.ts","redux/reducers/results.ts","redux/reducers/tags.ts","redux/reducers/reader.ts","redux/reducers/likes.ts","redux/reducers/modals.ts","redux/reducers/suggestions.ts","redux/reducers/index.ts","redux/store.ts","components/pages/Terms.tsx","components/widgets/SupertagModal.tsx","App.tsx","index.tsx"],"names":["ADD_ALIASES","ADD_POSTS","ADD_TAG","CLOSE_MODAL","ENTER_FULLSCREEN","EXIT_FULLSCREEN","FETCH_COMMENTS","FETCH_PREFERENCES","FETCH_SUGGESTIONS","GET_MORE_RESULTS","GET_RESULTS","LIKE_POST","OPEN_MODAL","REMOVE_TAG","SAVE_PREFERENCES","SET_COMMENTS","SET_FULLSCREEN_POST","SET_POSTS","SET_PREFERENCE","SET_PREFERENCES","SET_SUGGESTIONS","addTag","tag","type","removeTag","tagName","addAliases","aliases","forTag","addPosts","posts","setPosts","count","pageNumber","setComments","postId","comments","fetchComments","setPreference","key","value","setPreferences","preferences","getResults","getMoreResults","enterFullscreen","exitFullscreen","likePost","openModal","modalId","closeModal","setSuggestions","suggestions","fetchSuggestions","includeSupertags","fetchPreferences","savePreferences","defaultBorder","theme","css","colors","accentColor","dimensions","borderWidth","borderRadius","layer","layerBg","boxShadow","primaryHover","backgroundColor","hoverAccent","backgroundColor2","flexColumn","flexColumnWithGap","flexColumnGap","gutter","gridWithGap","gap","flexRowWithGap","flexRowGap","amount","supportsGap","supportsFlexGap","centeredMaxWidth","bodyWidth","defaultBlock","blockHeight","flexMedia","preserveAspectRatio","width","height","supportsAspectRatio","shadow","radius","color","dropShadow","mediaStyle","selectActiveTags","state","tags","active","selectActiveThemeId","themeId","selectAliases","selectAutoPlay","autoPlay","selectCookies","cookies","selectCount","results","selectFullsceenState","reader","isEnabled","selectHideSeen","hideSeen","selectOriginals","originals","selectPageNumber","selectPageSize","pageSize","selectPosts","selectPreferences","selectPreloadVideos","preloadVideos","selectPreloadGifs","selectResultsLayout","resultsLayout","selectShowComments","showComments","selectShowMetadata","showMetadata","selectSort","sort","selectSuggestions","entries","selectTagSuggestionCount","tagSuggestionsCount","selectNumberOfActiveTags","createSelector","Object","keys","length","selectAliasesAsList","values","flat","selectOutOfResults","selectHasMoreResults","outOfResults","selectLastPage","Math","ceil","selectFullScreenPost","fullScreenPostId","find","post","id","selectFullScreenIndex","fullScreenPost","indexOf","selectMinRating","rated","ratedThreshold","selectSupertagModalOpen","selectedIndex","undefined","modals","ModalId","CREATE_SUPERTAG","selectPostById","defaultMemoize","selectLikedByPostId","likes","serializeAllTags","tagsByModifier","reduce","result","current","modifier","push","groupTagsByModifier","resolvedTags","forEach","isSupertag","name","flattenSupertags","normalTags","map","serializeTag","join","optionalTags","serializeTagname","tagname","encodeURIComponent","toLowerCase","replace","getTagParameter","minScore","tagParts","bias","isBiased","getInterestingType","types","t","match","bindIcon","icon","props","ArrowDown","faCaretDown","ArtistIcon","faPen","CalendarIcon","faCalendarDay","CharacterIcon","faUser","CheckIcon","faCheckSquare","CloseIcon","faTimes","CodeBranchIcon","faCodeBranch","CopyrightIcon","faCopyright","DeviantArtIcon","faDeviantart","DiscordIcon","faDiscord","DownloadIcon","faDownload","ExpandIcon","faExpand","ExternalLinkIcon","faExternalLinkAlt","FailedIcon","faTimesCircle","GithubIcon","faGithub","GoogleIcon","faGoogle","HeartIcon","faHeart","ImageIcon","faImage","LinkIcon","faLink","MetaDataIcon","faInfoCircle","PatreonIcon","faPatreon","PlusIcon","faPlus","RatingIcon","faRegistered","SearchIcon","faSearch","SignOutIcon","faSignOutAlt","SourceIcon","faHashtag","SuccessIcon","faCheckCircle","SupertagIcon","faTags","TumblrIcon","faTumblr","TwitterIcon","faTwitter","UndoIcon","faUndoAlt","WrenchIcon","faWrench","RouteName","NO_OP","TextButton","styled","button","bigSpacing","fontSizes","content","timings","longTransitionTime","RedButton","transitionTime","BlockButton","AddButton","ModifierButton","logEvent","event","a","firebase","analytics","payload","googleAuthProvider","auth","GoogleAuthProvider","signIn","signInWithPopup","catch","error","console","code","message","signOut","sha256","msgBuffer","TextEncoder","encode","crypto","subtle","digest","hashBuffer","hashArray","Array","from","Uint8Array","hashHex","b","toString","padStart","userConverter","data","snapshot","options","getUserDoc","currentUser","email","userDoc","firestore","collection","doc","getUserData","withConverter","get","userSnap","userData","getPreferences","set","resetSeenPosts","log","getSupertags","snap","addSupertag","description","removeSupertag","delete","setTagsOfSupertag","update","useSupertags","useState","supertags","setSupertags","setCollection","useFirebaseAuthState","userInfo","useEffect","then","hash","col","docs","unsubscribe","onSnapshot","initializeApp","apiKey","authDomain","databaseURL","projectId","storageBucket","messagingSenderId","appId","measurementId","Title","h2","bigTitle","BigTitle","h1","SmallTitle","h3","Faded","span","subduedText","HorizontalLine","div","VerticalLine","listToMap","list","keyProp","parseUrl","URL","err","versionToNumber","majorMinorPatch","Number","split","download","url","filename","pop","fetch","headers","Headers","Origin","window","location","origin","mode","response","blob","document","createElement","href","createObjectURL","body","appendChild","click","remove","e","getVersion","process","REACT_APP_VERSION","getVersionString","version","boolToNumber","formatCount","trunc","formatSource","source","host","formatDuration","duration","min","sec","formatTagname","formatTagnameAndCount","formatDatetime","date","toLocaleDateString","toLocaleTimeString","formatTime","milliseconds","formatUnit","unitSize","unit","toFixed","unitString","flex","style","display","flexDirection","rowGap","isSupported","scrollHeight","parentNode","removeChild","supportsObjectFit","supportsFullscreen","fullscreenEnabled","openFullscreen","element","requestFullscreen","webkitRequestFullscreen","msRequestFullscreen","authState","setAuthState","user","setUser","onAuthStateChanged","TypeIcon","className","FlexColumn","FlexColumnWithSpacing","usePreference","dispatch","useDispatch","useSelector","setValue","useCallback","HeaderWrapper","header","TitleBar","layerBgSolid","MenuBar","nav","hugeSpacing","LocationStyledLink","Link","to","text","Header","useLocation","pathname","role","size","SEARCH","SETTINGS","ABOUT","useToggle","initialValue","toggleValue","resetValue","useAction","actionCreator","modifierToStyle","ModifierStyledText","TagName","tabIndex","AliasWrapper","Alias","handleClick","stopPropagation","onClick","ListWrapper","parentRef","offsetTop","clientHeight","offsetLeft","clientWidth","AliasesList","ChipWrapper","fg","bg","switchingColors","collapsed","DropdownArrow","$collapsed","TagChip","isActive","detailed","tagRef","setTagRef","toggleCollapsed","resetCollapsed","handleArrowClick","handleEnter","onKeyDown","onMouseLeave","ref","Supertag","BiasedTag","Tag","biasedTag","TagListWrapper","TagList","children","onTagClick","getIsActive","FlexImage","img","useToggleTag","activeTags","order","EntryWrapper","Name","Count","Icon","DropdownListEntry","tagSelectorRef","tagSelector","sizeAndPosition","DropdownList","entry","Input","input","TagInput","onSubmit","handleChange","target","onChange","placeholder","TagSelectorWrapper","closed","TagSelector","showSupertags","setTagSelectorRef","index","setIndex","nextModifier","useModifier","activateTag","useThrottledEffect","handleAddClick","trim","sanitizedTagname","suggestion","s","hasSuggestions","ResetButton","reset","localStorage","clear","reload","StyledSvg","svg","Loading","xmlns","xmlnsXlink","viewBox","xmlSpace","fill","stroke","cx","cy","r","attributeName","dur","repeatCount","begin","R34Icon","useTheme","transform","strokeWidth","strokeMiterlimit","strokeDasharray","strokeOpacity","fontStyle","fontWeight","fontSize","fontFamily","letterSpacing","wordSpacing","fillOpacity","x","y","fontVariant","fontStretch","ActiveTags","offerSupertags","numberOfActiveTags","openSupertagModal","toggleTag","checkIsActive","useCheckIsActive","title","useActivateTag","ErrorBoundary","hasError","this","fallback","React","Component","dark","spacing","layerBgHighlight","liked","positive","negative","themes","light","coffee","electric","deepsea","defaultThemeId","createGlobalStyle","FullScreenCentered","ErrorScreen","GlobalStyles","src","outOfResultsPicture","alt","LoadingScreen","CookieWrapper","StyledSpan","CookieConfirmation","setCookies","handleAccept","AnalyticsEventId","saveTimeout","eventLogging","store","next","action","page_number","getState","persistence","clearTimeout","setTimeout","firebaseFunctions","sourceTags","ratingTags","api","defaultPageSize","apiLocal","apiUrl1","apiUrl2","activeApi","setActiveApi","searchTerm","limit","json","fetchTags","matchingSupertags","filter","includes","details","matchingRating","matchingSourceTags","getIdToken","idToken","buildPostUrl","Authorization","apiResponse","comments_url","page","params","pid","i","apiRequests","hasMoreResults","minRating","getPosts","res","getAliases","sanitizedAliases","alias","getTags","warn","getComments","middleware","composeWithDevTools","applyMiddleware","requests","initialPreferencesState","produce","draft","assign","initialResultsState","postCount","postIndex","findIndex","p","initialTagsState","newTag","initialReaderState","setPostId","Date","now","initialModalsState","setOpenModal","combineReducers","persistConfig","storage","persistedReducer","persistReducer","rootReducer","createStore","persistor","persistStore","SectionBody","Surface","Section","Terms","Wrapper","ModalSurface","StyledInput","SupertagModal","onClose","setName","setDescription","handleCreate","Settings","lazy","Search","About","Privacy","App","loading","ThemedApp","isSupertagModalOpen","isSignedIn","onCloseModals","exact","path","PRIVACY","TERMS","ReactDOM","render","getElementById"],"mappings":"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","file":"static/js/main.5b9e0db7.chunk.js","sourcesContent":["import { ModalId } from '../data/types'\nimport * as r34 from 'r34-types'\n\n// Action Names\nexport const ADD_ALIASES = `r34-react/ADD_ALIASES`\nexport const ADD_POSTS = `r34-react/ADD_POSTS`\nexport const ADD_TAG = `r34-react/ADD_TAG`\nexport const CLOSE_MODAL = `r34-react/CLOSE_MODAL`\nexport const ENTER_FULLSCREEN = `r34-react/ENTER_FULLSCREEN`\nexport const EXIT_FULLSCREEN = 'r34-react/EXIT_FULLSCREEN'\nexport const FETCH_COMMENTS = `r34-react/FETCH_COMMENTS`\nexport const FETCH_PREFERENCES = `r34-react/FETCH_PREFERENCES`\nexport const FETCH_SUGGESTIONS = `r34-react/FETCH_SUGGESTIONS`\nexport const GET_MORE_RESULTS = `r34-react/GET_MORE_RESULTS`\nexport const GET_RESULTS = `r34-react/GET_RESULTS`\nexport const LIKE_POST = `r34-react/LIKE_POST`\nexport const OPEN_MODAL = `r34-react/OPEN_MODAL`\nexport const REMOVE_TAG = `r34-react/REMOVE_TAG`\nexport const SAVE_PREFERENCES = 'r34-react/SAVE_PREFERENCES'\nexport const SET_COMMENTS = `r34-react/SET_COMMENTS`\nexport const SET_FULLSCREEN_POST = `r34-react/SET_FULLSCREEN_POST`\nexport const SET_POSTS = `r34-react/SET_POSTS`\nexport const SET_PREFERENCE = `r34-react/SET_PREFERENCE`\nexport const SET_PREFERENCES = `r34-react/SET_PREFERENCES`\nexport const SET_SUGGESTIONS = `r34-react/SET_SUGGESTIONS`\n\n// Action Types\ninterface AddTagAction {\n  type: typeof ADD_TAG\n  tag: r34.AnyBiasedTag\n}\n\ninterface RemoveTagAction {\n  type: typeof REMOVE_TAG\n  tagName: string\n}\n\ninterface AddAliasesAction {\n  type: typeof ADD_ALIASES\n  aliases: r34.AliasTag[]\n  forTag: string\n}\n\nexport interface AddPostsAction {\n  type: typeof ADD_POSTS\n  posts: r34.Post[]\n}\n\nexport interface SetPostsAction {\n  type: typeof SET_POSTS\n  posts: r34.Post[]\n  count: number\n  pageNumber?: number\n}\n\ninterface SetCommentsAction {\n  type: typeof SET_COMMENTS\n  postId: number\n  comments: r34.Comment[]\n}\n\ninterface FetchCommentsAction {\n  type: typeof FETCH_COMMENTS\n  postId: number\n}\n\ninterface SetPreferenceAction {\n  type: typeof SET_PREFERENCE\n  key: r34.PreferenceKey\n  value: any\n}\n\ninterface SetPreferencesAction {\n  type: typeof SET_PREFERENCES\n  preferences: Partial<Record<r34.PreferenceKey, any>>\n}\n\ninterface GetResultsAction {\n  type: typeof GET_RESULTS\n  pageNumber: number\n}\n\ninterface GetMoreResultsAction {\n  type: typeof GET_MORE_RESULTS\n}\n\ninterface EnterFullcreenAction {\n  type: typeof ENTER_FULLSCREEN\n  postId: number\n}\n\ninterface SetFullScreenPostAction {\n  type: typeof SET_FULLSCREEN_POST\n  postId: number\n}\n\ninterface ExitFullscreenAction {\n  type: typeof EXIT_FULLSCREEN\n}\n\ninterface LikePostAction {\n  type: typeof LIKE_POST\n  postId: number\n}\n\ninterface OpenModalAction {\n  type: typeof OPEN_MODAL\n  modalId: ModalId\n}\n\ninterface CloseModalAction {\n  type: typeof CLOSE_MODAL\n}\n\ninterface SetSuggestionsAction {\n  type: typeof SET_SUGGESTIONS\n  suggestions: r34.AnyTag[]\n}\n\ninterface FetchSuggestionsAction {\n  type: typeof FETCH_SUGGESTIONS\n  value: string\n  includeSupertags: boolean\n}\n\ninterface FetchPreferencesAction {\n  type: typeof FETCH_PREFERENCES\n}\n\ninterface SavePreferencesAction {\n  type: typeof SAVE_PREFERENCES\n}\n\nexport type AppAction =\n  | AddAliasesAction\n  | AddPostsAction\n  | AddTagAction\n  | CloseModalAction\n  | EnterFullcreenAction\n  | ExitFullscreenAction\n  | FetchCommentsAction\n  | FetchPreferencesAction\n  | FetchSuggestionsAction\n  | GetMoreResultsAction\n  | GetResultsAction\n  | LikePostAction\n  | OpenModalAction\n  | RemoveTagAction\n  | SavePreferencesAction\n  | SetCommentsAction\n  | SetFullScreenPostAction\n  | SetPostsAction\n  | SetPreferenceAction\n  | SetPreferencesAction\n  | SetSuggestionsAction\n\n// Action Creators\nexport function addTag(tag: r34.AnyBiasedTag): AddTagAction {\n  return {\n    type: ADD_TAG,\n    tag,\n  }\n}\n\nexport function removeTag(tagName: string): RemoveTagAction {\n  return {\n    type: REMOVE_TAG,\n    tagName,\n  }\n}\n\nexport function addAliases(aliases: r34.AliasTag[], forTag: string): AddAliasesAction {\n  return {\n    type: ADD_ALIASES,\n    aliases,\n    forTag,\n  }\n}\n\nexport function addPosts(posts: r34.Post[]): AddPostsAction {\n  return {\n    type: ADD_POSTS,\n    posts,\n  }\n}\n\nexport function setPosts(posts: r34.Post[], count: number, pageNumber: number = 0): SetPostsAction {\n  return {\n    type: SET_POSTS,\n    posts,\n    count,\n    pageNumber,\n  }\n}\n\nexport function setComments(postId: number, comments: r34.Comment[]): SetCommentsAction {\n  return {\n    type: SET_COMMENTS,\n    postId,\n    comments,\n  }\n}\n\nexport function fetchComments(postId: number): FetchCommentsAction {\n  return {\n    type: FETCH_COMMENTS,\n    postId,\n  }\n}\n\nexport function setPreference(key: r34.PreferenceKey, value: any): SetPreferenceAction {\n  return {\n    type: SET_PREFERENCE,\n    key,\n    value,\n  }\n}\n\nexport function setPreferences(preferences: Partial<Record<r34.PreferenceKey, any>>): SetPreferencesAction {\n  return {\n    type: SET_PREFERENCES,\n    preferences,\n  }\n}\n\nexport function getResults(pageNumber: number = 0): GetResultsAction {\n  return {\n    type: GET_RESULTS,\n    pageNumber,\n  }\n}\n\nexport function getMoreResults(): GetMoreResultsAction {\n  return {\n    type: GET_MORE_RESULTS,\n  }\n}\n\nexport function enterFullscreen(postId: number): EnterFullcreenAction {\n  return {\n    type: ENTER_FULLSCREEN,\n    postId,\n  }\n}\n\nexport function exitFullscreen(): ExitFullscreenAction {\n  return {\n    type: EXIT_FULLSCREEN,\n  }\n}\n\nexport function setFullScreenPost(postId: number): SetFullScreenPostAction {\n  return {\n    type: SET_FULLSCREEN_POST,\n    postId,\n  }\n}\n\nexport function likePost(postId: number): LikePostAction {\n  return {\n    type: LIKE_POST,\n    postId,\n  }\n}\n\nexport function openModal(modalId: ModalId): OpenModalAction {\n  return {\n    type: OPEN_MODAL,\n    modalId,\n  }\n}\n\nexport function closeModal(): CloseModalAction {\n  return {\n    type: CLOSE_MODAL,\n  }\n}\n\nexport function setSuggestions(suggestions: r34.AnyTag[]): SetSuggestionsAction {\n  return {\n    type: SET_SUGGESTIONS,\n    suggestions,\n  }\n}\n\nexport function fetchSuggestions(value: string, includeSupertags: boolean): FetchSuggestionsAction {\n  return {\n    type: FETCH_SUGGESTIONS,\n    value,\n    includeSupertags,\n  }\n}\n\nexport function fetchPreferences(): FetchPreferencesAction {\n  return {\n    type: FETCH_PREFERENCES,\n  }\n}\n\nexport function savePreferences(): SavePreferencesAction {\n  return {\n    type: SAVE_PREFERENCES,\n  }\n}\n","import { css, DefaultTheme } from 'styled-components'\r\nimport { supportsAspectRatio, supportsFlexGap, supportsGap } from '../data/browserUtils'\r\n\r\nexport interface PropsWithTheme {\r\n  theme: DefaultTheme\r\n}\r\n\r\n/**\r\n * Gives elements a border TODO: rename to defaultborder\r\n */\r\nexport function defaultBorder({ theme }: PropsWithTheme) {\r\n  return css`\r\n    border-color: ${theme.colors.accentColor};\r\n    border-width: ${theme.dimensions.borderWidth};\r\n    ${borderRadius({ theme })}\r\n    border-style: solid;\r\n  `\r\n}\r\n\r\n/**\r\n * Element will look like a new layer\r\n */\r\nexport function layer({ theme }: PropsWithTheme) {\r\n  return css`\r\n    background-color: ${theme.colors.layerBg};\r\n    ${boxShadow({ theme })}\r\n  `\r\n}\r\n\r\n/**\r\n * Element becomes accentColor on hover, and is highlighted when active/focused\r\n */\r\nexport function primaryHover({ theme }: PropsWithTheme) {\r\n  return css`\r\n    color: ${theme.colors.backgroundColor};\r\n    background: ${theme.colors.accentColor};\r\n\r\n    :hover {\r\n      background-color: ${theme.colors.hoverAccent};\r\n      color: ${theme.colors.backgroundColor};\r\n    }\r\n\r\n    :active,\r\n    :focus {\r\n      color: ${theme.colors.backgroundColor2};\r\n      border-color: ${theme.colors.backgroundColor2};\r\n    }\r\n  `\r\n}\r\n\r\nexport function flexColumn() {\r\n  return css`\r\n    display: flex;\r\n    flex-direction: column;\r\n  `\r\n}\r\n\r\nexport function flexColumnWithGap({ theme }: PropsWithTheme) {\r\n  return css`\r\n    display: flex;\r\n    flex-direction: column;\r\n    ${flexColumnGap(theme.dimensions.gutter)};\r\n  `\r\n}\r\n\r\nexport function gridWithGap({ theme }: PropsWithTheme) {\r\n  return css`\r\n    display: grid;\r\n    ${gap(theme.dimensions.gutter)}\r\n  `\r\n}\r\n\r\nexport function flexRowWithGap({ theme }: PropsWithTheme) {\r\n  return css`\r\n    display: flex;\r\n    align-items: center;\r\n    ${flexRowGap(theme.dimensions.gutter)};\r\n  `\r\n}\r\n\r\nexport function gap(amount: string) {\r\n  return supportsGap\r\n    ? css`\r\n        gap: ${amount};\r\n      `\r\n    : css`\r\n        > :not(:last-child) {\r\n          margin-right: ${amount};\r\n          margin-bottom: ${amount};\r\n        }\r\n      `\r\n}\r\n\r\nexport function flexRowGap(amount: string) {\r\n  return supportsFlexGap\r\n    ? css`\r\n        gap: ${amount};\r\n      `\r\n    : css`\r\n        > :not(:last-child) {\r\n          margin-right: ${amount};\r\n        }\r\n      `\r\n}\r\n\r\nexport function flexColumnGap(amount: string) {\r\n  return supportsFlexGap\r\n    ? css`\r\n        gap: ${amount};\r\n      `\r\n    : css`\r\n        > :not(:last-child) {\r\n          margin-bottom: ${amount};\r\n        }\r\n      `\r\n}\r\n\r\n/**\r\n * Default spacing for grid and flex\r\n */\r\nexport function gutter({ theme }: PropsWithTheme) {\r\n  return css`\r\n    ${gap(theme.dimensions.gutter)};\r\n    padding: ${theme.dimensions.gutter};\r\n  `\r\n}\r\n\r\n/**\r\n * Limits content to a maximum width and centers it\r\n */\r\nexport function centeredMaxWidth({ theme }: PropsWithTheme) {\r\n  return css`\r\n    width: 100%;\r\n    max-width: ${theme.dimensions.bodyWidth};\r\n    margin-left: auto;\r\n    margin-right: auto;\r\n  `\r\n}\r\n\r\n/**\r\n * Fixed height and padding\r\n */\r\nexport function defaultBlock({ theme }: PropsWithTheme) {\r\n  return css`\r\n    height: ${theme.dimensions.blockHeight};\r\n    padding: 0 ${theme.dimensions.gutter};\r\n  `\r\n}\r\n\r\n/**\r\n * Preserves aspect ratio of the element and ensures it is displayed as big as possible\r\n */\r\nexport function flexMedia() {\r\n  return css`\r\n    width: 100%;\r\n    height: 100%;\r\n    display: block;\r\n    object-fit: contain;\r\n  `\r\n}\r\n\r\ninterface Size {\r\n  width: number\r\n  height: number\r\n}\r\n\r\nexport function preserveAspectRatio({ width, height }: Partial<Size>) {\r\n  if (!width || !height) {\r\n    return ''\r\n  }\r\n\r\n  return supportsAspectRatio\r\n    ? css`\r\n        aspect-ratio: ${width} / ${height};\r\n      `\r\n    : css`\r\n        max-width: 100%;\r\n        height: auto;\r\n      `\r\n}\r\n\r\nexport function borderRadius({ theme }: PropsWithTheme) {\r\n  return css`\r\n    border-radius: ${theme.dimensions.borderRadius};\r\n  `\r\n}\r\n\r\nexport function boxShadow({ theme }: PropsWithTheme) {\r\n  return css`\r\n    box-shadow: 0 1px ${theme.shadow.radius} ${theme.shadow.color};\r\n  `\r\n}\r\n\r\nexport function dropShadow({ theme }: PropsWithTheme) {\r\n  return css`\r\n    filter: drop-shadow(0 1px ${theme.shadow.radius} ${theme.shadow.color});\r\n  `\r\n}\r\n\r\nexport function mediaStyle() {\r\n  return css`\r\n    ${borderRadius}\r\n    ${boxShadow}\r\n    grid-area: 1/1/2/2;\r\n    z-index: 1;\r\n  `\r\n}\r\n","import * as r34 from 'r34-types'\r\nimport { createSelector, defaultMemoize } from 'reselect'\r\nimport { ModalId } from '../data/types'\r\nimport { AppState } from './appState'\r\n\r\n// Simple selectors\r\nexport const selectActiveTags = (state: AppState) => state.tags.active\r\nexport const selectActiveThemeId = (state: AppState) => state.preferences.themeId\r\nexport const selectAliases = (state: AppState) => state.tags.aliases\r\nexport const selectAutoPlay = (state: AppState) => state.preferences.autoPlay\r\nexport const selectCookies = (state: AppState) => state.preferences.cookies\r\nexport const selectCount = (state: AppState) => state.results.count\r\nexport const selectFullsceenPostId = (state: AppState) => state.reader.postId\r\nexport const selectFullsceenState = (state: AppState) => state.reader.isEnabled\r\nexport const selectHideSeen = (state: AppState) => state.preferences.hideSeen\r\nexport const selectOpenModalId = (state: AppState) => state.modals.openModal\r\nexport const selectOriginals = (state: AppState) => state.preferences.originals\r\nexport const selectPageNumber = (state: AppState) => state.results.pageNumber\r\nexport const selectPageSize = (state: AppState) => state.preferences.pageSize\r\nexport const selectPosts = (state: AppState) => state.results.posts\r\nexport const selectPreferences = (state: AppState) => state.preferences\r\nexport const selectPreloadVideos = (state: AppState) => state.preferences.preloadVideos\r\nexport const selectPreloadGifs = (state: AppState) => state.preferences.preloadVideos\r\nexport const selectRated = (state: AppState) => state.preferences.rated\r\nexport const selectRatedThreshold = (state: AppState) => state.preferences.ratedThreshold\r\nexport const selectResults = (state: AppState) => state.results\r\nexport const selectResultsLayout = (state: AppState) => state.preferences.resultsLayout\r\nexport const selectShowComments = (state: AppState) => state.preferences.showComments\r\nexport const selectShowMetadata = (state: AppState) => state.preferences.showMetadata\r\nexport const selectSort = (state: AppState) => state.preferences.sort\r\nexport const selectSuggestions = (state: AppState) => state.suggestions.entries\r\nexport const selectTagSuggestionCount = (state: AppState) => state.preferences.tagSuggestionsCount\r\n\r\n// Memoized selectors\r\nexport const selectNumberOfActiveTags = createSelector(selectActiveTags, (tags) => Object.keys(tags).length)\r\nexport const selectAliasesAsList = createSelector(selectAliases, (aliases) => Object.values(aliases).flat())\r\nexport const selectHasResults = createSelector(selectPosts, (posts) => posts.length !== 0)\r\nexport const selectOutOfResults = createSelector(selectPosts, selectCount, (posts, count) => posts.length === count)\r\nexport const selectHasMoreResults = createSelector(selectOutOfResults, (outOfResults) => !outOfResults)\r\nexport const selectLastPage = createSelector(\r\n  selectCount,\r\n  selectPageSize,\r\n  (count, pageSize) => Math.ceil(count / pageSize) - 1\r\n)\r\nexport const selectFullScreenPost = createSelector(selectPosts, selectFullsceenPostId, (posts, fullScreenPostId) =>\r\n  posts.find((post) => post.id === fullScreenPostId)\r\n)\r\nexport const selectFullScreenIndex = createSelector(selectPosts, selectFullScreenPost, (posts, fullScreenPost) =>\r\n  fullScreenPost ? posts.indexOf(fullScreenPost) : -1\r\n)\r\nexport const selectMinRating = createSelector(selectRated, selectRatedThreshold, (rated, ratedThreshold) =>\r\n  rated ? ratedThreshold : 0\r\n)\r\nexport const selectNextIndex = createSelector(selectPosts, selectFullScreenIndex, (posts, selectedIndex) =>\r\n  selectedIndex + 1 < posts.length ? selectedIndex + 1 : undefined\r\n)\r\nexport const selectPreviousIndex = createSelector(selectFullScreenIndex, (selectedIndex) =>\r\n  selectedIndex > 0 ? selectedIndex - 1 : undefined\r\n)\r\nexport const selectSupertagModalOpen = createSelector(\r\n  selectOpenModalId,\r\n  (modalId) => modalId === ModalId.CREATE_SUPERTAG\r\n)\r\n\r\n// Parameterized selectors\r\nexport const selectPostById = defaultMemoize((id: number) => {\r\n  return createSelector(selectPosts, (posts) => {\r\n    return posts.find((post) => post.id === id) as r34.Post\r\n  })\r\n})\r\n\r\nexport const selectAliasesByTagName = defaultMemoize((tagName: string) => {\r\n  return createSelector(selectAliases, (aliases) => {\r\n    return aliases[tagName]\r\n  })\r\n})\r\n\r\nexport const selectLikedByPostId = defaultMemoize((id: number) => (state: AppState) => id in state.likes)\r\n","import * as r34 from 'r34-types'\r\n\r\n//#region Tag serialization\r\n\r\n/**\r\n * Accepts a map of all tags and serializes them into a string that can be used as a Querystring parameter\r\n */\r\nexport function serializeAllTags(tags: Record<string, r34.QueryTag | r34.Supertag>) {\r\n  const resolvedTags = flattenSupertags(Object.values(tags))\r\n  const tagsByModifier = groupTagsByModifier(resolvedTags)\r\n  const normalTags = [...tagsByModifier['+'], ...tagsByModifier['-']].map(serializeTag).join(' + ')\r\n  const optionalTags =\r\n    tagsByModifier['~'].length > 0 ? ` + ( ${tagsByModifier['~'].map(serializeTag).join(' ~ ')} )` : ''\r\n\r\n  return `${normalTags}${optionalTags}`\r\n}\r\n\r\n/**\r\n * Accepts a list that holds normal tags and supertags and unpacks all supertags.\r\n * The result contains all normal tags given plus all contents of the supertags given.\r\n */\r\nexport function flattenSupertags(tags: Array<r34.QueryTag | r34.Supertag>) {\r\n  let resolvedTags: r34.QueryTag[] = []\r\n\r\n  tags.forEach((tag) => {\r\n    if (isSupertag(tag)) {\r\n      Object.entries(tag.tags).forEach(([name, modifier]) => {\r\n        resolvedTags.push({ name, modifier })\r\n      })\r\n    } else {\r\n      resolvedTags.push(tag)\r\n    }\r\n  })\r\n\r\n  return resolvedTags\r\n}\r\n\r\n/**\r\n * Given a list of tags this function returns a record with an entry for each modifier countaining all tags of the original list that match that modifier.\r\n */\r\nexport function groupTagsByModifier(tags: r34.QueryTag[]) {\r\n  return tags.reduce(\r\n    (result, current) => {\r\n      if (!(current.modifier in result)) result[current.modifier] = []\r\n\r\n      result[current.modifier]?.push(current)\r\n\r\n      return result\r\n    },\r\n    { '+': [], '-': [], '~': [] } as Record<r34.TagModifier, r34.QueryTag[]>\r\n  )\r\n}\r\n\r\n/**\r\n * Serializes a tag for use in urls\r\n */\r\nexport function serializeTag(tag: r34.QueryTag) {\r\n  return `${tag.modifier === '-' ? '-' : ''}${serializeTagname(tag.name)}`\r\n}\r\n\r\n/**\r\n * Serializes tag names for use in api requests.\r\n */\r\nexport function serializeTagname(tagname: string) {\r\n  return encodeURIComponent(tagname.toLowerCase().replace(/ /g, '_'))\r\n}\r\n\r\n//#endregion\r\n\r\n//#region Query parameter construction\r\n\r\n/**\r\n * Constructs the tag parameter for getting posts from the api\r\n */\r\nexport function getTagParameter(\r\n  tags: Record<string, r34.QueryTag | r34.Supertag>,\r\n  minScore: number,\r\n  sort: r34.PostsSort\r\n) {\r\n  const tagParts = []\r\n\r\n  if (Object.keys(tags).length > 0) {\r\n    tagParts.push(serializeAllTags(tags))\r\n  }\r\n\r\n  if (minScore > 0) {\r\n    tagParts.push(encodeURIComponent(`score:>=${minScore}`))\r\n  }\r\n\r\n  if (sort !== 'date') {\r\n    tagParts.push(encodeURIComponent(`sort:${sort}:desc`))\r\n  }\r\n\r\n  return tagParts.join(' + ')\r\n}\r\n\r\n//#endregion\r\n\r\n//#region Typing\r\n\r\nexport function bias(tag: r34.Tag, modifier: r34.TagModifier): r34.BiasedTag {\r\n  return { ...tag, modifier }\r\n}\r\n\r\nexport function isBiased(tag: r34.Tag | r34.BiasedTag): tag is r34.BiasedTag {\r\n  return (tag as r34.BiasedTag).modifier !== undefined\r\n}\r\n\r\nexport function isSupertag(tag: unknown): tag is r34.Supertag {\r\n  return (tag as r34.Supertag).tags !== undefined\r\n}\r\n\r\nexport function getInterestingType(types: r34.TagType[]) {\r\n  return types.find((t) => !t.match(/^[general|ambiguous]$/))\r\n}\r\n\r\n//#endregion\r\n","import { IconProp } from '@fortawesome/fontawesome-svg-core'\r\nimport {\r\n  faDeviantart,\r\n  faDiscord,\r\n  faGithub,\r\n  faGoogle,\r\n  faPatreon,\r\n  faTumblr,\r\n  faTwitter,\r\n} from '@fortawesome/free-brands-svg-icons'\r\nimport {\r\n  faCalendarDay,\r\n  faCaretDown,\r\n  faCheckCircle,\r\n  faCheckSquare,\r\n  faCodeBranch,\r\n  faCopyright,\r\n  faDownload,\r\n  faExpand,\r\n  faExternalLinkAlt,\r\n  faHashtag,\r\n  faHeart,\r\n  faImage,\r\n  faInfoCircle,\r\n  faLink,\r\n  faPen,\r\n  faPlus,\r\n  faRegistered,\r\n  faSearch,\r\n  faSignOutAlt,\r\n  faTags,\r\n  faTimes,\r\n  faTimesCircle,\r\n  faUndoAlt,\r\n  faUser,\r\n  faWrench,\r\n} from '@fortawesome/free-solid-svg-icons'\r\nimport { FontAwesomeIcon, FontAwesomeIconProps } from '@fortawesome/react-fontawesome'\r\n\r\n/**\r\n * Component factory that shortens the definition of a new icon considerably\r\n */\r\nconst bindIcon = (icon: IconProp) => (props: Omit<FontAwesomeIconProps, 'icon'>) =>\r\n  <FontAwesomeIcon data-testid='icon' icon={icon} {...props} />\r\n\r\nexport const ArrowDown = bindIcon(faCaretDown)\r\nexport const ArtistIcon = bindIcon(faPen)\r\nexport const CalendarIcon = bindIcon(faCalendarDay)\r\nexport const CharacterIcon = bindIcon(faUser)\r\nexport const CheckIcon = bindIcon(faCheckSquare)\r\nexport const CloseIcon = bindIcon(faTimes)\r\nexport const CodeBranchIcon = bindIcon(faCodeBranch)\r\nexport const CopyrightIcon = bindIcon(faCopyright)\r\nexport const DeviantArtIcon = bindIcon(faDeviantart)\r\nexport const DiscordIcon = bindIcon(faDiscord)\r\nexport const DownloadIcon = bindIcon(faDownload)\r\nexport const ExpandIcon = bindIcon(faExpand)\r\nexport const ExternalLinkIcon = bindIcon(faExternalLinkAlt)\r\nexport const FailedIcon = bindIcon(faTimesCircle)\r\nexport const GithubIcon = bindIcon(faGithub)\r\nexport const GoogleIcon = bindIcon(faGoogle)\r\nexport const HeartIcon = bindIcon(faHeart)\r\nexport const ImageIcon = bindIcon(faImage)\r\nexport const LinkIcon = bindIcon(faLink)\r\nexport const MetaDataIcon = bindIcon(faInfoCircle)\r\nexport const PatreonIcon = bindIcon(faPatreon)\r\nexport const PlusIcon = bindIcon(faPlus)\r\nexport const RatingIcon = bindIcon(faRegistered)\r\nexport const SearchIcon = bindIcon(faSearch)\r\nexport const SignOutIcon = bindIcon(faSignOutAlt)\r\nexport const SourceIcon = bindIcon(faHashtag)\r\nexport const SuccessIcon = bindIcon(faCheckCircle)\r\nexport const SupertagIcon = bindIcon(faTags)\r\nexport const TumblrIcon = bindIcon(faTumblr)\r\nexport const TwitterIcon = bindIcon(faTwitter)\r\nexport const UndoIcon = bindIcon(faUndoAlt)\r\nexport const WrenchIcon = bindIcon(faWrench)\r\n","/**\r\n * Tabs displayed in Post details\r\n */\r\nexport type ActiveTab = 'tags' | 'comments' | 'metadata'\r\n\r\n/**\r\n * All routes of the app.\r\n */\r\nexport enum RouteName {\r\n  SEARCH = '/',\r\n  SETTINGS = '/settings',\r\n  ABOUT = '/about',\r\n  PRIVACY = '/privacy',\r\n  TERMS = '/terms',\r\n}\r\n\r\n/**\r\n * All modals the app can display.\r\n */\r\nexport enum ModalId {\r\n  CREATE_SUPERTAG,\r\n}\r\n\r\n/**\r\n * One-time definition of an empty function. Reusing this improves React's performance as it does not break memoization.\r\n */\r\nexport const NO_OP = () => {}\r\n\r\nexport type InViewHookResponse<T extends Element> = {\r\n  ref: (node?: T | null) => void\r\n  inView: boolean\r\n  entry?: IntersectionObserverEntry\r\n}\r\n","import styled, { css } from 'styled-components'\nimport { defaultBorder, dropShadow, primaryHover } from '../../styled/mixins'\n\nconst TextButton = styled.button(\n  ({ theme }) => css`\n    height: ${theme.dimensions.blockHeight};\n    padding: 0 ${theme.dimensions.bigSpacing};\n    font-size: ${theme.fontSizes.content};\n    ${defaultBorder({ theme })}\n    display: inline-flex;\n    gap: ${theme.dimensions.gutter};\n    align-items: center;\n    place-content: center;\n\n    transition: all ${theme.timings.longTransitionTime} ease-out;\n  `\n)\n\nexport const InvisButton = styled.button(\n  ({ theme }) => css`\n    background-color: transparent;\n    border: none;\n    padding: ${theme.dimensions.gutter};\n    ${dropShadow({ theme })}\n\n    svg {\n      transition: all ${theme.timings.transitionTime} ease-out;\n    }\n\n    :active {\n      svg {\n        transform: scale(1.1);\n      }\n    }\n  `\n)\n\nexport const RedButton = styled(TextButton)`\n  ${primaryHover}\n`\n\nexport const BlockButton = styled(RedButton)`\n  width: 100%;\n\n  :active {\n    transform: scaleX(1.03) scaleY(1.1);\n  }\n`\n\nexport const AddButton = styled(RedButton)(\n  ({ theme }) => css`\n    border-radius: 0 ${theme.dimensions.borderRadius} ${theme.dimensions.borderRadius} 0;\n  `\n)\n\nexport const ModifierButton = styled(TextButton)(\n  ({ theme }) => css`\n    background-color: transparent;\n    min-width: 48px;\n    font-weight: bold;\n\n    ${defaultBorder({ theme })}\n    border-right-width: 0;\n    border-radius: ${theme.dimensions.borderRadius} 0 0 ${theme.dimensions.borderRadius};\n  `\n)\n","import firebase from 'firebase/app'\r\nimport 'firebase/analytics'\r\nimport { SearchEvent } from '../analytics/events'\r\n\r\nexport async function logEvent(event: SearchEvent) {\r\n  firebase.analytics().logEvent<typeof event.id>(event.id, event.payload)\r\n}\r\n","import firebase from 'firebase/app'\r\nimport 'firebase/auth'\r\n\r\nconst googleAuthProvider = new firebase.auth.GoogleAuthProvider()\r\n\r\nexport function signIn() {\r\n  firebase\r\n    .auth()\r\n    .signInWithPopup(googleAuthProvider)\r\n    .catch((error) => {\r\n      console.error('Sign in failed:', error.code, error.message)\r\n    })\r\n}\r\n\r\nexport async function signOut() {\r\n  return await firebase.auth().signOut()\r\n}\r\n","export async function sha256(message: string) {\r\n  const msgBuffer = new TextEncoder().encode(message)\r\n  const hashBuffer = await crypto.subtle.digest('SHA-256', msgBuffer)\r\n  const hashArray = Array.from(new Uint8Array(hashBuffer))\r\n  const hashHex = hashArray.map((b) => b.toString(16).padStart(2, '0')).join('')\r\n\r\n  return hashHex\r\n}\r\n","import firebase from 'firebase/app'\r\nimport 'firebase/auth'\r\nimport 'firebase/firestore'\r\nimport { useEffect, useState } from 'react'\r\nimport { SupertagData, TagModifier, User } from 'r34-types'\r\nimport { sha256 } from '../data/encryption'\r\nimport useFirebaseAuthState from '../hooks/useFirebaseAuthState'\r\nimport { PreferencesState } from '../redux/reducers/preferences'\r\nimport { GenericConverter } from './genericConverter'\r\n\r\nconst userConverter = new GenericConverter<User>()\r\n\r\nasync function getUserDoc() {\r\n  const { currentUser } = firebase.auth()\r\n  const email = currentUser?.email\r\n\r\n  if (email) {\r\n    const key = await sha256(email)\r\n    const userDoc = firebase.firestore().collection('users').doc(key)\r\n    return userDoc\r\n  }\r\n\r\n  return undefined\r\n}\r\n\r\nasync function getUserData() {\r\n  const userDoc = await getUserDoc()\r\n\r\n  if (userDoc) {\r\n    let userSnap = await userDoc.withConverter(userConverter).get()\r\n\r\n    const userData = userSnap.data()\r\n    return userData\r\n  }\r\n\r\n  return undefined\r\n}\r\n\r\nexport async function getPreferences() {\r\n  const userData = await getUserData()\r\n\r\n  if (userData) return userData.preferences\r\n\r\n  return undefined\r\n}\r\n\r\nexport async function setPreferences(preferences: PreferencesState) {\r\n  const userDoc = await getUserDoc()\r\n\r\n  await userDoc?.set({ preferences: preferences })\r\n}\r\n\r\nexport async function resetSeenPosts() {\r\n  console.log('broken')\r\n}\r\n\r\nexport async function getSupertags() {\r\n  const userDoc = await getUserDoc()\r\n\r\n  if (userDoc) {\r\n    const snap = await userDoc.collection('supertags').get()\r\n    const result: Record<string, SupertagData> = {}\r\n\r\n    snap.forEach((doc) => {\r\n      result[doc.id] = doc.data() as SupertagData\r\n    })\r\n\r\n    return result\r\n  }\r\n\r\n  return undefined\r\n}\r\n\r\nexport async function addSupertag(name: string, description: string, tags: Record<string, TagModifier>) {\r\n  const userDoc = await getUserDoc()\r\n\r\n  userDoc?.collection('supertags').doc(name).set({ description, tags })\r\n}\r\n\r\nexport async function removeSupertag(name: string) {\r\n  const userDoc = await getUserDoc()\r\n\r\n  userDoc?.collection('supertags').doc(name).delete()\r\n}\r\n\r\nexport async function setTagsOfSupertag(name: string, tags: Record<string, TagModifier>) {\r\n  const userDoc = await getUserDoc()\r\n\r\n  userDoc?.collection('supertags').doc(name).update({ tags })\r\n}\r\n\r\nexport function useSupertags() {\r\n  const [supertags, setSupertags] = useState<Record<string, SupertagData>>({})\r\n  const [collection, setCollection] = useState<firebase.firestore.CollectionReference>()\r\n\r\n  // eslint-disable-next-line @typescript-eslint/no-unused-vars\r\n  const [_, userInfo] = useFirebaseAuthState()\r\n\r\n  useEffect(() => {\r\n    if (userInfo?.email) {\r\n      sha256(userInfo.email)\r\n        .then((hash) => {\r\n          const col = firebase.firestore().collection(`users/${hash}/supertags`)\r\n          setCollection(col)\r\n          return col.get()\r\n        })\r\n        .then((snapshot) => {\r\n          const result = snapshot.docs.reduce((result, doc) => {\r\n            result[doc.id] = doc.data() as SupertagData\r\n            return result\r\n          }, {} as Record<string, SupertagData>)\r\n\r\n          setSupertags(result)\r\n        })\r\n    }\r\n  }, [userInfo?.email])\r\n\r\n  useEffect(() => {\r\n    if (collection) {\r\n      const unsubscribe = collection.onSnapshot((snapshot) => {\r\n        const result = snapshot.docs.reduce((result, doc) => {\r\n          const userSupertags = doc\r\n          result[userSupertags.id] = doc.data() as SupertagData\r\n          return result\r\n        }, {} as Record<string, SupertagData>)\r\n\r\n        setSupertags(result)\r\n      })\r\n\r\n      return () => {\r\n        unsubscribe()\r\n      }\r\n    }\r\n  }, [collection])\r\n\r\n  return supertags\r\n}\r\n","import firebase from 'firebase/app'\r\n\r\nexport class GenericConverter<T> {\r\n  toFirestore(data: T): firebase.firestore.DocumentData {\r\n    return data\r\n  }\r\n  fromFirestore(snapshot: firebase.firestore.QueryDocumentSnapshot, options: firebase.firestore.SnapshotOptions): T {\r\n    const data = snapshot.data(options)!\r\n    return data as T\r\n  }\r\n}\r\n","import firebase from 'firebase/app'\r\nimport 'firebase/analytics'\r\nimport 'firebase/auth'\r\nimport 'firebase/firestore'\r\n\r\nconst firebaseConfig = {\r\n  apiKey: 'AIzaSyBHdepwE7M4Byu2lFtX2s__9COcMdvXu7Q',\r\n  authDomain: 'r34-react.firebaseapp.com',\r\n  databaseURL: 'https://r34-react.firebaseio.com',\r\n  projectId: 'r34-react',\r\n  storageBucket: 'r34-react.appspot.com',\r\n  messagingSenderId: '844749417844',\r\n  appId: '1:844749417844:web:11fa1fda0e14f1ac2dd021',\r\n  measurementId: 'G-27J3QXZ8YR',\r\n}\r\n\r\nfirebase.initializeApp(firebaseConfig)\r\n\r\nexport * from './analytics'\r\nexport * from './signIn'\r\nexport * from './storage'\r\n","import styled, { css } from 'styled-components'\nimport { flexRowWithGap } from '../../styled/mixins'\n\nexport const Title = styled.h2(\n  ({ theme }) => css`\n    font-size: ${theme.fontSizes.bigTitle};\n    font-weight: lighter;\n    text-align: center;\n  `\n)\n\nexport const BigTitle = styled.h1(\n  ({ theme }) => css`\n    ${flexRowWithGap({ theme })}\n\n    justify-content: center;\n    font-size: ${theme.fontSizes.bigTitle};\n    font-weight: lighter;\n    text-align: center;\n  `\n)\n\nexport const SmallTitle = styled.h3(\n  ({ theme }) => css`\n    font-size: ${theme.fontSizes.content};\n  `\n)\n\nexport const Faded = styled.span(\n  ({ theme }) => css`\n    color: ${theme.colors.subduedText};\n  `\n)\n","import styled, { css } from 'styled-components'\n\nexport const HorizontalLine = styled.div(\n  (props) => css`\n    align-self: stretch;\n    height: 1px;\n    background: ${props.theme.colors.layerBg};\n  `\n)\n\nexport const VerticalLine = styled.div(\n  (props) => css`\n    width: 1px;\n    align-self: stretch;\n    background: ${props.theme.colors.layerBg};\n  `\n)\n","/**\n * Converts a list of objects into a map.\n * @param list The original list\n * @param keyProp The keyProp parameter defines which property of the objects will be used as the index for the map\n */\nexport const listToMap = <T>(list: T[], keyProp: string): Record<string, T> => {\n  return list.reduce((result: Record<string, T>, current: any) => {\n    result[current[keyProp]] = current\n    return result\n  }, {})\n}\n\n/**\n * Returns a URL object when the value is a hyperlink. Else undefined\n */\nexport function parseUrl(value: string) {\n  try {\n    return new URL(value)\n  } catch (err) {\n    return undefined\n  }\n}\n\n/**\n * converts a version like \"1.2.7\" into 127\n */\nexport function versionToNumber(majorMinorPatch: string) {\n  return Number(majorMinorPatch.split('.').join(''))\n}\n\n/**\n * Hacky ass way to download images cross origin. Could solve this by hosting both the app and the api on the same domain.\n */\nexport function download(url: string) {\n  const filename = url.split('/').pop() || ''\n\n  fetch(url, {\n    headers: new Headers({\n      Origin: window.location.origin,\n    }),\n    mode: 'cors',\n  })\n    .then((response) => response.blob())\n    .then((blob) => {\n      var a = document.createElement('a')\n      a.download = filename\n      a.href = window.URL.createObjectURL(blob)\n      document.body.appendChild(a)\n      a.click()\n      a.remove()\n    })\n    .catch((e) => console.error(e))\n}\n\n/**\n * Returns the current version of the project\n */\nexport function getVersion() {\n  // Some browsers fail to get environment variables. In that case return unknown.\n  if (process?.env?.REACT_APP_VERSION) {\n    return process.env.REACT_APP_VERSION\n  }\n\n  return 'unknown'\n}\n\n/**\n * Render ready version.\n */\nexport function getVersionString() {\n  const version = getVersion()\n\n  return version === 'unknown' ? 'Latest Release' : `Version ${version}`\n}\n\n/**\n * Returns the correct source based on preferences\n */\nexport function getCorrectSource(loadOriginal: boolean, big_src: string, small_src: string) {\n  const source = loadOriginal ? big_src : small_src\n  return source\n}\n\nexport function boolToNumber(value: boolean) {\n  return value ? 1 : 0\n}\n","import { parseUrl } from '../data/utils'\n\n/**\n * Transforms a number into a shortened version for rendering.\n * Useful as it takes up less space.\n */\nexport const formatCount = (value: number) => {\n  if (value / 1e6 >= 1) {\n    return `${Math.trunc(value / 1e6)}M`\n  }\n\n  if (value >= 1e3) {\n    return `${Math.trunc(value / 1e3)}K`\n  }\n\n  return value.toString()\n}\n\n/**\n * Formats source strings for rendering\n */\nexport const formatSource = (source: string) => {\n  const url = parseUrl(source)\n  return url ? url.host : source\n}\n\n/**\n * Seconds to mm:ss formatter\n */\nexport function formatDuration(duration: number) {\n  const min = Math.trunc(duration / 60)\n  const sec = Math.trunc(duration % 60)\n\n  return min + ':' + (sec < 10 ? '0' : '') + sec\n}\n\n/**\n * Formats tag names for rendering.\n */\nexport function formatTagname(tagname: string) {\n  return tagname\n    .replace(/_/g, ' ')\n    .replace(/source:/g, '')\n    .replace(/rating:/g, '')\n}\n\n/**\n * Formats tags with their count if possible\n */\nexport function formatTagnameAndCount(name: string, count?: number) {\n  return count ? `${formatTagname(name)} (${formatCount(count)})` : formatTagname(name)\n}\n\n/**\n * Returns a string containing date and time of agiven Date object\n */\nexport function formatDatetime(date: Date) {\n  return `${date.toLocaleDateString()} ${date.toLocaleTimeString()}`\n}\n\n/**\n * Returns a human friendly approximation of a given time\n */\nexport function formatTime(milliseconds: number) {\n  if (milliseconds >= 315576e5) {\n    return formatUnit(milliseconds, 315576e5, 'year')\n  }\n\n  if (milliseconds >= 26297568e2) {\n    return formatUnit(milliseconds, 26297568e2, 'month')\n  }\n\n  if (milliseconds >= 6048e5) {\n    return formatUnit(milliseconds, 6048e5, 'week')\n  }\n\n  if (milliseconds >= 854e5) {\n    return formatUnit(milliseconds, 854e5, 'day')\n  }\n\n  if (milliseconds >= 36e5) {\n    return formatUnit(milliseconds, 36e5, 'hour')\n  }\n\n  if (milliseconds >= 6e4) {\n    return formatUnit(milliseconds, 6e4, 'minute')\n  }\n\n  if (milliseconds >= 1e3) {\n    return formatUnit(milliseconds, 1e3, 'second')\n  }\n\n  return `${milliseconds} ms`\n}\n\nexport function formatUnit(value: number, unitSize: number, unit: string) {\n  const result = (value / unitSize).toFixed(0)\n\n  const unitString = result === '1' ? unit : `${unit}s`\n\n  return `${result} ${unitString}`\n}\n","export const supportsFlexGap = (() => {\r\n  // create flex container with row-gap set\r\n  var flex = document.createElement('div')\r\n  flex.style.display = 'flex'\r\n  flex.style.flexDirection = 'column'\r\n  flex.style.rowGap = '1px'\r\n\r\n  // create two, elements inside it\r\n  flex.appendChild(document.createElement('div'))\r\n  flex.appendChild(document.createElement('div'))\r\n\r\n  // append to the DOM (needed to obtain scrollHeight)\r\n  document.body.appendChild(flex)\r\n  var isSupported = flex.scrollHeight === 1 // flex container should be 1px high from the row-gap\r\n  //@ts-expect-error\r\n  flex.parentNode.removeChild(flex)\r\n\r\n  return isSupported\r\n})()\r\n\r\nexport const supportsGap = 'gap' in document.body.style\r\nexport const supportsAspectRatio = 'aspect-ratio' in document.body.style\r\nexport const supportsObjectFit = 'object-fit' in document.body.style\r\nexport const supportsFullscreen = document.fullscreenEnabled\r\n\r\nexport function openFullscreen(element: Element) {\r\n  if (element.requestFullscreen) {\r\n    element.requestFullscreen()\r\n    //@ts-expect-error\r\n  } else if (element.webkitRequestFullscreen) {\r\n    //@ts-expect-error\r\n    element.webkitRequestFullscreen()\r\n    //@ts-expect-error\r\n  } else if (element.msRequestFullscreen) {\r\n    //@ts-expect-error\r\n    element.msRequestFullscreen()\r\n  }\r\n}\r\n\r\nexport function closeFullscreen() {\r\n  if (document.exitFullscreen) {\r\n    document.exitFullscreen()\r\n    //@ts-expect-error\r\n  } else if (document.webkitExitFullscreen) {\r\n    //@ts-expect-error\r\n    document.webkitExitFullscreen()\r\n    //@ts-expect-error\r\n  } else if (document.msExitFullscreen) {\r\n    //@ts-expect-error\r\n    document.msExitFullscreen()\r\n  }\r\n}\r\n","import styled from 'styled-components'\nimport { borderRadius, gutter, layer } from '../../styled/mixins'\n\nexport default styled.div`\n  display: grid;\n  ${gutter}\n  ${layer}\n  ${borderRadius}\n  width: 100%;\n`\n","import firebase from 'firebase/app'\r\nimport 'firebase/auth'\r\nimport { useEffect, useState } from 'react'\r\n\r\n/**\r\n * A hook that provides the firebase authentication status for use in functional components.\r\n */\r\nexport default function useFirebaseAuthState() {\r\n  const [authState, setAuthState] = useState(false)\r\n  const [user, setUser] = useState<firebase.User | null>(null)\r\n\r\n  useEffect(() => {\r\n    const unsubscribe = firebase.auth().onAuthStateChanged((user) => {\r\n      if (user) {\r\n        setAuthState(true)\r\n        setUser(user)\r\n      } else {\r\n        setAuthState(false)\r\n        setUser(null)\r\n      }\r\n    })\r\n    return () => {\r\n      unsubscribe()\r\n    }\r\n  }, [])\r\n\r\n  return [authState, user] as const\r\n}\r\n","import { TagType } from 'r34-types'\nimport React from 'react'\nimport {\n  CharacterIcon,\n  CopyrightIcon,\n  ArtistIcon,\n  RatingIcon,\n  SourceIcon,\n  MetaDataIcon,\n  SupertagIcon,\n} from './FontAwesomeIcons'\n\ninterface TypeIconProps {\n  type?: TagType\n  className?: string\n}\n\nexport default function TypeIcon(props: TypeIconProps) {\n  const { type, className = '' } = props\n\n  switch (type) {\n    case 'character':\n      return <CharacterIcon className={className} />\n    case 'copyright':\n      return <CopyrightIcon className={className} />\n    case 'artist':\n      return <ArtistIcon className={className} />\n    case 'rating':\n      return <RatingIcon className={className} />\n    case 'source':\n      return <SourceIcon className={className} />\n    case 'metadata':\n      return <MetaDataIcon className={className} />\n    case 'supertag':\n      return <SupertagIcon className={className} />\n    default:\n      return null\n  }\n}\n","import styled from 'styled-components'\nimport { flexColumn, gutter, centeredMaxWidth } from '../../styled/mixins'\n\nconst FlexColumn = styled.div`\n  ${flexColumn}\n  width: 100%;\n  min-height: 100%;\n`\n\nexport default FlexColumn\n\nexport const FlexColumnWithSpacing = styled(FlexColumn)`\n  ${gutter}\n  ${centeredMaxWidth}\n`\n","import { useCallback } from 'react'\nimport { PreferenceKey } from 'r34-types'\nimport { useDispatch, useSelector } from 'react-redux'\nimport { setPreference } from '../redux/actions'\nimport { PreferencesState } from '../redux/reducers/preferences'\nimport { selectPreferences } from '../redux/selectors'\n\n/**\n * useState for preferences using redux instead of local state.\n */\nexport default function usePreference<T extends PreferenceKey>(\n  key: T\n): [PreferencesState[T], (value: PreferencesState[T]) => void] {\n  const dispatch = useDispatch()\n  const preferences = useSelector(selectPreferences)\n  const setValue = useCallback((value: any) => dispatch(setPreference(key, value)), [dispatch, key])\n\n  return [preferences[key], setValue]\n}\n","import React, { RefAttributes } from 'react'\nimport { Link, LinkProps, useLocation } from 'react-router-dom'\nimport styled, { css, ThemeProps } from 'styled-components'\nimport { RouteName } from '../../data/types'\nimport R34Icon from '../../icons/R34Icon'\nimport { boxShadow, flexColumn, flexColumnGap, flexRowGap, flexRowWithGap } from '../../styled/mixins'\nimport { VerticalLine } from '../common/Lines'\nimport { BigTitle } from '../common/Text'\n\nconst HeaderWrapper = styled.header(\n  ({ theme }) => css`\n    ${flexColumn()}\n    ${flexColumnGap(theme.dimensions.bigSpacing)}\n  `\n)\n\nconst TitleBar = styled.div(\n  ({ theme }) => css`\n    ${flexRowWithGap({ theme })}\n    justify-content: center;\n    background: ${theme.colors.layerBgSolid};\n    padding: ${theme.dimensions.gutter} 0;\n    ${boxShadow({ theme })}\n  `\n)\n\nconst MenuBar = styled.nav(\n  ({ theme }) => css`\n    display: flex;\n    justify-content: center;\n    padding: ${theme.dimensions.bigSpacing};\n    ${flexRowGap(theme.dimensions.hugeSpacing)}\n  `\n)\n\ntype LocationStyledLinkProps = LinkProps<unknown> &\n  RefAttributes<HTMLAnchorElement> &\n  ThemeProps<any> & { current: string }\n\nconst LocationStyledLink = styled(Link)(\n  ({ to, current, theme }: LocationStyledLinkProps) => css`\n    color: ${to === current ? theme.colors.accentColor : theme.colors.text};\n  `\n)\n\nexport default function Header() {\n  const current = useLocation().pathname\n\n  return (\n    <HeaderWrapper role='cell'>\n      <TitleBar>\n        <R34Icon size={32} />\n        <VerticalLine />\n        <BigTitle>\n          <span>Browse</span> <a href='https://rule34.xxx'>Rule34</a>\n        </BigTitle>\n      </TitleBar>\n\n      <MenuBar>\n        <LocationStyledLink current={current} to={RouteName.SEARCH}>\n          Search\n        </LocationStyledLink>\n        <VerticalLine />\n        <LocationStyledLink current={current} to={RouteName.SETTINGS}>\n          Settings\n        </LocationStyledLink>\n        <VerticalLine />\n        <LocationStyledLink current={current} to={RouteName.ABOUT}>\n          About\n        </LocationStyledLink>\n      </MenuBar>\n    </HeaderWrapper>\n  )\n}\n","import { useCallback, useState } from 'react'\n\n/**\n * A small wrapper for a useState<boolean> that is primarily used for toggling.\n * Saves me a few useCallbacks.\n */\nexport default function useToggle(initialValue = false): [boolean, () => void, () => void] {\n  const [value, setValue] = useState<boolean>(initialValue)\n  const toggleValue = useCallback(() => setValue(!value), [value])\n  const resetValue = useCallback(() => setValue(initialValue), [initialValue])\n\n  return [value, toggleValue, resetValue]\n}\n","import { useCallback } from 'react'\nimport { useDispatch } from 'react-redux'\nimport { AnyAction } from 'redux'\n\n/**\n * A hook that simplifies usage of simple (unparameterized) Redux actions\n */\nexport default function useAction<T extends () => AnyAction>(actionCreator: T) {\n  const dispatch = useDispatch()\n\n  return useCallback(() => dispatch(actionCreator()), [actionCreator, dispatch])\n}\n","import styled, { css } from 'styled-components'\r\nimport { TagModifier } from 'r34-types'\r\n\r\nconst modifierToStyle = {\r\n  '+': css``,\r\n  '-': css`\r\n    text-decoration: line-through;\r\n  `,\r\n  '~': css`\r\n    font-style: italic;\r\n  `,\r\n}\r\n\r\ninterface ModifierStyledTextProps {\r\n  modifier: TagModifier\r\n}\r\n\r\nexport const ModifierStyledText = styled.span(\r\n  ({ modifier = '+' }: ModifierStyledTextProps) => modifierToStyle[modifier]\r\n)\r\n","import { TagModifier } from 'r34-types'\nimport { formatTagnameAndCount } from '../../misc/formatting'\nimport { ModifierStyledText } from '../common/ModifierStyledText'\n\ninterface TagNameProps {\n  modifier: TagModifier\n  name: string\n  count?: number\n}\n\nexport default function TagName(props: TagNameProps) {\n  const { modifier, name, count } = props\n\n  return (\n    <ModifierStyledText modifier={modifier} tabIndex={0}>\n      {formatTagnameAndCount(name, count)}\n    </ModifierStyledText>\n  )\n}\n","import React, { MouseEventHandler, useCallback } from 'react'\nimport { useDispatch } from 'react-redux'\nimport styled, { css } from 'styled-components'\nimport { TagModifier } from 'r34-types'\nimport { addTag } from '../../redux/actions'\nimport { flexRowWithGap } from '../../styled/mixins'\nimport TagName from './TagName'\n\ninterface AliasProps {\n  modifier: TagModifier\n  name: string\n  count: number\n}\n\nconst AliasWrapper = styled.div(\n  ({ theme }) => css`\n    ${flexRowWithGap({ theme })}\n    padding: 0 ${theme.dimensions.bigSpacing};\n    height: ${theme.dimensions.blockHeight};\n    font-size: ${theme.fontSizes.content};\n  `\n)\n\nexport default function Alias(props: AliasProps) {\n  const { name, count, modifier } = props\n\n  const dispatch = useDispatch()\n\n  const handleClick: MouseEventHandler = useCallback(\n    (event) => {\n      event.stopPropagation()\n      dispatch(addTag({ name, types: [], count, modifier }))\n    },\n    [count, dispatch, modifier, name]\n  )\n\n  return (\n    <AliasWrapper onClick={handleClick}>\n      <TagName modifier={modifier} name={name} count={count} />\n    </AliasWrapper>\n  )\n}\n","import React from 'react'\nimport styled, { css, DefaultTheme } from 'styled-components'\nimport Alias from './Alias'\nimport * as r34 from 'r34-types'\n\nconst ListWrapper = styled.div(\n  ({ theme, parentRef }: { theme: DefaultTheme; parentRef: HTMLDivElement }) => css`\n    position: absolute;\n    top: ${parentRef.offsetTop + parentRef.clientHeight + 4}px;\n    left: ${parentRef.offsetLeft}px;\n    width: ${parentRef.clientWidth + 5}px;\n\n    display: flex;\n    flex-direction: column;\n\n    border-bottom-left-radius: ${theme.dimensions.borderRadius};\n    border-bottom-right-radius: ${theme.dimensions.borderRadius};\n    border: ${theme.dimensions.borderWidth} solid ${theme.colors.accentColor};\n    border-top: none;\n\n    background: ${theme.colors.backgroundColor};\n    z-index: 3;\n    color: ${theme.colors.accentColor};\n\n    > :not(:last-child) {\n      border-bottom: ${theme.dimensions.borderWidth} solid ${theme.colors.accentColor};\n    }\n  `\n)\n\ninterface AliasesListProps {\n  aliases: r34.AliasTag[]\n  modifier: r34.TagModifier\n  parentRef: HTMLDivElement\n}\n\nexport default function AliasesList(props: AliasesListProps) {\n  const { aliases, modifier, parentRef } = props\n\n  return (\n    <ListWrapper parentRef={parentRef}>\n      {aliases.map(({ name, count }) => (\n        <Alias key={'a_' + name} name={name} count={count} modifier={modifier} />\n      ))}\n    </ListWrapper>\n  )\n}\n","import { MouseEventHandler } from 'react'\nimport styled, { css, DefaultTheme } from 'styled-components'\nimport { flexRowWithGap } from '../../styled/mixins'\n\nconst dropdownBorderRadius = (collapsed: boolean, theme: DefaultTheme) =>\n  collapsed ? theme.dimensions.borderRadius : `${theme.dimensions.borderRadius} ${theme.dimensions.borderRadius} 0 0`\n\nconst switchingColors = (active: boolean, theme: DefaultTheme) => {\n  const fg = active ? theme.colors.backgroundColor : theme.colors.accentColor\n  const bg = active ? theme.colors.accentColor : 'transparent'\n\n  return css`\n    color: ${fg};\n    background-color: ${bg};\n    border: ${theme.colors.accentColor} ${theme.dimensions.borderWidth} solid;\n    transition: all ${theme.timings.transitionTime} ease-out;\n\n    svg {\n      color: ${fg};\n    }\n\n    cursor: pointer;\n\n    :hover,\n    :focus,\n    :active {\n      border-color: ${theme.colors.backgroundColor2};\n      color: ${theme.colors.backgroundColor2};\n\n      svg {\n        color: ${theme.colors.backgroundColor2};\n      }\n    }\n\n    :active {\n      transform: scale(1.05);\n    }\n  `\n}\n\nexport const ChipWrapper = styled.div(\n  (props: { active: boolean; collapsed: boolean; onMouseLeave: MouseEventHandler; theme: DefaultTheme }) =>\n    css`\n      ${flexRowWithGap({ theme: props.theme })}\n      ${switchingColors(props.active, props.theme)}\n      padding: 0 ${props.theme.dimensions.gutter};\n      height: ${props.theme.dimensions.blockHeight};\n      border-radius: ${dropdownBorderRadius(props.collapsed, props.theme)};\n      font-size: ${props.theme.fontSizes.content};\n    `\n)\n","import React, { KeyboardEventHandler, MouseEventHandler, SyntheticEvent, useCallback, useState } from 'react'\r\nimport styled, { DefaultTheme, css } from 'styled-components'\r\nimport { TagModifier, TagType, AliasTag } from 'r34-types'\r\nimport useToggle from '../../hooks/useToggle'\r\nimport { ArrowDown } from '../../icons/FontAwesomeIcons'\r\nimport TypeIcon from '../../icons/TypeIcon'\r\nimport AliasesList from './AliasesList'\r\nimport { ChipWrapper } from './ChipWrapper'\r\nimport TagName from './TagName'\r\n\r\nconst DropdownArrow = styled(ArrowDown)(\r\n  ({ $collapsed, theme }: { $collapsed: boolean; theme: DefaultTheme }) => css`\r\n    transition: all ${theme.timings.transitionTime} ease-out;\r\n    height: 32px;\r\n    width: 32px !important;\r\n    padding: 8px;\r\n    margin: 0 -8px;\r\n    ${$collapsed\r\n      ? css``\r\n      : css`\r\n          transform: rotate(180deg);\r\n        `}\r\n  `\r\n)\r\n\r\ninterface TagChipProps {\r\n  name: string\r\n  modifier: TagModifier\r\n  count?: number\r\n  type?: TagType\r\n  isActive: boolean\r\n  detailed: boolean\r\n  onClick: React.EventHandler<SyntheticEvent>\r\n  aliases?: AliasTag[]\r\n}\r\n\r\nexport default function TagChip(props: TagChipProps) {\r\n  const { name, count, modifier, type, isActive, detailed, onClick, aliases } = props\r\n\r\n  const [tagRef, setTagRef] = useState<HTMLDivElement | null>(null)\r\n  const [collapsed, toggleCollapsed, resetCollapsed] = useToggle(true)\r\n\r\n  const handleClick = useCallback(\r\n    (event: React.MouseEvent | React.KeyboardEvent) => {\r\n      event.stopPropagation()\r\n      onClick(event)\r\n    },\r\n    [onClick]\r\n  )\r\n\r\n  const handleArrowClick: MouseEventHandler = useCallback(\r\n    (event) => {\r\n      event.stopPropagation()\r\n      toggleCollapsed()\r\n    },\r\n    [toggleCollapsed]\r\n  )\r\n\r\n  const handleEnter: KeyboardEventHandler = useCallback(\r\n    (event) => {\r\n      if (event.key === 'Enter') handleClick(event)\r\n    },\r\n    [handleClick]\r\n  )\r\n\r\n  return (\r\n    <ChipWrapper\r\n      active={isActive}\r\n      collapsed={collapsed}\r\n      onClick={handleClick}\r\n      onKeyDown={handleEnter}\r\n      onMouseLeave={resetCollapsed}\r\n      ref={setTagRef}\r\n    >\r\n      {detailed && <TypeIcon type={type} />}\r\n      <TagName modifier={modifier} name={name} count={count} />\r\n      {detailed && aliases && aliases.length > 0 && (\r\n        <>\r\n          <DropdownArrow onClick={handleArrowClick} $collapsed={collapsed} />\r\n          {!collapsed && tagRef && <AliasesList aliases={aliases} modifier={modifier} parentRef={tagRef} />}\r\n        </>\r\n      )}\r\n    </ChipWrapper>\r\n  )\r\n}\r\n","import React from 'react'\r\nimport * as r34 from 'r34-types'\r\nimport TagChip from './TagChip'\r\n\r\ninterface SupertagProps {\r\n  tag: r34.Supertag\r\n  isActive: boolean\r\n  detailed: boolean\r\n  onClick: React.MouseEventHandler\r\n}\r\n\r\nexport default function Supertag(props: SupertagProps) {\r\n  const { tag, isActive, detailed, onClick } = props\r\n  const { name, tags } = tag\r\n\r\n  const count = Object.keys(tags).length\r\n\r\n  return (\r\n    <TagChip\r\n      name={name}\r\n      modifier='+'\r\n      type='supertag'\r\n      count={count}\r\n      isActive={isActive}\r\n      detailed={detailed}\r\n      onClick={onClick}\r\n    />\r\n  )\r\n}\r\n","import * as r34 from 'r34-types'\r\nimport TagChip from './TagChip'\r\nimport { getInterestingType } from '../../data/tagUtils'\r\n\r\ninterface TagProps {\r\n  tag: r34.BiasedTag\r\n  isActive: boolean\r\n  detailed: boolean\r\n  onClick: React.MouseEventHandler\r\n}\r\n\r\nexport function BiasedTag(props: TagProps) {\r\n  const { tag, detailed, onClick, isActive } = props\r\n  const { name, count, modifier, types } = tag\r\n\r\n  return (\r\n    <TagChip\r\n      name={name}\r\n      modifier={modifier}\r\n      type={getInterestingType(types)}\r\n      count={count}\r\n      isActive={isActive}\r\n      detailed={detailed}\r\n      onClick={onClick}\r\n    />\r\n  )\r\n}\r\n","import React, { MouseEventHandler, useCallback } from 'react'\r\nimport * as r34 from 'r34-types'\r\nimport { bias, isBiased, isSupertag } from '../../data/tagUtils'\r\nimport Supertag from './Supertag'\r\nimport { BiasedTag } from './BiasedTag'\r\n\r\ninterface TagProps {\r\n  tag: r34.AnyBiasedTag | r34.AnyTag\r\n  isActive: boolean\r\n  detailed: boolean\r\n  onClick: (tag: r34.AnyBiasedTag) => void\r\n}\r\n\r\nexport default function Tag(props: TagProps) {\r\n  const { tag, isActive, detailed, onClick } = props\r\n\r\n  const biasedTag = isSupertag(tag) || isBiased(tag) ? tag : bias(tag, '+')\r\n\r\n  const handleClick: MouseEventHandler = useCallback(\r\n    (event) => {\r\n      event?.stopPropagation()\r\n      onClick(biasedTag)\r\n    },\r\n    [onClick, biasedTag]\r\n  )\r\n\r\n  return isSupertag(biasedTag) ? (\r\n    <Supertag tag={biasedTag} isActive={isActive} detailed={detailed} onClick={handleClick} />\r\n  ) : (\r\n    <BiasedTag tag={biasedTag} isActive={isActive} detailed={detailed} onClick={handleClick} />\r\n  )\r\n}\r\n","import React from 'react'\r\nimport styled, { css } from 'styled-components'\r\nimport { AnyBiasedTag, AnyTag } from 'r34-types'\r\nimport { flexRowGap, flexColumnGap } from '../../styled/mixins'\r\nimport Tag from './Tag'\r\n\r\nconst TagListWrapper = styled.div(\r\n  ({ theme }) => css`\r\n    display: inline-flex;\r\n    flex-wrap: wrap;\r\n    ${flexRowGap(theme.dimensions.gutter)}\r\n    ${flexColumnGap(theme.dimensions.gutter)}\r\n  `\r\n)\r\n\r\ninterface TagListProps {\r\n  /**\r\n   * The entries of the list. Must be a map to avoid duplicates\r\n   */\r\n  tags: Record<string, AnyTag>\r\n  /**\r\n   * Passthrough classname for styling from outside\r\n   */\r\n  className?: string\r\n  /**\r\n   * Setting detailed to true displays a type for some tags and provides the ability to add aliases.\r\n   */\r\n  detailed: boolean\r\n  /**\r\n   * Children will be added at the end of the list. Here you can provide additional functionality or information\r\n   */\r\n  children?: React.ReactNode\r\n\r\n  onTagClick: (tag: AnyBiasedTag) => void\r\n  getIsActive?: (tag: AnyTag) => boolean\r\n}\r\n\r\n/**\r\n * This component can be used to display multiple tags in a list of chips/badges.\r\n *\r\n */\r\nexport default function TagList(props: TagListProps) {\r\n  const { tags, className, detailed, children = null, onTagClick, getIsActive } = props\r\n\r\n  return (\r\n    <TagListWrapper className={className}>\r\n      {Object.entries(tags).map(([key, tag]) => (\r\n        <Tag key={key} detailed={detailed} tag={tag} onClick={onTagClick} isActive={getIsActive?.(tag) || false} />\r\n      ))}\r\n      {children}\r\n    </TagListWrapper>\r\n  )\r\n}\r\n","import styled from 'styled-components'\nimport { preserveAspectRatio, flexMedia } from '../../styled/mixins'\n\nconst FlexImage = styled.img`\n  ${flexMedia}\n  ${preserveAspectRatio}\n`\n\nexport default FlexImage\n","import { useCallback } from 'react'\r\nimport { useDispatch, useSelector } from 'react-redux'\r\nimport { removeTag, addTag } from '../redux/actions'\r\nimport { selectActiveTags } from '../redux/selectors'\r\nimport * as r34 from 'r34-types'\r\n\r\n/**\r\n * This hook allows you to add a tag to your search or remove it based on its current status.\r\n */\r\nexport default function useToggleTag() {\r\n  const dispatch = useDispatch()\r\n  const activeTags = useSelector(selectActiveTags)\r\n  const toggleTag = useCallback(\r\n    (tag: r34.AnyBiasedTag) => {\r\n      if (tag.name in activeTags) {\r\n        dispatch(removeTag(tag.name))\r\n      } else {\r\n        dispatch(addTag(tag))\r\n      }\r\n    },\r\n    [activeTags, dispatch]\r\n  )\r\n\r\n  return toggleTag\r\n}\r\n","import { useCallback, useState } from 'react'\nimport { TagModifier } from 'r34-types'\n\nconst order: TagModifier[] = ['+', '-', '~']\n\n/**\n * Small utility hook to abstract the rotating modifier away\n */\nexport default function useModifier(initialValue: TagModifier = '+') {\n  const [index, setIndex] = useState(order.indexOf(initialValue))\n  const nextModifier = useCallback(() => setIndex((index + 1) % order.length), [index])\n\n  return [order[index], nextModifier] as const\n}\n","import React, { MouseEventHandler } from 'react'\nimport styled, { css } from 'styled-components'\nimport { TagType } from 'r34-types'\nimport TypeIcon from '../../icons/TypeIcon'\nimport { formatCount, formatTagname } from '../../misc/formatting'\n\nconst EntryWrapper = styled.div(\n  ({ theme }) => css`\n    display: grid;\n    grid-template-columns: 48px 1fr auto;\n    min-height: ${theme.dimensions.blockHeight}; // COMPAT: Kiwi Browser\n    height: ${theme.dimensions.blockHeight};\n    background: ${theme.colors.backgroundColor2};\n    align-items: center;\n    cursor: pointer;\n  `\n)\n\nconst Name = styled.span`\n  grid-column: 2/3;\n`\n\nconst Count = styled.span(\n  ({ theme }) => css`\n    grid-column: 3/4;\n    padding-right: ${theme.dimensions.bigSpacing};\n  `\n)\n\nconst Icon = styled.div`\n  grid-column: 1/2;\n  text-align: center;\n`\n\ntype Unit = 'tags' | 'posts'\n\ninterface EntryProps {\n  name: string\n  count: number\n  type?: TagType\n  onClick: MouseEventHandler\n}\n\nexport default function DropdownListEntry(props: EntryProps) {\n  const { name, count, type, onClick } = props\n\n  const unit: Unit = type === 'supertag' ? 'tags' : 'posts'\n\n  return (\n    <EntryWrapper onClick={onClick}>\n      <Icon>\n        <TypeIcon type={type} />\n      </Icon>\n      <Name>{formatTagname(name)}</Name>\n      <Count>\n        {count && formatCount(count)} {unit}\n      </Count>\n    </EntryWrapper>\n  )\n}\n","import React from 'react'\nimport styled, { css, DefaultTheme } from 'styled-components'\nimport DropdownListEntry from './DropdownListEntry'\nimport { flexColumn, flexColumnGap } from '../../styled/mixins'\nimport * as r34 from 'r34-types'\nimport { getInterestingType, isSupertag } from '../../data/tagUtils'\n\nfunction sizeAndPosition(tagSelector: HTMLDivElement | null) {\n  if (tagSelector) {\n    const { offsetTop, clientHeight, offsetLeft, clientWidth } = tagSelector\n\n    return css`\n      position: absolute;\n      top: ${offsetTop + clientHeight}px;\n      left: ${offsetLeft}px;\n      width: ${clientWidth}px;\n      max-height: 50vh;\n    `\n  } else {\n    return css`\n      display: none;\n    `\n  }\n}\n\nconst ListWrapper = styled.div(\n  ({ theme, tagSelectorRef }: { tagSelectorRef: HTMLDivElement | null; theme: DefaultTheme }) => css`\n    ${flexColumn()}\n    ${flexColumnGap('1px')}\n    ${sizeAndPosition(tagSelectorRef)};\n    background: lightgrey;\n    box-sizing: border-box;\n    border: ${theme.dimensions.borderWidth} ${theme.colors.accentColor} solid;\n    border-top: none;\n    border-radius: 0 0 3px 3px;\n    color: black;\n    overflow-y: auto;\n    z-index: 3;\n\n    ::-webkit-scrollbar {\n      width: 8px;\n\n      :hover {\n        background: ${theme.colors.layerBg};\n      }\n    }\n\n    /* Track */\n    ::-webkit-scrollbar-track {\n      background: ${theme.colors.backgroundColor2};\n      border-left: 1px lightgray solid;\n    }\n\n    /* Handle */\n    :hover {\n      ::-webkit-scrollbar {\n        background: ${theme.colors.backgroundColor}20;\n      }\n    }\n\n    ::-webkit-scrollbar-thumb {\n      background: ${theme.colors.backgroundColor}40;\n      border-radius: 1000px;\n\n      :hover {\n        background: ${theme.colors.backgroundColor}30;\n      }\n    }\n  `\n)\n\ninterface DropdownListProps {\n  tagSelectorRef: HTMLDivElement | null\n  entries: r34.AnyTag[]\n  onClick: (entry: r34.AnyTag) => void\n}\n\nexport default function DropdownList(props: DropdownListProps) {\n  const { tagSelectorRef, entries, onClick } = props\n\n  return entries.length > 0 ? (\n    <ListWrapper tagSelectorRef={tagSelectorRef}>\n      {entries.map((entry) => {\n        const type = isSupertag(entry) ? 'supertag' : getInterestingType(entry.types)\n        const count = isSupertag(entry) ? Object.keys(entry.tags).length : (entry.count as number)\n\n        return (\n          <DropdownListEntry\n            key={entry.name}\n            onClick={() => onClick(entry)}\n            name={entry.name}\n            type={type}\n            count={count}\n          />\n        )\n      })}\n    </ListWrapper>\n  ) : null\n}\n","import React, { ChangeEventHandler, KeyboardEventHandler, useCallback } from 'react'\nimport styled, { css } from 'styled-components'\n\nconst Input = styled.input(\n  (props) => css`\n    width: 100%;\n    border: none;\n    outline: none;\n    background: none;\n    font-size: ${props.theme.fontSizes.content};\n    border-top: ${props.theme.colors.accentColor} ${props.theme.dimensions.borderWidth} solid;\n    border-bottom: ${props.theme.colors.accentColor} ${props.theme.dimensions.borderWidth} solid;\n  `\n)\n\ninterface TagInputProps {\n  value: string\n  setValue: (newValue: string) => void\n  onSubmit: () => void\n}\n\nexport default function TagInput(props: TagInputProps) {\n  const { value, setValue, onSubmit } = props\n\n  const handleChange: ChangeEventHandler<HTMLInputElement> = useCallback(\n    (event) => {\n      setValue(event.target.value)\n    },\n    [setValue]\n  )\n\n  const handleEnter: KeyboardEventHandler = useCallback(\n    (event: React.KeyboardEvent) => {\n      if (event.key === 'Enter') {\n        onSubmit()\n      }\n    },\n    [onSubmit]\n  )\n\n  return (\n    <Input\n      id='tag-input'\n      value={value}\n      onChange={handleChange}\n      onKeyDown={handleEnter}\n      placeholder='Search for tags'\n      aria-label='Search'\n    />\n  )\n}\n","import React, { useCallback, useState } from 'react'\nimport { useDispatch, useSelector } from 'react-redux'\nimport styled, { css, DefaultTheme } from 'styled-components'\nimport useThrottledEffect from 'use-throttled-effect'\nimport useModifier from '../../hooks/useModifier'\nimport { fetchSuggestions, setSuggestions } from '../../redux/actions'\nimport { selectSuggestions } from '../../redux/selectors'\nimport { AddButton, ModifierButton } from '../common/Buttons'\nimport DropdownList from './DropdownList'\nimport TagInput from './TagInput'\nimport { PlusIcon } from '../../icons/FontAwesomeIcons'\nimport { Supertag, Tag, AnyBiasedTag, AnyTag } from 'r34-types'\nimport { bias, isSupertag, serializeTagname } from '../../data/tagUtils'\n\nconst TagSelectorWrapper = styled.div(\n  (props: { closed: boolean; ref: (ref: HTMLInputElement) => void; theme: DefaultTheme }) => css`\n    display: flex;\n    background: white;\n    ${props.closed\n      ? css`\n          border-radius: ${props.theme.dimensions.borderRadius};\n        `\n      : css`\n          border-radius: ${props.theme.dimensions.borderRadius} ${props.theme.dimensions.borderRadius} 0 0;\n\n          > ${AddButton} {\n            border-radius: 0 ${props.theme.dimensions.borderRadius} 0 0;\n          }\n\n          > ${ModifierButton} {\n            border-radius: ${props.theme.dimensions.borderRadius} 0 0 0;\n          }\n        `}\n  `\n)\n\ntype TagSelectorProps = {\n  showSupertags: boolean\n  onSubmit: (tag: AnyBiasedTag) => void\n}\n\nexport default function TagSelector(props: TagSelectorProps) {\n  const { onSubmit, showSupertags } = props\n\n  const dispatch = useDispatch()\n\n  const [value, setValue] = useState('')\n  const [tagSelectorRef, setTagSelectorRef] = useState<HTMLDivElement | null>(null)\n  const [modifier, nextModifier] = useModifier()\n\n  const suggestions = useSelector(selectSuggestions)\n\n  const activateTag = useCallback(\n    (tag: Tag | Supertag) => {\n      const biasedTag = isSupertag(tag) ? tag : bias(tag, modifier)\n      onSubmit(biasedTag)\n      setValue('')\n    },\n    [modifier, onSubmit]\n  )\n\n  // This effect fetches suggestions for the input value if the value\n  // is empty, it ensures the suggestions are as well\n  useThrottledEffect(\n    () => {\n      if (value === '') {\n        if (suggestions.length > 0) {\n          dispatch(setSuggestions([]))\n        }\n      }\n      if (value.length >= 3) {\n        dispatch(fetchSuggestions(value, showSupertags))\n      }\n    },\n    300,\n    [value]\n  )\n\n  const handleAddClick = useCallback(() => {\n    if (value.trim()) {\n      const sanitizedTagname = serializeTagname(value)\n      const suggestion: AnyTag | undefined = suggestions.find((s) => s.name === sanitizedTagname)\n\n      if (suggestion) activateTag(suggestion)\n    }\n  }, [value, activateTag, suggestions])\n\n  const hasSuggestions = suggestions.length > 0\n\n  return (\n    <TagSelectorWrapper ref={setTagSelectorRef} closed={!hasSuggestions}>\n      <ModifierButton onClick={nextModifier} aria-label='Tag Modifier'>\n        {modifier}\n      </ModifierButton>\n      <TagInput value={value} setValue={setValue} onSubmit={handleAddClick} />\n      <AddButton onClick={handleAddClick} aria-label='Add Tag'>\n        <PlusIcon />\n      </AddButton>\n      {hasSuggestions && value.length > 0 && (\n        <DropdownList tagSelectorRef={tagSelectorRef} entries={suggestions} onClick={activateTag} />\n      )}\n    </TagSelectorWrapper>\n  )\n}\n","import React, { useCallback } from 'react'\r\nimport { signOut } from '../../firebase'\r\nimport { UndoIcon } from '../../icons/FontAwesomeIcons'\r\nimport { BlockButton } from '../common/Buttons'\r\n\r\nexport default function ResetButton(props: any) {\r\n  const reset = useCallback(async () => {\r\n    localStorage.clear()\r\n    await signOut()\r\n\r\n    window.location.hash = ''\r\n    window.location.reload()\r\n  }, [])\r\n\r\n  return (\r\n    <BlockButton onClick={reset} {...props}>\r\n      <UndoIcon /> Reset Results\r\n    </BlockButton>\r\n  )\r\n}\r\n","export default __webpack_public_path__ + \"static/media/OutOfResults.9c71691c.png\";","import React from 'react'\nimport styled from 'styled-components'\n\n// Don't use theme here so the loadingScreen is independent\nconst StyledSvg = styled.svg`\n  height: 32px;\n  padding: 8px;\n`\n\nexport default function Loading() {\n  return (\n    <StyledSvg\n      xmlns='http://www.w3.org/2000/svg'\n      xmlnsXlink='http://www.w3.org/1999/xlink'\n      viewBox='0 0 50 20'\n      enable-background='new 0 0 0 0'\n      xmlSpace='preserve'\n    >\n      <circle fill='#fff' stroke='none' cx='6' cy='10' r='6'>\n        <animate attributeName='opacity' dur='1s' values='0;1;0' repeatCount='indefinite' begin='0.1' />\n      </circle>\n      <circle fill='#fff' stroke='none' cx='25' cy='10' r='6'>\n        <animate attributeName='opacity' dur='1s' values='0;1;0' repeatCount='indefinite' begin='0.2' />\n      </circle>\n      <circle fill='#fff' stroke='none' cx='44' cy='10' r='6'>\n        <animate attributeName='opacity' dur='1s' values='0;1;0' repeatCount='indefinite' begin='0.3' />\n      </circle>\n    </StyledSvg>\n  )\n}\n","import { useTheme } from 'styled-components'\n\nexport default function R34Icon(props: { size: number; className?: string }) {\n  const theme = useTheme()\n\n  return (\n    <svg\n      xmlns='http://www.w3.org/2000/svg'\n      width={props.size}\n      height={props.size}\n      viewBox='0 0 12.7 12.7'\n      className={props.className}\n    >\n      <g transform='translate(0,-284.3)'>\n        <circle\n          id='path18'\n          cx='6.3499999'\n          cy='290.65002'\n          fill='none'\n          stroke={theme.colors.accentColor}\n          strokeWidth='0.50848764'\n          strokeMiterlimit='4'\n          strokeDasharray='none'\n          strokeOpacity='1'\n          r='6.0957561'\n        />\n        <text\n          fontStyle='normal'\n          fontWeight='normal'\n          fontSize='8.3113203px'\n          fontFamily='sansSerif'\n          letterSpacing='0px'\n          wordSpacing='0px'\n          fill={theme.colors.accentColor}\n          fillOpacity='1'\n          x='2.1363549'\n          y='289.02704'\n          id='text4533'\n          transform='scale(0.98538224,1.0148346)'\n        >\n          <tspan\n            id='tspan4531'\n            x='2'\n            y='289.1'\n            fontStyle='normal'\n            fontVariant='normal'\n            fontWeight='300'\n            fontStretch='normal'\n            fontFamily='Calibri'\n            fill={theme.colors.accentColor}\n            fillOpacity='1'\n          >\n            34\n          </tspan>\n        </text>\n      </g>\n    </svg>\n  )\n}\n","import React, { useCallback, useEffect } from 'react'\nimport { useDispatch, useSelector } from 'react-redux'\nimport { ModalId, NO_OP } from '../../data/types'\nimport { useCheckIsActive } from '../../hooks/useCheckIsActive'\nimport useToggleTag from '../../hooks/useToggleTag'\nimport { SupertagIcon } from '../../icons/FontAwesomeIcons'\nimport { openModal } from '../../redux/actions'\nimport { selectActiveTags, selectNumberOfActiveTags } from '../../redux/selectors'\nimport { RedButton } from '../common/Buttons'\nimport TagList from '../tag/TagList'\n\ninterface ActiveTagsProps {\n  onChange?: () => void\n  offerSupertags?: boolean\n}\n\nexport default function ActiveTags(props: ActiveTagsProps) {\n  const { onChange = NO_OP, offerSupertags = false } = props\n\n  const dispatch = useDispatch()\n\n  const activeTags = useSelector(selectActiveTags)\n  const numberOfActiveTags = useSelector(selectNumberOfActiveTags)\n  const openSupertagModal = useCallback(() => dispatch(openModal(ModalId.CREATE_SUPERTAG)), [dispatch])\n\n  const toggleTag = useToggleTag()\n  const checkIsActive = useCheckIsActive()\n\n  // Fire change event when tags change\n  // This is used to re-measure the height\n  useEffect(() => onChange(), [onChange, activeTags])\n\n  return numberOfActiveTags > 0 ? (\n    <TagList tags={activeTags} detailed={true} onTagClick={toggleTag} getIsActive={checkIsActive}>\n      {offerSupertags && Object.keys(activeTags).length > 1 && (\n        <RedButton onClick={openSupertagModal} title='Create a supertag'>\n          <SupertagIcon />\n        </RedButton>\n      )}\n    </TagList>\n  ) : null\n}\n","import { useCallback } from 'react'\r\nimport { useSelector } from 'react-redux'\r\nimport { AnyTag } from '../../../r34-types'\r\nimport { selectActiveTags } from '../redux/selectors'\r\n\r\nexport const useCheckIsActive = () => {\r\n  const activeTags = useSelector(selectActiveTags)\r\n\r\n  return useCallback(\r\n    (tag: AnyTag) => {\r\n      return tag.name in activeTags\r\n    },\r\n    [activeTags]\r\n  )\r\n}\r\n","import * as r34 from 'r34-types'\r\nimport { useCallback } from 'react'\r\nimport { useDispatch } from 'react-redux'\r\nimport { addTag } from '../redux/actions'\r\n\r\nexport const useActivateTag = () => {\r\n  const dispatch = useDispatch()\r\n\r\n  return useCallback(\r\n    (tag: r34.AnyBiasedTag) => {\r\n      dispatch(addTag(tag))\r\n    },\r\n    [dispatch]\r\n  )\r\n}\r\n","import React, { ReactNode } from 'react'\r\n\r\ninterface ErrorBoundaryProps {\r\n  fallback: ReactNode\r\n  children: ReactNode\r\n}\r\n\r\ninterface ErrorBoundaryState {\r\n  hasError: boolean\r\n}\r\n\r\nexport default class ErrorBoundary extends React.Component<ErrorBoundaryProps, ErrorBoundaryState> {\r\n  constructor(props: ErrorBoundaryProps) {\r\n    super(props)\r\n    this.state = { hasError: false }\r\n  }\r\n\r\n  static getDerivedStateFromError(error: Error) {\r\n    return { hasError: true }\r\n  }\r\n\r\n  render() {\r\n    if (this.state.hasError) {\r\n      return this.props.fallback\r\n    }\r\n\r\n    return this.props.children\r\n  }\r\n}\r\n","import { DefaultTheme } from 'styled-components'\r\n\r\nconst dark: DefaultTheme = {\r\n  dimensions: {\r\n    borderRadius: '3px',\r\n    borderWidth: '2px',\r\n    spacing: '4px',\r\n    bigSpacing: '8px',\r\n    hugeSpacing: '16px',\r\n    gutter: '8px',\r\n    blockHeight: '32px',\r\n    bodyWidth: '1000px',\r\n  },\r\n  colors: {\r\n    //basic\r\n    text: '#fff',\r\n    backgroundColor: '#121212',\r\n    backgroundColor2: '#fff',\r\n    subduedText: '#ffffff80',\r\n    layerBg: '#ffffff11',\r\n    layerBgSolid: '#222222',\r\n    layerBgHighlight: '#ffffff22',\r\n\r\n    // theme\r\n    accentColor: '#ee3344',\r\n    hoverAccent: '#ff4455',\r\n\r\n    // semantic\r\n    liked: '#ff0d50',\r\n    positive: '#40ee40',\r\n    negative: '#dd1010',\r\n  },\r\n  shadow: {\r\n    radius: '4px',\r\n    color: 'transparent',\r\n  },\r\n  timings: {\r\n    transitionTime: '0.2s',\r\n    longTransitionTime: '0.2s',\r\n  },\r\n  fontSizes: {\r\n    content: '15px',\r\n    bigTitle: '24px',\r\n  },\r\n}\r\n\r\nexport default dark\r\n","import { DefaultTheme } from 'styled-components'\r\nimport { Theme } from 'r34-types'\r\nimport light from './light'\r\nimport dark from './dark'\r\nimport coffee from './coffee'\r\nimport electric from './electric'\r\nimport deepsea from './deepsea'\r\n\r\nconst themes: Record<Theme, DefaultTheme> = {\r\n  dark,\r\n  light,\r\n  coffee,\r\n  electric,\r\n  deepsea,\r\n}\r\n\r\nexport default themes\r\n\r\nexport const defaultThemeId = 'dark'\r\n","import dark from './dark'\r\n\r\nconst light = {\r\n  ...dark,\r\n  colors: {\r\n    ...dark.colors,\r\n    text: '#000',\r\n    backgroundColor: '#eee',\r\n    backgroundColor2: '#eee',\r\n    subduedText: '#00000080',\r\n    layerBg: '#ffffff',\r\n    layerBgSolid: '#ffffff',\r\n    layerBgHighlight: '#00000022',\r\n  },\r\n  shadow: {\r\n    ...dark.shadow,\r\n    color: 'transparent',\r\n  },\r\n}\r\n\r\nexport default light\r\n","import dark from './dark'\r\n\r\nconst coffee = {\r\n  ...dark,\r\n  colors: {\r\n    ...dark.colors,\r\n    backgroundColor: '#161410',\r\n    backgroundColor2: '#fff',\r\n    layerBg: '#ffffff11',\r\n    layerBgSolid: '#262420',\r\n    layerBgHighlight: '#ffffff22',\r\n  },\r\n}\r\n\r\nexport default coffee\r\n","import dark from './dark'\r\n\r\nconst electric = {\r\n  ...dark,\r\n  colors: {\r\n    ...dark.colors,\r\n    accentColor: '#2ae',\r\n    hoverAccent: '#2ae',\r\n  },\r\n}\r\n\r\nexport default electric\r\n","import dark from './dark'\r\n\r\nconst deepsea = {\r\n  ...dark,\r\n  colors: {\r\n    ...dark.colors,\r\n    backgroundColor: '#010917',\r\n    backgroundColor2: '#eef',\r\n    layerBg: '#ffffff11',\r\n    layerBgSolid: '#111929',\r\n    layerBgHighlight: '#ffffff22',\r\n    accentColor: '#4090bb',\r\n    hoverAccent: '#4090bb',\r\n  },\r\n}\r\n\r\nexport default deepsea\r\n","import { createGlobalStyle, css } from 'styled-components'\n\nexport default createGlobalStyle(\n  ({ theme }) => css`\n    * {\n      margin: 0;\n      padding: 0;\n      box-sizing: border-box;\n\n      font-family: 'Raleway', sans-serif;\n      -webkit-font-smoothing: antialiased;\n      -moz-osx-font-smoothing: grayscale;\n\n      :focus {\n        outline: none;\n      }\n    }\n\n    html,\n    body,\n    #app-root {\n      width: 100%;\n      height: 100%;\n    }\n\n    body {\n      font-size: ${theme.fontSizes.content};\n      color: ${theme.colors.text};\n      background-color: ${theme.colors.backgroundColor};\n      transition: color 0.4s, background-color 0.4s;\n    }\n\n    a {\n      color: ${theme.colors.accentColor};\n      text-decoration: none;\n    }\n\n    // Not a touch device\n    // Touch devices have nice scrollbars by default\n    @media (pointer: fine) {\n      // Underline stuff that is focused on non-touch devices\n      // makes keyboard navigation clearer\n      :focus {\n        text-decoration: underline;\n      }\n\n      ::-webkit-scrollbar {\n        height: 8px;\n        transition: all ${theme.timings.transitionTime} ease-in-out;\n\n        :hover {\n          background: ${theme.colors.layerBg};\n        }\n      }\n\n      /* Track */\n      ::-webkit-scrollbar-track {\n        background: transparent;\n      }\n\n      /* Handle */\n      :hover {\n        ::-webkit-scrollbar {\n          background: ${theme.colors.layerBg};\n        }\n      }\n\n      ::-webkit-scrollbar-thumb {\n        background: ${theme.colors.layerBg};\n        border-radius: 1000px;\n\n        :hover {\n          background: ${theme.colors.layerBgHighlight};\n        }\n      }\n    }\n  `\n)\n","import React from 'react'\r\nimport styled from 'styled-components'\r\nimport ResetButton from '../widgets/ResetButton'\r\nimport outOfResultsPicture from '../../icons/OutOfResults.png'\r\nimport FlexImage from '../common/FlexImage'\r\nimport themes, { defaultThemeId } from '../../styled/themes'\r\nimport GlobalStyles from '../../GlobalStyles'\r\n\r\nconst FullScreenCentered = styled.div`\r\n  height: 100vh;\r\n  width: 100%;\r\n  display: grid;\r\n  place-items: center;\r\n  align-content: center;\r\n  padding: 30px;\r\n  background: ${({ theme }) => theme.colors.backgroundColor};\r\n\r\n  > * {\r\n    margin-bottom: 10px;\r\n  }\r\n`\r\n\r\nexport default function ErrorScreen() {\r\n  const theme = themes[defaultThemeId]\r\n  return (\r\n    <FullScreenCentered theme={theme}>\r\n      <GlobalStyles theme={theme} />\r\n      <FlexImage src={outOfResultsPicture} alt='Shironeko does not understand' />\r\n      <h1>Sorry about that...</h1>\r\n      <ResetButton theme={theme} />\r\n    </FullScreenCentered>\r\n  )\r\n}\r\n","import React from 'react'\r\nimport styled from 'styled-components'\r\nimport Loading from '../../icons/Loading'\r\n\r\nconst FullScreenCentered = styled.div`\r\n  height: 100%;\r\n  width: 100%;\r\n  display: grid;\r\n  place-items: center;\r\n`\r\n\r\nexport default function LoadingScreen() {\r\n  return (\r\n    <FullScreenCentered>\r\n      <Loading />\r\n    </FullScreenCentered>\r\n  )\r\n}\r\n","import React, { useCallback } from 'react'\nimport styled, { css } from 'styled-components'\nimport { RedButton } from '../common/Buttons'\nimport usePreference from '../../hooks/usePreference'\n\nconst CookieWrapper = styled.div(\n  ({ theme }) => css`\n    position: fixed;\n    bottom: 0;\n    left: 0;\n    width: 100%;\n    display: flex;\n    align-items: center;\n    justify-content: space-between;\n    color: ${theme.colors.text};\n    background: ${theme.colors.layerBgSolid};\n    padding: ${theme.dimensions.gutter};\n    z-index: 100;\n  `\n)\n\nconst StyledSpan = styled.span`\n  height: min-content;\n`\n\nexport default function CookieConfirmation() {\n  const [cookies, setCookies] = usePreference('cookies')\n\n  const handleAccept = useCallback(() => setCookies(true), [setCookies])\n\n  return cookies ? null : (\n    <CookieWrapper>\n      <StyledSpan>This website uses cookies.</StyledSpan>\n      <RedButton onClick={handleAccept} aria-label='Allow Cookies'>\n        Okay\n      </RedButton>\n    </CookieWrapper>\n  )\n}\n","enum AnalyticsEventId {\n  SEARCH = 'r34_search',\n}\n\nexport type SearchEvent = {\n  id: AnalyticsEventId.SEARCH\n  payload: {\n    page_number: number\n  }\n}\n\n/**\n * Should be called whenever a new search is started.\n */\nexport const searchEvent = (page_number: number): SearchEvent => ({\n  id: AnalyticsEventId.SEARCH,\n  payload: {\n    page_number,\n  },\n})\n","import { MiddlewareAPI } from 'redux'\r\nimport { Dispatch } from 'react'\r\nimport {\r\n  AppAction,\r\n  FETCH_PREFERENCES,\r\n  savePreferences,\r\n  SAVE_PREFERENCES,\r\n  setPreferences,\r\n  SET_PREFERENCE,\r\n} from '../actions'\r\nimport * as firebaseFunctions from '../../firebase'\r\n\r\nlet saveTimeout: NodeJS.Timeout\r\n\r\nconst persistence = (store: MiddlewareAPI) => (next: Dispatch<AppAction>) => async (action: AppAction) => {\r\n  if (action.type === SET_PREFERENCE) {\r\n    if (saveTimeout) {\r\n      clearTimeout(saveTimeout)\r\n    }\r\n\r\n    saveTimeout = setTimeout(() => {\r\n      store.dispatch(savePreferences())\r\n    }, 10000)\r\n  }\r\n\r\n  if (action.type === FETCH_PREFERENCES) {\r\n    const preferences = await firebaseFunctions.getPreferences()\r\n\r\n    if (preferences) {\r\n      store.dispatch(setPreferences(preferences))\r\n    }\r\n  }\r\n\r\n  if (action.type === SAVE_PREFERENCES) {\r\n    const { preferences } = store.getState()\r\n    firebaseFunctions.setPreferences(preferences)\r\n  }\r\n\r\n  next(action)\r\n}\r\n\r\nexport default persistence\r\n","import { AppAction, SET_POSTS, ADD_POSTS } from '../actions'\r\n\r\nimport { searchEvent } from '../../analytics/events'\r\nimport { selectPageNumber, selectCookies } from '../selectors'\r\nimport { MiddlewareAPI, Dispatch } from 'redux'\r\nimport { logEvent } from '../../firebase'\r\n\r\nconst eventLogging = (store: MiddlewareAPI<any>) => (next: Dispatch<AppAction>) => (action: AppAction) => {\r\n  const state = store.getState()\r\n  const cookies = selectCookies(state)\r\n\r\n  // Only send analytics if the user consented\r\n  if (cookies) {\r\n    if (action.type === ADD_POSTS || action.type === SET_POSTS) {\r\n      const pageNumber = selectPageNumber(state)\r\n      logEvent(searchEvent(pageNumber))\r\n    }\r\n  }\r\n\r\n  next(action)\r\n}\r\n\r\nexport default eventLogging\r\n","import firebase from 'firebase/app'\nimport 'firebase/auth'\nimport { getSupertags } from '../firebase'\nimport * as r34 from 'r34-types'\nimport { getTagParameter } from '../data/tagUtils'\n\nconst sourceTags: r34.Tag[] = [\n  { name: 'source:*patreon*', count: 12711, types: ['source'] },\n  { name: 'source:*twitter*', count: 99927, types: ['source'] },\n  { name: 'source:*pixiv*', count: 185080, types: ['source'] },\n]\n\nconst ratingTags: r34.Tag[] = [\n  { name: 'rating:safe', count: 14293, types: ['rating'] },\n  { name: 'rating:questionable', count: 219552, types: ['rating'] },\n  { name: 'rating:explicit', count: 3821144, types: ['rating'] },\n]\n\nclass API {\n  readonly defaultPageSize = 20\n  readonly apiLocal = 'http://localhost:8080'\n  readonly apiUrl1 = 'https://r34-json.herokuapp.com'\n  readonly apiUrl2 = 'https://r34-api-clone.herokuapp.com'\n\n  private target: 'local' | 'live' = 'live'\n  private version: 'v1' | 'v2' = 'v2'\n  private activeApi!: string\n\n  constructor() {\n    this.setActiveApi()\n  }\n\n  /**\n   * Switches between remote prod api and local dev api\n   */\n  setTarget(target: 'live' | 'local') {\n    this.target = target\n    this.setActiveApi()\n  }\n\n  /**\n   * Sets the api version to use.\n   */\n  setVersion(version: 'v1' | 'v2') {\n    this.version = version\n    this.setActiveApi()\n  }\n\n  /**\n   * Updates the base url with new configuration.\n   * In case \"live\" api fails it will fallback to the backup.\n   */\n  setActiveApi() {\n    if (this.target === 'local') {\n      this.activeApi = `${this.apiLocal}/${this.version}`\n    } else {\n      this.activeApi = `${this.apiUrl1}/${this.version}`\n\n      // Failover to apiUrl2\n      fetch(this.activeApi).catch(() => (this.activeApi = `${this.apiUrl2}/${this.version}`))\n    }\n  }\n\n  /**\n   * Retrieves tags given a searchTerm\n   */\n  private async fetchTags(searchTerm: string, limit: number): Promise<r34.Tag[]> {\n    return await (await fetch(`${this.activeApi}/tags?limit=${limit}&name=${searchTerm}&sort=count`)).json()\n  }\n\n  async getTags(searchTerm: string, limit: number = this.defaultPageSize, includeSupertags = false) {\n    let tags: r34.AnyTag[] = await this.fetchTags(`*${searchTerm}*`, limit)\n\n    // request more specific if we get blcoked by the api\n    // if (tags.length === 0) tags = await this.fetchTags(`${searchTerm}*`, limit)\n    // if (tags.length === 0) tags = await this.fetchTags(`${searchTerm}`, limit)\n\n    if (includeSupertags) {\n      try {\n        const supertags = await getSupertags()\n        if (supertags) {\n          const matchingSupertags = Object.entries(supertags)\n            .filter(([name, details]) => name.toLowerCase().includes(searchTerm.toLowerCase()))\n            .map(([name, details]) => ({\n              name,\n              ...details,\n            }))\n          tags = [...matchingSupertags, ...tags]\n        }\n      } catch {\n        // do nothing as supertags are optional\n      }\n    }\n\n    // HACKY: Inject suggestions for ratings and some sources\n    const matchingRating = ratingTags.filter((tag) => tag.name.includes(searchTerm.replace('rating:', '')))\n    tags = [...matchingRating, ...tags]\n\n    const matchingSourceTags = sourceTags.filter((tag) => tag.name.includes(searchTerm.replace('source:', '')))\n    tags = [...matchingSourceTags, ...tags]\n\n    return tags\n  }\n\n  /**\n   * This function can be used to retrieve a number of posts from the backend.\n   */\n  async getPosts(\n    tags: Record<string, r34.AnyBiasedTag>,\n    limit: number = this.defaultPageSize,\n    pageNumber = 0,\n    minScore = 0,\n    sort: r34.PostsSort = 'date',\n    hideSeen = false\n  ) {\n    const idToken = await firebase.auth().currentUser?.getIdToken()\n    const url = this.buildPostUrl(pageNumber, tags, { minScore, limit, sort, hideSeen })\n    const apiResponse = await fetch(url, {\n      headers: {\n        Authorization: 'Bearer ' + idToken,\n      },\n    })\n    const data: r34.PostsResponse = await apiResponse.json()\n\n    return data\n  }\n\n  /**\n   * Returns all aliases for a given tag\n   */\n  async getAliases(tagName: string) {\n    const aliases: r34.AliasTag[] = await (await fetch(`${this.activeApi}/alias/${encodeURIComponent(tagName)}`)).json()\n\n    return aliases\n  }\n\n  /**\n   * Returns all comments for a given post.\n   */\n  async getComments(post: r34.Post) {\n    const comments: r34.Comment[] = await (await fetch(post.comments_url)).json()\n\n    return comments\n  }\n\n  /**\n   * Constructs an api url that will return posts that match your parameters\n   */\n  buildPostUrl(\n    page: number,\n    tags: Record<string, r34.QueryTag | r34.Supertag>,\n    options: {\n      minScore?: number\n      limit?: number\n      sort?: r34.PostsSort\n      hideSeen?: boolean\n    } = {}\n  ) {\n    const { minScore = 0, limit = api.defaultPageSize, sort = 'date', hideSeen = false } = options\n    const params = {\n      pid: page,\n      limit,\n      hideSeen,\n      tags: getTagParameter(tags, minScore, sort),\n    }\n\n    return `${api.activeApi}/posts?${Object.entries(params)\n      .map(([key, value]) => (value === '' || value === false ? null : `${key}=${value}`))\n      .filter((i) => i !== null)\n      .join('&')}`\n  }\n}\n\nexport const api = new API()\n","import { MiddlewareAPI } from 'redux'\nimport { Dispatch } from 'react'\nimport {\n  AppAction,\n  GET_RESULTS,\n  GET_MORE_RESULTS,\n  addPosts,\n  setPosts,\n  ADD_TAG,\n  addAliases,\n  LIKE_POST,\n  FETCH_SUGGESTIONS,\n  setSuggestions,\n  FETCH_COMMENTS,\n  setComments,\n} from '../actions'\nimport { api } from '../../misc/api'\nimport {\n  selectActiveTags,\n  selectPageNumber,\n  selectHasMoreResults,\n  selectMinRating,\n  selectPageSize,\n  selectSort,\n  selectTagSuggestionCount,\n  selectPostById,\n  selectHideSeen,\n} from '../selectors'\nimport { isSupertag, serializeTagname } from '../../data/tagUtils'\n\nconst apiRequests = (store: MiddlewareAPI) => (next: Dispatch<AppAction>) => async (action: AppAction) => {\n  const state = store.getState()\n  const hasMoreResults = selectHasMoreResults(state)\n\n  if (action.type === GET_RESULTS) {\n    const activeTags = selectActiveTags(state)\n    const pageSize = selectPageSize(state)\n    const minRating = selectMinRating(state)\n    const sort = selectSort(state)\n    const hideSeen = selectHideSeen(state)\n\n    const result = await api.getPosts(activeTags, pageSize, action.pageNumber, minRating, sort, hideSeen)\n\n    store.dispatch(setPosts(result.posts, result.count, action.pageNumber))\n  }\n\n  if (action.type === GET_MORE_RESULTS && hasMoreResults) {\n    const activeTags = selectActiveTags(state)\n    const pageNumber = selectPageNumber(state)\n    const pageSize = selectPageSize(state)\n    const minRating = selectMinRating(state)\n    const sort = selectSort(state)\n    const hideSeen = selectHideSeen(state)\n    console.log('hide seen', hideSeen)\n\n    const res = await api.getPosts(activeTags, pageSize, pageNumber + 1, minRating, sort, hideSeen)\n\n    store.dispatch(addPosts(res.posts))\n  }\n\n  if (action.type === ADD_TAG) {\n    const activeTags = selectActiveTags(state)\n    const aliases = await api.getAliases(action.tag.name)\n\n    const sanitizedAliases = aliases\n      .sort((a, b) => b.count - a.count)\n      .filter((alias) => !(alias.name in activeTags))\n      .map(({ name, count }) => ({ name, count, types: [] }))\n\n    store.dispatch(addAliases(sanitizedAliases, action.tag.name))\n\n    // Request types for newly added tag\n    if (!isSupertag(action.tag) && action.tag.types.length === 0) {\n      const tags = await api.getTags(action.tag.name, 1)\n      const tag = tags.find((tag) => tag.name === action.tag.name)\n\n      if (tag && !isSupertag(tag)) {\n        action.tag.types = tag.types\n        action.tag.count = tag.count\n      }\n    }\n  }\n\n  if (action.type === LIKE_POST) {\n    fetch(`https://rule34.xxx/index.php?page=post&s=vote&id=${action.postId}&type=up`, { mode: 'no-cors' })\n      .then(() => {\n        // nothing to do, I update the state in advance\n      })\n      .catch((err) => {\n        console.warn('Upvote rejected', err)\n      })\n  }\n\n  if (action.type === FETCH_SUGGESTIONS) {\n    const limit = selectTagSuggestionCount(state)\n    const suggestions = await api.getTags(serializeTagname(action.value), limit, action.includeSupertags)\n\n    store.dispatch(setSuggestions(suggestions))\n  }\n\n  if (action.type === FETCH_COMMENTS) {\n    const post = selectPostById(action.postId)(state)\n\n    if (post) {\n      const comments = await api.getComments(post)\n      store.dispatch(setComments(action.postId, comments))\n    }\n  }\n\n  next(action)\n}\n\nexport default apiRequests\n","import { applyMiddleware } from 'redux'\r\nimport analytics from './analytics'\r\nimport persistence from './persistence'\r\nimport requests from './requests'\r\nimport { composeWithDevTools } from 'redux-devtools-extension'\r\n\r\nconst middleware = composeWithDevTools(applyMiddleware(analytics, requests, persistence))\r\n\r\nexport default middleware\r\n","import produce from 'immer'\r\nimport * as r34 from 'r34-types'\r\nimport { AppAction, SET_PREFERENCE, SET_PREFERENCES } from '../actions'\r\n\r\nexport interface PreferencesState {\r\n  rated: boolean\r\n  ratedThreshold: number\r\n  originals: boolean\r\n  cookies: boolean\r\n  preloadVideos: boolean\r\n  tagSuggestionsCount: number\r\n  resultsLayout: r34.ResultsLayout\r\n  pageSize: number\r\n  showMetadata: boolean\r\n  showComments: boolean\r\n  sort: r34.PostsSort\r\n  themeId: r34.Theme\r\n  autoPlay: boolean\r\n  hideSeen: boolean\r\n}\r\n\r\nconst initialPreferencesState: PreferencesState = {\r\n  rated: false,\r\n  ratedThreshold: 1,\r\n  originals: false,\r\n  cookies: false,\r\n  preloadVideos: false,\r\n  tagSuggestionsCount: 20,\r\n  resultsLayout: 'infinite_column',\r\n  pageSize: 20,\r\n  showMetadata: false,\r\n  showComments: false,\r\n  sort: 'date',\r\n  themeId: 'dark',\r\n  autoPlay: false,\r\n  hideSeen: false,\r\n}\r\n\r\nfunction setPreference<T extends r34.PreferenceKey>(state: PreferencesState, key: T, value: PreferencesState[T]) {\r\n  return produce(state, (draft) => {\r\n    draft[key] = value\r\n  })\r\n}\r\n\r\nfunction setPreferences(state: PreferencesState, preferences: Partial<PreferencesState>) {\r\n  return produce(state, (draft) => {\r\n    Object.assign(draft, preferences)\r\n  })\r\n}\r\n\r\nconst preferences = (state: PreferencesState = initialPreferencesState, action: AppAction): PreferencesState => {\r\n  switch (action.type) {\r\n    case SET_PREFERENCE:\r\n      return setPreference(state, action.key, action.value)\r\n    case SET_PREFERENCES:\r\n      return setPreferences(state, action.preferences)\r\n    default:\r\n      return state\r\n  }\r\n}\r\n\r\nexport default preferences\r\n","import produce from 'immer'\nimport { Comment, Post } from 'r34-types'\nimport { SET_POSTS, ADD_POSTS, SET_COMMENTS, AppAction } from '../actions'\n\nexport interface ResultsState {\n  posts: Post[]\n  pageNumber: number\n  count: number\n}\n\nconst initialResultsState: ResultsState = {\n  posts: [],\n  pageNumber: 0,\n  count: 0,\n}\n\nconst addPosts = (state: ResultsState, posts: Post[]) =>\n  produce(state, (draft) => {\n    draft.posts = [...state.posts, ...posts]\n    draft.pageNumber = state.pageNumber + 1\n  })\n\nconst setPosts = (state: ResultsState, posts: Post[], postCount: number, pageNumber: number = 0) =>\n  produce(state, (draft) => {\n    draft.posts = posts\n    draft.count = postCount\n    draft.pageNumber = pageNumber\n  })\n\nconst setComments = (state: ResultsState, postId: number, comments: Comment[]) =>\n  produce(state, (draft) => {\n    const postIndex = state.posts.findIndex((p) => p.id === postId)\n    if (postIndex >= 0) {\n      draft.posts[postIndex].comments = comments\n    }\n  })\n\nconst results = (state: ResultsState = initialResultsState, action: AppAction): ResultsState => {\n  switch (action.type) {\n    case ADD_POSTS:\n      return addPosts(state, action.posts)\n    case SET_POSTS:\n      return setPosts(state, action.posts, action.count, action.pageNumber)\n    case SET_COMMENTS:\n      return setComments(state, action.postId, action.comments)\n    default:\n      return state\n  }\n}\n\nexport default results\n","import produce from 'immer'\nimport { AliasTag, AnyBiasedTag } from 'r34-types'\nimport { ADD_TAG, AppAction, REMOVE_TAG, ADD_ALIASES } from '../actions'\n\nexport interface TagsState {\n  active: Record<string, AnyBiasedTag>\n  aliases: Record<string, AliasTag[]>\n}\n\nconst initialTagsState: TagsState = {\n  active: {},\n  aliases: {},\n}\n\nconst addTag = (state: TagsState, newTag: AnyBiasedTag) =>\n  produce(state, (draft) => {\n    draft.active[newTag.name] = { ...state.active[newTag.name], ...newTag }\n  })\n\nconst addAliases = (state: TagsState, aliases: AliasTag[], forTag: string) =>\n  produce(state, (draft) => {\n    draft.aliases[forTag] = aliases\n  })\n\nconst removeTag = (state: TagsState, tagName: string) =>\n  produce(state, (draft) => {\n    delete draft.active[tagName]\n    delete draft.aliases[tagName]\n  })\n\nconst tags = (state: TagsState = initialTagsState, action: AppAction): TagsState => {\n  switch (action.type) {\n    case ADD_TAG:\n      return addTag(state, action.tag)\n    case REMOVE_TAG:\n      return removeTag(state, action.tagName)\n    case ADD_ALIASES:\n      return addAliases(state, action.aliases, action.forTag)\n    default:\n      return state\n  }\n}\n\nexport default tags\n","import produce from 'immer'\nimport { ENTER_FULLSCREEN, EXIT_FULLSCREEN, SET_FULLSCREEN_POST, AppAction } from '../actions'\n\nexport interface ReaderState {\n  isEnabled: boolean\n  postId: number\n}\n\nconst initialReaderState: ReaderState = {\n  isEnabled: false,\n  postId: 0,\n}\n\nconst enterFullscreen = (state: ReaderState, postId: number) =>\n  produce(state, (draft) => {\n    draft.isEnabled = true\n    draft.postId = postId\n  })\n\nconst exitFullscreen = (state: ReaderState) =>\n  produce(state, (draft) => {\n    draft.isEnabled = false\n  })\n\nconst setPostId = (state: ReaderState, value: number) =>\n  produce(state, (draft) => {\n    draft.postId = value\n  })\n\nconst reader = (state: ReaderState = initialReaderState, action: AppAction): ReaderState => {\n  switch (action.type) {\n    case ENTER_FULLSCREEN:\n      return enterFullscreen(state, action.postId)\n    case SET_FULLSCREEN_POST:\n      return setPostId(state, action.postId)\n    case EXIT_FULLSCREEN:\n      return exitFullscreen(state)\n    default:\n      return state\n  }\n}\n\nexport default reader\n","import produce from 'immer'\r\nimport { AppAction, LIKE_POST } from '../actions'\r\n\r\n/**\r\n * Key is postId, Value is time of like\r\n */\r\nexport type LikesState = Record<number, number>\r\n\r\nconst initialReaderState: LikesState = {}\r\n\r\nconst likePost = (state: LikesState, postId: number) =>\r\n  produce(state, (draft) => {\r\n    if (!(postId in state)) {\r\n      draft[postId] = Date.now()\r\n    }\r\n\r\n    // NOTE: Might need to introduce a cap here...\r\n    // Like 1000 likes max, delete oldest when more are added?\r\n  })\r\n\r\nconst likes = (state: LikesState = initialReaderState, action: AppAction): LikesState => {\r\n  switch (action.type) {\r\n    case LIKE_POST:\r\n      return likePost(state, action.postId)\r\n    default:\r\n      return state\r\n  }\r\n}\r\n\r\nexport default likes\r\n","import produce from 'immer'\r\nimport { ModalId } from '../../data/types'\r\nimport { AppAction, CLOSE_MODAL, OPEN_MODAL } from '../actions'\r\n\r\n/**\r\n * Key is postId, Value is time of like\r\n */\r\nexport interface ModalsState {\r\n  openModal: ModalId | null\r\n}\r\n\r\nconst initialModalsState: ModalsState = {\r\n  openModal: null,\r\n}\r\n\r\nconst setOpenModal = (state: ModalsState, modalId: ModalId | null) =>\r\n  produce(state, (draft) => {\r\n    draft.openModal = modalId\r\n  })\r\n\r\nconst modals = (state: ModalsState = initialModalsState, action: AppAction): ModalsState => {\r\n  switch (action.type) {\r\n    case OPEN_MODAL:\r\n      return setOpenModal(state, action.modalId)\r\n    case CLOSE_MODAL:\r\n      return setOpenModal(state, null)\r\n    default:\r\n      return state\r\n  }\r\n}\r\n\r\nexport default modals\r\n","import produce from 'immer'\r\nimport * as r34 from 'r34-types'\r\nimport { AppAction, SET_SUGGESTIONS } from '../actions'\r\n\r\n/**\r\n * Key is postId, Value is time of like\r\n */\r\nexport interface SuggestionsState {\r\n  entries: r34.AnyTag[]\r\n}\r\n\r\nconst initialReaderState: SuggestionsState = {\r\n  entries: [],\r\n}\r\n\r\nconst setSuggestions = (state: SuggestionsState, suggestions: r34.AnyTag[]) =>\r\n  produce(state, (draft) => {\r\n    draft.entries = suggestions\r\n  })\r\n\r\nconst suggestions = (state: SuggestionsState = initialReaderState, action: AppAction): SuggestionsState => {\r\n  switch (action.type) {\r\n    case SET_SUGGESTIONS:\r\n      return setSuggestions(state, action.suggestions)\r\n    default:\r\n      return state\r\n  }\r\n}\r\n\r\nexport default suggestions\r\n","import { combineReducers } from 'redux'\nimport preferences from './preferences'\nimport results from './results'\nimport tags from './tags'\nimport reader from './reader'\nimport likes from './likes'\nimport modals from './modals'\nimport suggestions from './suggestions'\n\nexport default combineReducers({ tags, results, preferences, reader, likes, suggestions, modals })\n","import { createStore } from 'redux'\nimport { persistReducer, persistStore } from 'redux-persist'\nimport storage from 'redux-persist/lib/storage'\nimport { getVersion, versionToNumber } from '../data/utils'\nimport middleware from './middleware'\nimport rootReducer from './reducers'\n\nconst version = getVersion()\n\nconst persistConfig = {\n  key: 'appstate',\n  version: versionToNumber(version),\n  storage,\n}\n\nconst persistedReducer = persistReducer(persistConfig, rootReducer)\n\nexport const store = createStore(persistedReducer, middleware)\n\nexport const persistor = persistStore(store)\n","import styled, { css } from 'styled-components'\r\nimport { gap } from '../../styled/mixins'\r\nimport FlexColumn, { FlexColumnWithSpacing } from '../common/FlexColumn'\r\nimport Surface from '../common/Surface'\r\nimport { Faded, Title } from '../common/Text'\r\nimport Header from '../features/Header'\r\n\r\nconst SectionBody = styled(Surface)(\r\n  ({ theme }) => css`\r\n    padding: ${theme.dimensions.hugeSpacing};\r\n    ${gap(theme.dimensions.hugeSpacing)};\r\n  `\r\n)\r\n\r\nconst Section = styled(FlexColumnWithSpacing)`\r\n  flex-grow: 1;\r\n`\r\n\r\nexport default function Terms() {\r\n  document.title = 'R34 React - Terms of Service'\r\n\r\n  return (\r\n    <FlexColumn>\r\n      <Header />\r\n      <Section>\r\n        <Title>Terms of Service</Title>\r\n        <SectionBody>\r\n          <p>\r\n            This website does not impose any additional terms on you. However, terms for the technologies this app uses\r\n            still apply. Therefore, you should read the following terms.\r\n          </p>\r\n          <a href='https://policies.google.com/terms'>Google - Privacy & Terms</a>\r\n          <a href='https://rule34.xxx/tos.php'>Rule34 - Terms of Serivce</a>\r\n          <Faded>If you have any questions feel free to contact me via Discord. See \"about\" section.</Faded>\r\n        </SectionBody>\r\n      </Section>\r\n    </FlexColumn>\r\n  )\r\n}\r\n","import React, { useCallback, useState } from 'react'\r\nimport { useDispatch, useSelector } from 'react-redux'\r\nimport styled, { css } from 'styled-components'\r\nimport { addSupertag } from '../../firebase'\r\nimport { selectActiveTags } from '../../redux/selectors'\r\nimport { defaultBlock, defaultBorder } from '../../styled/mixins'\r\nimport { BlockButton } from '../common/Buttons'\r\nimport { HorizontalLine } from '../common/Lines'\r\nimport Surface from '../common/Surface'\r\nimport { Title } from '../common/Text'\r\nimport TagSelector from '../tagSelector/TagSelector'\r\nimport ActiveTags from './ActiveTags'\r\nimport * as r34 from 'r34-types'\r\nimport { isSupertag } from '../../data/tagUtils'\r\nimport { useActivateTag } from '../../hooks/useActivateTag'\r\nimport { removeTag } from '../../redux/actions'\r\n\r\nconst Wrapper = styled.div`\r\n  position: fixed;\r\n  display: grid;\r\n  place-items: center;\r\n\r\n  bottom: 0;\r\n  left: 0;\r\n  width: 100vw;\r\n  height: 100vh;\r\n  padding: 20px;\r\n\r\n  z-index: 1000;\r\n\r\n  background: #000000d0;\r\n`\r\n\r\nconst ModalSurface = styled(Surface)`\r\n  max-width: 500px;\r\n  background-color: ${(props) => props.theme.colors.layerBgSolid};\r\n`\r\n\r\nconst StyledInput = styled.input(\r\n  ({ theme }) => css`\r\n    ${defaultBorder}\r\n    background-color: ${theme.colors.backgroundColor2};\r\n    ${defaultBlock}\r\n    text-align: left;\r\n  `\r\n)\r\n\r\ninterface SupertagModalProps {\r\n  onClose: () => void\r\n}\r\n\r\nexport default function SupertagModal(props: SupertagModalProps) {\r\n  const { onClose } = props\r\n  const [name, setName] = useState('')\r\n  const [description, setDescription] = useState('')\r\n  const activeTags = useSelector(selectActiveTags)\r\n  const dispatch = useDispatch()\r\n  const activateTag = useActivateTag()\r\n\r\n  const tags: Record<string, r34.TagModifier> = Object.values(activeTags)\r\n    .filter((tag): tag is r34.BiasedTag => !isSupertag(tag))\r\n    .reduce((result, tag) => ({ ...result, [tag.name]: tag.modifier }), {})\r\n\r\n  const handleCreate = useCallback(() => {\r\n    addSupertag(name, description, tags)\r\n      .then(() => {\r\n        Object.keys(tags).forEach((tagname) => dispatch(removeTag(tagname)))\r\n        activateTag({ name, description, tags })\r\n      })\r\n      .catch(() => console.log('Failed to create supertag'))\r\n    onClose()\r\n  }, [activateTag, description, dispatch, name, onClose, tags])\r\n\r\n  return (\r\n    <Wrapper onClick={onClose}>\r\n      <ModalSurface onClick={(e) => e.stopPropagation()}>\r\n        <Title>Create Supertag</Title>\r\n        <HorizontalLine />\r\n        <StyledInput type='text' placeholder='Name' value={name} onChange={(e) => setName(e.target.value)} />\r\n        <StyledInput\r\n          type='text'\r\n          placeholder='Description'\r\n          value={description}\r\n          onChange={(e) => setDescription(e.target.value)}\r\n        />\r\n        <TagSelector showSupertags={false} onSubmit={activateTag} />\r\n        <ActiveTags />\r\n        <BlockButton onClick={handleCreate}>Create</BlockButton>\r\n      </ModalSurface>\r\n    </Wrapper>\r\n  )\r\n}\r\n","import React, { Suspense, useEffect } from 'react'\nimport { Provider, useDispatch, useSelector } from 'react-redux'\nimport { HashRouter, Route, Switch } from 'react-router-dom'\nimport { PersistGate } from 'redux-persist/integration/react'\nimport { ThemeProvider } from 'styled-components'\nimport ErrorBoundary from './components/features/ErrorBoundary'\nimport ErrorScreen from './components/pages/ErrorScreen'\nimport LoadingScreen from './components/pages/LoadingScreen'\nimport CookieConfirmation from './components/widgets/CookieConfirmation'\nimport { RouteName } from './data/types'\nimport GlobalStyles from './GlobalStyles'\nimport themes, { defaultThemeId } from './styled/themes'\nimport { selectActiveThemeId, selectSupertagModalOpen } from './redux/selectors'\nimport { persistor, store } from './redux/store'\nimport Terms from './components/pages/Terms'\nimport useFirebaseAuthState from './hooks/useFirebaseAuthState'\nimport { closeModal, fetchPreferences } from './redux/actions'\nimport SupertagModal from './components/widgets/SupertagModal'\n\n// init firebase immediately\nimport './firebase'\nimport useAction from './hooks/useAction'\n\nconst Settings = React.lazy(() => import('./components/pages/Settings'))\nconst Search = React.lazy(() => import('./components/pages/Search'))\nconst About = React.lazy(() => import('./components/pages/About'))\nconst Privacy = React.lazy(() => import('./components/pages/Privacy'))\n\nexport default function App() {\n  return (\n    <ErrorBoundary fallback={<ErrorScreen />}>\n      <Provider store={store}>\n        <PersistGate loading={<LoadingScreen />} persistor={persistor}>\n          <ThemedApp />\n        </PersistGate>\n      </Provider>\n    </ErrorBoundary>\n  )\n}\n\nfunction ThemedApp() {\n  const dispatch = useDispatch()\n  const themeId = useSelector(selectActiveThemeId)\n  const isSupertagModalOpen = useSelector(selectSupertagModalOpen)\n  const [isSignedIn] = useFirebaseAuthState()\n  const onCloseModals = useAction(closeModal)\n\n  useEffect(() => {\n    if (isSignedIn) {\n      dispatch(fetchPreferences())\n    }\n  }, [dispatch, isSignedIn])\n\n  return (\n    <ThemeProvider theme={themes[themeId] || defaultThemeId}>\n      <GlobalStyles />\n      <HashRouter>\n        <Suspense fallback={<LoadingScreen />}>\n          <Switch>\n            <Route exact path={RouteName.SETTINGS}>\n              <Settings />\n            </Route>\n            <Route exact path={RouteName.ABOUT}>\n              <About />\n            </Route>\n            <Route exact path={RouteName.PRIVACY}>\n              <Privacy />\n            </Route>\n            <Route exact path={RouteName.TERMS}>\n              <Terms />\n            </Route>\n            <Route path={RouteName.SEARCH}>\n              <Search />\n            </Route>\n          </Switch>\n        </Suspense>\n\n        {isSupertagModalOpen && <SupertagModal onClose={onCloseModals} />}\n        <CookieConfirmation />\n      </HashRouter>\n    </ThemeProvider>\n  )\n}\n","// Polyfills\nimport 'whatwg-fetch'\n\nimport React from 'react'\nimport ReactDOM from 'react-dom'\nimport App from './App'\n\nReactDOM.render(<App />, document.getElementById('app-root'))\n"],"sourceRoot":""}