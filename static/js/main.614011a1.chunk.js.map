{"version":3,"sources":["redux/actions.ts","styled/mixins.tsx","redux/selectors.ts","data/tagUtils.ts","icons/FontAwesomeIcons.tsx","data/types.ts","components/designsystem/Buttons.tsx","firebase/analytics.ts","firebase/signIn.ts","data/encryption.ts","firebase/storage.ts","firebase/genericConverter.ts","firebase/index.ts","components/designsystem/Text.tsx","data/utils.ts","data/browserUtils.ts","hooks/useAction.tsx","hooks/usePreference.tsx","components/designsystem/Lines.tsx","misc/formatting.ts","components/designsystem/Surface.tsx","hooks/useFirebaseAuthState.tsx","components/designsystem/FlexImage.tsx","components/designsystem/LabeledToggle.tsx","icons/TypeIcon.tsx","components/designsystem/FlexColumn.tsx","components/designsystem/Toggle.tsx","components/features/Header.tsx","components/designsystem/FlexPair.tsx","components/designsystem/ModifierStyledText.tsx","components/tag/TagName.tsx","components/tag/Alias.tsx","components/tag/AliasesList.tsx","components/tag/ChipWrapper.tsx","components/tag/TagChip.tsx","components/tag/Supertag.tsx","components/tag/BiasedTag.tsx","components/tag/Tag.tsx","components/tag/TagList.tsx","hooks/useToggle.ts","hooks/useToggleTag.tsx","components/tagSelector/DropdownListEntry.tsx","components/tagSelector/DropdownListError.tsx","components/tagSelector/DropdownList.tsx","components/tagSelector/TagInput.tsx","components/tagSelector/TagSelector.tsx","components/widgets/ResetButton.tsx","icons/OutOfResults.png","icons/Loading.tsx","icons/R34Icon.tsx","hooks/useModifier.tsx","components/widgets/ActiveTags.tsx","hooks/useCheckIsActive.ts","hooks/useActivateTag.ts","components/features/ErrorBoundary.tsx","styled/themes/dark.ts","styled/themes/index.ts","styled/themes/light.ts","styled/themes/coffee.ts","styled/themes/electric.ts","styled/themes/deepsea.ts","GlobalStyles.tsx","components/pages/ErrorScreen.tsx","components/pages/LoadingScreen.tsx","components/pages/Terms.tsx","components/designsystem/Modal.tsx","icons/eeek.png","components/widgets/CellularWarningModal.tsx","components/widgets/CookieConfirmation.tsx","components/widgets/SupertagModal.tsx","analytics/events.ts","redux/middleware/persistence.ts","redux/middleware/analytics.ts","misc/api.ts","redux/middleware/requests.ts","redux/middleware/index.ts","redux/migrations.ts","redux/reducers/preferences.ts","redux/reducers/results.ts","redux/reducers/tags.ts","redux/reducers/fullscreen.ts","redux/reducers/likes.ts","redux/reducers/modals.ts","redux/reducers/suggestions.ts","redux/reducers/index.ts","redux/store.ts","App.tsx","hooks/useLoadPreferences.tsx","index.tsx"],"names":["ADD_ALIASES","ADD_POSTS","ADD_TAG","CLOSE_MODAL","ENTER_FULLSCREEN","EXIT_FULLSCREEN","FETCH_COMMENTS","FETCH_PREFERENCES","FETCH_SUGGESTIONS","GET_MORE_RESULTS","GET_RESULTS","LIKE_POST","OPEN_MODAL","REMOVE_TAG","SAVE_PREFERENCES","SET_COMMENTS","SET_FULLSCREEN_POST","SET_POSTS","SET_PREFERENCE","SET_PREFERENCES","SET_SUGGESTIONS","SET_SUGGESTIONS_ERROR","SET_SUGGESTIONS_MODIFIER","addTag","tag","type","removeTag","tagName","addAliases","aliases","forTag","addPosts","posts","setPosts","count","pageNumber","setComments","postId","comments","fetchComments","setPreference","key","value","setPreferences","preferences","getResults","getMoreResults","setFullscreenPost","index","likePost","openModal","modalId","closeModal","setSuggestions","suggestions","setSuggestionsError","error","fetchSuggestions","includeSupertags","fetchPreferences","savePreferences","setSuggestionsModifier","modifier","defaultBorder","theme","css","colors","accentColor","dimensions","borderWidth","borderRadius","layer","layerBg","primaryHover","disabled","backgroundColor","subduedText","timings","transitionTime","accentColorHover","accentColorActive","focusBorderAndColor","backgroundColor2","flexColumn","flexColumnWithGap","flexColumnGap","gutter","gridWithGap","gap","flexRowWithGap","flexRowGap","amount","supportsGap","supportsFlexGap","centeredMaxWidth","bodyWidth","defaultBlock","blockHeight","flexMedia","preserveAspectRatio","width","height","supportsAspectRatio","boxShadow","shadow","radius","color","dropShadow","mediaStyle","dropdownScrollbar","selectActiveTags","state","tags","active","selectActiveThemeId","themeId","selectAliases","selectAutoPlay","autoPlay","selectCookies","cookies","selectCount","results","selectFullsceenIndex","fullscreen","currentIndex","selectHideSeen","hideSeen","selectOpenModalId","modals","selectOriginals","originals","selectPageNumber","selectPageSize","pageSize","selectPosts","selectPreferences","selectPreloadVideos","preloadVideos","selectPreloadGifs","selectResultsLayout","resultsLayout","selectShowComments","showComments","selectShowMetadata","showMetadata","selectSort","sort","selectSuggestions","entries","selectSuggestionsError","selectSuggestionsModifier","selectTagSuggestionCount","tagSuggestionsCount","selectUpdated","updated","selectAutoscrollDelay","autoscrollDelay","selectNumberOfActiveTags","createSelector","Object","keys","length","selectAliasesAsList","values","flat","selectOutOfResults","selectHasMoreResults","outOfResults","selectLastPage","Math","ceil","selectFullScreenPost","fullScreenIndex","selectFullScreenIndex","fullScreenPost","indexOf","selectMinRating","rated","ratedThreshold","selectSupertagModalOpen","selectedIndex","undefined","ModalId","CREATE_SUPERTAG","selectCellularWarningModalOpen","CELLULAR_WARNING","selectPostById","defaultMemoize","id","find","post","selectPostByIndex","selectLikedByPostId","likes","selectActiveSupertagTags","activeTags","filter","isSupertag","reduce","result","serializeAllTags","tagsByModifier","current","push","groupTagsByModifier","resolvedTags","forEach","name","flattenSupertags","normalTags","map","serializeTag","join","optionalTags","serializeTagname","tagname","encodeURIComponent","toLowerCase","replace","getTagParameter","minScore","tagParts","bias","isBiased","getInterestingType","types","t","match","isSuggestionError","message","encodeSupertag","supertag","payload","encodeURI","description","m","Buffer","from","toString","decodeSupertag","base64","parts","substr","split","decodeURI","fromEntries","e","bindIcon","icon","props","ArrowDown","faCaretDown","ArtistIcon","faPen","CalendarIcon","faCalendarDay","CharacterIcon","faUser","CheckIcon","faCheckSquare","CloseIcon","faTimes","CodeBranchIcon","faCodeBranch","CopyIcon","faCopy","CopyrightIcon","faCopyright","DeviantArtIcon","faDeviantart","DiscordIcon","faDiscord","DownloadIcon","faDownload","ExpandIcon","faExpand","ExternalLinkIcon","faExternalLinkAlt","FailedIcon","faTimesCircle","GithubIcon","faGithub","GoogleIcon","faGoogle","HeartIcon","faHeart","ImageIcon","faImage","LinkIcon","faLink","MetaDataIcon","faInfoCircle","PatreonIcon","faPatreon","PlusIcon","faPlus","RatingIcon","faRegistered","SearchIcon","faSearch","ShareIcon","faShareAlt","SignOutIcon","faSignOutAlt","SourceIcon","faHashtag","SuccessIcon","faCheckCircle","SupertagIcon","faTags","TumblrIcon","faTumblr","TwitterIcon","faTwitter","UndoIcon","faUndoAlt","WrenchIcon","faWrench","ForwardIcon","faForward","BackwardIcon","faBackward","RouteName","NO_OP","TextButton","styled","button","bigSpacing","fontSizes","content","longTransitionTime","InvisButton","text","RedButton","BlockButton","AddButton","ModifierButton","logEvent","event","a","firebase","analytics","googleAuthProvider","auth","GoogleAuthProvider","signIn","signInWithPopup","catch","console","code","signOut","sha256","msgBuffer","TextEncoder","encode","crypto","subtle","digest","hashBuffer","hashArray","Array","Uint8Array","hashHex","b","padStart","userConverter","data","snapshot","options","getUserDoc","currentUser","email","userDoc","firestore","collection","doc","getUserData","withConverter","get","userSnap","userData","getPreferences","set","resetSeenPosts","warn","getSupertags","snap","addSupertag","removeSupertag","delete","setTagsOfSupertag","update","useSupertags","useState","supertags","setSupertags","setCollection","useFirebaseAuthState","userInfo","useEffect","then","hash","col","docs","err","unsubscribe","onSnapshot","initializeApp","apiKey","authDomain","databaseURL","projectId","storageBucket","messagingSenderId","appId","measurementId","Title","h2","bigTitle","BigTitle","h1","SmallTitle","h3","Faded","span","listToMap","list","keyProp","parseUrl","URL","versionToNumber","majorMinorPatch","Number","download","url","filename","pop","fetch","headers","Headers","Origin","window","location","origin","mode","response","blob","document","createElement","href","createObjectURL","body","appendChild","click","remove","getVersion","process","REACT_APP_VERSION","getVersionString","version","boolToNumber","flex","style","display","flexDirection","rowGap","isSupported","scrollHeight","parentNode","removeChild","supportsObjectFit","supportsFullscreen","fullscreenEnabled","supportsNetworkInformationAPI","navigator","openFullscreen","element","fullscreenElement","requestFullscreen","Promise","resolve","useAction","actionCreator","dispatch","useDispatch","useCallback","usePreference","useSelector","setValue","HorizontalLine","div","VerticalLine","formatCount","trunc","formatSource","source","host","formatDuration","duration","min","sec","formatTagname","formatTagnameAndCount","z","formatDatetime","date","dd","getDate","MM","getMonth","yyyy","getFullYear","hh","getHours","mm","getMinutes","formatTime","milliseconds","formatUnit","unitSize","unit","toFixed","unitString","authState","setAuthState","user","setUser","onAuthStateChanged","FlexImage","img","LabeledToggle","children","onToggle","TypeIcon","className","FlexColumn","FlexColumnWithSpacing","Track","Thumb","Toggle","onClick","role","HeaderWrapper","header","TitleBar","layerBgSolid","MenuBar","nav","hugeSpacing","LocationStyledLink","Link","to","Header","useLocation","pathname","size","SEARCH","SETTINGS","ABOUT","FlexPair","modifierToStyle","ModifierStyledText","TagName","tabIndex","AliasWrapper","Alias","handleClick","stopPropagation","ListWrapper","parentRef","offsetTop","clientHeight","offsetLeft","clientWidth","AliasesList","ChipWrapper","collapsed","switchingColors","DropdownArrow","$collapsed","TagChip","isActive","detailed","onContextMenu","tagRef","setTagRef","useToggle","toggleCollapsed","resetCollapsed","preventDefault","handleArrowClick","handleEnter","handleContextMenu","React","onKeyDown","onMouseLeave","ref","title","Supertag","BiasedTag","Tag","biasedTag","TagListWrapper","TagList","onTagClick","getIsActive","onTagMenu","initialValue","toggleValue","resetValue","useToggleTag","EntryWrapper","Name","Count","Icon","DropdownListEntry","DropdownListError","tagSelectorRef","tagSelector","sizeAndPosition","DropdownList","entry","Input","input","TagInput","onSubmit","handleChange","target","onChange","placeholder","TagSelectorWrapper","form","closed","TagSelector","showSupertags","setTagSelectorRef","useModifier","nextModifier","activateTag","useThrottledEffect","handleAddClick","trim","sanitizedTagname","suggestion","s","showList","ResetButton","reset","localStorage","clear","reload","StyledSvg","svg","Loading","xmlns","xmlnsXlink","viewBox","xmlSpace","fill","stroke","cx","cy","r","attributeName","dur","repeatCount","begin","R34Icon","useTheme","transform","strokeWidth","strokeMiterlimit","strokeDasharray","strokeOpacity","fontStyle","fontWeight","fontSize","fontFamily","letterSpacing","wordSpacing","fillOpacity","x","y","fontVariant","fontStretch","order","ActiveTags","offerSupertags","numberOfActiveTags","openSupertagModal","toggleTag","checkIsActive","useCheckIsActive","nextModifer","activeSupertagsTags","useActivateTag","ErrorBoundary","hasError","this","fallback","Component","dark","spacing","layerBgHighlight","liked","positive","negative","themes","light","coffee","electric","deepsea","defaultThemeId","createGlobalStyle","FullScreenCentered","ErrorScreen","GlobalStyles","src","outOfResultsPicture","alt","LoadingScreen","SectionBody","Surface","Section","Terms","Wrapper","ModalSurface","Modal","close","blockEvent","ButtonRow","CellularWarningModal","search","onConfirm","onCancel","setAutoPlay","toggleAutoPlay","setPreloadVideos","togglePreloadVideos","setOriginals","toggleOriginals","eeek","CookieWrapper","StyledSpan","CookieConfirmation","setCookies","handleAccept","StyledInput","SupertagModal","setName","setDescription","handleCreate","AnalyticsEventId","saveTimeout","eventLogging","store","next","action","page_number","getState","persistence","clearTimeout","setTimeout","firebaseFunctions","sourceTags","ratingTags","api","defaultPageSize","apiLocal","apiUrl1","apiUrl2","activeApi","setActiveApi","searchTerm","limit","json","doFuzzySearch","fetchTags","matchingSupertags","includes","details","matchingRating","matchingSourceTags","getIdToken","idToken","buildPostUrl","Authorization","apiResponse","comments_url","page","params","pid","i","apiRequests","hasMoreResults","minRating","getPosts","res","getAliases","sanitizedAliases","alias","getTags","getComments","middleware","composeWithDevTools","applyMiddleware","requests","migrations","reader","initialPreferencesState","produce","draft","assign","initialResultsState","Date","getTime","postCount","postIndex","findIndex","p","initialTagsState","newTag","initialFullscreenState","isEnabled","enterFullscreen","exitFullscreen","setIndex","initialLikesState","now","initialModalsState","setOpenModal","initialSuggestionsState","setError","setModifier","combineReducers","persistConfig","storage","migrate","createMigrate","persistedReducer","persistReducer","rootReducer","createStore","persistor","persistStore","About","lazy","Privacy","Search","Settings","Share","Stories","App","loading","ThemedApp","isCellularWarningModalOpen","isSupertagModalOpen","isSignedIn","useLoadPreferences","exact","path","component","PRIVACY","STORIES","TERMS","SHARE","Sentry","dsn","integrations","Integrations","BrowserTracing","tracesSampleRate","release","beforeBreadcrumb","breadcrumb","hint","category","startsWith","innerText","getAttribute","ReactDOM","render","getElementById"],"mappings":"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","file":"static/js/main.614011a1.chunk.js","sourcesContent":["import { ModalId, SuggestionsError } from '../data/types'\nimport * as r34 from 'r34-types'\nimport { PreferencesState } from './reducers/preferences'\n\n// Action Names\nexport const ADD_ALIASES = `r34-react/ADD_ALIASES`\nexport const ADD_POSTS = `r34-react/ADD_POSTS`\nexport const ADD_TAG = `r34-react/ADD_TAG`\nexport const CLOSE_MODAL = `r34-react/CLOSE_MODAL`\nexport const ENTER_FULLSCREEN = `r34-react/ENTER_FULLSCREEN`\nexport const EXIT_FULLSCREEN = 'r34-react/EXIT_FULLSCREEN'\nexport const FETCH_COMMENTS = `r34-react/FETCH_COMMENTS`\nexport const FETCH_PREFERENCES = `r34-react/FETCH_PREFERENCES`\nexport const FETCH_SUGGESTIONS = `r34-react/FETCH_SUGGESTIONS`\nexport const GET_MORE_RESULTS = `r34-react/GET_MORE_RESULTS`\nexport const GET_RESULTS = `r34-react/GET_RESULTS`\nexport const LIKE_POST = `r34-react/LIKE_POST`\nexport const OPEN_MODAL = `r34-react/OPEN_MODAL`\nexport const REMOVE_TAG = `r34-react/REMOVE_TAG`\nexport const SAVE_PREFERENCES = 'r34-react/SAVE_PREFERENCES'\nexport const SET_COMMENTS = `r34-react/SET_COMMENTS`\nexport const SET_FULLSCREEN_POST = `r34-react/SET_FULLSCREEN_POST`\nexport const SET_POSTS = `r34-react/SET_POSTS`\nexport const SET_PREFERENCE = `r34-react/SET_PREFERENCE`\nexport const SET_PREFERENCES = `r34-react/SET_PREFERENCES`\nexport const SET_SUGGESTIONS = `r34-react/SET_SUGGESTIONS`\nexport const SET_SUGGESTIONS_ERROR = `r34-react/SET_SUGGESTIONS_ERROR`\nexport const SET_SUGGESTIONS_MODIFIER = 'r34-react/SET_SUGGESTIONS_MODIFIER'\n\n// Action Types\ninterface AddTagAction {\n  type: typeof ADD_TAG\n  tag: r34.AnyBiasedTag\n}\n\ninterface RemoveTagAction {\n  type: typeof REMOVE_TAG\n  tagName: string\n}\n\ninterface AddAliasesAction {\n  type: typeof ADD_ALIASES\n  aliases: r34.AliasTag[]\n  forTag: string\n}\n\nexport interface AddPostsAction {\n  type: typeof ADD_POSTS\n  posts: r34.Post[]\n}\n\nexport interface SetPostsAction {\n  type: typeof SET_POSTS\n  posts: r34.Post[]\n  count: number\n  pageNumber?: number\n}\n\ninterface SetCommentsAction {\n  type: typeof SET_COMMENTS\n  postId: number\n  comments: r34.Comment[]\n}\n\ninterface FetchCommentsAction {\n  type: typeof FETCH_COMMENTS\n  postId: number\n}\n\ninterface SetPreferenceAction {\n  type: typeof SET_PREFERENCE\n  key: r34.PreferenceKey\n  value: any\n}\n\ninterface SetPreferencesAction {\n  type: typeof SET_PREFERENCES\n  preferences: Partial<PreferencesState>\n}\n\ninterface GetResultsAction {\n  type: typeof GET_RESULTS\n  pageNumber: number\n}\n\ninterface GetMoreResultsAction {\n  type: typeof GET_MORE_RESULTS\n}\n\ninterface EnterFullcreenAction {\n  type: typeof ENTER_FULLSCREEN\n  postId: number\n}\n\ninterface SetFullScreenPostAction {\n  type: typeof SET_FULLSCREEN_POST\n  index: number\n}\n\ninterface ExitFullscreenAction {\n  type: typeof EXIT_FULLSCREEN\n}\n\ninterface LikePostAction {\n  type: typeof LIKE_POST\n  postId: number\n}\n\ninterface OpenModalAction {\n  type: typeof OPEN_MODAL\n  modalId: ModalId\n}\n\ninterface CloseModalAction {\n  type: typeof CLOSE_MODAL\n}\n\ninterface SetSuggestionsAction {\n  type: typeof SET_SUGGESTIONS\n  suggestions: r34.AnyTag[]\n}\n\ninterface SetSuggestionsErrorAction {\n  type: typeof SET_SUGGESTIONS_ERROR\n  error: SuggestionsError\n}\n\ninterface FetchSuggestionsAction {\n  type: typeof FETCH_SUGGESTIONS\n  value: string\n  includeSupertags: boolean\n}\n\ninterface FetchPreferencesAction {\n  type: typeof FETCH_PREFERENCES\n}\n\ninterface SavePreferencesAction {\n  type: typeof SAVE_PREFERENCES\n}\n\ninterface SetSuggestionsModifierAction {\n  type: typeof SET_SUGGESTIONS_MODIFIER\n  modifier: r34.TagModifier\n}\n\nexport type AppAction =\n  | AddAliasesAction\n  | AddPostsAction\n  | AddTagAction\n  | CloseModalAction\n  | EnterFullcreenAction\n  | ExitFullscreenAction\n  | FetchCommentsAction\n  | FetchPreferencesAction\n  | FetchSuggestionsAction\n  | GetMoreResultsAction\n  | GetResultsAction\n  | LikePostAction\n  | OpenModalAction\n  | RemoveTagAction\n  | SavePreferencesAction\n  | SetCommentsAction\n  | SetFullScreenPostAction\n  | SetPostsAction\n  | SetPreferenceAction\n  | SetPreferencesAction\n  | SetSuggestionsAction\n  | SetSuggestionsErrorAction\n  | SetSuggestionsModifierAction\n\n// Action Creators\nexport function addTag(tag: r34.AnyBiasedTag): AddTagAction {\n  return {\n    type: ADD_TAG,\n    tag,\n  }\n}\n\nexport function removeTag(tagName: string): RemoveTagAction {\n  return {\n    type: REMOVE_TAG,\n    tagName,\n  }\n}\n\nexport function addAliases(aliases: r34.AliasTag[], forTag: string): AddAliasesAction {\n  return {\n    type: ADD_ALIASES,\n    aliases,\n    forTag,\n  }\n}\n\nexport function addPosts(posts: r34.Post[]): AddPostsAction {\n  return {\n    type: ADD_POSTS,\n    posts,\n  }\n}\n\nexport function setPosts(posts: r34.Post[], count: number, pageNumber: number = 0): SetPostsAction {\n  return {\n    type: SET_POSTS,\n    posts,\n    count,\n    pageNumber,\n  }\n}\n\nexport function setComments(postId: number, comments: r34.Comment[]): SetCommentsAction {\n  return {\n    type: SET_COMMENTS,\n    postId,\n    comments,\n  }\n}\n\nexport function fetchComments(postId: number): FetchCommentsAction {\n  return {\n    type: FETCH_COMMENTS,\n    postId,\n  }\n}\n\nexport function setPreference(key: r34.PreferenceKey, value: any): SetPreferenceAction {\n  return {\n    type: SET_PREFERENCE,\n    key,\n    value,\n  }\n}\n\nexport function setPreferences(preferences: Partial<PreferencesState>): SetPreferencesAction {\n  return {\n    type: SET_PREFERENCES,\n    preferences,\n  }\n}\n\nexport function getResults(pageNumber: number = 0): GetResultsAction {\n  return {\n    type: GET_RESULTS,\n    pageNumber,\n  }\n}\n\nexport function getMoreResults(): GetMoreResultsAction {\n  return {\n    type: GET_MORE_RESULTS,\n  }\n}\n\nexport function enterFullscreen(postId: number): EnterFullcreenAction {\n  return {\n    type: ENTER_FULLSCREEN,\n    postId,\n  }\n}\n\nexport function exitFullscreen(): ExitFullscreenAction {\n  return {\n    type: EXIT_FULLSCREEN,\n  }\n}\n\nexport function setFullscreenPost(index: number): SetFullScreenPostAction {\n  return {\n    type: SET_FULLSCREEN_POST,\n    index,\n  }\n}\n\nexport function likePost(postId: number): LikePostAction {\n  return {\n    type: LIKE_POST,\n    postId,\n  }\n}\n\nexport function openModal(modalId: ModalId): OpenModalAction {\n  return {\n    type: OPEN_MODAL,\n    modalId,\n  }\n}\n\nexport function closeModal(): CloseModalAction {\n  return {\n    type: CLOSE_MODAL,\n  }\n}\n\nexport function setSuggestions(suggestions: r34.AnyTag[]): SetSuggestionsAction {\n  return {\n    type: SET_SUGGESTIONS,\n    suggestions,\n  }\n}\n\nexport function setSuggestionsError(error: SuggestionsError): SetSuggestionsErrorAction {\n  return {\n    type: SET_SUGGESTIONS_ERROR,\n    error,\n  }\n}\n\nexport function fetchSuggestions(value: string, includeSupertags: boolean): FetchSuggestionsAction {\n  return {\n    type: FETCH_SUGGESTIONS,\n    value,\n    includeSupertags,\n  }\n}\n\nexport function fetchPreferences(): FetchPreferencesAction {\n  return {\n    type: FETCH_PREFERENCES,\n  }\n}\n\nexport function savePreferences(): SavePreferencesAction {\n  return {\n    type: SAVE_PREFERENCES,\n  }\n}\n\nexport function setSuggestionsModifier(modifier: r34.TagModifier): SetSuggestionsModifierAction {\n  return {\n    type: SET_SUGGESTIONS_MODIFIER,\n    modifier,\n  }\n}\n","import { css, DefaultTheme } from 'styled-components'\nimport { supportsAspectRatio, supportsFlexGap, supportsGap } from '../data/browserUtils'\n\nexport interface PropsWithTheme {\n  theme: DefaultTheme\n}\n\nexport interface SupportsDisable {\n  disabled: boolean\n}\n\n/**\n * Gives elements a border TODO: rename to defaultborder\n */\nexport function defaultBorder({ theme }: PropsWithTheme) {\n  return css`\n    border-color: ${theme.colors.accentColor};\n    border-width: ${theme.dimensions.borderWidth};\n    ${borderRadius({ theme })}\n    border-style: solid;\n  `\n}\n\n/**\n * Element will look like a new layer\n */\nexport function layer({ theme }: PropsWithTheme) {\n  return css`\n    background-color: ${theme.colors.layerBg};\n  `\n}\n\n/**\n * Element becomes accentColor on hover, and is highlighted when active/focused\n */\nexport function primaryHover({ theme, disabled }: PropsWithTheme & Partial<SupportsDisable>) {\n  return disabled\n    ? css`\n        color: ${theme.colors.backgroundColor};\n        border-color: transparent;\n        background-color: ${theme.colors.subduedText};\n      `\n    : css`\n        color: ${theme.colors.backgroundColor};\n        border-color: ${theme.colors.accentColor};\n        background-color: ${theme.colors.accentColor};\n\n        transition: color ${theme.timings.transitionTime} linear, border-color ${theme.timings.transitionTime} linear,\n          background-color ${theme.timings.transitionTime} linear;\n\n        :hover {\n          border-color: ${theme.colors.accentColorHover};\n          background-color: ${theme.colors.accentColorHover};\n        }\n\n        :active {\n          border-color: ${theme.colors.accentColorActive};\n          background-color: ${theme.colors.accentColorActive};\n        }\n\n        ${focusBorderAndColor}\n      `\n}\n\nexport function focusBorderAndColor({ theme }: PropsWithTheme) {\n  return css`\n    :focus,\n    :focus-within {\n      color: ${theme.colors.backgroundColor2};\n      border-color: ${theme.colors.backgroundColor2};\n    }\n  `\n}\n\nexport function flexColumn() {\n  return css`\n    display: flex;\n    flex-direction: column;\n  `\n}\n\nexport function flexColumnWithGap({ theme }: PropsWithTheme) {\n  return css`\n    display: flex;\n    flex-direction: column;\n    ${flexColumnGap(theme.dimensions.gutter)};\n  `\n}\n\nexport function gridWithGap({ theme }: PropsWithTheme) {\n  return css`\n    display: grid;\n    ${gap(theme.dimensions.gutter)}\n  `\n}\n\nexport function flexRowWithGap({ theme }: PropsWithTheme) {\n  return css`\n    display: flex;\n    align-items: center;\n    ${flexRowGap(theme.dimensions.gutter)};\n  `\n}\n\nexport function gap(amount: string) {\n  return supportsGap\n    ? css`\n        gap: ${amount};\n      `\n    : css`\n        > :not(:last-child) {\n          margin-right: ${amount};\n          margin-bottom: ${amount};\n        }\n      `\n}\n\nexport function flexRowGap(amount: string) {\n  return supportsFlexGap\n    ? css`\n        gap: ${amount};\n      `\n    : css`\n        > :not(:last-child) {\n          margin-right: ${amount};\n        }\n      `\n}\n\nexport function flexColumnGap(amount: string) {\n  return supportsFlexGap\n    ? css`\n        gap: ${amount};\n      `\n    : css`\n        > :not(:last-child) {\n          margin-bottom: ${amount};\n        }\n      `\n}\n\n/**\n * Default spacing for grid and flex\n */\nexport function gutter({ theme }: PropsWithTheme) {\n  return css`\n    ${gap(theme.dimensions.gutter)};\n    padding: ${theme.dimensions.gutter};\n  `\n}\n\n/**\n * Limits content to a maximum width and centers it\n */\nexport function centeredMaxWidth({ theme }: PropsWithTheme) {\n  return css`\n    width: 100%;\n    max-width: ${theme.dimensions.bodyWidth};\n    margin-left: auto;\n    margin-right: auto;\n  `\n}\n\n/**\n * Fixed height and padding\n */\nexport function defaultBlock({ theme }: PropsWithTheme) {\n  return css`\n    height: ${theme.dimensions.blockHeight};\n    padding: 0 ${theme.dimensions.gutter};\n  `\n}\n\n/**\n * Preserves aspect ratio of the element and ensures it is displayed as big as possible\n */\nexport function flexMedia() {\n  return css`\n    width: 100%;\n    height: 100%;\n    display: block;\n    object-fit: contain;\n  `\n}\n\ninterface Size {\n  width: number\n  height: number\n}\n\nexport function preserveAspectRatio({ width, height }: Partial<Size>) {\n  if (!width || !height) {\n    return ''\n  }\n\n  return supportsAspectRatio\n    ? css`\n        aspect-ratio: ${width} / ${height};\n      `\n    : css`\n        max-width: 100%;\n        height: auto;\n      `\n}\n\nexport function borderRadius({ theme }: PropsWithTheme) {\n  return css`\n    border-radius: ${theme.dimensions.borderRadius};\n  `\n}\n\nexport function boxShadow({ theme }: PropsWithTheme) {\n  return css`\n    box-shadow: 0 1px ${theme.shadow.radius} ${theme.shadow.color};\n  `\n}\n\nexport function dropShadow({ theme }: PropsWithTheme) {\n  return css`\n    filter: drop-shadow(0 1px ${theme.shadow.radius} ${theme.shadow.color});\n  `\n}\n\nexport function mediaStyle() {\n  return css`\n    ${borderRadius}\n    ${boxShadow}\n    grid-area: 1/1/2/2;\n    z-index: 1;\n  `\n}\n\nexport function dropdownScrollbar({ theme }: PropsWithTheme) {\n  return css`\n    overflow-x: hidden;\n    overflow-y: auto;\n\n    ::-webkit-scrollbar {\n      width: 8px;\n\n      :hover {\n        background: ${theme.colors.layerBg};\n      }\n    }\n\n    /* Track */\n    ::-webkit-scrollbar-track {\n      background: ${theme.colors.backgroundColor2};\n      border-left: 1px lightgray solid;\n    }\n\n    /* Handle */\n    :hover {\n      ::-webkit-scrollbar {\n        background: ${theme.colors.backgroundColor}20;\n      }\n    }\n\n    ::-webkit-scrollbar-thumb {\n      background: ${theme.colors.backgroundColor}40;\n      border-radius: 100px;\n\n      :hover {\n        background: ${theme.colors.backgroundColor}30;\n      }\n    }\n  `\n}\n","import * as r34 from 'r34-types'\nimport { createSelector, defaultMemoize } from 'reselect'\nimport { isSupertag } from '../data/tagUtils'\nimport { ModalId } from '../data/types'\nimport { AppState } from './appState'\n\n// Simple selectors\nexport const selectActiveTags = (state: AppState) => state.tags.active\nexport const selectActiveThemeId = (state: AppState) => state.preferences.themeId\nexport const selectAliases = (state: AppState) => state.tags.aliases\nexport const selectAutoPlay = (state: AppState) => state.preferences.autoPlay\nexport const selectCookies = (state: AppState) => state.preferences.cookies\nexport const selectCount = (state: AppState) => state.results.count\nexport const selectFullsceenIndex = (state: AppState) => state.fullscreen.currentIndex\nexport const selectFullsceenState = (state: AppState) => state.fullscreen.isEnabled\nexport const selectHideSeen = (state: AppState) => state.preferences.hideSeen\nexport const selectOpenModalId = (state: AppState) => state.modals.openModal\nexport const selectOriginals = (state: AppState) => state.preferences.originals\nexport const selectPageNumber = (state: AppState) => state.results.pageNumber\nexport const selectPageSize = (state: AppState) => state.preferences.pageSize\nexport const selectPosts = (state: AppState) => state.results.posts\nexport const selectPreferences = (state: AppState) => state.preferences\nexport const selectPreloadVideos = (state: AppState) => state.preferences.preloadVideos\nexport const selectPreloadGifs = (state: AppState) => state.preferences.preloadVideos\nexport const selectRated = (state: AppState) => state.preferences.rated\nexport const selectRatedThreshold = (state: AppState) => state.preferences.ratedThreshold\nexport const selectResults = (state: AppState) => state.results\nexport const selectResultsLayout = (state: AppState) => state.preferences.resultsLayout\nexport const selectShowComments = (state: AppState) => state.preferences.showComments\nexport const selectShowMetadata = (state: AppState) => state.preferences.showMetadata\nexport const selectSort = (state: AppState) => state.preferences.sort\nexport const selectSuggestions = (state: AppState) => state.suggestions.entries\nexport const selectSuggestionsError = (state: AppState) => state.suggestions.error\nexport const selectSuggestionsModifier = (state: AppState) => state.suggestions.modifier\nexport const selectTagSuggestionCount = (state: AppState) => state.preferences.tagSuggestionsCount\nexport const selectUpdated = (state: AppState) => state.results.updated\nexport const selectAutoscrollDelay = (state: AppState) => state.preferences.autoscrollDelay\n\n// Memoized selectors\nexport const selectNumberOfActiveTags = createSelector(selectActiveTags, (tags) => Object.keys(tags).length)\nexport const selectAliasesAsList = createSelector(selectAliases, (aliases) => Object.values(aliases).flat())\nexport const selectHasResults = createSelector(selectPosts, (posts) => posts.length !== 0)\nexport const selectOutOfResults = createSelector(selectPosts, selectCount, (posts, count) => posts.length === count)\nexport const selectHasMoreResults = createSelector(selectOutOfResults, (outOfResults) => !outOfResults)\nexport const selectLastPage = createSelector(\n  selectCount,\n  selectPageSize,\n  (count, pageSize) => Math.ceil(count / pageSize) - 1\n)\nexport const selectFullScreenPost = createSelector(\n  selectPosts,\n  selectFullsceenIndex,\n  (posts, fullScreenIndex) => posts[fullScreenIndex]\n)\nexport const selectFullScreenIndex = createSelector(selectPosts, selectFullScreenPost, (posts, fullScreenPost) =>\n  fullScreenPost ? posts.indexOf(fullScreenPost) : -1\n)\nexport const selectMinRating = createSelector(selectRated, selectRatedThreshold, (rated, ratedThreshold) =>\n  rated ? ratedThreshold : 0\n)\nexport const selectNextIndex = createSelector(selectPosts, selectFullScreenIndex, (posts, selectedIndex) =>\n  selectedIndex + 1 < posts.length ? selectedIndex + 1 : undefined\n)\nexport const selectPreviousIndex = createSelector(selectFullScreenIndex, (selectedIndex) =>\n  selectedIndex > 0 ? selectedIndex - 1 : undefined\n)\nexport const selectSupertagModalOpen = createSelector(\n  selectOpenModalId,\n  (modalId) => modalId === ModalId.CREATE_SUPERTAG\n)\nexport const selectCellularWarningModalOpen = createSelector(\n  selectOpenModalId,\n  (modalId) => modalId === ModalId.CELLULAR_WARNING\n)\n\n// Parameterized selectors\nexport const selectPostById = defaultMemoize((id: number) => {\n  return createSelector(selectPosts, (posts) => {\n    return posts.find((post) => post.id === id) as r34.Post\n  })\n})\nexport const selectPostByIndex = defaultMemoize((index: number) => {\n  return createSelector(selectPosts, (posts) => {\n    return posts[index]\n  })\n})\n\nexport const selectAliasesByTagName = defaultMemoize((tagName: string) => {\n  return createSelector(selectAliases, (aliases) => {\n    return aliases[tagName]\n  })\n})\n\nexport const selectLikedByPostId = defaultMemoize((id: number) => (state: AppState) => id in state.likes)\n\nexport const selectActiveSupertagTags = createSelector(selectActiveTags, (activeTags) =>\n  Object.values(activeTags)\n    .filter(isSupertag)\n    .reduce((result, tag) => ({ ...result, ...tag.tags }), {})\n)\n","import * as r34 from 'r34-types'\nimport { SuggestionsError } from './types'\n\n//#region Tag serialization\n\n/**\n * Accepts a map of all tags and serializes them into a string that can be used as a Querystring parameter\n */\nexport function serializeAllTags(tags: Record<string, r34.QueryTag | r34.Supertag>) {\n  const resolvedTags = flattenSupertags(Object.values(tags))\n  const tagsByModifier = groupTagsByModifier(resolvedTags)\n  const normalTags = [...tagsByModifier['+'], ...tagsByModifier['-']].map(serializeTag).join(' + ')\n  const optionalTags =\n    tagsByModifier['~'].length > 0 ? ` + ( ${tagsByModifier['~'].map(serializeTag).join(' ~ ')} )` : ''\n\n  return `${normalTags}${optionalTags}`\n}\n\n/**\n * Accepts a list that holds normal tags and supertags and unpacks all supertags.\n * The result contains all normal tags given plus all contents of the supertags given.\n */\nexport function flattenSupertags(tags: Array<r34.QueryTag | r34.Supertag>) {\n  let resolvedTags: r34.QueryTag[] = []\n\n  tags.forEach((tag) => {\n    if (isSupertag(tag)) {\n      Object.entries(tag.tags).forEach(([name, modifier]) => {\n        resolvedTags.push({ name, modifier })\n      })\n    } else {\n      resolvedTags.push(tag)\n    }\n  })\n\n  return resolvedTags\n}\n\n/**\n * Given a list of tags this function returns a record with an entry for each modifier countaining all tags of the original list that match that modifier.\n */\nexport function groupTagsByModifier(tags: r34.QueryTag[]) {\n  return tags.reduce(\n    (result, current) => {\n      if (!(current.modifier in result)) result[current.modifier] = []\n\n      result[current.modifier]?.push(current)\n\n      return result\n    },\n    { '+': [], '-': [], '~': [] } as Record<r34.TagModifier, r34.QueryTag[]>\n  )\n}\n\n/**\n * Serializes a tag for use in urls\n */\nexport function serializeTag(tag: r34.QueryTag) {\n  return `${tag.modifier === '-' ? '-' : ''}${serializeTagname(tag.name)}`\n}\n\n/**\n * Serializes tag names for use in api requests.\n */\nexport function serializeTagname(tagname: string) {\n  return encodeURIComponent(tagname.toLowerCase().replace(/ /g, '_'))\n}\n\n//#endregion\n\n//#region Query parameter construction\n\n/**\n * Constructs the tag parameter for getting posts from the api\n */\nexport function getTagParameter(\n  tags: Record<string, r34.QueryTag | r34.Supertag>,\n  minScore: number,\n  sort: r34.PostsSort\n) {\n  const tagParts = []\n\n  if (Object.keys(tags).length > 0) {\n    tagParts.push(serializeAllTags(tags))\n  }\n\n  if (minScore > 0) {\n    tagParts.push(encodeURIComponent(`score:>=${minScore}`))\n  }\n\n  if (sort !== 'date') {\n    tagParts.push(encodeURIComponent(`sort:${sort}:desc`))\n  }\n\n  return tagParts.join(' + ')\n}\n\n//#endregion\n\n//#region Typing\n\nexport function bias(tag: r34.Tag, modifier: r34.TagModifier): r34.BiasedTag {\n  return { ...tag, modifier }\n}\n\nexport function isBiased(tag: r34.Tag | r34.BiasedTag): tag is r34.BiasedTag {\n  return (tag as r34.BiasedTag).modifier !== undefined\n}\n\nexport function isSupertag(tag: unknown): tag is r34.Supertag {\n  return (tag as r34.Supertag).tags !== undefined\n}\n\nexport function getInterestingType(types: r34.TagType[]) {\n  return types.find((t) => !t.match(/^[general|ambiguous]$/))\n}\n\nexport function isSuggestionError(value: unknown): value is SuggestionsError {\n  return (value as SuggestionsError).message !== undefined\n}\n\n//#endregion\n\n//#region Compression\n\nfunction removeLeadingHastag(value: string) {\n  if (value[0] === '#') return value.substr(1)\n  else return value\n}\n\nexport function encodeSupertag(supertag: r34.Supertag) {\n  const payload = `${encodeURI(supertag.name)}/${encodeURI(supertag.description)}/${encodeURI(\n    Object.entries(supertag.tags)\n      .map(([t, m]) => `${t},${m}`)\n      .join(';')\n  )}`\n\n  return Buffer.from(payload).toString('base64')\n}\n\nexport function decodeSupertag(base64: string) {\n  const payload = Buffer.from(removeLeadingHastag(base64), 'base64').toString()\n\n  const parts = payload.split('/').map(decodeURI)\n\n  const supertag: r34.Supertag = {\n    name: parts[0],\n    description: parts[1],\n    tags: Object.fromEntries(parts[2].split(';').map((e) => e.split(','))),\n  }\n\n  return supertag\n}\n\n//#endregion\n","import { IconProp } from '@fortawesome/fontawesome-svg-core'\nimport {\n  faDeviantart,\n  faDiscord,\n  faGithub,\n  faGoogle,\n  faPatreon,\n  faTumblr,\n  faTwitter,\n} from '@fortawesome/free-brands-svg-icons'\nimport {\n  faBackward,\n  faCalendarDay,\n  faCaretDown,\n  faCheckCircle,\n  faCheckSquare,\n  faCodeBranch,\n  faCopy,\n  faCopyright,\n  faDownload,\n  faExpand,\n  faExternalLinkAlt,\n  faForward,\n  faHashtag,\n  faHeart,\n  faImage,\n  faInfoCircle,\n  faLink,\n  faPen,\n  faPlus,\n  faRegistered,\n  faSearch,\n  faShareAlt,\n  faSignOutAlt,\n  faTags,\n  faTimes,\n  faTimesCircle,\n  faUndoAlt,\n  faUser,\n  faWrench,\n} from '@fortawesome/free-solid-svg-icons'\nimport { FontAwesomeIcon, FontAwesomeIconProps } from '@fortawesome/react-fontawesome'\n\n/**\n * Component factory that shortens the definition of a new icon considerably\n */\nconst bindIcon = (icon: IconProp) => (props: Omit<FontAwesomeIconProps, 'icon'>) =>\n  <FontAwesomeIcon data-testid='icon' icon={icon} {...props} />\n\nexport const ArrowDown = bindIcon(faCaretDown)\nexport const ArtistIcon = bindIcon(faPen)\nexport const CalendarIcon = bindIcon(faCalendarDay)\nexport const CharacterIcon = bindIcon(faUser)\nexport const CheckIcon = bindIcon(faCheckSquare)\nexport const CloseIcon = bindIcon(faTimes)\nexport const CodeBranchIcon = bindIcon(faCodeBranch)\nexport const CopyIcon = bindIcon(faCopy)\nexport const CopyrightIcon = bindIcon(faCopyright)\nexport const DeviantArtIcon = bindIcon(faDeviantart)\nexport const DiscordIcon = bindIcon(faDiscord)\nexport const DownloadIcon = bindIcon(faDownload)\nexport const ExpandIcon = bindIcon(faExpand)\nexport const ExternalLinkIcon = bindIcon(faExternalLinkAlt)\nexport const FailedIcon = bindIcon(faTimesCircle)\nexport const GithubIcon = bindIcon(faGithub)\nexport const GoogleIcon = bindIcon(faGoogle)\nexport const HeartIcon = bindIcon(faHeart)\nexport const ImageIcon = bindIcon(faImage)\nexport const LinkIcon = bindIcon(faLink)\nexport const MetaDataIcon = bindIcon(faInfoCircle)\nexport const PatreonIcon = bindIcon(faPatreon)\nexport const PlusIcon = bindIcon(faPlus)\nexport const RatingIcon = bindIcon(faRegistered)\nexport const SearchIcon = bindIcon(faSearch)\nexport const ShareIcon = bindIcon(faShareAlt)\nexport const SignOutIcon = bindIcon(faSignOutAlt)\nexport const SourceIcon = bindIcon(faHashtag)\nexport const SuccessIcon = bindIcon(faCheckCircle)\nexport const SupertagIcon = bindIcon(faTags)\nexport const TumblrIcon = bindIcon(faTumblr)\nexport const TwitterIcon = bindIcon(faTwitter)\nexport const UndoIcon = bindIcon(faUndoAlt)\nexport const WrenchIcon = bindIcon(faWrench)\nexport const ForwardIcon = bindIcon(faForward)\nexport const BackwardIcon = bindIcon(faBackward)\n","/**\n * Tabs displayed in Post details\n */\nexport type ActiveTab = 'tags' | 'comments' | 'metadata'\n\n/**\n * All routes of the app.\n */\nexport enum RouteName {\n  SEARCH = '/',\n  SETTINGS = '/settings',\n  ABOUT = '/about',\n  PRIVACY = '/privacy',\n  TERMS = '/terms',\n  STORIES = '/stories',\n  SHARE = '/share',\n}\n\n/**\n * All modals the app can display.\n */\nexport enum ModalId {\n  CREATE_SUPERTAG,\n  CELLULAR_WARNING,\n}\n\nexport type EmptyCallback = () => void\n\n/**\n * One-time definition of an empty function. Reusing this improves React's performance as it does not break memoization.\n */\nexport const NO_OP = () => {}\n\n/**\n * Error sent from the backend when too many tag results were found\n */\nexport type SuggestionsError = { message: string; results: number }\n\n/**\n * direct: Tag is part of active tags\n * indirect: Tag is part of a supertag that is in active tags\n * no: Tag is not part of supertags at all\n */\nexport type TagIsActive = 'direct' | 'indirect' | 'no'\n\n/**\n * Unit for display in the TagSelector dropdown\n */\nexport type CountUnit = 'tags' | 'posts'\n","import styled, { css } from 'styled-components'\nimport { defaultBorder, dropShadow, primaryHover } from '../../styled/mixins'\n\nconst TextButton = styled.button(\n  ({ theme }) => css`\n    height: ${theme.dimensions.blockHeight};\n    padding: 0 ${theme.dimensions.bigSpacing};\n    font-size: ${theme.fontSizes.content};\n    ${defaultBorder({ theme })}\n    display: inline-flex;\n    gap: ${theme.dimensions.gutter};\n    align-items: center;\n    place-content: center;\n    cursor: pointer;\n    transition: all ${theme.timings.longTransitionTime} ease-out;\n  `\n)\n\nexport const InvisButton = styled.button(\n  ({ theme }) => css`\n    background-color: transparent;\n    border: none;\n    padding: ${theme.dimensions.gutter};\n    cursor: pointer;\n    ${dropShadow({ theme })}\n    color: ${theme.colors.text};\n\n    svg {\n      transition: all ${theme.timings.transitionTime} ease-out;\n    }\n  `\n)\n\nexport const RedButton = styled(TextButton)`\n  ${primaryHover}\n`\n\nexport const BlockButton = styled(RedButton)`\n  width: 100%;\n`\n\nexport const AddButton = styled(RedButton)(\n  ({ theme }) => css`\n    border-radius: 0 ${theme.dimensions.borderRadius} ${theme.dimensions.borderRadius} 0;\n  `\n)\n\nexport const ModifierButton = styled(TextButton)(\n  ({ theme }) => css`\n    background-color: transparent;\n    min-width: 48px;\n    font-weight: bold;\n\n    ${defaultBorder({ theme })}\n    border-right-width: 0;\n    border-radius: ${theme.dimensions.borderRadius} 0 0 ${theme.dimensions.borderRadius};\n  `\n)\n","import firebase from 'firebase/app'\nimport 'firebase/analytics'\nimport { SearchEvent } from '../analytics/events'\n\nexport async function logEvent(event: SearchEvent) {\n  firebase.analytics().logEvent<typeof event.id>(event.id, event.payload)\n}\n","import firebase from 'firebase/app'\nimport 'firebase/auth'\n\nconst googleAuthProvider = new firebase.auth.GoogleAuthProvider()\n\nexport function signIn() {\n  firebase\n    .auth()\n    .signInWithPopup(googleAuthProvider)\n    .catch((error) => {\n      console.error('Sign in failed:', error.code, error.message)\n    })\n}\n\nexport async function signOut() {\n  return await firebase.auth().signOut()\n}\n","export async function sha256(message: string) {\n  const msgBuffer = new TextEncoder().encode(message)\n  const hashBuffer = await crypto.subtle.digest('SHA-256', msgBuffer)\n  const hashArray = Array.from(new Uint8Array(hashBuffer))\n  const hashHex = hashArray.map((b) => b.toString(16).padStart(2, '0')).join('')\n\n  return hashHex\n}\n","import firebase from 'firebase/app'\nimport 'firebase/auth'\nimport 'firebase/firestore'\nimport { useEffect, useState } from 'react'\nimport { SupertagData, TagModifier, User } from 'r34-types'\nimport { sha256 } from '../data/encryption'\nimport useFirebaseAuthState from '../hooks/useFirebaseAuthState'\nimport { PreferencesState } from '../redux/reducers/preferences'\nimport { GenericConverter } from './genericConverter'\n\nconst userConverter = new GenericConverter<User>()\n\nasync function getUserDoc() {\n  const { currentUser } = firebase.auth()\n  const email = currentUser?.email\n\n  if (email) {\n    const key = await sha256(email)\n    const userDoc = firebase.firestore().collection('users').doc(key)\n    return userDoc\n  }\n\n  return undefined\n}\n\nasync function getUserData() {\n  const userDoc = await getUserDoc()\n\n  if (userDoc) {\n    let userSnap = await userDoc.withConverter(userConverter).get()\n\n    const userData = userSnap.data()\n    return userData\n  }\n\n  return undefined\n}\n\nexport async function getPreferences() {\n  const userData = await getUserData()\n\n  if (userData) return userData.preferences\n\n  return undefined\n}\n\nexport async function setPreferences(preferences: PreferencesState) {\n  const userDoc = await getUserDoc()\n\n  await userDoc?.set({ preferences: preferences })\n}\n\nexport async function resetSeenPosts() {\n  console.warn('broken')\n}\n\nexport async function getSupertags() {\n  const userDoc = await getUserDoc()\n\n  if (userDoc) {\n    const snap = await userDoc.collection('supertags').get()\n    const result: Record<string, SupertagData> = {}\n\n    snap.forEach((doc) => {\n      result[doc.id] = doc.data() as SupertagData\n    })\n\n    return result\n  }\n\n  return undefined\n}\n\nexport async function addSupertag(name: string, description: string, tags: Record<string, TagModifier>) {\n  const userDoc = await getUserDoc()\n\n  userDoc?.collection('supertags').doc(name).set({ description, tags })\n}\n\nexport async function removeSupertag(name: string) {\n  const userDoc = await getUserDoc()\n\n  userDoc?.collection('supertags').doc(name).delete()\n}\n\nexport async function setTagsOfSupertag(name: string, tags: Record<string, TagModifier>) {\n  const userDoc = await getUserDoc()\n\n  userDoc?.collection('supertags').doc(name).update({ tags })\n}\n\nexport function useSupertags() {\n  const [supertags, setSupertags] = useState<Record<string, SupertagData>>({})\n  const [collection, setCollection] = useState<firebase.firestore.CollectionReference>()\n\n  // eslint-disable-next-line @typescript-eslint/no-unused-vars\n  const [_, userInfo] = useFirebaseAuthState()\n\n  useEffect(() => {\n    if (userInfo?.email) {\n      sha256(userInfo.email)\n        .then((hash) => {\n          const col = firebase.firestore().collection(`users/${hash}/supertags`)\n          setCollection(col)\n          return col.get()\n        })\n        .then((snapshot) => {\n          const result = snapshot.docs.reduce((result, doc) => {\n            result[doc.id] = doc.data() as SupertagData\n            return result\n          }, {} as Record<string, SupertagData>)\n\n          setSupertags(result)\n        })\n        .catch((err) => {\n          console.error('Error with useSupertags', err)\n        })\n    }\n  }, [userInfo?.email])\n\n  useEffect(() => {\n    if (collection) {\n      const unsubscribe = collection.onSnapshot((snapshot) => {\n        const result = snapshot.docs.reduce((result, doc) => {\n          const userSupertags = doc\n          result[userSupertags.id] = doc.data() as SupertagData\n          return result\n        }, {} as Record<string, SupertagData>)\n\n        setSupertags(result)\n      })\n\n      return () => {\n        unsubscribe()\n      }\n    }\n  }, [collection])\n\n  return supertags\n}\n","import firebase from 'firebase/app'\n\nexport class GenericConverter<T> {\n  toFirestore(data: T): firebase.firestore.DocumentData {\n    return data\n  }\n  fromFirestore(snapshot: firebase.firestore.QueryDocumentSnapshot, options: firebase.firestore.SnapshotOptions): T {\n    const data = snapshot.data(options)!\n    return data as T\n  }\n}\n","import firebase from 'firebase/app'\nimport 'firebase/analytics'\nimport 'firebase/auth'\nimport 'firebase/firestore'\n\nconst firebaseConfig = {\n  apiKey: 'AIzaSyBHdepwE7M4Byu2lFtX2s__9COcMdvXu7Q',\n  authDomain: 'r34-react.firebaseapp.com',\n  databaseURL: 'https://r34-react.firebaseio.com',\n  projectId: 'r34-react',\n  storageBucket: 'r34-react.appspot.com',\n  messagingSenderId: '844749417844',\n  appId: '1:844749417844:web:11fa1fda0e14f1ac2dd021',\n  measurementId: 'G-27J3QXZ8YR',\n}\n\nfirebase.initializeApp(firebaseConfig)\n\nexport * from './analytics'\nexport * from './signIn'\nexport * from './storage'\n","import styled, { css } from 'styled-components'\nimport { flexRowWithGap } from '../../styled/mixins'\n\nexport const Title = styled.h2(\n  ({ theme }) => css`\n    font-size: ${theme.fontSizes.bigTitle};\n    font-weight: lighter;\n    text-align: center;\n  `\n)\n\nexport const BigTitle = styled.h1(\n  ({ theme }) => css`\n    ${flexRowWithGap({ theme })}\n\n    justify-content: center;\n    font-size: ${theme.fontSizes.bigTitle};\n    font-weight: lighter;\n    text-align: center;\n  `\n)\n\nexport const SmallTitle = styled.h3(\n  ({ theme }) => css`\n    font-size: ${theme.fontSizes.content};\n  `\n)\n\nexport const Faded = styled.span(\n  ({ theme }) => css`\n    color: ${theme.colors.subduedText};\n  `\n)\n","/**\n * Converts a list of objects into a map.\n * @param list The original list\n * @param keyProp The keyProp parameter defines which property of the objects will be used as the index for the map\n */\nexport const listToMap = <T>(list: T[], keyProp: string): Record<string, T> => {\n  return list.reduce((result: Record<string, T>, current: any) => {\n    result[current[keyProp]] = current\n    return result\n  }, {})\n}\n\n/**\n * Returns a URL object when the value is a hyperlink. Else undefined\n */\nexport function parseUrl(value: string) {\n  try {\n    return new URL(value)\n  } catch (err) {\n    // This is expected. If this method cannot parse the url it will return undefined.\n    return undefined\n  }\n}\n\n/**\n * converts a version like \"1.2.7\" into 127\n */\nexport function versionToNumber(majorMinorPatch: string) {\n  return Number(majorMinorPatch.split('.').join(''))\n}\n\n/**\n * Hacky ass way to download images cross origin. Could solve this by hosting both the app and the api on the same domain.\n */\nexport function download(url: string) {\n  const filename = url.split('/').pop() || ''\n\n  fetch(url, {\n    headers: new Headers({\n      Origin: window.location.origin,\n    }),\n    mode: 'cors',\n  })\n    .then((response) => response.blob())\n    .then((blob) => {\n      var a = document.createElement('a')\n      a.download = filename\n      a.href = window.URL.createObjectURL(blob)\n      document.body.appendChild(a)\n      a.click()\n      a.remove()\n    })\n    .catch((e) => console.error('Download error:', e))\n}\n\n/**\n * Returns the current version of the project\n */\nexport function getVersion() {\n  // Some browsers fail to get environment variables. In that case return unknown.\n  if (process?.env?.REACT_APP_VERSION) {\n    return process.env.REACT_APP_VERSION\n  }\n\n  return 'unknown'\n}\n\n/**\n * Render ready version.\n */\nexport function getVersionString() {\n  const version = getVersion()\n\n  return version === 'unknown' ? 'Latest Release' : `Version ${version}`\n}\n\n/**\n * Returns the correct source based on preferences\n */\nexport function getCorrectSource(loadOriginal: boolean, big_src: string, small_src: string) {\n  const source = loadOriginal ? big_src : small_src\n  return source\n}\n\nexport function boolToNumber(value: boolean) {\n  return value ? 1 : 0\n}\n","export const supportsFlexGap = (() => {\n  // create flex container with row-gap set\n  var flex = document.createElement('div')\n  flex.style.display = 'flex'\n  flex.style.flexDirection = 'column'\n  flex.style.rowGap = '1px'\n\n  // create two, elements inside it\n  flex.appendChild(document.createElement('div'))\n  flex.appendChild(document.createElement('div'))\n\n  // append to the DOM (needed to obtain scrollHeight)\n  document.body.appendChild(flex)\n  var isSupported = flex.scrollHeight === 1 // flex container should be 1px high from the row-gap\n  //@ts-expect-error\n  flex.parentNode.removeChild(flex)\n\n  return isSupported\n})()\n\nexport const supportsGap = 'gap' in document.body.style\nexport const supportsAspectRatio = 'aspect-ratio' in document.body.style\nexport const supportsObjectFit = 'object-fit' in document.body.style\nexport const supportsFullscreen = document.fullscreenEnabled\nexport const supportsNetworkInformationAPI =\n  'connection' in navigator || 'mozConnection' in navigator || 'webkitConnection' in navigator\n\nexport async function openFullscreen(element: Element) {\n  if (document.fullscreenEnabled && document.fullscreenElement === null) {\n    try {\n      const result = element.requestFullscreen()\n\n      if ('then' in result) {\n        return await result\n      }\n\n      return Promise.resolve(result)\n    } catch (err) {\n      // this causes a warning in console. So nothing to do for me here.\n    }\n  }\n\n  return null\n}\n\nexport async function closeFullscreen() {\n  if (document.fullscreenEnabled && document.fullscreenElement !== null) {\n    try {\n      const result = document.exitFullscreen()\n\n      if ('then' in result) {\n        return await result\n      }\n\n      return Promise.resolve(result)\n    } catch (err) {\n      // this causes a warning in console. So nothing to do for me here.\n    }\n  }\n\n  return null\n}\n","import { useCallback } from 'react'\nimport { useDispatch } from 'react-redux'\nimport { AnyAction } from 'redux'\n\n/**\n * A hook that simplifies usage of simple (unparameterized) Redux actions\n */\nexport default function useAction<T extends () => AnyAction>(actionCreator: T) {\n  const dispatch = useDispatch()\n\n  return useCallback(() => dispatch(actionCreator()), [actionCreator, dispatch])\n}\n","import { useCallback } from 'react'\nimport { PreferenceKey } from 'r34-types'\nimport { useDispatch, useSelector } from 'react-redux'\nimport { setPreference } from '../redux/actions'\nimport { PreferencesState } from '../redux/reducers/preferences'\nimport { selectPreferences } from '../redux/selectors'\n\n/**\n * useState for preferences using redux instead of local state.\n */\nexport default function usePreference<T extends PreferenceKey>(\n  key: T\n): [PreferencesState[T], (value: PreferencesState[T]) => void] {\n  const dispatch = useDispatch()\n  const preferences = useSelector(selectPreferences)\n  const setValue = useCallback((value: any) => dispatch(setPreference(key, value)), [dispatch, key])\n\n  return [preferences[key], setValue]\n}\n","import styled, { css } from 'styled-components'\n\nexport const HorizontalLine = styled.div(\n  (props) => css`\n    align-self: stretch;\n    height: 1px;\n    background: ${props.theme.colors.layerBg};\n  `\n)\n\nexport const VerticalLine = styled.div(\n  (props) => css`\n    width: 1px;\n    align-self: stretch;\n    background: ${props.theme.colors.layerBg};\n  `\n)\n","import { parseUrl } from '../data/utils'\n\n/**\n * Transforms a number into a shortened version for rendering.\n * Useful as it takes up less space.\n */\nexport const formatCount = (value: number) => {\n  if (value / 1e6 >= 1) {\n    return `${Math.trunc(value / 1e6)}M`\n  }\n\n  if (value >= 1e3) {\n    return `${Math.trunc(value / 1e3)}K`\n  }\n\n  return value.toString()\n}\n\n/**\n * Formats source strings for rendering\n */\nexport const formatSource = (source: string) => {\n  const url = parseUrl(source)\n  return url ? url.host : source\n}\n\n/**\n * Seconds to mm:ss formatter\n */\nexport function formatDuration(duration: number) {\n  const min = Math.trunc(duration / 60)\n  const sec = Math.trunc(duration % 60)\n\n  return min + ':' + (sec < 10 ? '0' : '') + sec\n}\n\n/**\n * Formats tag names for rendering.\n */\nexport function formatTagname(tagname: string) {\n  return tagname\n    .replace(/_/g, ' ')\n    .replace(/source:/g, '')\n    .replace(/rating:/g, '')\n}\n\n/**\n * Formats tags with their count if possible\n */\nexport function formatTagnameAndCount(name: string, count?: number) {\n  return count ? `${formatTagname(name)} (${formatCount(count)})` : formatTagname(name)\n}\n\nconst z = (value: number) => (value < 10 ? `0${value}` : value.toString())\n\n/**\n * Returns a string containing date and time of agiven Date object\n */\nexport function formatDatetime(date: Date) {\n  const dd = z(date.getDate())\n  const MM = z(date.getMonth() + 1) // zero indexed\n  const yyyy = date.getFullYear()\n  const hh = z(date.getHours())\n  const mm = z(date.getMinutes())\n\n  return `${dd}/${MM}/${yyyy} ${hh}:${mm}`\n}\n\n/**\n * Returns a human friendly approximation of a given time\n */\nexport function formatTime(milliseconds: number) {\n  if (milliseconds >= 315576e5) {\n    return formatUnit(milliseconds, 315576e5, 'year')\n  }\n\n  if (milliseconds >= 26297568e2) {\n    return formatUnit(milliseconds, 26297568e2, 'month')\n  }\n\n  if (milliseconds >= 6048e5) {\n    return formatUnit(milliseconds, 6048e5, 'week')\n  }\n\n  if (milliseconds >= 854e5) {\n    return formatUnit(milliseconds, 854e5, 'day')\n  }\n\n  if (milliseconds >= 36e5) {\n    return formatUnit(milliseconds, 36e5, 'hour')\n  }\n\n  if (milliseconds >= 6e4) {\n    return formatUnit(milliseconds, 6e4, 'minute')\n  }\n\n  if (milliseconds >= 1e3) {\n    return formatUnit(milliseconds, 1e3, 'second')\n  }\n\n  return `${milliseconds} ms`\n}\n\nexport function formatUnit(value: number, unitSize: number, unit: string) {\n  const result = (value / unitSize).toFixed(0)\n\n  const unitString = result === '1' ? unit : `${unit}s`\n\n  return `${result} ${unitString}`\n}\n","import styled from 'styled-components'\nimport { borderRadius, gutter, layer } from '../../styled/mixins'\n\nexport default styled.div`\n  display: grid;\n  ${gutter}\n  ${layer}\n  ${borderRadius}\n  width: 100%;\n`\n","import firebase from 'firebase/app'\nimport 'firebase/auth'\nimport { useEffect, useState } from 'react'\n\n/**\n * A hook that provides the firebase authentication status for use in functional components.\n */\nexport default function useFirebaseAuthState() {\n  const [authState, setAuthState] = useState(false)\n  const [user, setUser] = useState<firebase.User | null>(null)\n\n  useEffect(() => {\n    const unsubscribe = firebase.auth().onAuthStateChanged((user) => {\n      if (user) {\n        setAuthState(true)\n        setUser(user)\n      } else {\n        setAuthState(false)\n        setUser(null)\n      }\n    })\n    return () => {\n      unsubscribe()\n    }\n  }, [])\n\n  return [authState, user] as const\n}\n","import styled from 'styled-components'\nimport { preserveAspectRatio, flexMedia } from '../../styled/mixins'\n\nconst FlexImage = styled.img`\n  ${flexMedia}\n  ${preserveAspectRatio}\n`\n\nexport default FlexImage\n","import React, { MouseEventHandler } from 'react'\nimport FlexPair from './FlexPair'\nimport Toggle from './Toggle'\n\ninterface LabeledToggleProps {\n  children: React.ReactNode\n  value: boolean\n  onToggle: MouseEventHandler\n}\n\nexport default function LabeledToggle(props: LabeledToggleProps) {\n  const { children, value, onToggle } = props\n\n  return (\n    <FlexPair>\n      <Toggle value={value} onToggle={onToggle} />\n      <span>{children}</span>\n    </FlexPair>\n  )\n}\n","import { TagType } from 'r34-types'\nimport React from 'react'\nimport {\n  CharacterIcon,\n  CopyrightIcon,\n  ArtistIcon,\n  RatingIcon,\n  SourceIcon,\n  MetaDataIcon,\n  SupertagIcon,\n} from './FontAwesomeIcons'\n\ninterface TypeIconProps {\n  type?: TagType\n  className?: string\n}\n\nexport default function TypeIcon(props: TypeIconProps) {\n  const { type, className = '' } = props\n\n  switch (type) {\n    case 'character':\n      return <CharacterIcon className={className} />\n    case 'copyright':\n      return <CopyrightIcon className={className} />\n    case 'artist':\n      return <ArtistIcon className={className} />\n    case 'rating':\n      return <RatingIcon className={className} />\n    case 'source':\n      return <SourceIcon className={className} />\n    case 'metadata':\n      return <MetaDataIcon className={className} />\n    case 'supertag':\n      return <SupertagIcon className={className} />\n    default:\n      return null\n  }\n}\n","import styled from 'styled-components'\nimport { flexColumn, gutter, centeredMaxWidth } from '../../styled/mixins'\n\nconst FlexColumn = styled.div`\n  ${flexColumn}\n  width: 100%;\n  min-height: 100%;\n`\n\nexport default FlexColumn\n\nexport const FlexColumnWithSpacing = styled(FlexColumn)`\n  ${gutter}\n  ${centeredMaxWidth}\n`\n","import React, { MouseEventHandler } from 'react'\nimport styled, { css, DefaultTheme } from 'styled-components'\nimport { supportsAspectRatio } from '../../data/browserUtils'\nimport { defaultBorder } from '../../styled/mixins'\n\nconst Track = styled.div(\n  (props) => css`\n    height: 24px;\n    width: 50px;\n    ${defaultBorder(props)}\n    border-radius: 30px;\n    background-color: transparent;\n    transition: transform ${props.theme.timings.longTransitionTime} ease-in-out;\n    cursor: pointer;\n  `\n)\n\n/**\n * CSS helper that falls back to less fancy styling on older browsers\n */\nfunction circle() {\n  return supportsAspectRatio\n    ? css`\n        height: 100%;\n        aspect-ratio: 1/1;\n      `\n    : css`\n        height: 100%;\n        width: 22px;\n      `\n}\n\nconst Thumb = styled.div(\n  (props: { value: boolean; theme: DefaultTheme }) => css`\n    ${circle()}\n    background-color: ${props.value ? props.theme.colors.accentColor : props.theme.colors.backgroundColor2};\n    border-radius: 100px;\n    transition: all 0.2s ease-in-out;\n    transform: translate(${props.value ? '26px' : '0px'});\n  `\n)\n\ninterface ToggleProps {\n  value: boolean\n  onToggle: MouseEventHandler\n}\n\nexport default function Toggle(props: ToggleProps) {\n  const { value, onToggle } = props\n\n  return (\n    <Track onClick={onToggle} role='checkbox'>\n      <Thumb value={value} />\n    </Track>\n  )\n}\n","import React, { RefAttributes } from 'react'\nimport { Link, LinkProps, useLocation } from 'react-router-dom'\nimport styled, { css, ThemeProps } from 'styled-components'\nimport { RouteName } from '../../data/types'\nimport R34Icon from '../../icons/R34Icon'\nimport { flexColumn, flexColumnGap, flexRowGap, flexRowWithGap } from '../../styled/mixins'\nimport { VerticalLine } from '../designsystem/Lines'\nimport { BigTitle } from '../designsystem/Text'\n\nconst HeaderWrapper = styled.header(\n  ({ theme }) => css`\n    ${flexColumn()}\n    ${flexColumnGap(theme.dimensions.bigSpacing)}\n  `\n)\n\nconst TitleBar = styled.div(\n  ({ theme }) => css`\n    ${flexRowWithGap({ theme })}\n    justify-content: center;\n    background: ${theme.colors.layerBgSolid};\n    padding: ${theme.dimensions.gutter} 0;\n  `\n)\n\nconst MenuBar = styled.nav(\n  ({ theme }) => css`\n    display: flex;\n    justify-content: center;\n    padding: ${theme.dimensions.bigSpacing};\n    ${flexRowGap(theme.dimensions.hugeSpacing)}\n  `\n)\n\ntype LocationStyledLinkProps = LinkProps<unknown> &\n  RefAttributes<HTMLAnchorElement> &\n  ThemeProps<any> & { current: string }\n\nconst LocationStyledLink = styled(Link)(\n  ({ to, current, theme }: LocationStyledLinkProps) => css`\n    color: ${to === current ? theme.colors.accentColor : theme.colors.text};\n  `\n)\n\nexport default function Header() {\n  const current = useLocation().pathname\n\n  return (\n    <HeaderWrapper role='cell'>\n      <TitleBar>\n        <R34Icon size={32} />\n        <VerticalLine />\n        <BigTitle>\n          <span>Browse</span> <a href='https://rule34.xxx'>Rule34</a>\n        </BigTitle>\n      </TitleBar>\n\n      <MenuBar>\n        <LocationStyledLink current={current} to={RouteName.SEARCH}>\n          Search\n        </LocationStyledLink>\n        <VerticalLine />\n        <LocationStyledLink current={current} to={RouteName.SETTINGS}>\n          Settings\n        </LocationStyledLink>\n        <VerticalLine />\n        <LocationStyledLink current={current} to={RouteName.ABOUT}>\n          About\n        </LocationStyledLink>\n      </MenuBar>\n    </HeaderWrapper>\n  )\n}\n","import styled from 'styled-components'\nimport { flexRowWithGap } from '../../styled/mixins'\n\nconst FlexPair = styled.div`\n  ${flexRowWithGap}\n`\n\nexport default FlexPair\n","import styled, { css } from 'styled-components'\nimport { TagModifier } from 'r34-types'\n\nconst modifierToStyle = {\n  '+': css``,\n  '-': css`\n    text-decoration: line-through;\n  `,\n  '~': css`\n    font-style: italic;\n  `,\n}\n\ninterface ModifierStyledTextProps {\n  modifier: TagModifier\n}\n\nexport const ModifierStyledText = styled.span(\n  ({ modifier = '+' }: ModifierStyledTextProps) => modifierToStyle[modifier]\n)\n","import { TagModifier } from 'r34-types'\nimport { formatTagnameAndCount } from '../../misc/formatting'\nimport { ModifierStyledText } from '../designsystem/ModifierStyledText'\n\ninterface TagNameProps {\n  modifier: TagModifier\n  name: string\n  count?: number\n}\n\nexport default function TagName(props: TagNameProps) {\n  const { modifier, name, count } = props\n\n  return (\n    <ModifierStyledText modifier={modifier} tabIndex={0}>\n      {formatTagnameAndCount(name, count)}\n    </ModifierStyledText>\n  )\n}\n","import React, { MouseEventHandler, useCallback } from 'react'\nimport { useDispatch } from 'react-redux'\nimport styled, { css } from 'styled-components'\nimport { TagModifier } from 'r34-types'\nimport { addTag } from '../../redux/actions'\nimport { flexRowWithGap } from '../../styled/mixins'\nimport TagName from './TagName'\n\ninterface AliasProps {\n  modifier: TagModifier\n  name: string\n  count: number\n}\n\nconst AliasWrapper = styled.div(\n  ({ theme }) => css`\n    ${flexRowWithGap({ theme })}\n    padding: ${theme.dimensions.bigSpacing};\n    font-size: ${theme.fontSizes.content};\n  `\n)\n\nexport default function Alias(props: AliasProps) {\n  const { name, count, modifier } = props\n\n  const dispatch = useDispatch()\n\n  const handleClick: MouseEventHandler = useCallback(\n    (event) => {\n      event.stopPropagation()\n      dispatch(addTag({ name, types: [], count, modifier }))\n    },\n    [count, dispatch, modifier, name]\n  )\n\n  return (\n    <AliasWrapper onClick={handleClick} data-name={`alias:${name}`}>\n      <TagName modifier={modifier} name={name} count={count} />\n    </AliasWrapper>\n  )\n}\n","import React from 'react'\nimport styled, { css, DefaultTheme } from 'styled-components'\nimport Alias from './Alias'\nimport * as r34 from 'r34-types'\nimport { dropdownScrollbar } from '../../styled/mixins'\n\nconst ListWrapper = styled.div(({ theme, parentRef }: { theme: DefaultTheme; parentRef: HTMLDivElement }) =>\n  parentRef\n    ? css`\n        position: absolute;\n        top: ${parentRef.offsetTop + parentRef.clientHeight + 4}px;\n        left: ${parentRef.offsetLeft}px;\n        width: ${parentRef.clientWidth + 4}px;\n\n        display: flex;\n        flex-direction: column;\n\n        border-bottom-left-radius: ${theme.dimensions.borderRadius};\n        border-bottom-right-radius: ${theme.dimensions.borderRadius};\n        border: ${theme.dimensions.borderWidth} solid ${theme.colors.accentColor};\n        border-top: none;\n\n        background: ${theme.colors.backgroundColor2};\n        z-index: 3;\n        color: ${theme.colors.backgroundColor};\n\n        > :not(:last-child) {\n          border-bottom: ${theme.dimensions.borderWidth} solid lightgray;\n        }\n\n        max-height: 30vh;\n\n        ${dropdownScrollbar}\n      `\n    : css`\n        display: none;\n      `\n)\n\ninterface AliasesListProps {\n  aliases: r34.AliasTag[]\n  modifier: r34.TagModifier\n  parentRef: HTMLDivElement\n}\n\nexport default function AliasesList(props: AliasesListProps) {\n  const { aliases, modifier, parentRef } = props\n\n  return (\n    <ListWrapper parentRef={parentRef} className='aliaslist'>\n      {aliases.map(({ name, count }) => (\n        <Alias key={'a_' + name} name={name} count={count} modifier={modifier} />\n      ))}\n    </ListWrapper>\n  )\n}\n","import { MouseEventHandler } from 'react'\nimport styled, { css, DefaultTheme } from 'styled-components'\nimport { TagIsActive } from '../../data/types'\nimport { flexRowWithGap, focusBorderAndColor, primaryHover } from '../../styled/mixins'\n\nconst dropdownBorderRadius = (collapsed: boolean, theme: DefaultTheme) =>\n  collapsed ? theme.dimensions.borderRadius : `${theme.dimensions.borderRadius} ${theme.dimensions.borderRadius} 0 0`\n\nconst switchingColors = (active: TagIsActive, collapsed: boolean, theme: DefaultTheme) => {\n  switch (active) {\n    case 'direct':\n      return css`\n        ${primaryHover}\n      `\n    case 'indirect':\n      return css`\n        color: ${theme.colors.accentColor};\n        background-color: ${theme.colors.accentColor}40;\n\n        :hover {\n          background-color: ${theme.colors.accentColor}60;\n        }\n\n        :active {\n          background-color: ${theme.colors.accentColor}50;\n        }\n\n        ${focusBorderAndColor}\n      `\n    case 'no':\n      return css`\n        color: ${theme.colors.accentColor};\n\n        :hover {\n          background-color: ${theme.colors.accentColor}40;\n        }\n\n        :active {\n          background-color: ${theme.colors.accentColor}20;\n        }\n\n        ${focusBorderAndColor}\n      `\n  }\n}\n\nexport const ChipWrapper = styled.div(\n  (props: { active: TagIsActive; collapsed: boolean; onMouseLeave: MouseEventHandler; theme: DefaultTheme }) =>\n    css`\n      cursor: pointer;\n      border: ${props.theme.colors.accentColor} ${props.theme.dimensions.borderWidth} solid;\n      ${flexRowWithGap({ theme: props.theme })}\n      ${switchingColors(props.active, props.collapsed, props.theme)}\n      padding: 0 ${props.theme.dimensions.gutter};\n      height: ${props.theme.dimensions.blockHeight};\n      border-radius: ${dropdownBorderRadius(props.collapsed, props.theme)};\n      font-size: ${props.theme.fontSizes.content};\n      user-select: none;\n\n      ${props.collapsed\n        ? ''\n        : css`\n            border-bottom-color: ${props.theme.colors.accentColor};\n          `}\n\n      .aliaslist {\n        border-color: ${props.theme.colors.backgroundColor2};\n      }\n    `\n)\n","import React, { KeyboardEventHandler, MouseEventHandler, SyntheticEvent, useCallback, useState } from 'react'\nimport styled, { DefaultTheme, css } from 'styled-components'\nimport { TagModifier, TagType, AliasTag } from 'r34-types'\nimport useToggle from '../../hooks/useToggle'\nimport { ArrowDown } from '../../icons/FontAwesomeIcons'\nimport TypeIcon from '../../icons/TypeIcon'\nimport AliasesList from './AliasesList'\nimport { ChipWrapper } from './ChipWrapper'\nimport TagName from './TagName'\nimport { TagIsActive } from '../../data/types'\n\nconst DropdownArrow = styled(ArrowDown)(\n  ({ $collapsed, theme }: { $collapsed: boolean; theme: DefaultTheme }) => css`\n    transition: all ${theme.timings.transitionTime} ease-out;\n    height: 32px;\n    width: 32px !important;\n    padding: 8px;\n    margin: 0 -8px;\n    ${$collapsed\n      ? css``\n      : css`\n          transform: rotate(180deg);\n        `}\n  `\n)\n\ninterface TagChipProps {\n  name: string\n  modifier: TagModifier\n  count?: number\n  type?: TagType\n  isActive: TagIsActive\n  detailed: boolean\n  onClick: React.EventHandler<SyntheticEvent>\n  onContextMenu?: React.EventHandler<SyntheticEvent>\n  aliases?: AliasTag[]\n}\n\nexport default function TagChip(props: TagChipProps) {\n  const { name, count, modifier, type, isActive, detailed, onClick, onContextMenu, aliases } = props\n\n  const [tagRef, setTagRef] = useState<HTMLDivElement | null>(null)\n  const [collapsed, toggleCollapsed, resetCollapsed] = useToggle(true)\n\n  const handleClick = useCallback(\n    (event: React.MouseEvent | React.KeyboardEvent) => {\n      event.preventDefault()\n      event.stopPropagation()\n      onClick(event)\n    },\n    [onClick]\n  )\n\n  const handleArrowClick: MouseEventHandler = useCallback(\n    (event) => {\n      event.stopPropagation()\n      toggleCollapsed()\n    },\n    [toggleCollapsed]\n  )\n\n  const handleEnter: KeyboardEventHandler = useCallback(\n    (event) => {\n      if (event.key === 'Enter') handleClick(event)\n    },\n    [handleClick]\n  )\n\n  const handleContextMenu = React.useCallback(\n    (e) => {\n      e.stopPropagation()\n      e.preventDefault()\n      onContextMenu?.(e)\n    },\n    [onContextMenu]\n  )\n\n  return (\n    <ChipWrapper\n      active={isActive}\n      collapsed={collapsed}\n      onClick={handleClick}\n      onKeyDown={handleEnter}\n      onMouseLeave={resetCollapsed}\n      onContextMenu={handleContextMenu}\n      ref={setTagRef}\n      tabIndex={0}\n    >\n      {detailed && <TypeIcon type={type} />}\n      <TagName modifier={modifier} name={name} count={count} />\n      {detailed && aliases && aliases.length > 0 && (\n        <>\n          <DropdownArrow onClick={handleArrowClick} $collapsed={collapsed} title='Show aliases' />\n          {!collapsed && tagRef && <AliasesList aliases={aliases} modifier={modifier} parentRef={tagRef} />}\n        </>\n      )}\n    </ChipWrapper>\n  )\n}\n","import React from 'react'\nimport * as r34 from 'r34-types'\nimport TagChip from './TagChip'\nimport { TagIsActive } from '../../data/types'\n\ninterface SupertagProps {\n  tag: r34.Supertag\n  isActive: TagIsActive\n  detailed: boolean\n  onClick: React.MouseEventHandler\n}\n\nexport default function Supertag(props: SupertagProps) {\n  const { tag, isActive, detailed, onClick } = props\n  const { name, tags } = tag\n\n  const count = Object.keys(tags).length\n\n  return (\n    <TagChip\n      name={name}\n      modifier='+'\n      type='supertag'\n      count={count}\n      isActive={isActive}\n      detailed={detailed}\n      onClick={onClick}\n    />\n  )\n}\n","import * as r34 from 'r34-types'\nimport TagChip from './TagChip'\nimport { getInterestingType } from '../../data/tagUtils'\nimport { TagIsActive } from '../../data/types'\nimport { useSelector } from 'react-redux'\nimport { selectAliases } from '../../redux/selectors'\n\ninterface TagProps {\n  tag: r34.BiasedTag\n  isActive: TagIsActive\n  detailed: boolean\n  onClick: React.MouseEventHandler\n  onContextMenu: React.MouseEventHandler\n}\n\nexport function BiasedTag(props: TagProps) {\n  const { tag, detailed, onClick, isActive, onContextMenu } = props\n  const { name, count, modifier, types } = tag\n\n  const aliases = useSelector(selectAliases)[name]\n\n  return (\n    <TagChip\n      name={name}\n      modifier={modifier}\n      type={getInterestingType(types)}\n      count={count}\n      isActive={isActive}\n      detailed={detailed}\n      onClick={onClick}\n      onContextMenu={onContextMenu}\n      aliases={aliases}\n    />\n  )\n}\n","import React, { MouseEventHandler, useCallback } from 'react'\nimport * as r34 from 'r34-types'\nimport { bias, isBiased, isSupertag } from '../../data/tagUtils'\nimport Supertag from './Supertag'\nimport { BiasedTag } from './BiasedTag'\nimport { TagIsActive } from '../../data/types'\n\ninterface TagProps {\n  tag: r34.AnyBiasedTag | r34.AnyTag\n  isActive: TagIsActive\n  detailed: boolean\n  onClick: (tag: r34.AnyBiasedTag) => void\n  onContextMenu: (tag: r34.AnyBiasedTag) => void\n}\n\nexport default function Tag(props: TagProps) {\n  const { tag, isActive, detailed, onClick, onContextMenu } = props\n\n  const biasedTag = isSupertag(tag) || isBiased(tag) ? tag : bias(tag, '+')\n\n  const handleClick: MouseEventHandler = useCallback(\n    (event) => {\n      event?.stopPropagation()\n      onClick(biasedTag)\n    },\n    [onClick, biasedTag]\n  )\n\n  const handleContextMenu: MouseEventHandler = useCallback(\n    (event) => {\n      onContextMenu(biasedTag)\n    },\n    [biasedTag, onContextMenu]\n  )\n\n  return isSupertag(biasedTag) ? (\n    <Supertag tag={biasedTag} isActive={isActive} detailed={detailed} onClick={handleClick} />\n  ) : (\n    <BiasedTag\n      tag={biasedTag}\n      isActive={isActive}\n      detailed={detailed}\n      onClick={handleClick}\n      onContextMenu={handleContextMenu}\n    />\n  )\n}\n","import React from 'react'\nimport styled, { css } from 'styled-components'\nimport { AnyBiasedTag, AnyTag } from 'r34-types'\nimport { flexRowGap, flexColumnGap } from '../../styled/mixins'\nimport Tag from './Tag'\nimport { TagIsActive } from '../../data/types'\n\nconst TagListWrapper = styled.div(\n  ({ theme }) => css`\n    display: inline-flex;\n    flex-wrap: wrap;\n    ${flexRowGap(theme.dimensions.gutter)}\n    ${flexColumnGap(theme.dimensions.gutter)}\n  `\n)\n\ninterface TagListProps {\n  /**\n   * The entries of the list. Must be a map to avoid duplicates\n   */\n  tags: Record<string, AnyTag>\n  /**\n   * Passthrough classname for styling from outside\n   */\n  className?: string\n  /**\n   * Setting detailed to true displays a type for some tags and provides the ability to add aliases.\n   */\n  detailed: boolean\n  /**\n   * Children will be added at the end of the list. Here you can provide additional functionality or information\n   */\n  children?: React.ReactNode\n\n  onTagClick: (tag: AnyBiasedTag) => void\n  onTagMenu: (tag: AnyBiasedTag) => void\n  getIsActive?: (tag: AnyTag) => TagIsActive\n}\n\n/**\n * This component can be used to display multiple tags in a list of chips/badges.\n *\n */\nexport default function TagList(props: TagListProps) {\n  const { tags, className, detailed, children = null, onTagClick, getIsActive, onTagMenu } = props\n\n  return (\n    <TagListWrapper className={className}>\n      {Object.entries(tags).map(([key, tag]) => (\n        <Tag\n          key={key}\n          detailed={detailed}\n          tag={tag}\n          onClick={onTagClick}\n          onContextMenu={onTagMenu}\n          isActive={getIsActive?.(tag) || 'no'}\n        />\n      ))}\n      {children}\n    </TagListWrapper>\n  )\n}\n","import { useCallback, useState } from 'react'\n\n/**\n * A small wrapper for a useState<boolean> that is primarily used for toggling.\n * Saves me a few useCallbacks.\n */\nexport default function useToggle(initialValue = false): [boolean, () => void, () => void] {\n  const [value, setValue] = useState<boolean>(initialValue)\n  const toggleValue = useCallback(() => setValue(!value), [value])\n  const resetValue = useCallback(() => setValue(initialValue), [initialValue])\n\n  return [value, toggleValue, resetValue]\n}\n","import { useCallback } from 'react'\nimport { useDispatch, useSelector } from 'react-redux'\nimport { removeTag, addTag } from '../redux/actions'\nimport { selectActiveTags } from '../redux/selectors'\nimport * as r34 from 'r34-types'\n\n/**\n * This hook allows you to add a tag to your search or remove it based on its current status.\n */\nexport default function useToggleTag() {\n  const dispatch = useDispatch()\n  const activeTags = useSelector(selectActiveTags)\n  const toggleTag = useCallback(\n    (tag: r34.AnyBiasedTag) => {\n      if (tag.name in activeTags) {\n        dispatch(removeTag(tag.name))\n      } else {\n        dispatch(addTag(tag))\n      }\n    },\n    [activeTags, dispatch]\n  )\n\n  return toggleTag\n}\n","import React from 'react'\nimport * as r34 from 'r34-types'\nimport styled, { css } from 'styled-components'\nimport { CountUnit } from '../../data/types'\nimport TypeIcon from '../../icons/TypeIcon'\nimport { formatCount, formatTagname } from '../../misc/formatting'\n\nconst EntryWrapper = styled.div(\n  ({ theme }) => css`\n    display: grid;\n    grid-template-columns: 48px 1fr auto;\n    background: ${theme.colors.backgroundColor2};\n    padding: ${theme.dimensions.bigSpacing} 0;\n    align-items: center;\n    cursor: pointer;\n  `\n)\n\nconst Name = styled.span`\n  grid-column: 2/3;\n`\n\nconst Count = styled.span(\n  ({ theme }) => css`\n    grid-column: 3/4;\n    padding-right: ${theme.dimensions.bigSpacing};\n  `\n)\n\nconst Icon = styled.div`\n  grid-column: 1/2;\n  text-align: center;\n`\n\ninterface EntryProps {\n  name: string\n  count: number\n  type?: r34.TagType\n  onClick: React.MouseEventHandler\n}\n\nexport default function DropdownListEntry(props: EntryProps) {\n  const { name, count, type, onClick } = props\n\n  const unit: CountUnit = type === 'supertag' ? 'tags' : 'posts'\n\n  return (\n    <EntryWrapper onClick={onClick}>\n      <Icon>\n        <TypeIcon type={type} />\n      </Icon>\n      <Name>{formatTagname(name)}</Name>\n      <Count>\n        {count && formatCount(count)} {unit}\n      </Count>\n    </EntryWrapper>\n  )\n}\n","import styled, { css } from 'styled-components'\nimport { flexRowWithGap } from '../../styled/mixins'\n\nexport const DropdownListError = styled.div(\n  ({ theme }) => css`\n    ${flexRowWithGap}\n    flex-wrap: wrap;\n    min-height: ${theme.dimensions.blockHeight}; // COMPAT: Kiwi Browser\n    background: ${theme.colors.backgroundColor2};\n    padding: 6px;\n    align-items: center;\n    justify-content: center;\n    text-align: center;\n    cursor: pointer;\n  `\n)\n","import React from 'react'\nimport styled, { css, DefaultTheme } from 'styled-components'\nimport DropdownListEntry from './DropdownListEntry'\nimport { dropdownScrollbar, flexColumn, flexColumnGap } from '../../styled/mixins'\nimport * as r34 from 'r34-types'\nimport { getInterestingType, isSupertag } from '../../data/tagUtils'\nimport { SuggestionsError } from '../../data/types'\nimport { DropdownListError } from './DropdownListError'\n\nfunction sizeAndPosition(tagSelector: HTMLElement | null) {\n  if (tagSelector) {\n    const { offsetTop, clientHeight, offsetLeft, clientWidth } = tagSelector\n\n    return css`\n      position: absolute;\n      top: ${offsetTop + clientHeight}px;\n      left: ${offsetLeft}px;\n      width: ${clientWidth}px;\n      max-height: 50vh;\n    `\n  } else {\n    return css`\n      display: none;\n    `\n  }\n}\n\nconst ListWrapper = styled.div(\n  ({ theme, tagSelectorRef }: { tagSelectorRef: HTMLElement | null; theme: DefaultTheme }) => css`\n    ${flexColumn()}\n    ${flexColumnGap('1px')}\n    ${sizeAndPosition(tagSelectorRef)};\n    background: lightgrey;\n    box-sizing: border-box;\n    border: ${theme.dimensions.borderWidth} ${theme.colors.accentColor} solid;\n    border-top: none;\n    border-radius: 0 0 3px 3px;\n    color: black;\n    z-index: 3;\n\n    ${dropdownScrollbar}\n  `\n)\n\ninterface DropdownListProps {\n  tagSelectorRef: HTMLElement | null\n  entries: r34.AnyTag[]\n  onClick: (entry: r34.AnyTag) => void\n  error: SuggestionsError | null\n}\n\nexport default function DropdownList(props: DropdownListProps) {\n  const { tagSelectorRef, entries, onClick, error } = props\n\n  return (\n    <ListWrapper tagSelectorRef={tagSelectorRef}>\n      {error ? (\n        <DropdownListError>\n          <span>{error.message}.</span>\n          <span>{error.results} tags found</span>\n        </DropdownListError>\n      ) : (\n        entries.map((entry) => {\n          const type = isSupertag(entry) ? 'supertag' : getInterestingType(entry.types)\n          const count = isSupertag(entry) ? Object.keys(entry.tags).length : (entry.count as number)\n\n          return (\n            <DropdownListEntry\n              key={entry.name}\n              onClick={() => onClick(entry)}\n              name={entry.name}\n              type={type}\n              count={count}\n            />\n          )\n        })\n      )}\n    </ListWrapper>\n  )\n}\n","import React, { ChangeEventHandler, KeyboardEventHandler, useCallback } from 'react'\nimport styled, { css } from 'styled-components'\n\nconst Input = styled.input(\n  (props) => css`\n    width: 100%;\n    border: none;\n    outline: none;\n    background: none;\n    font-size: ${props.theme.fontSizes.content};\n    border-top: ${props.theme.colors.accentColor} ${props.theme.dimensions.borderWidth} solid;\n    border-bottom: ${props.theme.colors.accentColor} ${props.theme.dimensions.borderWidth} solid;\n  `\n)\n\ninterface TagInputProps {\n  value: string\n  setValue: (newValue: string) => void\n  onSubmit: () => void\n}\n\nexport default function TagInput(props: TagInputProps) {\n  const { value, setValue, onSubmit } = props\n\n  const handleChange: ChangeEventHandler<HTMLInputElement> = useCallback(\n    (event) => {\n      setValue(event.target.value)\n    },\n    [setValue]\n  )\n\n  const handleEnter: KeyboardEventHandler = useCallback(\n    (event: React.KeyboardEvent) => {\n      if (event.key === 'Enter') {\n        onSubmit()\n      }\n    },\n    [onSubmit]\n  )\n\n  return (\n    <Input\n      id='tag-input'\n      value={value}\n      onChange={handleChange}\n      onKeyDown={handleEnter}\n      placeholder='Search for tags'\n      aria-label='Search'\n    />\n  )\n}\n","import React from 'react'\nimport * as r34 from 'r34-types'\nimport { useDispatch, useSelector } from 'react-redux'\nimport styled, { css, DefaultTheme } from 'styled-components'\nimport useThrottledEffect from 'use-throttled-effect'\nimport { bias, isSupertag, serializeTagname } from '../../data/tagUtils'\nimport useModifier from '../../hooks/useModifier'\nimport { PlusIcon } from '../../icons/FontAwesomeIcons'\nimport { fetchSuggestions, setSuggestions } from '../../redux/actions'\nimport { selectSuggestions, selectSuggestionsError } from '../../redux/selectors'\nimport { AddButton, ModifierButton } from '../designsystem/Buttons'\nimport DropdownList from './DropdownList'\nimport TagInput from './TagInput'\n\nconst TagSelectorWrapper = styled.form(\n  (props: { closed: boolean; ref: (ref: HTMLInputElement) => void; theme: DefaultTheme }) => css`\n    display: flex;\n    background: white;\n    ${props.closed\n      ? css`\n          border-radius: ${props.theme.dimensions.borderRadius};\n        `\n      : css`\n          border-radius: ${props.theme.dimensions.borderRadius} ${props.theme.dimensions.borderRadius} 0 0;\n\n          > ${AddButton} {\n            border-radius: 0 ${props.theme.dimensions.borderRadius} 0 0;\n          }\n\n          > ${ModifierButton} {\n            border-radius: ${props.theme.dimensions.borderRadius} 0 0 0;\n          }\n        `}\n  `\n)\n\ninterface TagSelectorProps {\n  showSupertags: boolean\n  onSubmit: (tag: r34.AnyBiasedTag) => void\n}\n\nexport default function TagSelector(props: TagSelectorProps) {\n  const { onSubmit, showSupertags } = props\n\n  const dispatch = useDispatch()\n\n  const [value, setValue] = React.useState('')\n  const [tagSelectorRef, setTagSelectorRef] = React.useState<HTMLElement | null>(null)\n  const [modifier, nextModifier] = useModifier()\n\n  const suggestions = useSelector(selectSuggestions)\n  const error = useSelector(selectSuggestionsError)\n\n  const activateTag = React.useCallback(\n    (tag: r34.Tag | r34.Supertag) => {\n      const biasedTag = isSupertag(tag) ? tag : bias(tag, modifier)\n      onSubmit(biasedTag)\n      setValue('')\n    },\n    [modifier, onSubmit]\n  )\n\n  // This effect updates suggestions based on the input value\n  // if the value is empty, it clears suggestions\n  // if the value is not empty, it fetches suggestions from the backend\n  useThrottledEffect(\n    () => {\n      if (value === '') {\n        if (suggestions.length > 0) {\n          dispatch(setSuggestions([]))\n        }\n      } else {\n        dispatch(fetchSuggestions(value, showSupertags))\n      }\n    },\n    300,\n    [value]\n  )\n\n  const handleAddClick = React.useCallback(() => {\n    if (value.trim()) {\n      const sanitizedTagname = serializeTagname(value)\n      const suggestion: r34.AnyTag | undefined = suggestions.find((s) => s.name === sanitizedTagname)\n\n      if (suggestion) {\n        activateTag(suggestion)\n      } else {\n        activateTag({ name: sanitizedTagname, types: [] })\n      }\n    }\n  }, [value, activateTag, suggestions])\n\n  const showList = suggestions.length > 0 || error !== null\n\n  const preventDefault = React.useCallback((e) => e.preventDefault(), [])\n\n  return (\n    <TagSelectorWrapper ref={setTagSelectorRef} closed={!showList} onSubmit={preventDefault}>\n      <ModifierButton onClick={nextModifier} aria-label='Tag Modifier' title='Cycle tag modifier'>\n        {modifier}\n      </ModifierButton>\n      <TagInput value={value} setValue={setValue} onSubmit={handleAddClick} />\n      <AddButton onClick={handleAddClick} aria-label='Add Tag'>\n        <PlusIcon title='Add tag' />\n      </AddButton>\n      {showList && value.length > 0 && (\n        <DropdownList tagSelectorRef={tagSelectorRef} entries={suggestions} error={error} onClick={activateTag} />\n      )}\n    </TagSelectorWrapper>\n  )\n}\n","import React, { useCallback } from 'react'\nimport { signOut } from '../../firebase'\nimport { UndoIcon } from '../../icons/FontAwesomeIcons'\nimport { BlockButton } from '../designsystem/Buttons'\n\nexport default function ResetButton(props: any) {\n  const reset = useCallback(async () => {\n    localStorage.clear()\n    await signOut()\n\n    window.location.hash = ''\n    window.location.reload()\n  }, [])\n\n  return (\n    <BlockButton onClick={reset} {...props}>\n      <UndoIcon /> Reset Application\n    </BlockButton>\n  )\n}\n","export default __webpack_public_path__ + \"static/media/OutOfResults.9c71691c.png\";","import React from 'react'\nimport styled from 'styled-components'\n\n// Don't use theme here so the loadingScreen is independent\n// eg. Loading the theme displays this loading screen\nconst StyledSvg = styled.svg`\n  height: 32px;\n  padding: 8px;\n  color: white;\n`\n\nexport default function Loading() {\n  return (\n    <StyledSvg\n      xmlns='http://www.w3.org/2000/svg'\n      xmlnsXlink='http://www.w3.org/1999/xlink'\n      viewBox='0 0 50 20'\n      enable-background='new 0 0 0 0'\n      xmlSpace='preserve'\n    >\n      <circle fill='currentcolor' stroke='none' cx='6' cy='10' r='6'>\n        <animate attributeName='opacity' dur='1s' values='0;1;0' repeatCount='indefinite' begin='0.1' />\n      </circle>\n      <circle fill='currentcolor' stroke='none' cx='25' cy='10' r='6'>\n        <animate attributeName='opacity' dur='1s' values='0;1;0' repeatCount='indefinite' begin='0.2' />\n      </circle>\n      <circle fill='currentcolor' stroke='none' cx='44' cy='10' r='6'>\n        <animate attributeName='opacity' dur='1s' values='0;1;0' repeatCount='indefinite' begin='0.3' />\n      </circle>\n    </StyledSvg>\n  )\n}\n","import { useTheme } from 'styled-components'\n\nexport default function R34Icon(props: { size: number; className?: string }) {\n  const theme = useTheme()\n\n  return (\n    <svg\n      xmlns='http://www.w3.org/2000/svg'\n      width={props.size}\n      height={props.size}\n      viewBox='0 0 12.7 12.7'\n      className={props.className}\n    >\n      <g transform='translate(0,-284.3)'>\n        <circle\n          id='path18'\n          cx='6.3499999'\n          cy='290.65002'\n          fill='none'\n          stroke={theme.colors.accentColor}\n          strokeWidth='0.50848764'\n          strokeMiterlimit='4'\n          strokeDasharray='none'\n          strokeOpacity='1'\n          r='6.0957561'\n        />\n        <text\n          fontStyle='normal'\n          fontWeight='normal'\n          fontSize='8.3113203px'\n          fontFamily='sansSerif'\n          letterSpacing='0px'\n          wordSpacing='0px'\n          fill={theme.colors.accentColor}\n          fillOpacity='1'\n          x='2.1363549'\n          y='289.02704'\n          id='text4533'\n          transform='scale(0.98538224,1.0148346)'\n        >\n          <tspan\n            id='tspan4531'\n            x='2'\n            y='289.1'\n            fontStyle='normal'\n            fontVariant='normal'\n            fontWeight='300'\n            fontStretch='normal'\n            fontFamily='Calibri'\n            fill={theme.colors.accentColor}\n            fillOpacity='1'\n          >\n            34\n          </tspan>\n        </text>\n      </g>\n    </svg>\n  )\n}\n","import { useCallback } from 'react'\nimport { TagModifier } from 'r34-types'\nimport { useDispatch, useSelector } from 'react-redux'\nimport { selectSuggestionsModifier } from '../redux/selectors'\nimport { setSuggestionsModifier } from '../redux/actions'\n\nconst order: TagModifier[] = ['+', '-', '~']\n\n/**\n * Small utility hook to abstract the rotating modifier away\n */\nexport default function useModifier() {\n  const dispatch = useDispatch()\n  const modifier = useSelector(selectSuggestionsModifier)\n  const nextModifier = useCallback(\n    () => dispatch(setSuggestionsModifier(order[(order.indexOf(modifier) + 1) % order.length])),\n    [dispatch, modifier]\n  )\n\n  return [modifier, nextModifier] as const\n}\n","import React, { useCallback, useEffect } from 'react'\nimport * as r34 from 'r34-types'\nimport { useDispatch, useSelector } from 'react-redux'\nimport { isSupertag } from '../../data/tagUtils'\nimport { ModalId, NO_OP } from '../../data/types'\nimport { useCheckIsActive } from '../../hooks/useCheckIsActive'\nimport useToggleTag from '../../hooks/useToggleTag'\nimport { SupertagIcon } from '../../icons/FontAwesomeIcons'\nimport { addTag, openModal } from '../../redux/actions'\nimport { selectActiveTags, selectNumberOfActiveTags } from '../../redux/selectors'\nimport { RedButton } from '../designsystem/Buttons'\nimport TagList from '../tag/TagList'\n\ninterface ActiveTagsProps {\n  onChange?: () => void\n  offerSupertags?: boolean\n}\n\nexport default function ActiveTags(props: ActiveTagsProps) {\n  const { onChange = NO_OP, offerSupertags = false } = props\n\n  const dispatch = useDispatch()\n\n  const activeTags = useSelector(selectActiveTags)\n  const numberOfActiveTags = useSelector(selectNumberOfActiveTags)\n  const openSupertagModal = useCallback(() => dispatch(openModal(ModalId.CREATE_SUPERTAG)), [dispatch])\n\n  const toggleTag = useToggleTag()\n  const checkIsActive = useCheckIsActive()\n\n  const onTagMenu = React.useCallback(\n    (tag: r34.AnyBiasedTag) => {\n      if (!isSupertag(tag)) {\n        const order: r34.TagModifier[] = ['+', '-', '~']\n        const nextModifer = order[(order.indexOf(tag.modifier) + 1) % 3]\n        dispatch(addTag({ ...tag, modifier: nextModifer }))\n      }\n    },\n    [dispatch]\n  )\n\n  // Fire change event when tags change\n  // This is used to re-measure the height\n  useEffect(() => onChange(), [onChange, activeTags])\n\n  return numberOfActiveTags > 0 ? (\n    <TagList tags={activeTags} onTagClick={toggleTag} getIsActive={checkIsActive} onTagMenu={onTagMenu} detailed>\n      {offerSupertags && Object.keys(activeTags).length > 1 && (\n        <RedButton onClick={openSupertagModal} title='Create a supertag'>\n          <SupertagIcon />\n        </RedButton>\n      )}\n    </TagList>\n  ) : null\n}\n","import { useCallback } from 'react'\nimport { useSelector } from 'react-redux'\nimport { AnyTag } from 'r34-types'\nimport { TagIsActive } from '../data/types'\nimport { selectActiveSupertagTags, selectActiveTags } from '../redux/selectors'\n\nexport const useCheckIsActive = () => {\n  const activeTags = useSelector(selectActiveTags)\n  const activeSupertagsTags = useSelector(selectActiveSupertagTags)\n\n  return useCallback(\n    (tag: AnyTag): TagIsActive => {\n      if (tag.name in activeTags) return 'direct'\n      if (tag.name in activeSupertagsTags) return 'indirect'\n      else return 'no'\n    },\n    [activeSupertagsTags, activeTags]\n  )\n}\n","import * as r34 from 'r34-types'\nimport { useCallback } from 'react'\nimport { useDispatch } from 'react-redux'\nimport { addTag } from '../redux/actions'\n\nexport const useActivateTag = () => {\n  const dispatch = useDispatch()\n\n  return useCallback(\n    (tag: r34.AnyBiasedTag) => {\n      dispatch(addTag(tag))\n    },\n    [dispatch]\n  )\n}\n","import React, { ReactNode } from 'react'\n\ninterface ErrorBoundaryProps {\n  fallback: ReactNode\n  children: ReactNode\n}\n\ninterface ErrorBoundaryState {\n  hasError: boolean\n}\n\nexport default class ErrorBoundary extends React.Component<ErrorBoundaryProps, ErrorBoundaryState> {\n  constructor(props: ErrorBoundaryProps) {\n    super(props)\n    this.state = { hasError: false }\n  }\n\n  static getDerivedStateFromError(error: Error) {\n    return { hasError: true }\n  }\n\n  render() {\n    if (this.state.hasError) {\n      return this.props.fallback\n    }\n\n    return this.props.children\n  }\n}\n","import { DefaultTheme } from 'styled-components'\n\nconst dark: DefaultTheme = {\n  dimensions: {\n    borderRadius: '3px',\n    borderWidth: '2px',\n    spacing: '4px',\n    bigSpacing: '8px',\n    hugeSpacing: '16px',\n    gutter: '8px',\n    blockHeight: '32px',\n    bodyWidth: '1000px',\n  },\n  colors: {\n    //basic\n    text: '#ffffff',\n    backgroundColor: '#121212',\n    backgroundColor2: '#ffffff',\n    subduedText: '#ffffff80',\n    layerBg: '#ffffff11',\n    layerBgSolid: '#222222',\n    layerBgHighlight: '#ffffff22',\n\n    // theme\n    accentColor: '#ee3344',\n    accentColorHover: '#f74555',\n    accentColorActive: '#d93847',\n\n    // semantic\n    liked: '#ff0d50',\n    positive: '#3fb950',\n    negative: '#f85149',\n  },\n  shadow: {\n    radius: '6px',\n    color: '#00000080',\n  },\n  timings: {\n    transitionTime: '0.2s',\n    longTransitionTime: '0.2s',\n  },\n  fontSizes: {\n    content: '15px',\n    bigTitle: '24px',\n  },\n}\n\nexport default dark\n","import { DefaultTheme } from 'styled-components'\nimport { Theme } from 'r34-types'\nimport light from './light'\nimport dark from './dark'\nimport coffee from './coffee'\nimport electric from './electric'\nimport deepsea from './deepsea'\n\nconst themes: Record<Theme, DefaultTheme> = {\n  dark,\n  light,\n  coffee,\n  electric,\n  deepsea,\n}\n\nexport default themes\n\nexport const defaultThemeId = 'dark'\n","import dark from './dark'\n\nconst light = {\n  ...dark,\n  colors: {\n    ...dark.colors,\n    text: '#000',\n    backgroundColor: '#eee',\n    backgroundColor2: '#eee',\n    subduedText: '#00000080',\n    layerBg: '#ffffff',\n    layerBgSolid: '#ffffff',\n    layerBgHighlight: '#00000022',\n  },\n  shadow: {\n    ...dark.shadow,\n    color: 'transparent',\n  },\n}\n\nexport default light\n","import dark from './dark'\n\nconst coffee = {\n  ...dark,\n  colors: {\n    ...dark.colors,\n    backgroundColor: '#161410',\n    backgroundColor2: '#fff',\n    layerBg: '#ffffff11',\n    layerBgSolid: '#262420',\n    layerBgHighlight: '#ffffff22',\n  },\n}\n\nexport default coffee\n","import dark from './dark'\n\nconst electric = {\n  ...dark,\n  colors: {\n    ...dark.colors,\n    accentColor: '#2ae',\n    accentColorHover: '#39b8f7',\n    accentColorActive: '#1e99d6',\n  },\n}\n\nexport default electric\n","import dark from './dark'\n\nconst deepsea = {\n  ...dark,\n  colors: {\n    ...dark.colors,\n    backgroundColor: '#010917',\n    backgroundColor2: '#eef',\n    layerBg: '#ffffff11',\n    layerBgSolid: '#111929',\n    layerBgHighlight: '#ffffff22',\n    accentColor: '#4090bb',\n    accentColorHover: '#55aecf',\n    accentColorActive: '#3b7a9c',\n  },\n}\n\nexport default deepsea\n","import { createGlobalStyle, css } from 'styled-components'\n\nexport default createGlobalStyle(\n  ({ theme }) => css`\n    * {\n      margin: 0;\n      padding: 0;\n      box-sizing: border-box;\n\n      font-family: 'Raleway', sans-serif;\n      -webkit-font-smoothing: antialiased;\n      -moz-osx-font-smoothing: grayscale;\n\n      :focus {\n        outline: none;\n      }\n    }\n\n    html,\n    body,\n    #app-root {\n      width: 100%;\n      height: 100%;\n    }\n\n    body {\n      font-size: ${theme.fontSizes.content};\n      color: ${theme.colors.text};\n      background-color: ${theme.colors.backgroundColor};\n      transition: color 0.4s, background-color 0.4s;\n    }\n\n    a {\n      color: ${theme.colors.accentColor};\n      text-decoration: none;\n    }\n\n    // Not a touch device\n    // Touch devices have nice scrollbars by default\n    @media (pointer: fine) {\n      // Underline stuff that is focused on non-touch devices\n      // makes keyboard navigation clearer\n      button,\n      input {\n        &:focus {\n          text-decoration: underline;\n        }\n      }\n\n      ::-webkit-scrollbar {\n        height: 8px;\n        transition: all ${theme.timings.transitionTime} ease-in-out;\n\n        :hover {\n          background: ${theme.colors.layerBg};\n        }\n      }\n\n      /* Track */\n      ::-webkit-scrollbar-track {\n        background: transparent;\n      }\n\n      /* Handle */\n      :hover {\n        ::-webkit-scrollbar {\n          background: ${theme.colors.layerBg};\n        }\n      }\n\n      ::-webkit-scrollbar-thumb {\n        background: ${theme.colors.layerBg};\n        border-radius: 1000px;\n\n        :hover {\n          background: ${theme.colors.layerBgHighlight};\n        }\n      }\n    }\n  `\n)\n","import React from 'react'\nimport styled from 'styled-components'\nimport ResetButton from '../widgets/ResetButton'\nimport outOfResultsPicture from '../../icons/OutOfResults.png'\nimport FlexImage from '../designsystem/FlexImage'\nimport themes, { defaultThemeId } from '../../styled/themes'\nimport GlobalStyles from '../../GlobalStyles'\n\nconst FullScreenCentered = styled.div`\n  height: 100vh;\n  width: 100%;\n  display: grid;\n  place-items: center;\n  align-content: center;\n  padding: 30px;\n  background: ${({ theme }) => theme.colors.backgroundColor};\n\n  > * {\n    margin-bottom: 10px;\n  }\n`\n\nexport default function ErrorScreen() {\n  const theme = themes[defaultThemeId]\n\n  return (\n    <FullScreenCentered theme={theme}>\n      <GlobalStyles theme={theme} />\n      <FlexImage src={outOfResultsPicture} alt='Shironeko does not understand' />\n      <h1>Sorry about that...</h1>\n      <ResetButton theme={theme} />\n    </FullScreenCentered>\n  )\n}\n","import React from 'react'\nimport styled from 'styled-components'\nimport Loading from '../../icons/Loading'\n\nconst FullScreenCentered = styled.div`\n  height: 100%;\n  width: 100%;\n  display: grid;\n  place-items: center;\n`\n\nexport default function LoadingScreen() {\n  return (\n    <FullScreenCentered>\n      <Loading />\n    </FullScreenCentered>\n  )\n}\n","import styled, { css } from 'styled-components'\nimport { gap } from '../../styled/mixins'\nimport FlexColumn, { FlexColumnWithSpacing } from '../designsystem/FlexColumn'\nimport Surface from '../designsystem/Surface'\nimport { Faded, Title } from '../designsystem/Text'\nimport Header from '../features/Header'\n\nconst SectionBody = styled(Surface)(\n  ({ theme }) => css`\n    padding: ${theme.dimensions.hugeSpacing};\n    ${gap(theme.dimensions.hugeSpacing)};\n  `\n)\n\nconst Section = styled(FlexColumnWithSpacing)`\n  flex-grow: 1;\n`\n\nexport default function Terms() {\n  document.title = 'R34 React - Terms of Service'\n\n  return (\n    <FlexColumn>\n      <Header />\n      <Section>\n        <Title>Terms of Service</Title>\n        <SectionBody>\n          <p>\n            This website does not impose any additional terms on you. However, terms for the technologies this app uses\n            still apply. Therefore, you should read the following terms.\n          </p>\n          <a href='https://policies.google.com/terms'>Google - Privacy & Terms</a>\n          <a href='https://rule34.xxx/tos.php'>Rule34 - Terms of Serivce</a>\n          <Faded>If you have any questions feel free to contact me via Discord. See \"about\" section.</Faded>\n        </SectionBody>\n      </Section>\n    </FlexColumn>\n  )\n}\n","import React, { useCallback } from 'react'\nimport styled from 'styled-components'\nimport useAction from '../../hooks/useAction'\nimport { closeModal } from '../../redux/actions'\nimport Surface from './Surface'\n\nconst Wrapper = styled.div`\n  position: fixed;\n  display: grid;\n  place-items: center;\n\n  bottom: 0;\n  left: 0;\n  width: 100vw;\n  height: 100vh;\n  padding: 20px;\n\n  z-index: 1000;\n\n  background: #000000d0;\n`\n\nconst ModalSurface = styled(Surface)`\n  max-width: 500px;\n  background-color: ${(props) => props.theme.colors.layerBgSolid};\n`\n\ninterface ModalProps {\n  children: React.ReactNode\n}\n\nexport default function Modal(props: ModalProps) {\n  const { children } = props\n\n  const close = useAction(closeModal)\n  const blockEvent = useCallback((e) => e.stopPropagation(), [])\n\n  return (\n    <Wrapper onClick={close} title='Close modal'>\n      <ModalSurface onClick={blockEvent}>{children}</ModalSurface>\n    </Wrapper>\n  )\n}\n","export default __webpack_public_path__ + \"static/media/eeek.ff41d889.png\";","import React, { useCallback } from 'react'\nimport useAction from '../../hooks/useAction'\nimport { closeModal, getResults } from '../../redux/actions'\nimport Modal from '../designsystem/Modal'\nimport eeek from '../../icons/eeek.png'\nimport FlexImage from '../designsystem/FlexImage'\nimport { Faded, Title } from '../designsystem/Text'\nimport { flexRowWithGap } from '../../styled/mixins'\nimport { RedButton } from '../designsystem/Buttons'\nimport styled from 'styled-components'\nimport { FailedIcon, SuccessIcon } from '../../icons/FontAwesomeIcons'\nimport LabeledToggle from '../designsystem/LabeledToggle'\nimport usePreference from '../../hooks/usePreference'\n\nconst ButtonRow = styled.div`\n  ${flexRowWithGap}\n\n  > button {\n    flex-grow: 1;\n  }\n`\n\nexport default function CellularWarningModal() {\n  const close = useAction(closeModal)\n  const search = useAction(getResults)\n\n  const onConfirm = useCallback(() => {\n    search()\n    close()\n  }, [close, search])\n\n  const onCancel = useCallback(() => {\n    close()\n  }, [close])\n\n  const [autoPlay, setAutoPlay] = usePreference('autoPlay')\n  const toggleAutoPlay = useCallback(() => setAutoPlay(!autoPlay), [autoPlay, setAutoPlay])\n  const [preloadVideos, setPreloadVideos] = usePreference('preloadVideos')\n  const togglePreloadVideos = useCallback(() => setPreloadVideos(!preloadVideos), [preloadVideos, setPreloadVideos])\n  const [originals, setOriginals] = usePreference('originals')\n  const toggleOriginals = useCallback(() => setOriginals(!originals), [originals, setOriginals])\n\n  return (\n    <Modal>\n      <FlexImage src={eeek} />\n      <Title>Wait!</Title>\n      <Faded>\n        You are on cellular and have some features enabled that will consume a lot of data. Are you sure this is\n        intended?\n      </Faded>\n      <LabeledToggle value={autoPlay} onToggle={toggleAutoPlay}>\n        Auto-play Animations\n      </LabeledToggle>\n      <LabeledToggle value={preloadVideos} onToggle={togglePreloadVideos}>\n        Preload Animations\n      </LabeledToggle>\n      <LabeledToggle value={originals} onToggle={toggleOriginals}>\n        Load original sizes\n      </LabeledToggle>\n      <ButtonRow>\n        <RedButton onClick={onConfirm}>\n          <SuccessIcon /> Yes\n        </RedButton>\n        <RedButton onClick={onCancel}>\n          <FailedIcon /> No\n        </RedButton>\n      </ButtonRow>\n    </Modal>\n  )\n}\n","import React, { useCallback } from 'react'\nimport styled, { css } from 'styled-components'\nimport { RedButton } from '../designsystem/Buttons'\nimport usePreference from '../../hooks/usePreference'\n\nconst CookieWrapper = styled.div(\n  ({ theme }) => css`\n    position: fixed;\n    bottom: 0;\n    left: 0;\n    width: 100%;\n    display: flex;\n    align-items: center;\n    justify-content: space-between;\n    color: ${theme.colors.text};\n    background: ${theme.colors.layerBgSolid};\n    padding: ${theme.dimensions.gutter};\n    z-index: 100;\n  `\n)\n\nconst StyledSpan = styled.span`\n  height: min-content;\n`\n\nexport default function CookieConfirmation() {\n  const [, setCookies] = usePreference('cookies')\n\n  const handleAccept = useCallback(() => setCookies(true), [setCookies])\n\n  return (\n    <CookieWrapper>\n      <StyledSpan>This website uses cookies.</StyledSpan>\n      <RedButton onClick={handleAccept} aria-label='Allow Cookies' title='Accept Cookie usage'>\n        Okay\n      </RedButton>\n    </CookieWrapper>\n  )\n}\n","import React, { useCallback, useState } from 'react'\nimport { useDispatch, useSelector } from 'react-redux'\nimport styled, { css } from 'styled-components'\nimport { addSupertag } from '../../firebase'\nimport { selectActiveTags } from '../../redux/selectors'\nimport { defaultBlock, defaultBorder } from '../../styled/mixins'\nimport { BlockButton } from '../designsystem/Buttons'\nimport { HorizontalLine } from '../designsystem/Lines'\nimport { Title } from '../designsystem/Text'\nimport TagSelector from '../tagSelector/TagSelector'\nimport ActiveTags from './ActiveTags'\nimport * as r34 from 'r34-types'\nimport { isSupertag } from '../../data/tagUtils'\nimport { useActivateTag } from '../../hooks/useActivateTag'\nimport { closeModal, removeTag } from '../../redux/actions'\nimport useAction from '../../hooks/useAction'\nimport Modal from '../designsystem/Modal'\n\nconst StyledInput = styled.input(\n  ({ theme }) => css`\n    ${defaultBorder}\n    background-color: ${theme.colors.backgroundColor2};\n    ${defaultBlock}\n    text-align: left;\n  `\n)\n\nexport default function SupertagModal() {\n  const [name, setName] = useState('')\n  const [description, setDescription] = useState('')\n  const activeTags = useSelector(selectActiveTags)\n  const dispatch = useDispatch()\n  const activateTag = useActivateTag()\n  const close = useAction(closeModal)\n\n  const tags: Record<string, r34.TagModifier> = Object.values(activeTags)\n    .filter((tag): tag is r34.BiasedTag => !isSupertag(tag))\n    .reduce((result, tag) => ({ ...result, [tag.name]: tag.modifier }), {})\n\n  const handleCreate = useCallback(() => {\n    addSupertag(name, description, tags)\n      .then(() => {\n        Object.keys(tags).forEach((tagname) => dispatch(removeTag(tagname)))\n        activateTag({ name, description, tags })\n        close()\n      })\n      .catch((err) => console.error('Failed to create supertag', err))\n  }, [activateTag, close, description, dispatch, name, tags])\n\n  return (\n    <Modal>\n      <Title>Create Supertag</Title>\n      <HorizontalLine />\n      <StyledInput type='text' placeholder='Name' value={name} onChange={(e) => setName(e.target.value)} />\n      <StyledInput\n        type='text'\n        placeholder='Description'\n        value={description}\n        onChange={(e) => setDescription(e.target.value)}\n      />\n      <TagSelector showSupertags={false} onSubmit={activateTag} />\n      <ActiveTags />\n      <BlockButton onClick={handleCreate}>Create</BlockButton>\n    </Modal>\n  )\n}\n","enum AnalyticsEventId {\n  SEARCH = 'r34_search',\n}\n\nexport type SearchEvent = {\n  id: AnalyticsEventId.SEARCH\n  payload: {\n    page_number: number\n  }\n}\n\n/**\n * Should be called whenever a new search is started.\n */\nexport const searchEvent = (page_number: number): SearchEvent => ({\n  id: AnalyticsEventId.SEARCH,\n  payload: {\n    page_number,\n  },\n})\n","import { MiddlewareAPI } from 'redux'\nimport { Dispatch } from 'react'\nimport {\n  AppAction,\n  FETCH_PREFERENCES,\n  savePreferences,\n  SAVE_PREFERENCES,\n  setPreferences,\n  SET_PREFERENCE,\n} from '../actions'\nimport * as firebaseFunctions from '../../firebase'\n\nlet saveTimeout: NodeJS.Timeout\n\nconst persistence = (store: MiddlewareAPI) => (next: Dispatch<AppAction>) => async (action: AppAction) => {\n  if (action.type === SET_PREFERENCE) {\n    if (saveTimeout) {\n      clearTimeout(saveTimeout)\n    }\n\n    saveTimeout = setTimeout(() => {\n      store.dispatch(savePreferences())\n    }, 10000)\n  }\n\n  if (action.type === FETCH_PREFERENCES) {\n    const preferences = await firebaseFunctions.getPreferences()\n\n    if (preferences) {\n      store.dispatch(setPreferences(preferences))\n    }\n  }\n\n  if (action.type === SAVE_PREFERENCES) {\n    const { preferences } = store.getState()\n    firebaseFunctions.setPreferences(preferences)\n  }\n\n  next(action)\n}\n\nexport default persistence\n","import { AppAction, SET_POSTS, ADD_POSTS } from '../actions'\n\nimport { searchEvent } from '../../analytics/events'\nimport { selectPageNumber, selectCookies } from '../selectors'\nimport { MiddlewareAPI, Dispatch } from 'redux'\nimport { logEvent } from '../../firebase'\n\nconst eventLogging = (store: MiddlewareAPI<any>) => (next: Dispatch<AppAction>) => (action: AppAction) => {\n  const state = store.getState()\n  const cookies = selectCookies(state)\n\n  // Only send analytics if the user consented\n  if (cookies) {\n    if (action.type === ADD_POSTS || action.type === SET_POSTS) {\n      const pageNumber = selectPageNumber(state)\n      logEvent(searchEvent(pageNumber))\n    }\n  }\n\n  next(action)\n}\n\nexport default eventLogging\n","import firebase from 'firebase/app'\nimport 'firebase/auth'\nimport { getSupertags } from '../firebase'\nimport * as r34 from 'r34-types'\nimport { getTagParameter, isSuggestionError } from '../data/tagUtils'\nimport { SuggestionsError } from '../data/types'\n\ntype Version = 'v1' | 'v2'\ntype Target = 'local' | 'live'\n\nconst sourceTags: r34.Tag[] = [\n  { name: 'source:*patreon*', count: 12711, types: ['source'] },\n  { name: 'source:*twitter*', count: 99927, types: ['source'] },\n  { name: 'source:*pixiv*', count: 185080, types: ['source'] },\n]\n\nconst ratingTags: r34.Tag[] = [\n  { name: 'rating:safe', count: 14293, types: ['rating'] },\n  { name: 'rating:questionable', count: 219552, types: ['rating'] },\n  { name: 'rating:explicit', count: 3821144, types: ['rating'] },\n]\n\nclass API {\n  readonly defaultPageSize = 20\n  readonly apiLocal = 'http://localhost:8080'\n  readonly apiUrl1 = 'https://r34-json.herokuapp.com'\n  readonly apiUrl2 = 'https://r34-api-clone.herokuapp.com'\n\n  private target: Target = 'live'\n  private version: Version = 'v2'\n  private activeApi!: string\n\n  constructor() {\n    this.setActiveApi()\n  }\n\n  /**\n   * Switches between remote prod api and local dev api\n   */\n  setTarget(target: 'live' | 'local') {\n    this.target = target\n    this.setActiveApi()\n  }\n\n  /**\n   * Sets the api version to use.\n   */\n  setVersion(version: 'v1' | 'v2') {\n    this.version = version\n    this.setActiveApi()\n  }\n\n  /**\n   * Updates the base url with new configuration.\n   */\n  setActiveApi() {\n    if (this.target === 'local') {\n      this.activeApi = `${this.apiLocal}/${this.version}`\n    } else {\n      this.activeApi = `${this.apiUrl1}/${this.version}`\n    }\n  }\n\n  /**\n   * Retrieves tags given a searchTerm\n   */\n  private async fetchTags(searchTerm: string, limit: number): Promise<r34.Tag[] | SuggestionsError> {\n    return await (await fetch(`${this.activeApi}/tags?limit=${limit}&name=${searchTerm}&sort=count`)).json()\n  }\n\n  async getTags(searchTerm: string, limit: number = this.defaultPageSize, includeSupertags = false) {\n    const doFuzzySearch = searchTerm.length > 3\n    try {\n      const result = await this.fetchTags(doFuzzySearch ? `*${searchTerm}*` : searchTerm, limit)\n\n      if (isSuggestionError(result)) {\n        return result\n      }\n\n      let tags = result as r34.AnyTag[]\n\n      if (includeSupertags) {\n        try {\n          const supertags = await getSupertags()\n          if (supertags) {\n            const matchingSupertags = Object.entries(supertags)\n              .filter(([name, details]) => name.toLowerCase().includes(searchTerm.toLowerCase()))\n              .map(([name, details]) => ({\n                name,\n                ...details,\n              }))\n            tags = [...matchingSupertags, ...tags]\n          }\n        } catch {\n          // do nothing as supertags are only for registered users.\n        }\n      }\n\n      // HACKY: Inject suggestions for ratings and some sources\n      const matchingRating = ratingTags.filter((tag) => tag.name.includes(searchTerm.replace('rating:', '')))\n      tags = [...matchingRating, ...tags]\n\n      const matchingSourceTags = sourceTags.filter((tag) => tag.name.includes(searchTerm.replace('source:', '')))\n      tags = [...matchingSourceTags, ...tags]\n\n      return tags\n    } catch (err) {\n      console.warn('Failed to get tags:', err)\n      return []\n    }\n  }\n\n  /**\n   * This function can be used to retrieve a number of posts from the backend.\n   */\n  async getPosts(\n    tags: Record<string, r34.AnyBiasedTag>,\n    limit: number = this.defaultPageSize,\n    pageNumber = 0,\n    minScore = 0,\n    sort: r34.PostsSort = 'date',\n    hideSeen = false\n  ) {\n    try {\n      const idToken = await firebase.auth().currentUser?.getIdToken()\n      const url = this.buildPostUrl(pageNumber, tags, { minScore, limit, sort, hideSeen })\n      const apiResponse = await fetch(url, {\n        headers: {\n          Authorization: 'Bearer ' + idToken,\n        },\n      })\n      const data: r34.PostsResponse = await apiResponse.json()\n\n      return data\n    } catch (err) {\n      console.warn('Failed to get posts:', err)\n      return { count: 0, posts: [] }\n    }\n  }\n\n  /**\n   * Returns all aliases for a given tag\n   */\n  async getAliases(tagName: string) {\n    try {\n      const aliases: r34.AliasTag[] = await (\n        await fetch(`${this.activeApi}/alias/${encodeURIComponent(tagName)}`)\n      ).json()\n\n      return aliases\n    } catch (err) {\n      console.warn('Failed to get aliases:', err)\n      return []\n    }\n  }\n\n  /**\n   * Returns all comments for a given post.\n   */\n  async getComments(post: r34.Post) {\n    try {\n      const comments: r34.Comment[] = await (await fetch(post.comments_url)).json()\n\n      return comments\n    } catch (err) {\n      console.warn('Failed to get comments:', err)\n      return []\n    }\n  }\n\n  /**\n   * Constructs an api url that will return posts that match your parameters\n   */\n  buildPostUrl(\n    page: number,\n    tags: Record<string, r34.QueryTag | r34.Supertag>,\n    options: {\n      minScore?: number\n      limit?: number\n      sort?: r34.PostsSort\n      hideSeen?: boolean\n    } = {}\n  ) {\n    const { minScore = 0, limit = api.defaultPageSize, sort = 'date', hideSeen = false } = options\n    const params = {\n      pid: page,\n      limit,\n      hideSeen,\n      tags: getTagParameter(tags, minScore, sort),\n    }\n\n    return `${api.activeApi}/posts?${Object.entries(params)\n      .map(([key, value]) => (value === '' || value === false ? null : `${key}=${value}`))\n      .filter((i) => i !== null)\n      .join('&')}`\n  }\n}\n\nexport const api = new API()\n","import { Dispatch } from 'react'\nimport { MiddlewareAPI } from 'redux'\nimport { isSuggestionError, isSupertag, serializeTagname } from '../../data/tagUtils'\nimport { api } from '../../misc/api'\nimport {\n  addAliases,\n  addPosts,\n  ADD_TAG,\n  AppAction,\n  FETCH_COMMENTS,\n  FETCH_SUGGESTIONS,\n  GET_MORE_RESULTS,\n  GET_RESULTS,\n  LIKE_POST,\n  setComments,\n  setPosts,\n  setSuggestions,\n  setSuggestionsError,\n} from '../actions'\nimport {\n  selectActiveTags,\n  selectHasMoreResults,\n  selectHideSeen,\n  selectMinRating,\n  selectPageNumber,\n  selectPageSize,\n  selectPostById,\n  selectSort,\n  selectTagSuggestionCount,\n} from '../selectors'\n\nconst apiRequests = (store: MiddlewareAPI) => (next: Dispatch<AppAction>) => async (action: AppAction) => {\n  const state = store.getState()\n  const hasMoreResults = selectHasMoreResults(state)\n\n  if (action.type === GET_RESULTS) {\n    const activeTags = selectActiveTags(state)\n    const pageSize = selectPageSize(state)\n    const minRating = selectMinRating(state)\n    const sort = selectSort(state)\n    const hideSeen = selectHideSeen(state)\n\n    const result = await api.getPosts(activeTags, pageSize, action.pageNumber, minRating, sort, hideSeen)\n\n    store.dispatch(setPosts(result.posts, result.count, action.pageNumber))\n  }\n\n  if (action.type === GET_MORE_RESULTS && hasMoreResults) {\n    const activeTags = selectActiveTags(state)\n    const pageNumber = selectPageNumber(state)\n    const pageSize = selectPageSize(state)\n    const minRating = selectMinRating(state)\n    const sort = selectSort(state)\n    const hideSeen = selectHideSeen(state)\n\n    const res = await api.getPosts(activeTags, pageSize, pageNumber + 1, minRating, sort, hideSeen)\n\n    store.dispatch(addPosts(res.posts))\n  }\n\n  if (action.type === ADD_TAG) {\n    const activeTags = selectActiveTags(state)\n    const aliases = await api.getAliases(action.tag.name)\n\n    const sanitizedAliases = aliases\n      .sort((a, b) => b.count - a.count)\n      .filter((alias) => !(alias.name in activeTags))\n      .map(({ name, count }) => ({ name, count, types: [] }))\n\n    store.dispatch(addAliases(sanitizedAliases, action.tag.name))\n\n    // Request types for newly added tag\n    if (!isSupertag(action.tag) && action.tag.types.length === 0) {\n      const data = await api.getTags(action.tag.name, 1, false)\n      if (!isSuggestionError(data)) {\n        const tag = data.find((tag) => tag.name === action.tag.name)\n\n        if (tag && !isSupertag(tag)) {\n          action.tag.types = tag.types\n          action.tag.count = tag.count\n        }\n      }\n    }\n  }\n\n  if (action.type === LIKE_POST) {\n    fetch(`https://rule34.xxx/index.php?page=post&s=vote&id=${action.postId}&type=up`, { mode: 'no-cors' })\n      .then(() => {\n        // nothing to do, I update the state in advance\n      })\n      .catch((err) => {\n        console.warn('Upvote rejected', err)\n      })\n  }\n\n  if (action.type === FETCH_SUGGESTIONS) {\n    const limit = selectTagSuggestionCount(state)\n    const result = await api.getTags(serializeTagname(action.value), limit, action.includeSupertags)\n\n    if (isSuggestionError(result)) {\n      store.dispatch(setSuggestionsError(result))\n    } else {\n      store.dispatch(setSuggestions(result))\n    }\n  }\n\n  if (action.type === FETCH_COMMENTS) {\n    const post = selectPostById(action.postId)(state)\n\n    if (post) {\n      const comments = await api.getComments(post)\n      store.dispatch(setComments(action.postId, comments))\n    }\n  }\n\n  next(action)\n}\n\nexport default apiRequests\n","import { applyMiddleware } from 'redux'\nimport analytics from './analytics'\nimport persistence from './persistence'\nimport requests from './requests'\nimport { composeWithDevTools } from 'redux-devtools-extension'\n\nconst middleware = composeWithDevTools(applyMiddleware(analytics, requests, persistence))\n\nexport default middleware\n","export const migrations = {\n  // Delete reader state\n  278: (state: any) => {\n    return {\n      ...state,\n      reader: undefined,\n    }\n  },\n  // Add autoscroll delay\n  279: (state: any) => {\n    return {\n      ...state,\n      preferences: {\n        ...state.preferences,\n        autoscrollDelay: 10,\n      },\n    }\n  },\n}\n","import produce from 'immer'\nimport * as r34 from 'r34-types'\nimport { AppAction, SET_PREFERENCE, SET_PREFERENCES } from '../actions'\n\nexport interface PreferencesState {\n  rated: boolean\n  ratedThreshold: number\n  originals: boolean\n  cookies: boolean\n  preloadVideos: boolean\n  tagSuggestionsCount: number\n  resultsLayout: r34.ResultsLayout\n  pageSize: number\n  showMetadata: boolean\n  showComments: boolean\n  sort: r34.PostsSort\n  themeId: r34.Theme\n  autoPlay: boolean\n  hideSeen: boolean\n  autoscrollDelay: number\n}\n\nconst initialPreferencesState: PreferencesState = {\n  rated: false,\n  ratedThreshold: 1,\n  originals: false,\n  cookies: false,\n  preloadVideos: false,\n  tagSuggestionsCount: 20,\n  resultsLayout: 'infinite_column',\n  pageSize: 20,\n  showMetadata: false,\n  showComments: false,\n  sort: 'date',\n  themeId: 'dark',\n  autoPlay: false,\n  hideSeen: false,\n  autoscrollDelay: 10,\n}\n\nfunction setPreference<T extends r34.PreferenceKey>(state: PreferencesState, key: T, value: PreferencesState[T]) {\n  return produce(state, (draft) => {\n    draft[key] = value\n  })\n}\n\nfunction setPreferences(state: PreferencesState, preferences: Partial<PreferencesState>) {\n  return produce(state, (draft) => {\n    Object.assign(draft, preferences)\n  })\n}\n\nconst preferences = (state: PreferencesState = initialPreferencesState, action: AppAction): PreferencesState => {\n  switch (action.type) {\n    case SET_PREFERENCE:\n      return setPreference(state, action.key, action.value)\n    case SET_PREFERENCES:\n      return setPreferences(state, action.preferences)\n    default:\n      return state\n  }\n}\n\nexport default preferences\n","import produce from 'immer'\nimport { Comment, Post } from 'r34-types'\nimport { SET_POSTS, ADD_POSTS, SET_COMMENTS, AppAction } from '../actions'\n\nexport interface ResultsState {\n  posts: Post[]\n  pageNumber: number\n  count: number\n  updated: number\n}\n\nconst initialResultsState: ResultsState = {\n  posts: [],\n  pageNumber: 0,\n  count: 0,\n  updated: 0,\n}\n\nconst addPosts = (state: ResultsState, posts: Post[]) =>\n  produce(state, (draft) => {\n    draft.posts = [...state.posts, ...posts]\n    draft.pageNumber = state.pageNumber + 1\n    draft.updated = new Date().getTime()\n  })\n\nconst setPosts = (state: ResultsState, posts: Post[], postCount: number, pageNumber: number = 0) =>\n  produce(state, (draft) => {\n    draft.posts = posts\n    draft.count = postCount\n    draft.pageNumber = pageNumber\n    draft.updated = new Date().getTime()\n  })\n\nconst setComments = (state: ResultsState, postId: number, comments: Comment[]) =>\n  produce(state, (draft) => {\n    const postIndex = state.posts.findIndex((p) => p.id === postId)\n    if (postIndex >= 0) {\n      draft.posts[postIndex].comments = comments\n    }\n  })\n\nconst results = (state: ResultsState = initialResultsState, action: AppAction): ResultsState => {\n  switch (action.type) {\n    case ADD_POSTS:\n      return addPosts(state, action.posts)\n    case SET_POSTS:\n      return setPosts(state, action.posts, action.count, action.pageNumber)\n    case SET_COMMENTS:\n      return setComments(state, action.postId, action.comments)\n    default:\n      return state\n  }\n}\n\nexport default results\n","import produce from 'immer'\nimport { AliasTag, AnyBiasedTag } from 'r34-types'\nimport { ADD_TAG, AppAction, REMOVE_TAG, ADD_ALIASES } from '../actions'\n\nexport interface TagsState {\n  active: Record<string, AnyBiasedTag>\n  aliases: Record<string, AliasTag[]>\n}\n\nconst initialTagsState: TagsState = {\n  active: {},\n  aliases: {},\n}\n\nconst addTag = (state: TagsState, newTag: AnyBiasedTag) =>\n  produce(state, (draft) => {\n    draft.active[newTag.name] = { ...state.active[newTag.name], ...newTag }\n  })\n\nconst addAliases = (state: TagsState, aliases: AliasTag[], forTag: string) =>\n  produce(state, (draft) => {\n    draft.aliases[forTag] = aliases\n  })\n\nconst removeTag = (state: TagsState, tagName: string) =>\n  produce(state, (draft) => {\n    delete draft.active[tagName]\n    delete draft.aliases[tagName]\n  })\n\nconst tags = (state: TagsState = initialTagsState, action: AppAction): TagsState => {\n  switch (action.type) {\n    case ADD_TAG:\n      return addTag(state, action.tag)\n    case REMOVE_TAG:\n      return removeTag(state, action.tagName)\n    case ADD_ALIASES:\n      return addAliases(state, action.aliases, action.forTag)\n    default:\n      return state\n  }\n}\n\nexport default tags\n","import produce from 'immer'\nimport { ENTER_FULLSCREEN, EXIT_FULLSCREEN, SET_FULLSCREEN_POST, AppAction } from '../actions'\n\nexport interface FullscreenState {\n  isEnabled: boolean\n  currentIndex: number\n}\n\nconst initialFullscreenState: FullscreenState = {\n  isEnabled: false,\n  currentIndex: 0,\n}\n\nconst enterFullscreen = (state: FullscreenState, index: number) =>\n  produce(state, (draft) => {\n    draft.isEnabled = true\n    draft.currentIndex = index\n  })\n\nconst exitFullscreen = (state: FullscreenState) =>\n  produce(state, (draft) => {\n    draft.isEnabled = false\n  })\n\nconst setIndex = (state: FullscreenState, index: number) =>\n  produce(state, (draft) => {\n    draft.currentIndex = index\n  })\n\nexport const fullscreen = (state: FullscreenState = initialFullscreenState, action: AppAction): FullscreenState => {\n  switch (action.type) {\n    case ENTER_FULLSCREEN:\n      return enterFullscreen(state, action.postId)\n    case SET_FULLSCREEN_POST:\n      return setIndex(state, action.index)\n    case EXIT_FULLSCREEN:\n      return exitFullscreen(state)\n    default:\n      return state\n  }\n}\n","import produce from 'immer'\nimport { AppAction, LIKE_POST } from '../actions'\n\n/**\n * Key is postId, Value is time of like\n */\nexport type LikesState = Record<number, number>\n\nconst initialLikesState: LikesState = {}\n\nconst likePost = (state: LikesState, postId: number) =>\n  produce(state, (draft) => {\n    if (!(postId in state)) {\n      draft[postId] = Date.now()\n    }\n\n    // NOTE: Might need to introduce a cap here...\n    // Like 1000 likes max, delete oldest when more are added?\n  })\n\nconst likes = (state: LikesState = initialLikesState, action: AppAction): LikesState => {\n  switch (action.type) {\n    case LIKE_POST:\n      return likePost(state, action.postId)\n    default:\n      return state\n  }\n}\n\nexport default likes\n","import produce from 'immer'\nimport { ModalId } from '../../data/types'\nimport { AppAction, CLOSE_MODAL, OPEN_MODAL } from '../actions'\n\n/**\n * Key is postId, Value is time of like\n */\nexport interface ModalsState {\n  openModal: ModalId | null\n}\n\nconst initialModalsState: ModalsState = {\n  openModal: null,\n}\n\nconst setOpenModal = (state: ModalsState, modalId: ModalId | null) =>\n  produce(state, (draft) => {\n    draft.openModal = modalId\n  })\n\nconst modals = (state: ModalsState = initialModalsState, action: AppAction): ModalsState => {\n  switch (action.type) {\n    case OPEN_MODAL:\n      return setOpenModal(state, action.modalId)\n    case CLOSE_MODAL:\n      return setOpenModal(state, null)\n    default:\n      return state\n  }\n}\n\nexport default modals\n","import produce from 'immer'\nimport * as r34 from 'r34-types'\nimport { SuggestionsError } from '../../data/types'\nimport { AppAction, SET_SUGGESTIONS, SET_SUGGESTIONS_ERROR, SET_SUGGESTIONS_MODIFIER } from '../actions'\n\nexport interface SuggestionsState {\n  entries: r34.AnyTag[]\n  error: SuggestionsError | null\n  modifier: r34.TagModifier\n}\n\nconst initialSuggestionsState: SuggestionsState = {\n  entries: [],\n  error: null,\n  modifier: '+',\n}\n\nconst setSuggestions = (state: SuggestionsState, suggestions: r34.AnyTag[]) =>\n  produce(state, (draft) => {\n    draft.entries = suggestions\n    draft.error = null\n  })\n\nconst setError = (state: SuggestionsState, error: SuggestionsError) =>\n  produce(state, (draft) => {\n    draft.entries = []\n    draft.error = error\n  })\n\nconst setModifier = (state: SuggestionsState, modifier: r34.TagModifier) =>\n  produce(state, (draft) => {\n    draft.modifier = modifier\n  })\n\nconst suggestions = (state: SuggestionsState = initialSuggestionsState, action: AppAction): SuggestionsState => {\n  switch (action.type) {\n    case SET_SUGGESTIONS:\n      return setSuggestions(state, action.suggestions)\n    case SET_SUGGESTIONS_ERROR:\n      return setError(state, action.error)\n    case SET_SUGGESTIONS_MODIFIER:\n      return setModifier(state, action.modifier)\n    default:\n      return state\n  }\n}\n\nexport default suggestions\n","import { combineReducers } from 'redux'\nimport preferences from './preferences'\nimport results from './results'\nimport tags from './tags'\nimport { fullscreen } from './fullscreen'\nimport likes from './likes'\nimport modals from './modals'\nimport suggestions from './suggestions'\n\nexport default combineReducers({ tags, results, preferences, fullscreen, likes, suggestions, modals })\n","import { createStore } from 'redux'\nimport { createMigrate, persistReducer, persistStore } from 'redux-persist'\nimport storage from 'redux-persist/lib/storage'\nimport { getVersion, versionToNumber } from '../data/utils'\nimport middleware from './middleware'\nimport { migrations } from './migrations'\nimport rootReducer from './reducers'\n\nconst version = getVersion()\n\nconst persistConfig = {\n  key: 'appstate',\n  version: versionToNumber(version),\n  storage,\n  migrate: createMigrate(migrations),\n}\n\nconst persistedReducer = persistReducer(persistConfig, rootReducer)\n\nexport const store = createStore(persistedReducer, middleware)\n\nexport const persistor = persistStore(store)\n","import React, { Suspense } from 'react'\nimport { Provider, useSelector } from 'react-redux'\nimport { HashRouter, Route, Switch } from 'react-router-dom'\nimport { PersistGate } from 'redux-persist/integration/react'\nimport { ThemeProvider } from 'styled-components'\nimport ErrorBoundary from './components/features/ErrorBoundary'\nimport ErrorScreen from './components/pages/ErrorScreen'\nimport LoadingScreen from './components/pages/LoadingScreen'\nimport Terms from './components/pages/Terms'\nimport CellularWarningModal from './components/widgets/CellularWarningModal'\nimport CookieConfirmation from './components/widgets/CookieConfirmation'\nimport SupertagModal from './components/widgets/SupertagModal'\nimport { RouteName } from './data/types'\nimport './firebase' // init firebase immediately\nimport GlobalStyles from './GlobalStyles'\nimport { useLoadPreferences } from './hooks/useLoadPreferences'\nimport {\n  selectActiveThemeId,\n  selectCellularWarningModalOpen,\n  selectCookies,\n  selectSupertagModalOpen,\n} from './redux/selectors'\nimport { persistor, store } from './redux/store'\nimport themes, { defaultThemeId } from './styled/themes'\n\nconst About = React.lazy(() => import('./components/pages/About'))\nconst Privacy = React.lazy(() => import('./components/pages/Privacy'))\nconst Search = React.lazy(() => import('./components/pages/Search'))\nconst Settings = React.lazy(() => import('./components/pages/Settings'))\nconst Share = React.lazy(() => import('./components/pages/Share'))\nconst Stories = React.lazy(() => import('./components/pages/Stories'))\n\nexport default function App() {\n  return (\n    <ErrorBoundary fallback={<ErrorScreen />}>\n      <Provider store={store}>\n        <PersistGate loading={<LoadingScreen />} persistor={persistor}>\n          <ThemedApp />\n        </PersistGate>\n      </Provider>\n    </ErrorBoundary>\n  )\n}\n\nfunction ThemedApp() {\n  const cookies = useSelector(selectCookies)\n  const isCellularWarningModalOpen = useSelector(selectCellularWarningModalOpen)\n  const isSupertagModalOpen = useSelector(selectSupertagModalOpen)\n  const themeId = useSelector(selectActiveThemeId)\n\n  useLoadPreferences()\n\n  return (\n    <ThemeProvider theme={themes[themeId] || defaultThemeId}>\n      <GlobalStyles />\n      <HashRouter>\n        <Suspense fallback={<LoadingScreen />}>\n          <Switch>\n            <Route exact path={RouteName.ABOUT} component={About} />\n            <Route exact path={RouteName.PRIVACY} component={Privacy} />\n            <Route exact path={RouteName.SETTINGS} component={Settings} />\n            <Route exact path={RouteName.STORIES} component={Stories} />\n            <Route exact path={RouteName.TERMS} component={Terms} />\n            <Route exact path={RouteName.SHARE} component={Share} />\n            <Route path={RouteName.SEARCH} component={Search} />\n          </Switch>\n        </Suspense>\n\n        {isSupertagModalOpen && <SupertagModal />}\n        {isCellularWarningModalOpen && <CellularWarningModal />}\n        {!cookies && <CookieConfirmation />}\n      </HashRouter>\n    </ThemeProvider>\n  )\n}\n","import React from 'react'\nimport { useDispatch } from 'react-redux'\nimport { fetchPreferences } from '../redux/actions'\nimport useFirebaseAuthState from './useFirebaseAuthState'\n\nexport function useLoadPreferences() {\n  const dispatch = useDispatch()\n  const [isSignedIn] = useFirebaseAuthState()\n\n  React.useEffect(() => {\n    if (isSignedIn) {\n      dispatch(fetchPreferences())\n    }\n  }, [dispatch, isSignedIn])\n}\n","// Polyfills\nimport 'whatwg-fetch'\n\nimport React from 'react'\nimport ReactDOM from 'react-dom'\nimport * as Sentry from '@sentry/react'\nimport { Integrations } from '@sentry/tracing'\nimport App from './App'\nimport { getVersionString } from './data/utils'\n\nSentry.init({\n  dsn: 'https://1a2933d829da41fe84d4dab5fcc520ae@o955708.ingest.sentry.io/5905045',\n  integrations: [new Integrations.BrowserTracing()],\n  tracesSampleRate: 1.0,\n  release: getVersionString(),\n  beforeBreadcrumb(breadcrumb, hint) {\n    try {\n      if (breadcrumb?.category?.startsWith('ui')) {\n        const target = hint?.event.target as HTMLElement\n        const tag = target.tagName.toLowerCase()\n        if (target.innerText) {\n          breadcrumb.message = `${tag}: ${target.innerText}`\n        } else if (target.id) {\n          breadcrumb.message = `${tag}: ${target.id}`\n        } else if (target.getAttribute('name')) {\n          breadcrumb.message = `${tag}: ${target.getAttribute('name')}`\n        } else if (target.title) {\n          breadcrumb.message = `${tag}: ${target.title}`\n        } else if (target.getAttribute('aria-label')) {\n          breadcrumb.message = `${tag}: ${target.getAttribute('aria-label')}`\n        } else if (target.getAttribute('data-name')) {\n          breadcrumb.message = `${tag}: ${target.getAttribute('data-name')}`\n        }\n      }\n    } catch (err) {\n      // fancy breadcrumbs are optional\n    }\n    return breadcrumb\n  },\n})\n\nReactDOM.render(<App />, document.getElementById('app-root'))\n"],"sourceRoot":""}