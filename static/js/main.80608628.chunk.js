(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{28:function(e,t,n){e.exports=n(75)},33:function(e,t,n){},41:function(e,t,n){},43:function(e,t,n){},47:function(e,t,n){},49:function(e,t,n){},62:function(e,t,n){},73:function(e,t,n){},75:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),c=n(23),i=n.n(c),o=(n(33),n(3)),s=n(10),l=n(12),u=n(11),m=n(13),f=n(17),p=n(1),h=n(5),d=n(24),g=n.n(d);n(41);var v=function(e){var t=e.text,n=e.initial,a=e.onChange;return r.a.createElement("label",{className:"toggle-wrapper"},r.a.createElement(g.a,{defaultChecked:n||!1,icons:{checked:null,unchecked:null},onChange:a}),r.a.createElement("span",{className:"toggle-text"},t))},b=(n(43),n(9)),E=n.n(b),O=n(16),j=20,N="https://custom-r34-api.herokuapp.com";fetch(N).catch(function(){return N="https://r34-api-clone.herokuapp.com"});var k={getTags:function(){var e=Object(O.a)(E.a.mark(function e(t){var n;return E.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch(N+"/tags?limit="+j+"&name="+t+"*&order_by=posts");case 2:return n=e.sent,e.next=5,n.json();case 5:return e.abrupt("return",e.sent);case 6:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}(),getPosts:function(){var e=Object(O.a)(E.a.mark(function e(t){var n,a,r,c=arguments;return E.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=c.length>1&&void 0!==c[1]?c[1]:0,a=c.length>2&&void 0!==c[2]?c[2]:0,e.next=4,fetch(S(n,t,a));case 4:return r=e.sent,e.next=7,r.json();case 7:return e.abrupt("return",e.sent);case 8:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}(),getAliases:function(){var e=Object(O.a)(E.a.mark(function e(t){var n;return E.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch(N+"/alias/"+t);case 2:return n=e.sent,e.next=5,n.json();case 5:return e.abrupt("return",e.sent);case 6:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()};function S(e,t,n){var a=N+"/posts";return a+="?pid="+e,a+="&limit="+j,a+="&tags="+t.map(function(e){return(e.modifier?e.modifier:"")+encodeURIComponent(e.name)}).join("+"),a+=encodeURIComponent("+score:>="+n)}function w(e){var t=e.name,n=e.count,c=e.modifier,i=e.types,o=e.activeTags,s=e.onClick,l=e.onAliasClick,u=Object(a.useState)(),m=Object(p.a)(u,2),f=m[0],h=m[1],d=Object(a.useState)(!0),g=Object(p.a)(d,2),v=g[0],b=g[1];l=l.bind(void 0,{name:t,count:n,modifier:c,types:i}),Object(a.useEffect)(function(){o.some(function(e){return e.name===t})&&k.getAliases(t).then(function(e){e.sort(function(e,t){return Number(t.posts)-Number(e.posts)}),h(e.filter(function(e){return!o.some(function(t){return t.name===e.name})}))})},[t,o]);var E=o.some(function(e){return e.name===t}),O="-"===c,j=i.includes("character"),N=i.includes("artist"),S=f&&f.length>0;return r.a.createElement("div",{className:"tag"+(E?" active":"")+(O?" exclude":"")+(j?" character":"")+(N?" artist":"")+(v?"":" dropped"),onMouseLeave:function(){return b(!0)}},r.a.createElement(y,{name:t,count:n,modifier:c,types:i,activeTags:o,onClick:s}),S&&r.a.createElement(r.a.Fragment,null,r.a.createElement("i",{className:"caret fas fa-caret-down",onClick:function(){return b(!v)}}),r.a.createElement("div",{className:"dropdown-list"+(v?"":" visible")},f.map(function(e){var t=e.name,n=e.posts;return r.a.createElement(C,{key:"t_"+t,name:t,count:n,onClick:l})}))))}function y(e){var t=e.name,n=e.count,a=e.types,c=e.modifier,i=e.onClick;return r.a.createElement("span",{onClick:function(){return i({name:t,count:n,types:a,modifier:c})}},n?"".concat(t," (").concat(n,")"):t)}function C(e){var t=e.name,n=e.count,a=e.onClick;return r.a.createElement("div",{className:"alias"},r.a.createElement(y,{name:t,count:n,onClick:function(){return a({name:t,count:n})}}))}w.defaultProps={types:[],onClick:function(){}},y.defaultProps={modifier:"+",types:[],activeTags:[],onClick:function(){}};var _=w;function x(e){var t=e.tags,n=e.activeTags,a=e.onItemClick,c=e.onItemItemClick;return r.a.createElement("div",{className:"tag-list"},t.map(function(e){return r.a.createElement(_,Object.assign({key:"t_"+e.name},e,{activeTags:n,onClick:a,onAliasClick:c}))}))}var T=x;n(47);var I=function(e){var t,n=e.id,c=e.media_type,i=e.preview_src,o=e.original_src,s=e.thumbnail_src,l=e.rating,u=e.score,m=e.source,f=e.tags,h=e.loadOriginal,d=e.activeTags,g=e.onTagClick;h?t=o:(t="".concat(i,"?").concat(n)).includes("//images")&&(t=t.replace("//images","/images"));var v=Object(a.useState)(!0),b=Object(p.a)(v,2),E=b[0],O=b[1];return r.a.createElement("li",{id:n,className:"list-group-item post gray"},r.a.createElement(J,{type:c,src:t,thumbnail_src:s,onClick:function(){return O(!E)}}),r.a.createElement("div",{className:"details collapse"+(E?"":".show")},r.a.createElement("div",{className:"d-flex justify-content-between info-bar"},r.a.createElement(R,{value:l}),r.a.createElement(z,{value:u}),r.a.createElement(P,{value:m})),r.a.createElement("div",{className:"pl-1"},r.a.createElement(x,{tags:f,activeTags:d,onItemClick:g}))))};function J(e){var t=e.type,n=e.src,a=e.thumbnail_src,c=e.onClick,i=!1;switch(t){case"image":return r.a.createElement("img",{src:n,alt:n,className:"img-fluid",onClick:c});case"video":return r.a.createElement("video",{controls:!0,loop:!0,src:n,alt:n,poster:a,className:"video-fluid",preload:"none",onClick:c,onTouchMove:function(){i=!0},onTouchEnd:function(e){i||c(e),i=!1}});default:return null}}function R(e){var t=e.value;return r.a.createElement("span",{className:"rating"},t[0].toUpperCase())}function z(e){var t=e.value;return r.a.createElement("span",{className:"score"},t)}function P(e){var t=e.value;return t?t.startsWith("http")?r.a.createElement("a",{href:t,target:"_blank",rel:"noopener noreferrer",className:"source"},"Source"):r.a.createElement("span",{className:"source"},t):null}n(49);var H=function(e){var t=e.posts,n=e.activeTags,a=e.loadOriginal,c=e.onTagClick;return r.a.createElement("ul",{className:"post-list list-group list-group-flush"},t.map(function(e){return r.a.createElement(I,Object.assign({key:"p_".concat(e.id)},e,{loadOriginal:a,activeTags:n,onTagClick:c}))}))},A=n(25),L=n.n(A),q=(n(62),function e(t,n,a,r,c,i,s,l,u,m,f,p,h,d,g,v,b,E,O,j,N){Object(o.a)(this,e),this.id=t,this.score=n,this.rating=a,this.source=r,this.tags=c,this.media_type=i,this.preview_src=s,this.original_src=l,this.thumbnail_src=u,this.width=m,this.height=f,this.creator_id=p,this.creator_url=h,this.status=d,this.parent_id=g,this.has_children=v,this.has_comments=b,this.comments_url=E,this.has_notes=O,this.created_at=j,this.change=N}),B=function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],a=arguments.length>2?arguments[2]:void 0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"+";Object(o.a)(this,e),this.name=t,this.types=n,this.count=a,this.modifier=r},G=function(e){return e.name?function(e){var t=e.name,n=e.types,a=e.count,r=e.modifier;return new B(t,n,Number(a),r)}(e):function(e){var t=e.id,n=e.type,a=e.score,r=e.rating,c=e.source,i=e.tags,o=e.file_url,s=e.width,l=e.height,u=e.creator_id,m=e.creator_url,f=e.sample_url,p=e.preview_url,h=e.status,d=e.parent_id,g=e.has_children,v=e.has_comments,b=e.comments_url,E=e.has_notes,O=e.created_at,j=e.change;return new q(Number(t),Number(a),r,c,i.map(function(e){return new B(e)}),n,f,o,p,Number(s),Number(l),u,m,h,d,g,v,b,E,O,j)}(e)};var M=function(e){var t=e.onSubmit,n=Object(a.useState)(""),c=Object(p.a)(n,2),i=c[0],o=c[1],s=Object(a.useState)("+"),l=Object(p.a)(s,2),u=l[0],m=l[1],f=Object(a.useState)([]),h=Object(p.a)(f,2),d=h[0],g=h[1],v=Object(a.useState)([]),b=Object(p.a)(v,2),E=b[0],O=b[1];Object(a.useEffect)(function(){d&&d.length>0&&O(d.filter(function(){return!0}))},[d]);var j={placeholder:"Search for tags",value:i,onChange:function(e,t){var n=t.newValue;return o(n)}};return r.a.createElement("form",{onSubmit:function(e){var n=E.find(function(e){return e.name===i})||{};t(G({name:i,count:n.posts,types:n.types,modifier:u})),o(""),e.preventDefault()},className:"d-flex input-group tag-selector"},r.a.createElement("div",{className:"input-group-prepend left-append"},r.a.createElement("select",{className:"form-control select-modifier",value:u,onChange:function(e){return m(e.target.value)}},r.a.createElement("option",null,"+"),r.a.createElement("option",null,"-"))),r.a.createElement(L.a,{suggestions:d,onSuggestionsFetchRequested:function(e){var t,n=e.value;k.getTags((t=n,t.toLowerCase().replace(" ","_"))).then(function(e){g(e)})},onSuggestionsClearRequested:function(){return g([])},getSuggestionValue:function(e){return e.name},renderSuggestion:function(e){var t=e.name,n=e.posts;return r.a.createElement("span",null,"".concat(t," (").concat(n,")"))},inputProps:j}),r.a.createElement("div",{className:"input-group-append right-append"},r.a.createElement("input",{type:"submit",value:"Add",className:"btn btn-red btn-add-tag"})))},U=!0;var W=Object(h.e)(function(e){var t=e.initialState,n=t.infinite,c=t.rated,i=t.originals,o=t.activeTags,s=Object(a.useState)(n),l=Object(p.a)(s,2),u=l[0],m=l[1],h=Object(a.useState)(c),d=Object(p.a)(h,2),g=d[0],b=d[1],E=Object(a.useState)(0),O=Object(p.a)(E,2),j=O[0],N=O[1],S=Object(a.useState)(i),w=Object(p.a)(S,2),y=w[0],C=w[1],_=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=Object(a.useState)(e),n=Object(p.a)(t,2),r=n[0],c=n[1],i=function(e){r.find(function(t){return t.name===e.name})&&o(e),c([].concat(Object(f.a)(r),[e]))},o=function(e){var t=r.filter(function(t){return t.name!==e.name});c(t)};return[r,function(e){r.find(function(t){return t.name===e.name})?o(e):i(e)},i,o]}(o),x=Object(p.a)(_,4),I=x[0],J=x[1],R=x[2],z=x[3],P=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=Object(a.useState)(e),n=Object(p.a)(t,2),r=n[0],c=n[1];return[r,c,function(e){return c([].concat(Object(f.a)(r),Object(f.a)(e)))}]}([]),A=Object(p.a)(P,3),L=A[0],q=A[1],B=A[2];!function(e,t,n,r){Object(a.useEffect)(function(){localStorage.setItem("infinteScroll",JSON.stringify(e))},[e]),Object(a.useEffect)(function(){localStorage.setItem("showRated",JSON.stringify(t))},[t]),Object(a.useEffect)(function(){localStorage.setItem("originalSizes",JSON.stringify(n))},[n]),Object(a.useEffect)(function(){localStorage.setItem("tags",JSON.stringify(r))},[r])}(u,g,y,I);var W=function(){k.getPosts(I,j+1,g?1:void 0).then(function(e){B(e.map(G)),N(j+1),U=!0})};return window.onscroll=function(){u&&U&&window.innerHeight+document.documentElement.scrollTop>=document.documentElement.scrollHeight-window.innerHeight&&(U=!1,W())},r.a.createElement("main",null,r.a.createElement("section",{className:"search"},r.a.createElement("h3",{className:"centered"},"Search"),r.a.createElement(M,{onSubmit:R,className:"centered"}),I.length>0?r.a.createElement("label",null,"Tags:",r.a.createElement(T,{tags:I,activeTags:I,onItemClick:z,onItemItemClick:function(e,t){z(e),R(t)}})):r.a.createElement("div",{className:"mb-1"}),r.a.createElement(v,{text:"Infinite Scroll",initial:u,onChange:function(){return m(!u)}}),r.a.createElement(v,{text:"Only show Rated",initial:g,onChange:function(){return b(!g)}}),r.a.createElement(v,{text:"Load Original Sizes",initial:y,onChange:function(){return C(!y)}}),r.a.createElement("button",{className:"btn btn-block btn-red",onClick:function(){k.getPosts(I,0,g?1:void 0).then(function(e){q(e.map(G)),N(0)})}},"Search")),L.length>0?r.a.createElement("section",{className:"results"},r.a.createElement("h3",{className:"centered"},"Results"),r.a.createElement(H,{posts:L,activeTags:I,loadOriginal:y,onTagClick:J}),!u&&r.a.createElement("button",{className:"btn btn-block btn-red",onClick:W},"Load More")):null)}),F=function(e){function t(){return Object(o.a)(this,t),Object(l.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){return r.a.createElement("div",{className:"app"},r.a.createElement("main",null,r.a.createElement("p",null,"Helpful things")))}}]),t}(a.Component),V=function(e){function t(){return Object(o.a)(this,t),Object(l.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){return r.a.createElement("div",{className:"app"},r.a.createElement("header",null,r.a.createElement("h1",null,"404 - not found")),r.a.createElement("main",null,r.a.createElement("p",null,"Go away")))}}]),t}(a.Component),D=n(15),$=(n(71),n(73),function(e){function t(){return Object(o.a)(this,t),Object(l.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(s.a)(t,[{key:"loadStorage",value:function(){var e=JSON.parse(localStorage.getItem("tags")),t=JSON.parse(localStorage.getItem("infinteScroll")),n=JSON.parse(localStorage.getItem("showRated")),a=JSON.parse(localStorage.getItem("originalSizes"));return{activeTags:null===e?[]:e,infinite:null!==t&&t,rated:null!==n&&n,originals:null!==a&&a}}},{key:"render",value:function(){var e=this;return r.a.createElement(D.a,{basename:"/r34-react"},r.a.createElement("header",{className:"centered"},r.a.createElement("h1",{className:"centered"},"Browse ",r.a.createElement("a",{href:"https://rule34.xxx"},"Rule34")),r.a.createElement("div",{className:"container d-flex justify-content-center menu-bar"},r.a.createElement(D.b,{to:"/",className:"menu-item"},"Search"),r.a.createElement(D.b,{to:"/help",className:"menu-item"},"Help"))),r.a.createElement(h.c,null,r.a.createElement(h.a,{exact:!0,path:"/",render:function(){return r.a.createElement(W,{initialState:e.loadStorage()})}}),r.a.createElement(h.a,{exact:!0,path:"/help",component:F}),r.a.createElement(h.a,{component:V})),r.a.createElement("div",{className:"spacer"}),r.a.createElement("footer",null,r.a.createElement("small",null,r.a.createElement("div",{className:"d-flex justify-content-center"},r.a.createElement("p",null,r.a.createElement("a",{href:"https://github.com/kurozenzen/r34"},"Github Repository"))),r.a.createElement("div",{className:"d-flex justify-content-center"},r.a.createElement("p",null,"Please, if you notice"," ",r.a.createElement("a",{href:"https://github.com/kurozenzen/r34/issues/new?template=bug_report.md"}," ","something isn't right"),", or you"," ",r.a.createElement("a",{href:"https://github.com/kurozenzen/r34/issues/new?template=feature_request.md"},"want a feature")," ","to be implemented take the time to let me know.")),r.a.createElement("div",{className:"d-flex justify-content-center"},r.a.createElement("p",null,"Hosted with Github Pages.")))))}}]),t}(a.Component));Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));i.a.render(r.a.createElement($,null),document.getElementById("app-root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})}},[[28,2,1]]]);
//# sourceMappingURL=main.80608628.chunk.js.map