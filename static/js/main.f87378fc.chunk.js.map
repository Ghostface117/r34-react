{"version":3,"sources":["redux/actions.ts","hooks/useAction.tsx","components/features/CookieConfirmation.tsx","GlobalStyles.tsx","misc/theme.ts","components/layout/infinite/InfiniteColumn.tsx","components/post/Rating.tsx","components/post/Score.tsx","components/post/Source.tsx","components/post/Details.tsx","data/utils.ts","components/player/FlexVideo.tsx","components/styled/animations.tsx","components/player/Overlay.tsx","components/player/Video.tsx","components/player/FlexImage.tsx","components/player/Gif.tsx","components/player/Picture.tsx","components/player/utils.ts","components/player/Player.tsx","components/post/Post.tsx","components/features/SearchButton.tsx","components/features/ActiveTags.tsx","components/features/Config.tsx","components/features/KofiButton.tsx","components/common/RandomTip.tsx","components/layout/LayoutHeader.tsx","icons/OutOfResults.png","components/layout/LayoutOutOfItems.tsx","icons/Loading.tsx","components/layout/LayoutLoadingItem.tsx","components/layout/pages/PageNavigation.tsx","components/layout/pages/PageLayout.tsx","components/reader/Reader.tsx","components/pages/Search.tsx","redux/reducers/preferences.ts","redux/reducers/results.ts","redux/reducers/tags.ts","redux/reducers/reader.ts","redux/reducers/index.ts","analytics/events.ts","redux/middleware/eventLogging.ts","redux/middleware/apiRequests.ts","redux/store.ts","App.tsx","index.tsx","icons/Icons.tsx","components/common/Buttons.tsx","components/common/Text.tsx","misc/formatting.ts","hooks/useToggle.ts","components/common/FlexPair.tsx","misc/api.ts","data/Tag.ts","components/tag/tagUtils.ts","components/common/Lines.tsx","components/tag/TagName.tsx","components/tag/Alias.tsx","components/tag/AliasesList.tsx","components/tag/NewTag.tsx","components/tag/TagList.tsx","components/tag/TagWrapper.tsx","data/Post.ts","misc/prepare.ts","components/common/Surface.tsx","icons/TypeIcon.tsx","hooks/usePreference.tsx","components/common/FlexColumn.tsx","icons/R34Icon.tsx","components/features/Header.tsx","data/types.ts","components/common/Toggle.tsx","components/common/SmallInput.tsx","components/tagSelector/TagInput.tsx","components/tagSelector/DropdownListEntry.tsx","components/tagSelector/DropdownList.tsx","components/tagSelector/useModifier.tsx","components/tagSelector/TagSelector.tsx","hooks/useThrottledEffect.tsx","components/common/LabeledToggle.tsx","components/features/Options.tsx","redux/selectors.ts"],"names":["ADD_TAG","REMOVE_TAG","ADD_ALIASES","ADD_POSTS","SET_POSTS","SET_OPTION","GET_RESULTS","GET_MORE_RESULTS","ALLOW_COOKIES","ENTER_FULLSCREEN","EXIT_FULLSCREEN","SET_FULLSCREEN_POST","addTag","tag","type","removeTag","addAliases","aliases","forTag","addPosts","posts","setPosts","count","pageNumber","setOption","key","value","getResults","getMoreResults","allowCookiesAction","enterFullscreen","postId","exitFullscreen","setFullScreenPost","useAction","actionCreator","dispatch","useDispatch","useCallback","CookieWrapper","styled","div","theme","css","colors","backgroundColor2","layerBgSolid","dimensions","gutter","StyledSpan","span","CookieConfirmation","cookies","useSelector","selectCookies","onClick","aria-label","createGlobalStyle","fontSizes","content","backgroundColor","accentColor","borderRadius","borderWidth","spacing","bigSpacing","hugeSpacing","blockHeight","bodyWidth","hoverAccent","subduedText","layerBg","shadow","box","drop","timings","transitionTime","longTransitionTime","misc","layer","bigTitle","InifinteColumn","props","Header","items","LoadingItem","hasMoreRows","ItemComponent","loadMore","OutOfItems","isLoading","setLoading","useState","listRef","setListRef","cache","useMemo","CellMeasurerCache","fixedWidth","prependedRows","rowCount","length","isRowLoaded","index","useEffect","listener","measureAllRows","recomputeRowHeights","forceUpdateGrid","window","addEventListener","removeEventListener","rowRenderer","parent","style","columnIndex","rowIndex","measure","registerChild","virtualRef","onLoad","console","warn","loadMoreRows","params","Promise","reject","resolve","setTimeout","onRowsRendered","ref","child","deferredMeasurementCache","overscanRowCount","rowHeight","width","innerWidth","height","innerHeight","Rating","FlexPair","color","toUpperCase","ColoredA","a","Source","startsWith","includes","TwitterLink","PixivSource","PatreonLink","DeviantArtLink","DefaultLink","FallbackSource","href","target","rel","className","left","formatSource","split","Bar","DetailsTagList","TagList","Details","rating","score","source","tags","tagsForRendering","listToMap","keyProp","reduce","result","current","Score","loadAliases","FlexVideo","video","fadeOut","keyframes","Wrapper","isVisible","ProgressBar","OverlayButton","InvisButton","FullScreenButton","OpenExternalButton","PlayButton","PreviousButton","NextButton","LengthDisplay","Overlay","togglePlay","NO_OP","isPaused","isPlayable","currentTime","duration","externalSrc","mediaRef","selectPosts","useToggle","toggleVisible","isReaderOpen","selectFullsceenState","onExpandClick","selectedIndex","findIndex","post","id","selectPostAt","postAtindex","hasNext","selectNext","hasPrevious","selectPrevious","size","isNaN","formatDuration","Video","src","videoRef","setVideoRef","Date","now","setTime","intervalId","setIntervalId","play","setInterval","pause","clearInterval","event","stopPropagation","paused","preloadVideos","selectPreferences","controls","loop","preload","FlexImage","img","Gif","thumbnail_src","setPaused","usedSource","alt","loading","Picture","getMedia","VIDEO","GIF","PICTURE","getMediaType","Player","URL","searchParams","get","media","MediaComponent","ItemWrapper","PositonWrapper","PostWrapper","getCorrectSource","loadOriginal","big_src","small_src","Post","media_type","originals","collapsed","toggleCollapsed","media_src","toggleDetails","role","SearchButton","search","ActiveTags","onChange","activeTags","selectActiveTags","numberOfActiveTags","selectNumberOfActiveTags","ConfigWrapper","section","Config","htmlFor","Surface","TagSelector","Options","Container","AButton","Text","Image","KofiButton","label","title","tips","Span","Faded","RandomTip","tip","Math","floor","random","Placeholder","LayoutHeader","fullNumber","toggleFullNumber","selectCount","toLocaleString","formatCount","Div","StyledSurface","StyledImage","LayoutOutOfItems","selectAliasesAsList","aliasesForRendering","alias","name","outOfResultsPicture","padding","StyledSvg","svg","Loading","version","xmlns","xmlnsXlink","viewBox","enable-background","xmlSpace","fill","stroke","cx","cy","r","attributeName","dur","values","repeatCount","begin","LayoutLoadingItem","PageRow","PageNumber","RedButton","CurrentNumber","SmallNumberInput","PageNavigation","currentPage","loadPage","lastPage","selectLastPage","loadSpecificPage","newPage","Number","loadFirst","loadLast","loadPrevious","loadNext","onSubmit","FlexColumn","BaseFlexColumn","PageLayout","header","pageSize","scrollAndLoadPage","document","getElementsByClassName","scrollIntoView","map","item","FullScreenDiv","Reader","fullScreenPostId","selectFullsceenPostId","fullScreenPost","find","Search","hasMorePosts","selectHasMoreResults","resultsLayout","selectPageNumber","ResultLayout","INFINITE_COLUMN","hasMorePages","initialPreferencesState","infinite","rated","ratedTreshold","tagSuggestionsCount","state","produce","draft","preferences","action","COOKIES","initialResultsState","results","postCount","initialTagsState","active","newTag","tagToRemove","initialReaderState","isEnabled","reader","setPostId","combineReducers","config","apiKey","authDomain","databaseURL","projectId","storageBucket","messagingSenderId","appId","measurementId","firebaseApp","analytics","eventLogging","store","next","getState","firebase","initializeApp","payload","modifier","logEvent","page_number","active_tags","Object","sort","searchEvent","apiRequests","api","getPosts","then","res","preparePost","isOutOfResults","selectOutOfResults","persistConfig","storage","persistedReducer","persistReducer","rootReducer","createStore","composeWithDevTools","applyMiddleware","persistor","persistStore","Help","React","lazy","Settings","App","GlobalStyles","fallback","path","RouteName","HELP","SETTINGS","SEARCH","ReactDOM","render","getElementById","StyledIcon","i","TagWrapper","IconWrapper","Icon","icon","right","prefix","CharacterIcon","attrs","ArtistIcon","CopyrightIcon","CloseIcon","ExpandIcon","memo","ArrowIcon","ExternalLinkIcon","SourceIcon","RatingIcon","HeartIcon","TwitterIcon","PatreonIcon","DeviantArtIcon","LinkIcon","PlayIcon","PauseIcon","ArrowLeft","ArrowRight","CodeBranchIcon","PixivIcon","d","TextButton","button","BlockButton","AddButton","ModifierButton","Title","h2","BigTitle","h1","SmallTitle","h3","numberString","number","toFixed","sourceString","semiSanitized","replace","substring","indexOf","min","trunc","sec","initialValue","setValue","toggleValue","resetValue","children","API","constructor","activeApi","apiUrl2","this","apiUrl1","fetch","catch","getTags","searchTerm","limit","json","minScore","buildPostUrl","getAliases","tagName","page","normalTags","filter","Modifier","OR","orTags","tagString","encodeURIComponent","join","url","TagDataClass","types","PLUS","prettifyTagname","tagname","normalizeTagname","toLowerCase","HorizontalLine","VerticalLine","modifierToStyle","MINUS","TagNameSpan","TagName","text","toggleTag","AliasWrapper","Alias","ListWrapper","parentRef","offsetTop","clientHeight","offsetLeft","clientWidth","AliasesList","NewTag","tagRef","setTagRef","resetCollapsed","selectAliasesByTagName","isActive","newAliases","b","filtered","onMouseLeave","TypeIcon","TagListWrapper","entries","fg","bg","switchingColors","PostDataClass","file_url","creator_id","creator_url","status","parent_id","has_children","has_comments","comments_url","has_notes","created_at","change","prepareTag","dirtyTag","sample_url","preview_url","t","Boolean","match","usePreference","setPreference","FlexColumnWithSpacing","R34Icon","useTheme","transform","strokeWidth","strokeMiterlimit","strokeDasharray","strokeOpacity","fontStyle","fontWeight","fontSize","fontFamily","letterSpacing","wordSpacing","fillOpacity","x","y","fontVariant","fontStretch","HeaderWrapper","TitleBar","MenuBar","nav","LocationStyledLink","Link","to","useLocation","pathname","RATED","RATEDTRESHOLD","ORIGINALS","PRELOAD_VIDEOS","TAG_SUGGESTIONS_COUNT","RESULTS_LAYOUT","PAGE_SIZE","Track","Thumb","Toggle","onToggle","TextInput","input","toString","internalValue","setInternalValue","onBlur","onKeyDown","Input","TagInput","placeholder","EntryWrapper","Name","Count","DropdownListEntry","tagSelector","sizeAndPosition","tagSelectorRef","DropdownList","entry","order","TagSelectorWrapper","closed","suggestions","setSuggestions","setTagSelectorRef","setModifier","nextModifier","currentIndex","useModifier","activateTag","effect","timeout","deps","newSuggestions","handle","clearTimeout","onAddClick","trim","suggestion","s","onSuggestionClick","LabeledToggle","OptionsWrapper","StyledInput","setRated","setRatedThreshold","toggleRated","ratedTresholdInternal","setRatedThresholdInternal","display","createSelector","keys","flat","outOfResults","ceil"],"mappings":"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","file":"static/js/main.f87378fc.chunk.js","sourcesContent":["import { PreferenceKey } from \"../data/types\"\nimport TagDataClass from \"../data/Tag\"\nimport PostDataClass from \"../data/Post\"\n\n/////////////////////////////////////////////////////////\n\nexport const ADD_TAG = \"R34_ADD_TAG\"\nexport const REMOVE_TAG = \"R34_REMOVE_TAG\"\nexport const ADD_ALIASES = \"R34_ADD_ALIASES\"\nexport const ADD_POSTS = \"R34_ADD_POSTS\"\nexport const SET_POSTS = \"R34_SET_POSTS\"\nexport const SET_OPTION = \"R34_SET_OPTION\"\nexport const GET_RESULTS = \"R34_GET_RESULTS\"\nexport const GET_MORE_RESULTS = \"R34_GET_MORE_RESULTS\"\nexport const ALLOW_COOKIES = \"R34_ALLOW_COOKIES\"\nexport const ENTER_FULLSCREEN = \"R34_ENTER_FULLSCREEN\"\nexport const EXIT_FULLSCREEN = \"R34_EXIT_FULLSCREEN\"\nexport const SET_FULLSCREEN_POST = \"R34_SET_FULLSCREEN_POST\"\n\n/////////////////////////////////////////////////////////\n\ninterface AddTagAction {\n  type: typeof ADD_TAG\n  tag: TagDataClass\n}\n\ninterface RemoveTagAction {\n  type: typeof REMOVE_TAG\n  tag: TagDataClass\n}\n\ninterface AddAliasesAction {\n  type: typeof ADD_ALIASES\n  aliases: TagDataClass[]\n  forTag: string\n}\n\ninterface AddPostsAction {\n  type: typeof ADD_POSTS\n  posts: PostDataClass[]\n}\n\ninterface SetPostsAction {\n  type: typeof SET_POSTS\n  posts: PostDataClass[]\n  count: string\n  pageNumber?: number\n}\n\ninterface SetOptionAction {\n  type: typeof SET_OPTION\n  key: PreferenceKey\n  value: any\n}\n\ninterface GetResultsAction {\n  type: typeof GET_RESULTS\n  pageNumber: number\n}\n\ninterface GetMoreResultsAction {\n  type: typeof GET_MORE_RESULTS\n}\n\ninterface AllowCookiesAction {\n  type: typeof ALLOW_COOKIES\n  value: boolean\n}\n\ninterface EnterFullcreenAction {\n  type: typeof ENTER_FULLSCREEN\n  postId: number\n}\n\ninterface SetFullScreenPostAction {\n  type: typeof SET_FULLSCREEN_POST\n  postId: number\n}\n\ninterface ExitFullscreenAction {\n  type: typeof EXIT_FULLSCREEN\n}\n\n/////////////////////////////////////////////////////////\n\nexport const addTag = (tag: TagDataClass) => ({\n  type: ADD_TAG,\n  tag,\n})\n\nexport const removeTag = (tag: TagDataClass) => ({\n  type: REMOVE_TAG,\n  tag,\n})\n\nexport const addAliases = (aliases: TagDataClass[], forTag: string) => ({\n  type: ADD_ALIASES,\n  aliases,\n  forTag,\n})\n\nexport const addPosts = (posts: PostDataClass[]) => ({\n  type: ADD_POSTS,\n  posts,\n})\n\nexport const setPosts = (posts: PostDataClass[], count: string, pageNumber: number = 0) => ({\n  type: SET_POSTS,\n  posts,\n  count,\n  pageNumber,\n})\n\nexport const setOption = (key: PreferenceKey, value: any) => ({\n  type: SET_OPTION,\n  key,\n  value,\n})\n\nexport const getResults = (pageNumber: number = 0) => ({\n  type: GET_RESULTS,\n  pageNumber,\n})\n\nexport const getMoreResults = () => ({\n  type: GET_MORE_RESULTS,\n})\n\nexport const allowCookiesAction = () => ({\n  type: ALLOW_COOKIES,\n  value: true,\n})\n\nexport const enterFullscreen = (postId: number) => ({\n  type: ENTER_FULLSCREEN,\n  postId,\n})\n\nexport const exitFullscreen = () => ({\n  type: EXIT_FULLSCREEN,\n})\n\nexport const setFullScreenPost = (postId: number) => ({\n  type: SET_FULLSCREEN_POST,\n  postId,\n})\n\n/////////////////////////////////////////////////////////\n\nexport type AppAction =\n  | AddTagAction\n  | RemoveTagAction\n  | AddAliasesAction\n  | AddPostsAction\n  | SetPostsAction\n  | SetOptionAction\n  | GetResultsAction\n  | GetMoreResultsAction\n  | AllowCookiesAction\n  | EnterFullcreenAction\n  | ExitFullscreenAction\n  | SetFullScreenPostAction\n","import { useCallback } from \"react\"\r\nimport { useDispatch } from \"react-redux\"\r\nimport { AnyAction } from \"redux\"\r\n\r\nexport default function useAction<T extends () => AnyAction>(actionCreator: T) {\r\n  const dispatch = useDispatch()\r\n  return useCallback(() => dispatch(actionCreator()), [actionCreator, dispatch])\r\n}\r\n","import React from \"react\"\r\nimport styled, { css } from \"styled-components\"\r\nimport { RedButton } from \"../common/Buttons\"\r\nimport { useSelector } from \"react-redux\"\r\nimport { allowCookiesAction } from \"../../redux/actions\"\r\nimport { selectCookies } from \"../../redux/selectors\"\r\nimport useAction from \"../../hooks/useAction\"\r\n\r\nconst CookieWrapper = styled.div(\r\n  ({ theme }) => css`\r\n    position: fixed;\r\n    bottom: 0;\r\n    left: 0;\r\n    width: 100%;\r\n    display: flex;\r\n    align-items: center;\r\n    justify-content: space-between;\r\n\r\n    color: ${theme.colors.backgroundColor2};\r\n    background: ${theme.colors.layerBgSolid};\r\n\r\n    padding: ${theme.dimensions.gutter};\r\n  `\r\n)\r\n\r\nconst StyledSpan = styled.span`\r\n  height: min-content;\r\n`\r\n\r\nexport default function CookieConfirmation() {\r\n  const cookies = useSelector(selectCookies)\r\n  const onClick = useAction(allowCookiesAction)\r\n\r\n  return cookies ? null : (\r\n    <CookieWrapper>\r\n      <StyledSpan>This website uses cookies.</StyledSpan>\r\n      <RedButton onClick={onClick} aria-label=\"Allow Cookies\">\r\n        Got it\r\n      </RedButton>\r\n    </CookieWrapper>\r\n  )\r\n}\r\n","import { createGlobalStyle, css } from \"styled-components\"\r\n\r\nexport default createGlobalStyle(\r\n  ({ theme }) => css`\r\n    * {\r\n      margin: 0;\r\n      padding: 0;\r\n      box-sizing: border-box;\r\n\r\n      font-family: \"Raleway\", sans-serif;\r\n      -webkit-font-smoothing: antialiased;\r\n      -moz-osx-font-smoothing: grayscale;\r\n\r\n      :focus {\r\n        outline: none;\r\n        text-decoration: underline;\r\n      }\r\n    }\r\n\r\n    html,\r\n    body,\r\n    #app-root {\r\n      width: 100%;\r\n      height: 100%;\r\n    }\r\n\r\n    body {\r\n      font-size: ${theme.fontSizes.content};\r\n      color: ${theme.colors.backgroundColor2};\r\n      background-color: ${theme.colors.backgroundColor};\r\n    }\r\n\r\n    a {\r\n      color: ${theme.colors.accentColor};\r\n      text-decoration: none;\r\n    }\r\n  `\r\n)\r\n","const theme = {\n  dimensions: {\n    borderRadius: \"3px\",\n    borderWidth: \"2px\",\n    spacing: \"4px\",\n    bigSpacing: \"8px\",\n    hugeSpacing: \"16px\",\n    gutter: \"8px\",\n    blockHeight: \"32px\",\n    bodyWidth: \"1000px\",\n  },\n  colors: {\n    accentColor: \"#ee3344\",\n    hoverAccent: \"#ee3344\",\n    backgroundColor: \"#121212\",\n    backgroundColor2: \"#fff\",\n    subduedText: \"#ffffff80\",\n    layerBg: \"#ffffff11\",\n    layerBgSolid: \"#222222\",\n  },\n  shadow: {\n    box: \"box-shadow: 0 0 8px #000\",\n    drop: \"drop-shadow(0 0 4px #000)\",\n  },\n  timings: {\n    transitionTime: \"0.2s\",\n    longTransitionTime: \"0.2s\",\n  },\n  misc: {\n    layer: \"#ffffff11; :hover { background: #ffffff16;} transition: background-color 0.2s ease-in-out\",\n  },\n  fontSizes: {\n    content: \"15px\",\n    bigTitle: \"24px\",\n  },\n}\n\nexport default theme\n\nexport type ThemeType = typeof theme\n","import React, { useCallback, useEffect, useMemo, useState } from \"react\"\nimport { CellMeasurer, CellMeasurerCache, IndexRange, InfiniteLoader, List } from \"react-virtualized\"\nimport LayoutElementProps from \"../LayoutElementProps\"\n\ninterface InfiniteColumnProps<T> {\n  Header?: (props: LayoutElementProps) => JSX.Element\n  OutOfItems?: (props: LayoutElementProps) => JSX.Element\n  items?: T[]\n  LoadingItem: (props: LayoutElementProps) => JSX.Element\n  hasMoreRows: boolean\n  loadMore: () => void\n  ItemComponent: (props: T & LayoutElementProps) => JSX.Element\n  isLoading: boolean\n  setLoading: (value: boolean) => void\n}\n\nexport default function InifinteColumn<T>(props: InfiniteColumnProps<T>) {\n  const {\n    Header,\n    items = [],\n    LoadingItem,\n    hasMoreRows,\n    ItemComponent,\n    loadMore,\n    OutOfItems,\n    isLoading,\n    setLoading,\n  } = props\n\n  const [listRef, setListRef] = useState<List | null>(null)\n\n  const cache = useMemo(\n    () =>\n      new CellMeasurerCache({\n        fixedWidth: true,\n      }),\n    []\n  )\n\n  const prependedRows = Header ? 1 : 0\n  const loadingRows = 1\n\n  const rowCount = items.length + prependedRows + loadingRows\n\n  const isRowLoaded = useCallback(\n    ({ index }: { index: number }) => index < prependedRows + items.length + (hasMoreRows ? 0 : 1),\n    [hasMoreRows, items.length, prependedRows]\n  )\n\n  useEffect(() => {\n    if (listRef) {\n      const listener = () => {\n        listRef.measureAllRows()\n        listRef.recomputeRowHeights()\n        listRef.forceUpdateGrid()\n      }\n\n      window.addEventListener(\"resize\", listener)\n\n      return () => {\n        window.removeEventListener(\"resize\", listener)\n      }\n    }\n  }, [listRef])\n\n  const rowRenderer = useCallback(\n    ({ index, key, parent, style }: { index: number; key: any; parent: any; style: any }) => {\n      return (\n        <CellMeasurer cache={cache} columnIndex={0} key={key} rowIndex={index} parent={parent}>\n          {({ measure, registerChild }) => {\n            // Index 0\n            if (Header && index < prependedRows) {\n              return <Header style={style} virtualRef={registerChild} onLoad={measure} />\n            }\n\n            // Index 1\n            if (index < prependedRows + items.length) {\n              return (\n                <ItemComponent\n                  style={style}\n                  virtualRef={registerChild}\n                  onLoad={measure}\n                  {...items[index - prependedRows]}\n                />\n              )\n            }\n\n            // Index 2\n            if (index < prependedRows + items.length + loadingRows) {\n              return hasMoreRows || isLoading ? (\n                <LoadingItem style={style} virtualRef={registerChild} onLoad={measure} />\n              ) : OutOfItems && items.length > 0 ? (\n                <OutOfItems style={style} virtualRef={registerChild} onLoad={measure} />\n              ) : (\n                <div></div>\n              )\n            }\n\n            console.warn(\"index not found / out of bounds. INDEX:\", index)\n            return null\n          }}\n        </CellMeasurer>\n      )\n    },\n    [cache, Header, prependedRows, items, ItemComponent, hasMoreRows, isLoading, LoadingItem, OutOfItems]\n  )\n\n  const loadMoreRows = (params: IndexRange) => {\n    if (isLoading || !hasMoreRows) {\n      return Promise.reject(0)\n    }\n\n    setLoading(true)\n    loadMore()\n\n    return new Promise((resolve) => {\n      setTimeout(() => {\n        setLoading(false)\n        resolve(1)\n      }, 1000)\n    })\n  }\n\n  return (\n    <InfiniteLoader isRowLoaded={isRowLoaded} loadMoreRows={loadMoreRows} rowCount={rowCount}>\n      {({ onRowsRendered, registerChild }) => {\n        const registerChildHereAswell = (child: List) => {\n          setListRef(child)\n          registerChild(child)\n        }\n        return (\n          <List\n            ref={registerChildHereAswell}\n            onRowsRendered={onRowsRendered}\n            rowRenderer={rowRenderer}\n            deferredMeasurementCache={cache}\n            overscanRowCount={10}\n            rowCount={items.length + prependedRows + loadingRows}\n            rowHeight={cache.rowHeight}\n            width={window.innerWidth}\n            height={window.innerHeight}\n          />\n        )\n      }}\n    </InfiniteLoader>\n  )\n}\n","import { RatingType } from \"../../data/types\"\nimport React from \"react\"\nimport { RatingIcon } from \"../../icons/Icons\"\nimport FlexPair from \"../common/FlexPair\"\n\nexport default function Rating(props: { value: RatingType }) {\n  return (\n    <FlexPair>\n      <RatingIcon color=\"white\" />\n      <span>{props.value[0].toUpperCase()}</span>\n    </FlexPair>\n  )\n}\n","import React from \"react\"\nimport { HeartIcon } from \"../../icons/Icons\"\nimport FlexPair from \"../common/FlexPair\"\n\nexport default (props: { value: number }) => (\n  <FlexPair>\n    <HeartIcon color=\"white\" />\n    <span>{props.value}</span>\n  </FlexPair>\n)\n","import React from \"react\"\nimport styled, { css } from \"styled-components\"\nimport { DeviantArtIcon, LinkIcon, PatreonIcon, PixivIcon, SourceIcon, TwitterIcon } from \"../../icons/Icons\"\nimport { formatSource } from \"../../misc/formatting\"\nimport FlexPair from \"../common/FlexPair\"\n\nconst ColoredA = styled.a(\n  (props) => css`\n    color: ${props.color} !important;\n    display: flex;\n    gap: ${props.theme.dimensions.spacing};\n  `\n)\n\ninterface SourceProps {\n  value: string\n}\n\nexport default function Source({ value }: SourceProps) {\n  if (value.startsWith(\"http\")) {\n    if (value.includes(\"twitter.com\")) {\n      return <TwitterLink value={value} />\n    }\n\n    if (value.includes(\"pixiv.net\")) {\n      return <PixivSource value={value} />\n    }\n\n    if (value.includes(\"patreon.com\")) {\n      return <PatreonLink value={value} />\n    }\n\n    if (value.includes(\"deviantart.com\")) {\n      return <DeviantArtLink value={value} />\n    }\n\n    return <DefaultLink value={value} />\n  }\n\n  return <FallbackSource value={value} />\n}\n\nconst FallbackSource = ({ value }: SourceProps) => {\n  return (\n    <FlexPair>\n      <SourceIcon color=\"white\" />\n      <span>{value}</span>\n    </FlexPair>\n  )\n}\n\nconst DefaultLink = ({ value }: SourceProps) => {\n  return (\n    <a href={value} target=\"_blank\" rel=\"noopener noreferrer\" className=\"source\">\n      <LinkIcon color=\"red\" left />\n      {formatSource(value)}\n    </a>\n  )\n}\n\nconst TwitterLink = ({ value }: SourceProps) => {\n  return (\n    <ColoredA href={value} target=\"_blank\" rel=\"noopener noreferrer\" className=\"source\" color=\"rgb(29, 161, 242)\">\n      <TwitterIcon color=\"rgb(29, 161, 242)\" />\n      {value.split(\"twitter.com/\")[1].split(\" \")[0].split(\"?\")[0].split(\"/\")[0]}\n    </ColoredA>\n  )\n}\n\nconst DeviantArtLink = ({ value }: SourceProps) => {\n  return (\n    <ColoredA href={value} target=\"_blank\" rel=\"noopener noreferrer\" className=\"source\" color=\"#00e59b\">\n      <DeviantArtIcon color=\"#00e59b\" />\n      {value.split(\"deviantart.com/\")[1].split(\" \")[0].split(\"?\")[0].split(\"/\")[0]}\n    </ColoredA>\n  )\n}\n\nconst PatreonLink = ({ value }: SourceProps) => {\n  return (\n    <ColoredA href={value} target=\"_blank\" rel=\"noopener noreferrer\" className=\"source\" color=\"#FF424D\">\n      <PatreonIcon color=\"#FF424D\" />\n      {value.split(\"patreon.com/\")[1].split(\" \")[0].split(\"?\")[0].split(\"/\")[0]}\n    </ColoredA>\n  )\n}\n\nconst PixivSource = ({ value }: SourceProps) => {\n  return (\n    <ColoredA href={value} target=\"_blank\" rel=\"noopener noreferrer\" className=\"source\" color=\"#0096FA\">\n      <PixivIcon color=\"#0096FA\" left />\n      <span>Pixiv</span>\n    </ColoredA>\n  )\n}\n","import React, { useMemo } from \"react\"\nimport styled, { css } from \"styled-components\"\nimport TagList from \"../tag/TagList\"\nimport { RatingType } from \"../../data/types\"\nimport TagDataClass from \"../../data/Tag\"\nimport { listToMap } from \"../../data/utils\"\nimport Rating from \"./Rating\"\nimport Score from \"./Score\"\nimport Source from \"./Source\"\n\nconst Bar = styled.div(\n  ({ theme: { dimensions, misc, shadow } }) => css`\n    grid-row: 2/3;\n    display: flex;\n    flex-wrap: wrap;\n    justify-content: space-between;\n    background: ${misc.layer};\n    padding: ${dimensions.bigSpacing};\n    ${shadow.box};\n    border-radius: 0 0 ${dimensions.borderRadius} ${dimensions.borderRadius};\n  `\n)\n\nconst DetailsTagList = styled(TagList)(\n  ({ theme }) => css`\n    grid-row: 3/4;\n    padding: ${theme.dimensions.gutter};\n  `\n)\n\ninterface DetailsProps {\n  rating: RatingType\n  score: number\n  source: string\n  tags: TagDataClass[]\n}\n\nexport default function Details(props: DetailsProps) {\n  const { rating, score, source, tags } = props\n  const tagsForRendering = useMemo(() => listToMap(tags, \"name\"), [tags])\n\n  return (\n    <>\n      <Bar>\n        {!!rating && <Rating value={rating} />}\n        {!!score && <Score value={score} />}\n        {!!source && <Source value={source} />}\n      </Bar>\n      <DetailsTagList tags={tagsForRendering} loadAliases={false} />\n    </>\n  )\n}\n","import { SimpleMap } from \"./types\"\n\nexport const listToMap = <T>(list: T[], keyProp: string): SimpleMap<T> => {\n  return list.reduce((result: SimpleMap<T>, current: any) => {\n    result[current[keyProp]] = current\n    return result\n  }, {})\n}\n","import styled, { css } from \"styled-components\"\r\n\r\nconst FlexVideo = styled.video(\r\n  ({ width, height }) => css`\r\n    width: 100%;\r\n    height: 100%;\r\n    display: block;\r\n    object-fit: contain;\r\n    grid-area: 1/1/2/2;\r\n    ${width && height\r\n      ? css`\r\n          aspect-ratio: ${width} / ${height};\r\n        `\r\n      : \"\"}\r\n  `\r\n)\r\n\r\nexport default FlexVideo\r\n","import { keyframes } from \"styled-components\"\n\nexport const fadeOut = keyframes`\n  from {\n    opacity: 1;\n  }\n\n  to {\n    opacity: 0;\n  }\n`\n\nexport const kofiWiggle = keyframes`\n  0% {\n    transform: rotate(0) scale(1);\n  }\n  60% {\n    transform: rotate(0) scale(1);\n  }\n  75% {\n    transform: rotate(0) scale(1.12);\n  }\n  80% {\n    transform: rotate(0) scale(1.1);\n  }\n  84% {\n    transform: rotate(-10deg) scale(1.1);\n  }\n  88% {\n    transform: rotate(10deg) scale(1.1);\n  }\n  92% {\n    transform: rotate(-10deg) scale(1.1);\n  }\n  96% {\n    transform: rotate(10deg) scale(1.1);\n  }\n  100% {\n    transform: rotate(0) scale(1);\n  }\n`\n","import React, { MouseEventHandler, useCallback, useMemo } from \"react\"\r\n\r\nimport { ExpandIcon, PlayIcon, PauseIcon, ExternalLinkIcon, CloseIcon, ArrowLeft, ArrowRight } from \"../../icons/Icons\"\r\nimport styled, { css } from \"styled-components\"\r\nimport useToggle from \"../../hooks/useToggle\"\r\nimport { fadeOut } from \"../styled/animations\"\r\nimport { InvisButton } from \"../common/Buttons\"\r\nimport { NO_OP } from \"../../data/types\"\r\nimport { formatDuration } from \"../../misc/formatting\"\r\nimport { useDispatch, useSelector } from \"react-redux\"\r\nimport { selectFullsceenState, selectPosts } from \"../../redux/selectors\"\r\nimport { enterFullscreen, exitFullscreen, setFullScreenPost } from \"../../redux/actions\"\r\n\r\nconst Wrapper = styled.div(\r\n  (props: { isVisible: boolean }) => css`\r\n    grid-area: 1/1/2/2;\r\n    display: grid;\r\n    grid-template-columns: repeat(3, 1fr);\r\n    grid-template-rows: auto 1fr auto auto;\r\n    z-index: 1;\r\n\r\n    ${!props.isVisible\r\n      ? css`\r\n          opacity: 0;\r\n          animation: ${fadeOut} 0.4s ease-in-out;\r\n        `\r\n      : \"\"};\r\n  `\r\n)\r\n\r\nconst ProgressBar = styled.div(\r\n  (props) => css`\r\n    grid-area: 4/1/4/4;\r\n    height: 5px;\r\n    background-color: ${props.theme.colors.accentColor};\r\n  `\r\n)\r\n\r\nconst OverlayButton = styled(InvisButton)(\r\n  (props) => css`\r\n    width: max-content;\r\n    height: max-content;\r\n    padding: ${props.theme.dimensions.bigSpacing};\r\n  `\r\n)\r\n\r\nconst FullScreenButton = styled(OverlayButton)`\r\n  grid-area: 1/1/2/2;\r\n  place-self: start start;\r\n`\r\n\r\nconst OpenExternalButton = styled(OverlayButton)`\r\n  grid-area: 3/1/4/1;\r\n  place-self: end start;\r\n`\r\n\r\nconst PlayButton = styled(OverlayButton)`\r\n  grid-area: 2/2/3/3;\r\n  place-self: center center;\r\n`\r\n\r\nconst PreviousButton = styled(OverlayButton)`\r\n  grid-area: 2/1/3/2;\r\n  place-self: center start;\r\n`\r\n\r\nconst NextButton = styled(OverlayButton)`\r\n  grid-area: 2/3/3/4;\r\n  place-self: center end;\r\n`\r\n\r\nconst LengthDisplay = styled.span(\r\n  (props) => css`\r\n    grid-area: 3/3/4/4;\r\n    place-self: end end;\r\n    background: #00000080;\r\n    border-radius: 4px;\r\n    padding: ${props.theme.dimensions.spacing};\r\n    margin: ${props.theme.dimensions.spacing};\r\n  `\r\n)\r\n\r\ninterface OverlayProps {\r\n  postId: number\r\n  externalSrc: string\r\n  togglePlay?: MouseEventHandler\r\n  isPaused?: boolean\r\n  isPlayable: boolean\r\n  currentTime?: number\r\n  duration?: number\r\n  mediaRef?: HTMLVideoElement | null\r\n}\r\n\r\nfunction Overlay(props: OverlayProps) {\r\n  const {\r\n    togglePlay = NO_OP,\r\n    isPaused = true,\r\n    isPlayable = false,\r\n    currentTime = 0,\r\n    duration = null,\r\n    externalSrc,\r\n    mediaRef,\r\n    postId,\r\n  } = props\r\n\r\n  const posts = useSelector(selectPosts)\r\n  const [isVisible, toggleVisible] = useToggle()\r\n  const isReaderOpen = useSelector(selectFullsceenState)\r\n\r\n  const dispatch = useDispatch()\r\n  const onExpandClick = useCallback(() => {\r\n    if (isReaderOpen) {\r\n      dispatch(exitFullscreen())\r\n    } else {\r\n      dispatch(enterFullscreen(postId))\r\n    }\r\n  }, [dispatch, isReaderOpen, postId])\r\n\r\n  const selectedIndex = useMemo(() => posts.findIndex((post) => post.id === postId), [postId, posts])\r\n\r\n  const selectPostAt = useCallback(\r\n    (index: number) => {\r\n      const postAtindex = posts[index]\r\n\r\n      if (postAtindex) {\r\n        dispatch(setFullScreenPost(postAtindex.id))\r\n      }\r\n    },\r\n    [dispatch, posts]\r\n  )\r\n\r\n  const hasNext = selectedIndex + 1 < posts.length\r\n  const selectNext = useCallback(() => {\r\n    selectPostAt(selectedIndex + 1)\r\n  }, [selectPostAt, selectedIndex])\r\n\r\n  const hasPrevious = selectedIndex > 0\r\n  const selectPrevious = useCallback(() => {\r\n    selectPostAt(selectedIndex - 1)\r\n  }, [selectPostAt, selectedIndex])\r\n\r\n  return (\r\n    <Wrapper isVisible={isPaused || isVisible} onClick={toggleVisible}>\r\n      <FullScreenButton onClick={onExpandClick} aria-label=\"Open Fullscreen\">\r\n        {isReaderOpen ? <CloseIcon color=\"white\" /> : <ExpandIcon color=\"white\" />}\r\n      </FullScreenButton>\r\n\r\n      <OpenExternalButton>\r\n        <a href={externalSrc} target=\"_blank\" rel=\"noopener noreferrer\" aria-label=\"Open In New Tab\">\r\n          <ExternalLinkIcon color=\"white\" />\r\n        </a>\r\n      </OpenExternalButton>\r\n\r\n      {isPlayable && (\r\n        <>\r\n          <PlayButton onClick={togglePlay} aria-label=\"Play/Pause\">\r\n            {isPaused ? <PlayIcon color=\"white\" size={50} /> : <PauseIcon color=\"white\" size={50} />}\r\n          </PlayButton>\r\n          {!!duration && !!currentTime && <ProgressBar style={{ width: `${(currentTime / duration) * 100}%` }} />}\r\n\r\n          {mediaRef && !isNaN(mediaRef.duration) && <LengthDisplay>{formatDuration(mediaRef.duration)}</LengthDisplay>}\r\n          {externalSrc.includes(\".gif\") && <LengthDisplay>gif</LengthDisplay>}\r\n        </>\r\n      )}\r\n\r\n      {isReaderOpen && hasPrevious && (\r\n        <PreviousButton onClick={selectPrevious}>\r\n          <ArrowLeft size={40} color=\"white\" />\r\n        </PreviousButton>\r\n      )}\r\n      {isReaderOpen && hasNext && (\r\n        <NextButton onClick={selectNext}>\r\n          <ArrowRight size={40} color=\"white\" />\r\n        </NextButton>\r\n      )}\r\n    </Wrapper>\r\n  )\r\n}\r\n\r\nexport default Overlay\r\n","import React, { useState, useCallback } from \"react\"\r\nimport { useSelector } from \"react-redux\"\r\nimport { selectPreferences } from \"../../redux/selectors\"\r\nimport FlexVideo from \"./FlexVideo\"\r\nimport MediaProps from \"./MediaProps\"\r\nimport Overlay from \"./Overlay\"\r\n\r\nexport default function Video(props: MediaProps) {\r\n  const { src, onLoad, externalSrc, postId, width, height } = props\r\n\r\n  const [videoRef, setVideoRef] = useState<HTMLVideoElement | null>(null)\r\n\r\n  const [, setTime] = useState(Date.now())\r\n  const [intervalId, setIntervalId] = useState<NodeJS.Timeout | null>(null)\r\n\r\n  const play = useCallback(() => {\r\n    videoRef && videoRef.play()\r\n\r\n    // ~30 fps\r\n    const id = setInterval(() => {\r\n      setTime(Date.now())\r\n    }, 34)\r\n\r\n    setIntervalId(id)\r\n  }, [videoRef])\r\n\r\n  const pause = useCallback(() => {\r\n    videoRef && videoRef.pause()\r\n    clearInterval(intervalId as NodeJS.Timeout)\r\n    setIntervalId(null)\r\n  }, [videoRef, intervalId])\r\n\r\n  const togglePlay = useCallback(\r\n    (event) => {\r\n      event.stopPropagation()\r\n      videoRef && (videoRef.paused ? play() : pause())\r\n    },\r\n    [videoRef, play, pause]\r\n  )\r\n\r\n  const { preloadVideos } = useSelector(selectPreferences)\r\n\r\n  return (\r\n    <>\r\n      <FlexVideo\r\n        controls={false}\r\n        loop\r\n        preload={preloadVideos ? \"auto\" : \"metadata\"}\r\n        ref={setVideoRef}\r\n        onLoad={onLoad}\r\n        width={width}\r\n        height={height}\r\n      >\r\n        <source src={src} />\r\n      </FlexVideo>\r\n      <Overlay\r\n        mediaRef={videoRef}\r\n        isPaused={videoRef ? videoRef.paused : true}\r\n        currentTime={videoRef?.currentTime}\r\n        duration={videoRef?.duration}\r\n        postId={postId}\r\n        togglePlay={togglePlay}\r\n        externalSrc={externalSrc}\r\n        isPlayable\r\n      />\r\n    </>\r\n  )\r\n}\r\n","import styled, { css } from \"styled-components\"\r\n\r\nconst FlexImage = styled.img(\r\n  ({ width, height }) => css`\r\n    width: 100%;\r\n    height: 100%;\r\n    display: block;\r\n    object-fit: contain;\r\n    grid-area: 1/1/2/2;\r\n    ${width && height\r\n      ? css`\r\n          aspect-ratio: ${width} / ${height};\r\n        `\r\n      : \"\"}\r\n  `\r\n)\r\n\r\nexport default FlexImage\r\n","import React, { useState } from \"react\"\r\nimport { NO_OP } from \"../../data/types\"\r\nimport FlexImage from \"./FlexImage\"\r\nimport MediaProps from \"./MediaProps\"\r\nimport Overlay from \"./Overlay\"\r\n\r\nexport default function Gif(props: MediaProps) {\r\n  const { src, thumbnail_src, onLoad = NO_OP, externalSrc, postId, width, height } = props\r\n\r\n  const [isPaused, setPaused] = useState(true)\r\n  const usedSource = isPaused ? thumbnail_src : src\r\n\r\n  return (\r\n    <>\r\n      <FlexImage src={usedSource} alt={usedSource} loading=\"lazy\" onLoad={onLoad} width={width} height={height} />\r\n      <Overlay\r\n        isPlayable\r\n        isPaused={isPaused}\r\n        togglePlay={(event) => {\r\n          event.stopPropagation()\r\n          setPaused(!isPaused)\r\n        }}\r\n        externalSrc={externalSrc}\r\n        postId={postId}\r\n      />\r\n    </>\r\n  )\r\n}\r\n","import React from \"react\"\r\nimport { NO_OP } from \"../../data/types\"\r\nimport FlexImage from \"./FlexImage\"\r\nimport MediaProps from \"./MediaProps\"\r\nimport Overlay from \"./Overlay\"\r\n\r\nexport default function Picture(props: MediaProps) {\r\n  const { src, onLoad = NO_OP, externalSrc, postId, width, height } = props\r\n\r\n  return (\r\n    <>\r\n      <FlexImage src={src} alt={src} onLoad={onLoad} loading=\"lazy\" width={width} height={height} />\r\n      <Overlay isPlayable={false} externalSrc={externalSrc} postId={postId} />\r\n    </>\r\n  )\r\n}\r\n","import { PostType, VIDEO, GIF, PICTURE } from \"../../data/types\"\n\nexport const openFullscreen = (elem: HTMLVideoElement) => {\n  elem.requestFullscreen()\n}\n\nexport const getMediaType = (type: PostType, src: string) => {\n  if (type === VIDEO) {\n    return VIDEO\n  }\n\n  // can't use .endsWith because of queryString\n  if (src.includes(\".gif\")) {\n    return GIF\n  }\n\n  return PICTURE\n}\n","import React, { useMemo } from \"react\"\r\nimport Video from \"./Video\"\r\nimport Gif from \"./Gif\"\r\nimport Picture from \"./Picture\"\r\n\r\nimport { getMediaType } from \"./utils\"\r\nimport { GIF, PostType, VIDEO } from \"../../data/types\"\r\n\r\ninterface PlayerProps {\r\n  postId: number\r\n  type: PostType\r\n  src: string\r\n  thumbnail_src: string\r\n  onLoad: () => void\r\n  width: number\r\n  height: number\r\n}\r\n\r\nconst getMedia = (type: PostType, src: string) => {\r\n  switch (getMediaType(type, src)) {\r\n    case VIDEO:\r\n      return Video\r\n    case GIF:\r\n      return Gif\r\n    default:\r\n      return Picture\r\n  }\r\n}\r\n\r\nexport default function Player(props: PlayerProps) {\r\n  const { type, src, thumbnail_src, onLoad, postId, width, height } = props\r\n\r\n  const externalSrc = new URL(src).searchParams.get(\"url\") || \"\"\r\n\r\n  const media = useMemo(() => {\r\n    const MediaComponent = getMedia(type, src)\r\n    return (\r\n      <MediaComponent\r\n        src={src}\r\n        thumbnail_src={thumbnail_src}\r\n        onLoad={onLoad}\r\n        externalSrc={externalSrc}\r\n        postId={postId}\r\n        width={width}\r\n        height={height}\r\n      />\r\n    )\r\n  }, [type, src, thumbnail_src, onLoad, externalSrc, postId, width, height])\r\n\r\n  return <>{media}</>\r\n}\r\n","import React, { useCallback, useEffect, useMemo } from \"react\"\r\nimport styled, { css } from \"styled-components\"\r\nimport Details from \"./Details\"\r\nimport Player from \"../player/Player\"\r\nimport { useSelector } from \"react-redux\"\r\nimport { selectPreferences } from \"../../redux/selectors\"\r\nimport PostDataClass from \"../../data/Post\"\r\nimport LayoutElementProps from \"../layout/LayoutElementProps\"\r\nimport { NO_OP } from \"../../data/types\"\r\nimport useToggle from \"../../hooks/useToggle\"\r\n\r\nconst ItemWrapper = styled.div(\r\n  ({ theme }) => css`\r\n    padding-top: ${theme.dimensions.gutter};\r\n  `\r\n)\r\n\r\nconst PositonWrapper = styled.div(\r\n  ({ theme }) => css`\r\n    padding: 0 ${theme.dimensions.gutter};\r\n    width: 100%;\r\n    max-width: ${theme.dimensions.bodyWidth};\r\n    margin: auto;\r\n  `\r\n)\r\n\r\nconst PostWrapper = styled.div(\r\n  ({ theme }) => css`\r\n    display: grid;\r\n    grid-template-columns: 1fr;\r\n    grid-template-rows: auto auto auto;\r\n    border-radius: ${theme.dimensions.borderRadius};\r\n    overflow: hidden;\r\n    background: ${theme.misc.layer};\r\n  `\r\n)\r\n\r\nexport function getCorrectSource(loadOriginal: boolean, big_src: string, small_src: string) {\r\n  return loadOriginal ? big_src : small_src\r\n}\r\n\r\nexport default function Post(props: PostDataClass & LayoutElementProps) {\r\n  const {\r\n    media_type,\r\n    small_src,\r\n    big_src,\r\n    thumbnail_src,\r\n    rating,\r\n    score,\r\n    source,\r\n    tags,\r\n    style,\r\n    onLoad = NO_OP,\r\n    virtualRef,\r\n    id,\r\n    width,\r\n    height,\r\n  } = props\r\n\r\n  const { originals } = useSelector(selectPreferences)\r\n\r\n  const [collapsed, toggleCollapsed] = useToggle(true)\r\n\r\n  const media_src = useMemo(() => getCorrectSource(originals, big_src, small_src), [big_src, originals, small_src])\r\n\r\n  const toggleDetails = useCallback(() => {\r\n    toggleCollapsed()\r\n  }, [toggleCollapsed])\r\n\r\n  // re-measure when collapsed state changes\r\n  useEffect(() => {\r\n    onLoad()\r\n  }, [onLoad, collapsed])\r\n\r\n  return (\r\n    <ItemWrapper style={style} ref={virtualRef} className=\"list-div\">\r\n      <PositonWrapper>\r\n        <PostWrapper onClick={toggleDetails} role=\"row\">\r\n          <Player\r\n            onLoad={onLoad}\r\n            type={media_type}\r\n            src={media_src}\r\n            thumbnail_src={thumbnail_src}\r\n            postId={id}\r\n            width={width}\r\n            height={height}\r\n          />\r\n          {!collapsed && <Details rating={rating} score={score} source={source} tags={tags} />}\r\n        </PostWrapper>\r\n      </PositonWrapper>\r\n    </ItemWrapper>\r\n  )\r\n}\r\n","import React from \"react\"\nimport useAction from \"../../hooks/useAction\"\nimport { getResults } from \"../../redux/actions\"\nimport { BlockButton } from \"../common/Buttons\"\n\nexport default function SearchButton() {\n  const search = useAction(getResults)\n\n  return (\n    <BlockButton onClick={search} aria-label=\"Search\">\n      Search\n    </BlockButton>\n  )\n}\n","import React, { useEffect } from \"react\"\r\nimport { useSelector } from \"react-redux\"\r\nimport { selectActiveTags, selectNumberOfActiveTags } from \"../../redux/selectors\"\r\nimport TagList from \"../tag/TagList\"\r\n\r\ninterface ActiveTagsProps {\r\n  onChange: () => void\r\n}\r\n\r\nexport default function ActiveTags(props: ActiveTagsProps) {\r\n  const { onChange } = props\r\n  const activeTags = useSelector(selectActiveTags)\r\n  const numberOfActiveTags = useSelector(selectNumberOfActiveTags)\r\n\r\n  // Fire change event when tags change\r\n  // This is used to re-measure the height\r\n  useEffect(() => onChange(), [onChange, activeTags])\r\n\r\n  return numberOfActiveTags > 0 ? <TagList tags={activeTags} loadAliases /> : null\r\n}\r\n","import React from \"react\"\nimport styled, { css } from \"styled-components\"\nimport TagSelector from \"../tagSelector/TagSelector\"\nimport Options from \"./Options\"\nimport { Title } from \"../common/Text\"\nimport Surface from \"../common/Surface\"\nimport SearchButton from \"./SearchButton\"\nimport ActiveTags from \"./ActiveTags\"\n\nconst ConfigWrapper = styled.section(\n  ({ theme }) => css`\n    display: flex;\n    flex-direction: column;\n    gap: ${theme.dimensions.gutter};\n    padding: ${theme.dimensions.gutter};\n    width: 100%;\n    max-width: ${theme.dimensions.bodyWidth};\n    margin: auto;\n  `\n)\n\nexport default function Config(props: { onLoad: () => void }) {\n  const { onLoad } = props\n\n  return (\n    <ConfigWrapper>\n      <Title>\n        <label htmlFor=\"tag-input\">Search</label>\n      </Title>\n      <Surface>\n        <TagSelector />\n        <ActiveTags onChange={onLoad} />\n        <Options />\n        <SearchButton />\n      </Surface>\n    </ConfigWrapper>\n  )\n}\n","import React from \"react\"\nimport styled, { css } from \"styled-components\"\n\nconst Container = styled.div`\n  display: inline-block;\n  white-space: nowrap;\n  min-width: 160px;\n`\n\nconst AButton = styled.a(\n  ({ theme }) => css`\n    box-shadow: 1px 1px 0px rgba(0, 0, 0, 0.2);\n    line-height: 36px !important;\n    min-width: 150px;\n    display: inline-block !important;\n    background-color: ${theme.colors.layerBg};\n    padding: 2px 12px !important;\n    text-align: center !important;\n    border-radius: 3px;\n    color: #fff;\n    cursor: pointer;\n    overflow-wrap: break-word;\n    vertical-align: middle;\n    border: 0 none #fff !important;\n    font-family: \"Quicksand\", Helvetica, Century Gothic, sans-serif !important;\n    text-decoration: none;\n    text-shadow: none;\n    font-weight: 700 !important;\n    font-size: 14px !important;\n\n    :visited {\n      color: #fff !important;\n      text-decoration: none !important;\n    }\n\n    :hover {\n      opacity: 0.85;\n      color: #f5f5f5 !important;\n      text-decoration: none !important;\n    }\n\n    :active {\n      color: #f5f5f5 !important;\n      text-decoration: none !important;\n    }\n  `\n)\n\nconst Text = styled.span`\n  color: #fff !important;\n  letter-spacing: -0.15px !important;\n  vertical-align: middle;\n  line-height: 33px !important;\n  padding: 0;\n  text-align: center;\n  text-decoration: none !important;\n  text-shadow: 0 1px 1px rgba(34, 34, 34, 0.05);\n\n  a {\n    color: #fff !important;\n    text-decoration: none !important;\n  }\n\n  a:hover {\n    color: #fff !important;\n    text-decoration: none;\n  }\n`\n\nconst Image = styled.img`\n  display: initial !important;\n  vertical-align: middle;\n  height: 13px !important;\n  width: 20px !important;\n  padding-top: 0;\n  padding-bottom: 0;\n  border: none;\n  margin-top: 0;\n  margin-right: 5px;\n  margin-left: 0;\n  margin-bottom: 3px;\n  content: url(\"https://ko-fi.com/img/cup-border.png\");\n\n  :after {\n    vertical-align: middle;\n    height: 25px;\n    padding-top: 0;\n    padding-bottom: 0;\n    border: none;\n    margin-top: 0;\n    margin-right: 6px;\n    margin-left: 0;\n    margin-bottom: 4px !important;\n    content: url(\"https://ko-fi.com/img/whitelogo.svg\");\n\n    height: 15px !important;\n    width: 22px !important;\n    display: initial;\n    animation: kofi-wiggle 3s infinite;\n  }\n`\n\ninterface KofiButtonProps {\n  id: string\n  label: string\n}\n\nexport default function KofiButton(props: KofiButtonProps) {\n  const { id, label } = props\n\n  return (\n    <Container>\n      <AButton title={label} href={\"https://ko-fi.com/\" + id} target=\"_blank\" rel=\"noopener noreferrer\">\n        <Text>\n          <Image src=\"https://ko-fi.com/img/cup-border.png\" className=\"kofiimg\" alt=\"Ko-Fi button\" />\n          {label}\n        </Text>\n      </AButton>\n    </Container>\n  )\n}\n","import React, { useMemo } from \"react\"\r\nimport styled, { css } from \"styled-components\"\r\nimport { Faded } from \"./Text\"\r\n\r\nconst tips = [\r\n  \"Try tapping the little plus in the tag search. You can exclude tags with the '-' and make them optional with the '~'.\",\r\n  \"Check out the settings. There are lots of uesful options there.\",\r\n  \"Starting a tag search with a * gives more results.\",\r\n  \"When filtering rated posts, you can configure the minimum score by taping the red number.\",\r\n  \"You can get more info about a post be tapping it once.\",\r\n  \"Clicking a tag below a post adds it to your active tags.\",\r\n  \"Large gifs and videos can take a while to load in the app. Try clicking the 'Open in new tab' icon in the bottom left corner for faster loading times.\",\r\n  \"If anything stops working or gets weird. Reset the app in the settings.\",\r\n  \"I hope you are having a nice day!\",\r\n  \"If a tag is ambiguous, it will have a little arrow on the right. Tapping it shows related tags.\",\r\n]\r\n\r\nconst Span = styled(Faded)(\r\n  ({ theme }) => css`\r\n    text-align: center;\r\n    font-size: 16px;\r\n    padding: ${theme.dimensions.hugeSpacing};\r\n    max-width: ${theme.dimensions.bodyWidth};\r\n  `\r\n)\r\n\r\nexport default function RandomTip() {\r\n  const tip = useMemo(() => tips[Math.floor(Math.random() * tips.length)], [])\r\n\r\n  return <Span>{tip}</Span>\r\n}\r\n","import React, { useEffect } from \"react\"\r\nimport { useSelector } from \"react-redux\"\r\nimport { formatCount } from \"../../misc/formatting\"\r\nimport useToggle from \"../../hooks/useToggle\"\r\nimport { selectCount } from \"../../redux/selectors\"\r\nimport { Title } from \"../common/Text\"\r\nimport Config from \"../features/Config\"\r\nimport Header from \"../features/Header\"\r\nimport LayoutElementProps from \"./LayoutElementProps\"\r\nimport KofiButton from \"../features/KofiButton\"\r\nimport styled, { css } from \"styled-components\"\r\nimport { NO_OP } from \"../../data/types\"\r\nimport RandomTip from \"../common/RandomTip\"\r\nimport Surface from \"../common/Surface\"\r\nimport { HorizontalLine } from \"../common/Lines\"\r\n\r\nconst Placeholder = styled.div(\r\n  ({ theme }) => css`\r\n    display: flex;\r\n    flex-direction: column;\r\n    gap: ${theme.dimensions.hugeSpacing};\r\n    align-items: center;\r\n    max-width: ${theme.dimensions.bodyWidth};\r\n    margin: auto;\r\n\r\n    height: calc(100vh - 400px);\r\n    padding: 0 10%;\r\n  `\r\n)\r\n\r\nexport default function LayoutHeader({ onLoad = NO_OP, virtualRef, style }: LayoutElementProps) {\r\n  const [fullNumber, toggleFullNumber] = useToggle()\r\n  const count = useSelector(selectCount)\r\n\r\n  // Trigger load event when count is > 0\r\n  // This is used to re-measure the element\r\n  useEffect(() => {\r\n    count > 0 && onLoad()\r\n  }, [count, onLoad])\r\n\r\n  return (\r\n    <div onLoad={onLoad} ref={virtualRef} style={style} role=\"row\">\r\n      <Header />\r\n      <Config onLoad={onLoad} />\r\n      {count > 0 ? (\r\n        <Title onClick={toggleFullNumber}>\r\n          {(fullNumber ? count.toLocaleString() : formatCount(count)) + \" results\"}\r\n        </Title>\r\n      ) : (\r\n        <Placeholder>\r\n          <RandomTip />\r\n\r\n          <KofiButton id=\"V7V73PWW9\" label=\"Support Me on Ko-fi\" />\r\n        </Placeholder>\r\n      )}\r\n    </div>\r\n  )\r\n}\r\n","export default __webpack_public_path__ + \"static/media/OutOfResults.9c71691c.png\";","import React, { useMemo } from \"react\"\r\nimport Surface from \"../common/Surface\"\r\nimport { Title } from \"../common/Text\"\r\nimport TagList from \"../tag/TagList\"\r\nimport outOfResultsPicture from \"../../icons/OutOfResults.png\"\r\nimport { useSelector } from \"react-redux\"\r\nimport { selectAliasesAsList } from \"../../redux/selectors\"\r\nimport TagDataClass from \"../../data/Tag\"\r\nimport { NO_OP, SimpleMap } from \"../../data/types\"\r\nimport LayoutElementProps from \"./LayoutElementProps\"\r\nimport { HorizontalLine } from \"../common/Lines\"\r\nimport styled, { css } from \"styled-components\"\r\nimport FlexImage from \"../player/FlexImage\"\r\n\r\nconst Div = styled.div(\r\n  ({ theme }) => css`\r\n    padding: ${theme.dimensions.gutter};\r\n  `\r\n)\r\n\r\nconst StyledSurface = styled(Surface)(\r\n  ({ theme }) => css`\r\n    max-width: ${theme.dimensions.bodyWidth};\r\n    margin: auto;\r\n    text-align: center;\r\n  `\r\n)\r\n\r\nconst StyledImage = styled(FlexImage)`\r\n  max-height: 50vh;\r\n`\r\n\r\nexport default function LayoutOutOfItems({ onLoad = NO_OP, virtualRef, style }: LayoutElementProps) {\r\n  const aliases = useSelector(selectAliasesAsList)\r\n  const aliasesForRendering = useMemo(\r\n    () =>\r\n      aliases.reduce((result: SimpleMap<TagDataClass>, alias) => {\r\n        result[alias.name] = alias\r\n        return result\r\n      }, {}),\r\n    [aliases]\r\n  )\r\n\r\n  return (\r\n    <Div style={style} ref={virtualRef} onLoad={onLoad} role=\"row\">\r\n      <StyledSurface>\r\n        <StyledImage src={outOfResultsPicture} alt=\"Shironeko does not understand\" />\r\n        <HorizontalLine />\r\n        <Title>You have reached the end!</Title>\r\n        <p>Go look for something else!</p>\r\n        {aliases.length > 0 && (\r\n          <>\r\n            <p>How about some of these?</p>\r\n            <TagList tags={aliasesForRendering} padding />\r\n          </>\r\n        )}\r\n      </StyledSurface>\r\n    </Div>\r\n  )\r\n}\r\n","import React from \"react\"\nimport styled, { css } from \"styled-components\"\n\nconst StyledSvg = styled.svg(\n  ({ theme }) => css`\n    height: ${theme.dimensions.blockHeight};\n    padding: ${theme.dimensions.bigSpacing};\n  `\n)\n\nexport default function Loading() {\n  return (\n    <StyledSvg\n      version=\"1.1\"\n      xmlns=\"http://www.w3.org/2000/svg\"\n      xmlnsXlink=\"http://www.w3.org/1999/xlink\"\n      viewBox=\"0 0 50 20\"\n      enable-background=\"new 0 0 0 0\"\n      xmlSpace=\"preserve\"\n    >\n      <circle fill=\"#fff\" stroke=\"none\" cx=\"6\" cy=\"10\" r=\"6\">\n        <animate attributeName=\"opacity\" dur=\"1s\" values=\"0;1;0\" repeatCount=\"indefinite\" begin=\"0.1\" />\n      </circle>\n      <circle fill=\"#fff\" stroke=\"none\" cx=\"26\" cy=\"10\" r=\"6\">\n        <animate attributeName=\"opacity\" dur=\"1s\" values=\"0;1;0\" repeatCount=\"indefinite\" begin=\"0.2\" />\n      </circle>\n      <circle fill=\"#fff\" stroke=\"none\" cx=\"46\" cy=\"10\" r=\"6\">\n        <animate attributeName=\"opacity\" dur=\"1s\" values=\"0;1;0\" repeatCount=\"indefinite\" begin=\"0.3\" />\n      </circle>\n    </StyledSvg>\n  )\n}\n","import React from \"react\"\nimport LayoutElementProps from \"./LayoutElementProps\"\nimport LoadingIcon from \"../../icons/Loading\"\nimport styled from \"styled-components\"\nimport { NO_OP } from \"../../data/types\"\n\nconst Wrapper = styled.div`\n  display: grid;\n  place-items: center;\n`\n\nexport default function LayoutLoadingItem({ onLoad = NO_OP, virtualRef, style }: LayoutElementProps) {\n  return (\n    <Wrapper onLoad={onLoad} ref={virtualRef} style={style} role=\"row\">\n      <LoadingIcon />\n    </Wrapper>\n  )\n}\n","import React, { MouseEventHandler, useCallback } from \"react\"\r\nimport { useSelector } from \"react-redux\"\r\nimport styled, { css } from \"styled-components\"\r\nimport { selectLastPage } from \"../../../redux/selectors\"\r\nimport { RedButton } from \"../../common/Buttons\"\r\nimport { SmallNumberInput } from \"../../common/SmallInput\"\r\n\r\nconst PageRow = styled.div(\r\n  ({ theme }) => css`\r\n    display: grid;\r\n    grid-template-columns: repeat(5, 1fr);\r\n    justify-content: center;\r\n    place-items: center;\r\n    gap: ${theme.dimensions.gutter};\r\n    padding: ${theme.dimensions.gutter};\r\n    padding-bottom: 0;\r\n    max-width: ${theme.dimensions.bodyWidth};\r\n    margin: auto;\r\n  `\r\n)\r\n\r\nconst PageNumber = styled(RedButton)``\r\n\r\nconst CurrentNumber = styled(SmallNumberInput)``\r\n\r\ninterface PageNavigationProps {\r\n  currentPage: number\r\n  loadPage: (pageNumber: number) => void\r\n}\r\n\r\nexport default function PageNavigation(props: PageNavigationProps) {\r\n  const { currentPage, loadPage } = props\r\n\r\n  const lastPage = useSelector(selectLastPage)\r\n\r\n  const loadSpecificPage = useCallback((newPage: number | string) => loadPage(Number(newPage)), [loadPage])\r\n  const loadFirst: MouseEventHandler<HTMLButtonElement> = useCallback(() => loadPage(0), [loadPage])\r\n  const loadLast: MouseEventHandler<HTMLButtonElement> = useCallback(() => loadPage(lastPage), [loadPage, lastPage])\r\n  const loadPrevious: MouseEventHandler<HTMLButtonElement> = useCallback(() => loadPage(currentPage - 1), [\r\n    currentPage,\r\n    loadPage,\r\n  ])\r\n  const loadNext: MouseEventHandler<HTMLButtonElement> = useCallback(() => loadPage(currentPage + 1), [\r\n    currentPage,\r\n    loadPage,\r\n  ])\r\n\r\n  // Render Empty divs to keep everything lined up\r\n  // Could achive the same with grid-column (might do that in the future)\r\n  return (\r\n    <PageRow className=\"page-navigation\">\r\n      {currentPage > 1 ? <PageNumber onClick={loadFirst}>0</PageNumber> : <div></div>}\r\n      {currentPage > 0 ? <PageNumber onClick={loadPrevious}>{currentPage - 1}</PageNumber> : <div></div>}\r\n      <CurrentNumber value={currentPage} onSubmit={loadSpecificPage} />\r\n      {currentPage < lastPage ? <PageNumber onClick={loadNext}>{currentPage + 1}</PageNumber> : <div></div>}\r\n      {currentPage < lastPage - 1 ? <PageNumber onClick={loadLast}>{lastPage}</PageNumber> : <div></div>}\r\n    </PageRow>\r\n  )\r\n}\r\n","import React, { useCallback } from \"react\"\nimport styled, { css } from \"styled-components\"\nimport PostDataClass from \"../../../data/Post\"\nimport BaseFlexColumn from \"../../common/FlexColumn\"\nimport PageNavigation from \"./PageNavigation\"\n\nconst FlexColumn = styled(BaseFlexColumn)(\n  ({ theme }) => css`\n    padding-bottom: ${theme.dimensions.gutter};\n  `\n)\n\ninterface PageLayoutProps<T> {\n  header?: JSX.Element\n  outOfItems?: JSX.Element\n  items?: T[]\n  pageSize: number\n  currentPage: number\n  hasMorePages: boolean\n  loadPage: (pageNumber: number) => void\n  ItemComponent: (props: T) => JSX.Element\n  isLoading: boolean\n  setLoading: (value: boolean) => void\n}\n\nexport default function PageLayout(props: PageLayoutProps<PostDataClass>) {\n  const { header, items, ItemComponent, pageSize, currentPage, loadPage } = props\n\n  const scrollAndLoadPage = useCallback(\n    (value: number) => {\n      loadPage(value)\n      document.getElementsByClassName(\"page-navigation\")[0].scrollIntoView()\n    },\n    [loadPage]\n  )\n\n  return (\n    <FlexColumn>\n      {header}\n      {items && items.length > 0 && (\n        <>\n          <PageNavigation currentPage={currentPage} loadPage={loadPage} />\n          {items?.map((item) => (\n            <ItemComponent key={item.id} {...item} />\n          ))}\n          <PageNavigation currentPage={currentPage} loadPage={scrollAndLoadPage} />\n        </>\n      )}\n    </FlexColumn>\n  )\n}\n","import React, { useMemo } from \"react\"\r\nimport { useSelector } from \"react-redux\"\r\nimport styled, { css } from \"styled-components\"\r\nimport PostDataClass from \"../../data/Post\"\r\nimport { NO_OP } from \"../../data/types\"\r\nimport { selectFullsceenPostId, selectFullsceenState, selectPosts, selectPreferences } from \"../../redux/selectors\"\r\nimport Player from \"../player/Player\"\r\nimport { getCorrectSource } from \"../post/Post\"\r\n\r\nconst FullScreenDiv = styled.div(\r\n  ({ theme }) => css`\r\n    position: fixed;\r\n    width: 100vw;\r\n    height: 100vh;\r\n    left: 0;\r\n    top: 0;\r\n\r\n    display: grid;\r\n    grid-template-columns: 100vw;\r\n    grid-template-rows: 100vh;\r\n\r\n    background: ${theme.colors.backgroundColor};\r\n\r\n    z-index: 5;\r\n  `\r\n)\r\n\r\nexport default function Reader() {\r\n  const posts = useSelector(selectPosts)\r\n  const { originals } = useSelector(selectPreferences)\r\n  const isReaderOpen = useSelector(selectFullsceenState)\r\n  const fullScreenPostId = useSelector(selectFullsceenPostId)\r\n\r\n  const fullScreenPost = useMemo(() => posts.find((post) => post.id === fullScreenPostId) as PostDataClass, [\r\n    fullScreenPostId,\r\n    posts,\r\n  ])\r\n\r\n  if (!isReaderOpen) {\r\n    return null\r\n  }\r\n\r\n  const { media_type, small_src, big_src, thumbnail_src, id, width, height } = fullScreenPost as PostDataClass\r\n  const media_src = getCorrectSource(originals, big_src, small_src)\r\n\r\n  return (\r\n    <FullScreenDiv>\r\n      <Player\r\n        onLoad={NO_OP}\r\n        type={media_type}\r\n        src={media_src}\r\n        thumbnail_src={thumbnail_src}\r\n        postId={id}\r\n        width={width}\r\n        height={height}\r\n      />\r\n    </FullScreenDiv>\r\n  )\r\n}\r\n","import React, { useCallback, useState } from \"react\"\r\nimport { useDispatch, useSelector } from \"react-redux\"\r\nimport InifinteColumn from \"../layout/infinite/InfiniteColumn\"\r\nimport Post from \"../post/Post\"\r\nimport { getMoreResults, getResults } from \"../../redux/actions\"\r\nimport { selectHasMoreResults, selectPageNumber, selectPosts, selectPreferences } from \"../../redux/selectors\"\r\nimport LayoutHeader from \"../layout/LayoutHeader\"\r\nimport LayoutOutOfItems from \"../layout/LayoutOutOfItems\"\r\nimport LayoutLoadingItem from \"../layout/LayoutLoadingItem\"\r\nimport useAction from \"../../hooks/useAction\"\r\nimport { ResultLayout } from \"../../data/types\"\r\nimport PageLayout from \"../layout/pages/PageLayout\"\r\n\r\nimport Reader from \"../reader/Reader\"\r\n\r\nexport default function Search() {\r\n  const [isLoading, setLoading] = useState(false)\r\n\r\n  const posts = useSelector(selectPosts)\r\n  const hasMorePosts = useSelector(selectHasMoreResults)\r\n  const { resultsLayout, pageSize } = useSelector(selectPreferences)\r\n  const pageNumber = useSelector(selectPageNumber)\r\n\r\n  const dispatch = useDispatch()\r\n  const loadMore = useAction(getMoreResults)\r\n  const loadPage = useCallback((index: number) => dispatch(getResults(index)), [dispatch])\r\n\r\n  return (\r\n    <>\r\n      <Reader />\r\n      {resultsLayout === ResultLayout.INFINITE_COLUMN ? (\r\n        <InifinteColumn\r\n          Header={LayoutHeader}\r\n          OutOfItems={LayoutOutOfItems}\r\n          items={posts}\r\n          LoadingItem={LayoutLoadingItem}\r\n          hasMoreRows={hasMorePosts}\r\n          ItemComponent={Post}\r\n          loadMore={loadMore}\r\n          isLoading={isLoading}\r\n          setLoading={setLoading}\r\n        />\r\n      ) : (\r\n        <PageLayout\r\n          header={<LayoutHeader />}\r\n          pageSize={pageSize}\r\n          currentPage={pageNumber}\r\n          hasMorePages={hasMorePosts}\r\n          loadPage={loadPage}\r\n          ItemComponent={Post}\r\n          isLoading={isLoading}\r\n          setLoading={setLoading}\r\n          items={posts}\r\n        />\r\n      )}\r\n    </>\r\n  )\r\n}\r\n","import produce from \"immer\"\r\nimport { PreferenceKey, COOKIES, ResultLayout } from \"../../data/types\"\r\nimport { AppAction, SET_OPTION, ALLOW_COOKIES } from \"../actions\"\r\n\r\nexport interface PreferencesState {\r\n  infinite: boolean\r\n  rated: boolean\r\n  ratedTreshold: number\r\n  originals: boolean\r\n  cookies: boolean\r\n  preloadVideos: boolean\r\n  tagSuggestionsCount: number\r\n  resultsLayout: ResultLayout\r\n  pageSize: number\r\n}\r\n\r\nexport const initialPreferencesState: PreferencesState = {\r\n  infinite: true,\r\n  rated: false,\r\n  ratedTreshold: 1,\r\n  originals: false,\r\n  cookies: false,\r\n  preloadVideos: false,\r\n  tagSuggestionsCount: 20,\r\n  resultsLayout: ResultLayout.INFINITE_COLUMN,\r\n  pageSize: 20,\r\n}\r\n\r\nfunction setOption<T extends PreferenceKey>(state: PreferencesState, key: T, value: PreferencesState[T]) {\r\n  return produce(state, (draft) => {\r\n    draft[key] = value\r\n  })\r\n}\r\n\r\nconst preferences = (state: PreferencesState = initialPreferencesState, action: AppAction): PreferencesState => {\r\n  switch (action.type) {\r\n    case SET_OPTION:\r\n      return setOption(state, action.key, action.value)\r\n    case ALLOW_COOKIES:\r\n      return setOption(state, COOKIES, action.value)\r\n    default:\r\n      return state\r\n  }\r\n}\r\n\r\nexport default preferences\r\n","import produce from \"immer\"\nimport PostDataClass from \"../../data/Post\"\nimport { SET_POSTS, ADD_POSTS, AppAction } from \"../actions\"\n\nexport interface ResultsState {\n  posts: PostDataClass[]\n  pageNumber: number\n  count: number\n}\n\nexport const initialResultsState: ResultsState = {\n  posts: [],\n  pageNumber: 0,\n  count: 0,\n}\n\nconst addPosts = (state: ResultsState, posts: PostDataClass[]) =>\n  produce(state, (draft) => {\n    draft.posts = [...state.posts, ...posts]\n    draft.pageNumber = state.pageNumber + 1\n  })\n\nconst setPosts = (state: ResultsState, posts: PostDataClass[], postCount: string, pageNumber: number = 0) =>\n  produce(state, (draft) => {\n    draft.posts = posts\n    draft.count = Number(postCount)\n    draft.pageNumber = pageNumber\n  })\n\nconst results = (state: ResultsState = initialResultsState, action: AppAction): ResultsState => {\n  switch (action.type) {\n    case ADD_POSTS:\n      return addPosts(state, action.posts)\n    case SET_POSTS:\n      return setPosts(state, action.posts, action.count, action.pageNumber)\n    default:\n      return state\n  }\n}\n\nexport default results\n","import produce from \"immer\"\nimport TagDataClass from \"../../data/Tag\"\nimport { SimpleMap } from \"../../data/types\"\nimport { ADD_TAG, AppAction, REMOVE_TAG, ADD_ALIASES } from \"../actions\"\n\nexport interface TagsState {\n  active: SimpleMap<TagDataClass>\n  aliases: SimpleMap<TagDataClass[]>\n}\n\nexport const initialTagsState: TagsState = {\n  active: {},\n  aliases: {},\n}\n\nconst addTag = (state: TagsState, newTag: TagDataClass) =>\n  produce(state, (draft) => {\n    draft.active[newTag.name] = { ...state.active[newTag.name], ...newTag }\n  })\n\nconst addAliases = (state: TagsState, aliases: TagDataClass[], forTag: string) =>\n  produce(state, (draft) => {\n    draft.aliases[forTag] = aliases\n  })\n\nconst removeTag = (state: TagsState, tagToRemove: TagDataClass) =>\n  produce(state, (draft) => {\n    delete draft.active[tagToRemove.name]\n    delete draft.aliases[tagToRemove.name]\n  })\n\nconst tags = (state: TagsState = initialTagsState, action: AppAction): TagsState => {\n  switch (action.type) {\n    case ADD_TAG:\n      return addTag(state, action.tag)\n    case REMOVE_TAG:\n      return removeTag(state, action.tag)\n    case ADD_ALIASES:\n      return addAliases(state, action.aliases, action.forTag)\n    default:\n      return state\n  }\n}\n\nexport default tags\n","import produce from \"immer\"\nimport { ENTER_FULLSCREEN, EXIT_FULLSCREEN, SET_FULLSCREEN_POST, AppAction } from \"../actions\"\n\nexport interface ReaderState {\n  isEnabled: boolean\n  postId: number\n}\n\nexport const initialReaderState: ReaderState = {\n  isEnabled: false,\n  postId: 0,\n}\n\nconst enterFullscreen = (state: ReaderState, postId: number) =>\n  produce(state, (draft) => {\n    draft.isEnabled = true\n    draft.postId = postId\n  })\n\nconst exitFullscreen = (state: ReaderState) =>\n  produce(state, (draft) => {\n    draft.isEnabled = false\n  })\n\nconst setPostId = (state: ReaderState, value: number) =>\n  produce(state, (draft) => {\n    draft.postId = value\n  })\n\nconst reader = (state: ReaderState = initialReaderState, action: AppAction): ReaderState => {\n  switch (action.type) {\n    case ENTER_FULLSCREEN:\n      return enterFullscreen(state, action.postId)\n    case SET_FULLSCREEN_POST:\n      return setPostId(state, action.postId)\n    case EXIT_FULLSCREEN:\n      return exitFullscreen(state)\n    default:\n      return state\n  }\n}\n\nexport default reader\n","import { combineReducers } from \"redux\"\nimport preferences from \"./preferences\"\nimport results from \"./results\"\nimport tags from \"./tags\"\nimport reader from \"./reader\"\n\nexport default combineReducers({ tags, results, preferences, reader })\n","import { Modifier, SimpleMap } from \"../data/types\"\nimport TagDataClass from \"../data/Tag\"\nimport { PreferencesState } from \"../redux/reducers/preferences\"\n\nconst SEARCH = \"r34_search\"\nconst ADD_TAG = \"r34_add_tag\"\n\ninterface SearchEvent {\n  id: typeof SEARCH\n  payload: {\n    tags: string[]\n  }\n}\n\ninterface TagActivateEvent {\n  id: typeof ADD_TAG\n  payload: {\n    name: string\n    modifier: Modifier | undefined\n  }\n}\n\nexport const searchEvent = (\n  activeTags: SimpleMap<TagDataClass>,\n  page_number: number,\n  preferences: PreferencesState\n) => ({\n  id: SEARCH,\n  payload: {\n    active_tags: Object.values(activeTags)\n      .map((tag) => `${tag.modifier}${tag.name}`)\n      .sort(),\n    page_number,\n    preferences,\n  },\n})\n\nexport const addTagEvent = (tag: TagDataClass) => ({\n  id: ADD_TAG,\n  payload: {\n    name: tag.name,\n    modifier: tag.modifier,\n  },\n})\n\nexport type EventType = SearchEvent | TagActivateEvent\n","import { ADD_TAG, AppAction, SET_POSTS, ADD_POSTS } from \"../actions\"\nimport firebase from \"firebase/app\"\nimport \"firebase/analytics\"\nimport { addTagEvent, searchEvent } from \"../../analytics/events\"\nimport { selectActiveTags, selectPreferences, selectPageNumber, selectCookies } from \"../selectors\"\nimport { MiddlewareAPI, Dispatch } from \"redux\"\n\nconst config = {\n  apiKey: \"AIzaSyBHdepwE7M4Byu2lFtX2s__9COcMdvXu7Q\",\n  authDomain: \"r34-react.firebaseapp.com\",\n  databaseURL: \"https://r34-react.firebaseio.com\",\n  projectId: \"r34-react\",\n  storageBucket: \"r34-react.appspot.com\",\n  messagingSenderId: \"844749417844\",\n  appId: \"1:844749417844:web:11fa1fda0e14f1ac2dd021\",\n  measurementId: \"G-27J3QXZ8YR\",\n}\n\nlet firebaseApp: firebase.app.App\nlet analytics: firebase.analytics.Analytics\n\nconst eventLogging = (store: MiddlewareAPI<any>) => (next: Dispatch<AppAction>) => (action: AppAction) => {\n  const cookies = selectCookies(store.getState())\n\n  if (cookies) {\n    if (!firebaseApp) {\n      firebaseApp = firebase.initializeApp(config)\n      analytics = firebaseApp.analytics()\n    }\n\n    if (action.type === ADD_TAG) {\n      const { id, payload } = addTagEvent(action.tag)\n      analytics.logEvent<typeof id>(id, payload)\n    }\n\n    if (action.type === ADD_POSTS || action.type === SET_POSTS) {\n      const activeTags = selectActiveTags(store.getState())\n      const pageNumber = selectPageNumber(store.getState())\n      const preferences = selectPreferences(store.getState())\n      const { id, payload } = searchEvent(activeTags, action.type === SET_POSTS ? 0 : pageNumber + 1, preferences)\n      analytics.logEvent<typeof id>(id, payload)\n    }\n  }\n\n  next(action)\n}\n\nexport default eventLogging\n","import { MiddlewareAPI } from \"redux\"\nimport { Dispatch } from \"react\"\nimport { AppAction, GET_RESULTS, GET_MORE_RESULTS, addPosts, setPosts } from \"../actions\"\nimport api from \"../../misc/api\"\nimport { preparePost } from \"../../misc/prepare\"\nimport { selectActiveTags, selectPreferences, selectPageNumber, selectOutOfResults } from \"../selectors\"\n\nconst apiRequests = (store: MiddlewareAPI<any>) => (next: Dispatch<AppAction>) => (action: AppAction) => {\n  if (action.type === GET_RESULTS) {\n    const activeTags = selectActiveTags(store.getState())\n    const { pageSize } = selectPreferences(store.getState())\n    const { rated, ratedTreshold } = selectPreferences(store.getState())\n\n    api.getPosts(activeTags, pageSize, action.pageNumber, rated ? ratedTreshold : 0).then((res) => {\n      store.dispatch(setPosts(res.posts.map(preparePost), res.count, action.pageNumber))\n    })\n  }\n\n  const isOutOfResults = selectOutOfResults(store.getState())\n  if (action.type === GET_MORE_RESULTS && !isOutOfResults) {\n    const activeTags = selectActiveTags(store.getState())\n    const { pageSize } = selectPreferences(store.getState())\n    const pageNumber = selectPageNumber(store.getState())\n    const { rated, ratedTreshold } = selectPreferences(store.getState())\n\n    api.getPosts(activeTags, pageSize, pageNumber + 1, rated ? ratedTreshold : 0).then((res) => {\n      store.dispatch(addPosts(res.posts.map(preparePost)))\n    })\n  }\n\n  next(action)\n}\n\nexport default apiRequests\n","import { createStore, applyMiddleware } from \"redux\"\nimport { persistStore, persistReducer } from \"redux-persist\"\nimport storage from \"redux-persist/lib/storage\"\nimport rootReducer from \"./reducers\"\nimport eventLogging from \"./middleware/eventLogging\"\nimport apiRequests from \"./middleware/apiRequests\"\nimport { composeWithDevTools } from \"redux-devtools-extension\"\n\nconst persistConfig = {\n  key: \"appstate\",\n  storage,\n}\n\nconst persistedReducer = persistReducer(persistConfig, rootReducer)\n\nexport const store = createStore(persistedReducer, composeWithDevTools(applyMiddleware(eventLogging, apiRequests)))\n\nexport const persistor = persistStore(store)\n","import React, { Suspense } from \"react\"\r\nimport { Provider } from \"react-redux\"\r\nimport { HashRouter, Route, Switch } from \"react-router-dom\"\r\nimport { PersistGate } from \"redux-persist/integration/react\"\r\nimport { ThemeProvider } from \"styled-components\"\r\nimport CookieConfirmation from \"./components/features/CookieConfirmation\"\r\nimport GlobalStyles from \"./GlobalStyles\"\r\nimport theme from \"./misc/theme\"\r\nimport Search from \"./components/pages/Search\"\r\nimport { persistor, store } from \"./redux/store\"\r\nimport { RouteName } from \"./data/types\"\r\n\r\nconst Help = React.lazy(() => import(\"./components/pages/Help\"))\r\nconst Settings = React.lazy(() => import(\"./components/pages/Settings\"))\r\n\r\nexport default function App() {\r\n  return (\r\n    <Provider store={store}>\r\n      <PersistGate loading={null} persistor={persistor}>\r\n        <ThemeProvider theme={theme}>\r\n          <GlobalStyles />\r\n          <HashRouter>\r\n            <Suspense fallback={<div>Loading...</div>}>\r\n              <Switch>\r\n                <Route path={RouteName.HELP}>\r\n                  <Help />\r\n                </Route>\r\n                <Route path={RouteName.SETTINGS}>\r\n                  <Settings />\r\n                </Route>\r\n                <Route path={RouteName.SEARCH}>\r\n                  <Search />\r\n                </Route>\r\n              </Switch>\r\n            </Suspense>\r\n            <CookieConfirmation />\r\n          </HashRouter>\r\n        </ThemeProvider>\r\n      </PersistGate>\r\n    </Provider>\r\n  )\r\n}\r\n","import React from \"react\"\nimport ReactDOM from \"react-dom\"\nimport App from \"./App\"\n\nReactDOM.render(<App />, document.getElementById(\"app-root\"))\n","import React, { MouseEventHandler, memo } from \"react\"\r\nimport styled, { css } from \"styled-components\"\r\nimport TagWrapper from \"../components/tag/TagWrapper\"\r\nimport { NO_OP } from \"../data/types\"\r\n\r\nimport { ThemeType } from \"../misc/theme\"\r\n\r\nexport const StyledIcon = styled.i(\r\n  (props: { color: string; size: number; theme: ThemeType }) => css`\r\n    color: ${props.color};\r\n    min-width: ${props.size}px;\r\n    height: ${props.size}px;\r\n\r\n    svg {\r\n      color: ${props.color};\r\n    }\r\n\r\n    ${TagWrapper}:hover & {\r\n      color: ${props.theme.colors.accentColor};\r\n    }\r\n\r\n    ${TagWrapper}:active & ,  ${TagWrapper}:focus & {\r\n      color: ${props.theme.colors.backgroundColor2};\r\n    }\r\n  `\r\n)\r\n\r\nconst StyledSvg = styled.svg(\r\n  (props: { size: number } & JSX.IntrinsicAttributes) => css`\r\n    width: ${props.size}px;\r\n    height: ${props.size}px;\r\n  `\r\n)\r\n\r\nconst IconWrapper = styled.span((props: { left: boolean; right: boolean }) => css``)\r\n\r\ninterface IconProps {\r\n  icon: string\r\n  className?: string\r\n  color?: string\r\n  size?: number\r\n  onClick?: MouseEventHandler\r\n  left?: boolean\r\n  right?: boolean\r\n  prefix?: string\r\n}\r\n\r\nconst Icon = (props: IconProps) => {\r\n  const {\r\n    icon,\r\n    className = \"\",\r\n    color = \"black\",\r\n    size = 14,\r\n    onClick = NO_OP,\r\n    left = false,\r\n    right = false,\r\n    prefix = \"fas\",\r\n  } = props\r\n\r\n  return (\r\n    <IconWrapper onClick={onClick} left={left} right={right}>\r\n      <StyledIcon className={`${prefix} ${icon} ${className}`} color={color} size={size} />\r\n    </IconWrapper>\r\n  )\r\n}\r\n\r\nexport const CharacterIcon = styled(Icon).attrs({\r\n  icon: \"fa-user\",\r\n})``\r\n\r\nexport const ArtistIcon = styled(Icon).attrs({\r\n  icon: \"fa-pen\",\r\n})``\r\n\r\nexport const CopyrightIcon = styled(Icon).attrs({\r\n  icon: \"fa-copyright\",\r\n})``\r\n\r\nexport const PlusIcon = styled(Icon).attrs({\r\n  icon: \"fa-plus-circle\",\r\n})``\r\n\r\nexport const MinusIcon = styled(Icon).attrs({\r\n  icon: \"fa-minus-circle\",\r\n})``\r\n\r\nexport const CloseIcon = styled(Icon).attrs({\r\n  icon: \"fa-times\",\r\n})``\r\n\r\nexport const ExpandIcon = memo(\r\n  styled(Icon).attrs({\r\n    icon: \"fa-expand\",\r\n  })``\r\n)\r\n\r\nexport const ArrowIcon = styled(Icon).attrs({\r\n  icon: \"fa-caret-down\",\r\n})``\r\n\r\nexport const ExternalLinkIcon = styled(Icon).attrs({\r\n  icon: \"fa-external-link-alt\",\r\n})``\r\n\r\nexport const SourceIcon = styled(Icon).attrs({\r\n  icon: \"fa-hashtag\",\r\n})``\r\n\r\nexport const RatingIcon = styled(Icon).attrs({\r\n  icon: \"fa-registered\",\r\n})``\r\n\r\nexport const HeartIcon = styled(Icon).attrs({\r\n  icon: \"fa-heart\",\r\n})``\r\n\r\nexport const TwitterIcon = styled(Icon).attrs({\r\n  prefix: \"fab\",\r\n  icon: \"fa-twitter\",\r\n})``\r\n\r\nexport const PatreonIcon = styled(Icon).attrs({\r\n  prefix: \"fab\",\r\n  icon: \"fa-patreon\",\r\n})``\r\n\r\nexport const DeviantArtIcon = styled(Icon).attrs({\r\n  prefix: \"fab\",\r\n  icon: \"fa-deviantart\",\r\n})``\r\n\r\nexport const LinkIcon = styled(Icon).attrs({\r\n  icon: \"fa-link\",\r\n})``\r\n\r\nexport const PlayIcon = memo(\r\n  styled(Icon).attrs({\r\n    icon: \"fa-play\",\r\n  })``\r\n)\r\n\r\nexport const PauseIcon = memo(\r\n  styled(Icon).attrs({\r\n    icon: \"fa-pause\",\r\n  })``\r\n)\r\n\r\nexport const ArrowUp = styled(Icon).attrs({\r\n  icon: \"fa-caret-down\",\r\n})``\r\n\r\nexport const ArrowDown = styled(Icon).attrs({\r\n  icon: \"fa-caret-up\",\r\n})``\r\n\r\nexport const ArrowLeft = styled(Icon).attrs({\r\n  icon: \"fa-caret-left\",\r\n})``\r\n\r\nexport const ArrowRight = styled(Icon).attrs({\r\n  icon: \"fa-caret-right\",\r\n})``\r\n\r\nexport const CodeBranchIcon = styled(Icon).attrs({\r\n  icon: \" fa-code-branch\",\r\n})``\r\n\r\nexport const PixivIcon = (props: Omit<IconProps, \"icon\">) => {\r\n  const { color = \"black\", size = 14, onClick = NO_OP, left = false, right = false } = props\r\n\r\n  return (\r\n    <IconWrapper onClick={onClick} left={left} right={right}>\r\n      <StyledSvg viewBox=\"0 0 24 24\" xmlns=\"http://www.w3.org/2000/svg\" size={size}>\r\n        <path\r\n          fill={color}\r\n          d=\"M4.935 0A4.924 4.924 0 0 0 0 4.935v14.13A4.924 4.924 0 0 0 4.935 24h14.13A4.924 4.924 0 0 0 24 19.065V4.935A4.924 4.924 0 0 0 19.065 0zm7.81 4.547c2.181 0 4.058.676 5.399 1.847a6.118 6.118 0 0 1 2.116 4.66c.005 1.854-.88 3.476-2.257 4.563-1.375 1.092-3.225 1.697-5.258 1.697-2.314 0-4.46-.842-4.46-.842v2.718c.397.116 1.048.365.635.779H5.79c-.41-.41.19-.65.644-.779V7.666c-1.053.81-1.593 1.51-1.868 2.031.32 1.02-.284.969-.284.969l-1.09-1.73s3.868-4.39 9.553-4.39zm-.19.971c-1.423-.003-3.184.473-4.27 1.244v8.646c.988.487 2.484.832 4.26.832h.01c1.596 0 2.98-.593 3.93-1.533.952-.948 1.486-2.183 1.492-3.683-.005-1.54-.504-2.864-1.42-3.86-.918-.992-2.274-1.645-4.002-1.646Z\"\r\n        />\r\n      </StyledSvg>\r\n    </IconWrapper>\r\n  )\r\n}\r\n","import styled, { css } from \"styled-components\"\n\nexport const TextButton = styled.button(\n  ({ theme }) => css`\n    height: ${theme.dimensions.blockHeight};\n    padding: 0 ${theme.dimensions.bigSpacing};\n    font-size: ${theme.fontSizes.content};\n    border: ${theme.colors.accentColor} ${theme.dimensions.borderWidth} solid;\n    border-radius: ${theme.dimensions.borderRadius};\n\n    transition: all ${theme.timings.longTransitionTime} ease-in-out;\n  `\n)\n\nexport const InvisButton = styled.button(\n  ({ theme }) => css`\n    background-color: transparent;\n    border: none;\n    padding: ${theme.dimensions.spacing};\n    filter: ${theme.shadow.drop};\n\n    svg {\n      transition: all ${theme.timings.transitionTime} ease-in-out;\n    }\n\n    :hover {\n      svg {\n        transform: scale(1.1);\n      }\n    }\n  `\n)\n\nexport const RedButton = styled(TextButton)(\n  ({ theme }) => css`\n    color: ${theme.colors.accentColor};\n    background: ${theme.colors.backgroundColor};\n\n    :hover {\n      background-color: ${theme.colors.accentColor};\n      color: ${theme.colors.backgroundColor};\n    }\n\n    :active,\n    :focus {\n      color: ${theme.colors.backgroundColor2};\n      border-color: ${theme.colors.backgroundColor2};\n    }\n  `\n)\n\nexport const BlockButton = styled(RedButton)(\n  ({ theme }) => css`\n    width: 100%;\n  `\n)\n\nexport const AddButton = styled(RedButton)(\n  ({ theme }) => css`\n    border-left-width: 0;\n    border-radius: 0 ${theme.dimensions.borderRadius} ${theme.dimensions.borderRadius} 0;\n  `\n)\n\nexport const ModifierButton = styled(TextButton)(\n  ({ theme }) => css`\n    background-color: transparent;\n    min-width: 48px;\n    border: ${theme.colors.accentColor} ${theme.dimensions.borderWidth} solid;\n    border-right-width: 0;\n    border-radius: ${theme.dimensions.borderRadius} 0 0 ${theme.dimensions.borderRadius};\n    font-weight: bold;\n  `\n)\n","import styled, { css } from \"styled-components\"\n\nexport const Title = styled.h2(\n  ({ theme }) => css`\n    font-size: ${theme.fontSizes.bigTitle};\n    font-weight: lighter;\n    text-align: center;\n  `\n)\n\nexport const BigTitle = styled.h1(\n  ({ theme }) => css`\n    display: flex;\n    justify-content: center;\n    font-size: ${theme.fontSizes.bigTitle};\n    font-weight: lighter;\n    text-align: center;\n  `\n)\n\nexport const SmallTitle = styled.h3(\n  ({ theme }) => css`\n    font-size: ${theme.fontSizes.content};\n  `\n)\n\nexport const Faded = styled.span(\n  ({ theme }) => css`\n    color: ${theme.colors.subduedText};\n  `\n)\n","export const formatCount = (numberString: number) => {\n  const number = numberString\n\n  if (number >= 1e6) {\n    return `${(number / 1e6).toFixed(0)}M`\n  }\n\n  if (number >= 1e3) {\n    return `${(number / 1e3).toFixed(0)}K`\n  }\n\n  return number\n}\n\n/**\n * @param {String} sourceString\n */\nexport const formatSource = (sourceString: string) => {\n  if (\n    sourceString.includes(\"http:\") ||\n    sourceString.includes(\"https:\") ||\n    sourceString.includes(\"www.\") ||\n    sourceString.includes(\".com\")\n  ) {\n    let semiSanitized = sourceString\n      .replace(/https?:\\/\\//, \"\")\n      .replace(/ww[w\\d]\\./, \"\")\n      .replace(\".com\", \"\")\n      .replace(\".org\", \"\")\n      .replace(\".net\", \"\")\n\n    return semiSanitized.substring(0, semiSanitized.indexOf(\"/\"))\n  } else {\n    return sourceString\n  }\n}\n\nexport function formatDuration(duration: number) {\n  const min = Math.trunc(duration / 60)\n  const sec = Math.trunc(duration % 60)\n\n  return min + \":\" + (sec < 10 ? \"0\" : \"\") + sec\n}\n","import { useCallback, useState } from \"react\"\n\nexport default function useToggle(initialValue = false): [boolean, () => void, () => void] {\n  const [value, setValue] = useState<boolean>(initialValue)\n  const toggleValue = useCallback(() => setValue(!value), [value])\n  const resetValue = useCallback(() => setValue(initialValue), [initialValue])\n\n  return [value, toggleValue, resetValue]\n}\n","import React from \"react\"\nimport styled, { css } from \"styled-components\"\n\ninterface FlexPairProps {\n  children: [JSX.Element, JSX.Element]\n}\n\nconst Wrapper = styled.div(\n  ({ theme }) => css`\n    display: flex;\n    align-items: center;\n    gap: ${theme.dimensions.spacing};\n  `\n)\n\nexport default function FlexPair({ children }: FlexPairProps) {\n  return <Wrapper>{children}</Wrapper>\n}\n","import TagDataClass from \"../data/Tag\"\nimport { Modifier, SimpleMap } from \"../data/types\"\n\nexport class API {\n  static pageSize = 20\n  static apiUrl1 = \"https://r34-json.herokuapp.com\"\n  static apiUrl2 = \"https://r34-api-clone.herokuapp.com\"\n  activeApi = API.apiUrl2\n\n  constructor() {\n    this.activeApi = API.apiUrl1\n\n    // Failover to apiUrl2\n    fetch(this.activeApi).catch(() => (this.activeApi = API.apiUrl2))\n  }\n\n  async getTags(searchTerm: string, limit: number = API.pageSize) {\n    const res = await fetch(`${this.activeApi}/tags?limit=${limit}&name=${searchTerm}*&order_by=posts`)\n\n    return await res.json()\n  }\n\n  async getPosts(tags: SimpleMap<TagDataClass>, limit: number = API.pageSize, pageNumber = 0, minScore = 0) {\n    const res = await fetch(this.buildPostUrl(pageNumber, tags, minScore, limit))\n\n    return await res.json()\n  }\n\n  async getAliases(tagName: string) {\n    const res = await fetch(`${this.activeApi}/alias/${tagName}`)\n\n    return await res.json()\n  }\n\n  buildPostUrl(page: number, tags: SimpleMap<TagDataClass>, minScore: number, limit: number = API.pageSize) {\n    const normalTags = Object.values(tags).filter((tag) => tag.modifier !== Modifier.OR)\n    const orTags = Object.values(tags).filter((tag) => tag.modifier === Modifier.OR)\n\n    let tagString = normalTags\n      .map((tag) => `${tag.modifier === \"-\" ? \"-\" : \"\"}${encodeURIComponent(tag.name)}`)\n      .join(\" + \")\n\n    if (orTags.length > 0) {\n      tagString += \"+ ( \" + orTags.map((tag) => encodeURIComponent(tag.name)).join(\" ~ \") + \" )\"\n    }\n\n    let url = `${this.activeApi}/posts?pid=${page}&limit=${limit}&tags=${tagString}`\n\n    if (minScore > 0) {\n      url += `+${encodeURIComponent(\"score:>=\" + minScore)}`\n    }\n\n    return url\n  }\n}\n\nexport default new API()\n","import { TagType, Modifier } from \"./types\"\n\nexport default class TagDataClass {\n  name: string\n  count?: number | null\n  types?: TagType[]\n  modifier?: Modifier\n\n  constructor(name: string, types: TagType[] = [], count: number | null = null, modifier: Modifier = Modifier.PLUS) {\n    this.name = name\n    this.types = types\n    this.count = count\n    this.modifier = modifier\n  }\n}\n","export function prettifyTagname(tagname: string) {\n  return tagname.replace(/_/g, \" \")\n}\n\nexport function normalizeTagname(tagname: string) {\n  return tagname.toLowerCase().replace(/ /g, \"_\")\n}\n","import styled, { css } from \"styled-components\"\n\nexport const HorizontalLine = styled.div(\n  (props) => css`\n    align-self: stretch;\n    height: 1px;\n    background: ${props.theme.misc.layer};\n  `\n)\n\nexport const VerticalLine = styled.div(\n  (props) => css`\n    width: 1px;\n    align-self: stretch;\n    background: ${props.theme.misc.layer};\n  `\n)\n","import { MouseEventHandler, useCallback } from \"react\"\r\nimport { useDispatch, useSelector } from \"react-redux\"\r\nimport styled, { css } from \"styled-components\"\r\nimport TagDataClass from \"../../data/Tag\"\r\nimport { Modifier, TagType } from \"../../data/types\"\r\nimport { formatCount } from \"../../misc/formatting\"\r\nimport { removeTag, addTag } from \"../../redux/actions\"\r\nimport { selectActiveTags } from \"../../redux/selectors\"\r\nimport { prettifyTagname } from \"./tagUtils\"\r\n\r\ninterface TagNameProps {\r\n  modifier: Modifier\r\n  name: string\r\n  count?: number | null\r\n  types?: TagType[]\r\n}\r\n\r\nconst modifierToStyle = {\r\n  [Modifier.PLUS]: css``,\r\n  [Modifier.MINUS]: css`\r\n    text-decoration: line-through;\r\n  `,\r\n  [Modifier.OR]: css`\r\n    font-style: italic;\r\n  `,\r\n}\r\n\r\nconst TagNameSpan = styled.span(\r\n  ({ modifier = Modifier.PLUS }: Pick<TagNameProps, \"modifier\">) => css`\r\n    ${modifierToStyle[modifier]};\r\n  `\r\n)\r\n\r\nexport default function TagName(props: TagNameProps) {\r\n  const { modifier, name, count, types = [] } = props\r\n\r\n  const text = count ? `${prettifyTagname(name)} (${formatCount(count)})` : prettifyTagname(name)\r\n\r\n  const dispatch = useDispatch()\r\n  const activeTags = useSelector(selectActiveTags)\r\n\r\n  const toggleTag: MouseEventHandler = useCallback(\r\n    (event) => {\r\n      event.stopPropagation()\r\n      const tag = new TagDataClass(name, types, count, modifier)\r\n\r\n      if (name in activeTags) {\r\n        dispatch(removeTag(tag))\r\n      } else {\r\n        dispatch(addTag(tag))\r\n      }\r\n    },\r\n    [activeTags, count, dispatch, modifier, name, types]\r\n  )\r\n\r\n  return (\r\n    <TagNameSpan modifier={modifier} onClick={toggleTag}>\r\n      {text}\r\n    </TagNameSpan>\r\n  )\r\n}\r\n","import React from \"react\"\nimport styled, { css } from \"styled-components\"\nimport { Modifier } from \"../../data/types\"\nimport TagName from \"./TagName\"\n\ninterface AliasProps {\n  modifier: Modifier\n  name: string\n  count?: number | null\n}\n\nconst AliasWrapper = styled.div(\n  ({ theme }) => css`\n    display: flex;\n    padding: 0 ${theme.dimensions.bigSpacing};\n    gap: ${theme.dimensions.spacing};\n    align-items: center;\n    height: ${theme.dimensions.blockHeight};\n    font-size: ${theme.fontSizes.content};\n  `\n)\n\nexport default function Alias(props: AliasProps) {\n  const { modifier, name, count } = props\n\n  return (\n    <AliasWrapper>\n      <TagName modifier={modifier} name={name} count={count} />\n    </AliasWrapper>\n  )\n}\n","import React from \"react\"\nimport styled, { css } from \"styled-components\"\nimport TagDataClass from \"../../data/Tag\"\nimport { Modifier } from \"../../data/types\"\nimport Alias from \"./Alias\"\nimport { ThemeType } from \"../../misc/theme\"\n\nconst ListWrapper = styled.div(\n  ({ theme, parentRef }: { theme: ThemeType; parentRef: HTMLDivElement }) => css`\n    position: absolute;\n    top: ${parentRef.offsetTop + parentRef.clientHeight + 4}px;\n    left: ${parentRef.offsetLeft}px;\n    width: ${parentRef.clientWidth + 4}px;\n\n    display: flex;\n    flex-direction: column;\n\n    border-bottom-left-radius: ${theme.dimensions.borderRadius};\n    border-bottom-right-radius: ${theme.dimensions.borderRadius};\n    border: ${theme.dimensions.borderWidth} solid ${theme.colors.accentColor};\n    border-top: none;\n\n    background: ${theme.colors.backgroundColor};\n    z-index: 3;\n    color: ${theme.colors.accentColor};\n\n    > :not(:last-child) {\n      border-bottom: ${theme.dimensions.borderWidth} solid ${theme.colors.accentColor};\n    }\n  `\n)\n\ninterface AliasesListProps {\n  aliases: TagDataClass[]\n  modifier: Modifier\n  parentRef: HTMLDivElement\n}\n\nexport default function AliasesList(props: AliasesListProps) {\n  const { aliases, modifier, parentRef } = props\n\n  return (\n    <ListWrapper parentRef={parentRef}>\n      {aliases.map(({ name, count }) => (\n        <Alias key={\"a_\" + name} modifier={modifier} name={name} count={count} />\n      ))}\n    </ListWrapper>\n  )\n}\n","import React, { useEffect, useState } from \"react\"\r\nimport api from \"../../misc/api\"\r\nimport TypeIcon from \"../../icons/TypeIcon\"\r\nimport { ArrowIcon } from \"../../icons/Icons\"\r\nimport TagDataClass from \"../../data/Tag\"\r\nimport { useDispatch, useSelector } from \"react-redux\"\r\nimport { selectActiveTags, selectAliasesByTagName } from \"../../redux/selectors\"\r\nimport { addAliases } from \"../../redux/actions\"\r\nimport useToggle from \"../../hooks/useToggle\"\r\nimport TagWrapper from \"./TagWrapper\"\r\nimport TagName from \"./TagName\"\r\nimport { Modifier } from \"../../data/types\"\r\nimport AliasesList from \"./AliasesList\"\r\n\r\n/**\r\n * Same data as a tag but different names\r\n */\r\ntype TagLike = {\r\n  name: string\r\n  posts: number\r\n}\r\n\r\ninterface TagProps extends TagDataClass {\r\n  loadAliases: boolean\r\n}\r\n\r\nexport default function NewTag(props: TagProps) {\r\n  const { name, count, modifier = Modifier.PLUS, types, loadAliases } = props\r\n\r\n  const [tagRef, setTagRef] = useState<HTMLDivElement | null>(null)\r\n  const [collapsed, toggleCollapsed, resetCollapsed] = useToggle(true)\r\n\r\n  const dispatch = useDispatch()\r\n  const activeTags = useSelector(selectActiveTags)\r\n  const aliases = useSelector(selectAliasesByTagName(name))\r\n\r\n  const isActive = name in activeTags\r\n\r\n  useEffect(() => {\r\n    if (loadAliases && activeTags[name])\r\n      api.getAliases(name).then((newAliases: TagLike[]) => {\r\n        newAliases.sort((a, b) => b.posts - a.posts)\r\n        const filtered = newAliases\r\n          .filter((alias) => !activeTags[alias.name])\r\n          .map((alias) => new TagDataClass(alias.name, [], alias.posts))\r\n        dispatch(addAliases(filtered, name))\r\n      })\r\n  }, [loadAliases, name, activeTags, dispatch])\r\n\r\n  return (\r\n    <TagWrapper active={isActive} collapsed={collapsed} onMouseLeave={resetCollapsed} ref={setTagRef}>\r\n      <TypeIcon types={types} />\r\n      <TagName modifier={modifier} name={name} count={count} />\r\n      {loadAliases && aliases?.length > 0 && (\r\n        <>\r\n          <ArrowIcon onClick={toggleCollapsed} />\r\n          {!collapsed && tagRef && <AliasesList aliases={aliases} modifier={modifier} parentRef={tagRef} />}\r\n        </>\r\n      )}\r\n    </TagWrapper>\r\n  )\r\n}\r\n","import React from \"react\"\nimport styled, { css } from \"styled-components\"\nimport TagDataClass from \"../../data/Tag\"\nimport { SimpleMap } from \"../../data/types\"\nimport NewTag from \"./NewTag\"\n\nexport const TagListWrapper = styled.div(\n  ({ theme }) => css`\n    display: inline-flex;\n    flex-wrap: wrap;\n    gap: ${theme.dimensions.gutter};\n  `\n)\n\ninterface TagListProps {\n  tags: SimpleMap<TagDataClass>\n  loadAliases?: boolean\n  padding?: boolean\n  className?: string\n}\n\nexport default function TagList(props: TagListProps) {\n  const { tags, loadAliases = false, className } = props\n\n  return (\n    <TagListWrapper className={className}>\n      {Object.entries(tags).map(([key, tag]) => (\n        <NewTag key={key} {...tag} loadAliases={loadAliases} />\n      ))}\n    </TagListWrapper>\n  )\n}\n","import { MouseEventHandler } from \"react\"\nimport styled, { css } from \"styled-components\"\n\nimport { ThemeType } from \"../../misc/theme\"\n\nconst dropdownBorderRadius = (collapsed: boolean, theme: ThemeType) =>\n  collapsed ? theme.dimensions.borderRadius : `${theme.dimensions.borderRadius} ${theme.dimensions.borderRadius} 0 0`\n\nconst switchingColors = (active: boolean, theme: ThemeType) => {\n  const fg = active ? theme.colors.backgroundColor : theme.colors.accentColor\n  const bg = active ? theme.colors.accentColor : theme.colors.backgroundColor\n\n  return css`\n    color: ${fg};\n    background-color: ${bg};\n    border: ${theme.colors.accentColor} ${theme.dimensions.borderWidth} solid;\n    transition: background-color 0.4s ease-in-out;\n\n    cursor: pointer;\n\n    :hover,\n    :focus,\n    :active {\n      border-color: ${theme.colors.backgroundColor2};\n      color: ${theme.colors.backgroundColor2};\n\n      svg {\n        color: ${theme.colors.backgroundColor2} !important;\n      }\n    }\n  `\n}\n\nconst TagWrapper = styled.div(\n  (props: { active: boolean; collapsed: boolean; onMouseLeave: MouseEventHandler; theme: ThemeType }) =>\n    css`\n      display: flex;\n      padding: 0 ${props.theme.dimensions.spacing};\n      gap: ${props.theme.dimensions.spacing};\n      align-items: center;\n      height: ${props.theme.dimensions.blockHeight};\n      border-radius: ${dropdownBorderRadius(props.collapsed, props.theme)};\n      font-size: ${props.theme.fontSizes.content};\n      ${switchingColors(props.active, props.theme)}\n    `\n)\n\nexport default TagWrapper\n","import { RatingType, PostType } from \"./types\"\nimport TagDataClass from \"./Tag\"\n\nexport default class PostDataClass {\n  id: number\n\n  score: number\n  rating: RatingType\n  source: string\n  tags: TagDataClass[]\n\n  media_type: PostType\n\n  thumbnail_src: string\n  small_src: string\n  big_src: string\n\n  width: number\n  height: number\n\n  creator_id: number\n  creator_url: string\n\n  status: string\n  parent_id: number\n  has_children: boolean\n  has_comments: boolean\n  comments_url: string\n  has_notes: boolean\n  created_at: string\n  change: string\n\n  constructor(\n    id: number,\n    score: number,\n    rating: string,\n    source: string,\n    tags: TagDataClass[],\n    media_type: string,\n    media_src: any,\n    file_url: any,\n    thumbnail_src: string,\n    width: number,\n    height: number,\n    creator_id: number,\n    creator_url: string,\n    status: string,\n    parent_id: number,\n    has_children: boolean,\n    has_comments: boolean,\n    comments_url: string,\n    has_notes: boolean,\n    created_at: string,\n    change: string\n  ) {\n    this.id = id\n\n    this.score = score\n    this.rating = rating as RatingType\n    this.source = source\n    this.tags = tags\n\n    this.media_type = media_type as PostType\n    this.small_src = media_src\n    this.big_src = file_url\n    this.thumbnail_src = thumbnail_src\n\n    this.width = width\n    this.height = height\n\n    this.creator_id = creator_id\n    this.creator_url = creator_url\n\n    this.status = status\n    this.parent_id = parent_id\n    this.has_children = has_children\n    this.has_comments = has_comments\n    this.comments_url = comments_url\n    this.has_notes = has_notes\n    this.created_at = created_at\n    this.change = change\n  }\n}\n","import PostDataClass from \"../data/Post\"\nimport TagDataClass from \"../data/Tag\"\nimport { TagType, Modifier, RatingType } from \"../data/types\"\n\ninterface DirtyTag {\n  name: string\n  types: string[]\n  count: string\n  modifier: string\n}\n\ninterface DirtyPost {\n  id: string\n  type: string\n  score: string\n  rating: string\n  source: string\n  tags: string[]\n  file_url: string\n  width: string\n  height: string\n  creator_id: string\n  creator_url: string\n  sample_url: string\n  preview_url: string\n  status: string\n  parent_id: string\n  has_children: string\n  has_comments: string\n  comments_url: string\n  has_notes: string\n  created_at: string\n  change: string\n}\n\nexport function prepareTag(dirtyTag: DirtyTag) {\n  const { name, types, count, modifier } = dirtyTag\n\n  return new TagDataClass(name, types as TagType[], Number(count), modifier as Modifier)\n}\n\nexport function preparePost(post: DirtyPost) {\n  const {\n    id,\n    type,\n    score,\n    rating,\n    source,\n    tags,\n    file_url,\n    width,\n    height,\n    creator_id,\n    creator_url,\n    sample_url,\n    preview_url,\n    status,\n    parent_id,\n    has_children,\n    has_comments,\n    comments_url,\n    has_notes,\n    created_at,\n    change,\n  } = post\n  return new PostDataClass(\n    Number(id),\n    Number(score),\n    rating as RatingType,\n    source,\n    tags ? tags.map((t) => new TagDataClass(t)) : [],\n    type,\n    sample_url,\n    file_url,\n    preview_url,\n    Number(width),\n    Number(height),\n    Number(creator_id),\n    creator_url,\n    status,\n    Number(parent_id),\n    Boolean(has_children),\n    Boolean(has_comments),\n    comments_url,\n    Boolean(has_notes),\n    created_at,\n    change\n  )\n}\n","import styled, { css } from \"styled-components\"\n\nexport default styled.div(\n  (props) => css`\n    display: grid;\n    padding: ${props.theme.dimensions.gutter};\n    background: ${props.theme.misc.layer};\n    ${props.theme.shadow.box};\n    border-radius: ${props.theme.dimensions.borderRadius};\n    width: 100%;\n    gap: ${props.theme.dimensions.gutter};\n  `\n)\n","import React, { MouseEventHandler } from \"react\"\nimport { NO_OP } from \"../data/types\"\nimport { CharacterIcon, CopyrightIcon, ArtistIcon } from \"./Icons\"\n\ninterface TypeIconProps {\n  types?: string[]\n  className?: string\n  color?: string\n  size?: number\n  onClick?: MouseEventHandler\n  left?: boolean\n  right?: boolean\n}\n\nexport default function TypeIcon(props: TypeIconProps) {\n  const { types = [], className = \"\", onClick = NO_OP } = props\n  const interestingType = types.find((t) => !t.match(/^[general|ambiguous]$/))\n\n  switch (interestingType) {\n    case \"character\":\n      return <CharacterIcon className={className} onClick={onClick} />\n    case \"copyright\":\n      return <CopyrightIcon className={className} onClick={onClick} />\n    case \"artist\":\n      return <ArtistIcon className={className} onClick={onClick} />\n    default:\n      return null\n  }\n}\n","import { useCallback } from \"react\"\r\nimport { useDispatch, useSelector } from \"react-redux\"\r\nimport { PreferenceKey } from \"../data/types\"\r\nimport { setOption } from \"../redux/actions\"\r\nimport { PreferencesState } from \"../redux/reducers/preferences\"\r\nimport { selectPreferences } from \"../redux/selectors\"\r\n\r\nexport default function usePreference<T extends PreferenceKey>(\r\n  key: T\r\n): [PreferencesState[T], (value: PreferencesState[T]) => void] {\r\n  const dispatch = useDispatch()\r\n  const preferences = useSelector(selectPreferences)\r\n  const setPreference = useCallback((value: any) => dispatch(setOption(key, value)), [dispatch, key])\r\n\r\n  return [preferences[key], setPreference]\r\n}\r\n","import styled, { css } from \"styled-components\"\n\nconst FlexColumn = styled.div`\n  display: flex;\n  flex-direction: column;\n  width: 100%;\n  min-height: 100%;\n`\n\nexport default FlexColumn\n\nexport const FlexColumnWithSpacing = styled(FlexColumn)(\n  ({ theme }) => css`\n    gap: ${theme.dimensions.gutter};\n    padding: ${theme.dimensions.gutter};\n    max-width: ${theme.dimensions.bodyWidth};\n    margin: 0 auto;\n  `\n)\n","import React from \"react\"\nimport { ThemeType } from \"../misc/theme\"\nimport { useTheme } from \"styled-components\"\n\nexport default function R34Icon(props: { size: number }) {\n  const theme = useTheme() as ThemeType\n\n  return (\n    <svg xmlns=\"http://www.w3.org/2000/svg\" width={props.size} height={props.size} viewBox=\"0 0 12.7 12.7\">\n      <g transform=\"translate(0,-284.3)\">\n        <circle\n          id=\"path18\"\n          cx=\"6.3499999\"\n          cy=\"290.65002\"\n          fill=\"none\"\n          stroke={theme.colors.accentColor}\n          strokeWidth=\"0.50848764\"\n          strokeMiterlimit=\"4\"\n          strokeDasharray=\"none\"\n          strokeOpacity=\"1\"\n          r=\"6.0957561\"\n        />\n        <text\n          fontStyle=\"normal\"\n          fontWeight=\"normal\"\n          fontSize=\"8.3113203px\"\n          fontFamily=\"sansSerif\"\n          letterSpacing=\"0px\"\n          wordSpacing=\"0px\"\n          fill={theme.colors.accentColor}\n          fillOpacity=\"1\"\n          x=\"2.1363549\"\n          y=\"289.02704\"\n          id=\"text4533\"\n          transform=\"scale(0.98538224,1.0148346)\"\n        >\n          <tspan\n            id=\"tspan4531\"\n            x=\"2\"\n            y=\"289.1\"\n            fontStyle=\"normal\"\n            fontVariant=\"normal\"\n            fontWeight=\"300\"\n            fontStretch=\"normal\"\n            fontFamily=\"Calibri\"\n            fill={theme.colors.accentColor}\n            fillOpacity=\"1\"\n          >\n            34\n          </tspan>\n        </text>\n      </g>\n    </svg>\n  )\n}\n","import React, { RefAttributes } from \"react\"\nimport { Link, LinkProps, useLocation } from \"react-router-dom\"\nimport styled, { css, ThemeProps } from \"styled-components\"\nimport { RouteName } from \"../../data/types\"\nimport R34Icon from \"../../icons/R34Icon\"\nimport { VerticalLine } from \"../common/Lines\"\nimport { BigTitle } from \"../common/Text\"\n\nconst HeaderWrapper = styled.header(\n  ({ theme }) => css`\n    display: flex;\n    flex-direction: column;\n    gap: ${theme.dimensions.bigSpacing};\n  `\n)\n\nconst TitleBar = styled.div(\n  ({ theme }) => css`\n    display: flex;\n    gap: ${theme.dimensions.bigSpacing};\n    align-items: center;\n    justify-content: center;\n    background: ${theme.misc.layer};\n    padding: ${theme.dimensions.gutter} 0;\n    ${theme.shadow.box};\n  `\n)\n\nconst MenuBar = styled.nav(\n  ({ theme }) => css`\n    display: flex;\n    justify-content: center;\n    padding: ${theme.dimensions.bigSpacing};\n    gap: ${theme.dimensions.hugeSpacing};\n  `\n)\n\ntype LocationStyledLinkProps = LinkProps<unknown> &\n  RefAttributes<HTMLAnchorElement> &\n  ThemeProps<any> & { current: string }\n\nconst LocationStyledLink = styled(Link)(\n  ({ to, current, theme }: LocationStyledLinkProps) => css`\n    color: ${to === current ? theme.colors.accentColor : theme.colors.backgroundColor2};\n  `\n)\n\nexport default function Header() {\n  const current = useLocation().pathname\n\n  return (\n    <HeaderWrapper role=\"cell\">\n      <TitleBar>\n        <R34Icon size={32} />\n        <VerticalLine />\n        <BigTitle>\n          Browse <a href=\"https://rule34.xxx\">Rule34</a>\n        </BigTitle>\n      </TitleBar>\n\n      <MenuBar role=\"cell\">\n        <LocationStyledLink current={current} to={RouteName.SEARCH}>\n          Search\n        </LocationStyledLink>\n        <VerticalLine />\n        <LocationStyledLink current={current} to={RouteName.HELP}>\n          Help\n        </LocationStyledLink>\n        <VerticalLine />\n        <LocationStyledLink current={current} to={RouteName.SETTINGS}>\n          Settings\n        </LocationStyledLink>\n      </MenuBar>\n    </HeaderWrapper>\n  )\n}\n","export const GENERAL = \"general\"\r\nexport const CHARACTER = \"character\"\r\nexport const AMBIGUOUS = \"ambiguous\"\r\nexport const ARTIST = \"artist\"\r\nexport const COPYRIGHT = \"copyright\"\r\nexport type TagType = typeof GENERAL | typeof CHARACTER | typeof AMBIGUOUS | typeof ARTIST | typeof COPYRIGHT\r\n\r\nexport enum Modifier {\r\n  PLUS = \"+\",\r\n  MINUS = \"-\",\r\n  OR = \"~\",\r\n}\r\n\r\nexport const VIDEO = \"video\"\r\nexport const IMAGE = \"image\"\r\nexport type PostType = typeof VIDEO | typeof IMAGE\r\n\r\nexport const PICTURE = \"picture\"\r\nexport const GIF = \"gif\"\r\nexport type MediaType = typeof VIDEO | typeof PICTURE | typeof GIF\r\n\r\nexport enum ResultLayout {\r\n  INFINITE_COLUMN = \"infinite_column\",\r\n  PAGES = \"pages\",\r\n}\r\n\r\nexport enum RouteName {\r\n  SEARCH = \"/\",\r\n  HELP = \"/help\",\r\n  SETTINGS = \"/settings\",\r\n}\r\n\r\nexport const INVISIBLE = \"invisible\"\r\nexport const BLOCK = \"block\"\r\nexport const MODIFIER = \"modifier\"\r\nexport const ADD = \"add\"\r\nexport const RED = \"red\"\r\nexport type ButtonType = typeof INVISIBLE | typeof BLOCK | typeof MODIFIER | typeof ADD | typeof RED\r\n\r\nexport const SAFE = \"safe\"\r\nexport const QUESTIONABLE = \"questionable\"\r\nexport const EXPLICIT = \"explicit\"\r\nexport type RatingType = typeof SAFE | typeof QUESTIONABLE | typeof EXPLICIT\r\n\r\nexport const INFINITE = \"infinite\"\r\nexport const RATED = \"rated\"\r\nexport const RATEDTRESHOLD = \"ratedTreshold\"\r\nexport const ORIGINALS = \"originals\"\r\nexport const COOKIES = \"cookies\"\r\nexport const PRELOAD_VIDEOS = \"preloadVideos\"\r\nexport const TAG_SUGGESTIONS_COUNT = \"tagSuggestionsCount\"\r\nexport const RESULTS_LAYOUT = \"resultsLayout\"\r\nexport const PAGE_SIZE = \"pageSize\"\r\n\r\nexport type PreferenceKey =\r\n  | typeof INFINITE\r\n  | typeof RATED\r\n  | typeof RATEDTRESHOLD\r\n  | typeof ORIGINALS\r\n  | typeof COOKIES\r\n  | typeof PRELOAD_VIDEOS\r\n  | typeof TAG_SUGGESTIONS_COUNT\r\n  | typeof RESULTS_LAYOUT\r\n  | typeof PAGE_SIZE\r\n\r\nexport interface SimpleMap<V> {\r\n  [key: string]: V\r\n}\r\n\r\nexport interface SimpleList<V> {\r\n  [key: number]: V\r\n}\r\n\r\nexport const NO_OP = () => {}\r\n","import React, { MouseEventHandler } from \"react\"\r\nimport styled, { css } from \"styled-components\"\r\nimport { ThemeType } from \"../../misc/theme\"\r\n\r\nconst Track = styled.div(\r\n  (props) => css`\r\n    border-radius: 30px;\r\n    width: 50px;\r\n    border: ${props.theme.dimensions.borderWidth} solid ${props.theme.colors.accentColor};\r\n    background-color: ${props.theme.colors.backgroundColor};\r\n    transition: transform ${props.theme.timings.longTransitionTime} ease-in-out;\r\n    height: 24px;\r\n  `\r\n)\r\n\r\nconst Thumb = styled.div(\r\n  (props: { value: boolean; theme: ThemeType }) => css`\r\n    height: 100%;\r\n    aspect-ratio: 1/1;\r\n    background-color: ${props.value ? props.theme.colors.accentColor : props.theme.colors.backgroundColor2};\r\n    border-radius: 50%;\r\n    transition: all 0.2s ease-in-out;\r\n    transform: translate(${props.value ? \"26px\" : \"0px\"});\r\n  `\r\n)\r\n\r\ninterface ToggleProps {\r\n  value: boolean\r\n  onToggle: MouseEventHandler\r\n}\r\n\r\nexport default function Toggle(props: ToggleProps) {\r\n  const { value, onToggle } = props\r\n\r\n  return (\r\n    <Track onClick={onToggle}>\r\n      <Thumb value={value} />\r\n    </Track>\r\n  )\r\n}\r\n","import React, { ChangeEventHandler, KeyboardEventHandler, useCallback, useEffect, useState } from \"react\"\r\nimport styled, { css } from \"styled-components\"\r\n\r\nconst TextInput = styled.input(\r\n  ({ theme }) => css`\r\n    width: 50px;\r\n    border: ${theme.dimensions.borderWidth} solid ${theme.colors.accentColor};\r\n    background-color: ${theme.colors.backgroundColor2};\r\n    padding: ${theme.dimensions.spacing};\r\n    border-radius: ${theme.dimensions.borderRadius};\r\n    text-align: center;\r\n    height: ${theme.dimensions.blockHeight};\r\n  `\r\n)\r\n\r\ninterface SmallInputProps<T> {\r\n  value: T\r\n  onSubmit: (value: T) => void\r\n}\r\n\r\nexport function SmallTextInput(props: SmallInputProps<string>) {\r\n  const { value, onSubmit } = props\r\n  const [internalValue, setInternalValue] = useState(value)\r\n\r\n  useEffect(() => {\r\n    setInternalValue(value)\r\n  }, [value])\r\n\r\n  const onChange: ChangeEventHandler<HTMLInputElement> = useCallback((event) => {\r\n    setInternalValue(event.target.value)\r\n  }, [])\r\n\r\n  const onBlur = useCallback(() => {\r\n    onSubmit(internalValue)\r\n  }, [internalValue, onSubmit])\r\n\r\n  const onKeyDown: KeyboardEventHandler = useCallback(\r\n    (event) => {\r\n      if (event.key === \"Enter\") {\r\n        onSubmit(internalValue)\r\n      }\r\n    },\r\n    [internalValue, onSubmit]\r\n  )\r\n\r\n  return <TextInput type=\"text\" value={internalValue} onChange={onChange} onBlur={onBlur} onKeyDown={onKeyDown} />\r\n}\r\n\r\nexport function SmallNumberInput(props: SmallInputProps<number>) {\r\n  const { value, onSubmit } = props\r\n  const [internalValue, setInternalValue] = useState(value.toString())\r\n\r\n  useEffect(() => {\r\n    setInternalValue(value.toString())\r\n  }, [value])\r\n\r\n  const onChange: ChangeEventHandler<HTMLInputElement> = useCallback((event) => {\r\n    setInternalValue(event.target.value)\r\n  }, [])\r\n\r\n  const onBlur = useCallback(() => {\r\n    onSubmit(Number(internalValue))\r\n  }, [internalValue, onSubmit])\r\n\r\n  const onKeyDown: KeyboardEventHandler = useCallback(\r\n    (event) => {\r\n      if (event.key === \"Enter\") {\r\n        onSubmit(Number(internalValue))\r\n      }\r\n    },\r\n    [internalValue, onSubmit]\r\n  )\r\n\r\n  return <TextInput type=\"number\" value={internalValue} onChange={onChange} onBlur={onBlur} onKeyDown={onKeyDown} />\r\n}\r\n","import React from \"react\"\nimport styled, { css } from \"styled-components\"\n\nconst Input = styled.input(\n  (props) => css`\n    width: 100%;\n    border: none;\n    outline: none;\n    background: none;\n    font-size: ${props.theme.fontSizes.content};\n    border-top: ${props.theme.colors.accentColor} ${props.theme.dimensions.borderWidth} solid;\n    border-bottom: ${props.theme.colors.accentColor} ${props.theme.dimensions.borderWidth} solid;\n  `\n)\n\ninterface TagInputProps {\n  value: string\n  setValue: (newValue: string) => void\n}\n\nexport default function TagInput(props: TagInputProps) {\n  const { value, setValue } = props\n  return (\n    <Input\n      id=\"tag-input\"\n      value={value}\n      onChange={(event) => setValue(event.target.value)}\n      placeholder=\"Search for tags\"\n      aria-label=\"Search\"\n    />\n  )\n}\n","import React, { MouseEventHandler } from \"react\"\nimport styled, { css } from \"styled-components\"\nimport { TagType } from \"../../data/types\"\nimport TypeIcon from \"../../icons/TypeIcon\"\nimport { formatCount } from \"../../misc/formatting\"\nimport { prettifyTagname } from \"../tag/tagUtils\"\n\ninterface EntryProps {\n  name: string\n  posts: number\n  types: TagType[]\n  onClick: MouseEventHandler\n}\n\nconst EntryWrapper = styled.div(\n  ({ theme }) => css`\n    display: grid;\n    grid-template-columns: 48px 1fr auto;\n    height: ${theme.dimensions.blockHeight};\n    background: white;\n    align-items: center;\n  `\n)\n\nconst Name = styled.span`\n  grid-column: 2/3;\n`\n\nconst Count = styled.span`\n  grid-column: 3/4;\n`\n\nconst Icon = styled.div`\n  grid-column: 1/2;\n  text-align: center;\n`\n\nexport default function DropdownListEntry(props: EntryProps) {\n  const { name, posts, types, onClick } = props\n\n  return (\n    <EntryWrapper onClick={onClick}>\n      <Icon>\n        <TypeIcon types={types} />\n      </Icon>\n      <Name>{prettifyTagname(name)}</Name>\n      <Count>{formatCount(posts)} posts</Count>\n    </EntryWrapper>\n  )\n}\n","import React from \"react\"\nimport styled, { css } from \"styled-components\"\nimport DropdownListEntry from \"./DropdownListEntry\"\nimport TagDataClass from \"../../data/Tag\"\nimport { TagType } from \"../../data/types\"\nimport { ThemeType } from \"../../misc/theme\"\n\nfunction sizeAndPosition(tagSelector: HTMLDivElement | null) {\n  if (tagSelector) {\n    const { offsetTop, clientHeight, offsetLeft, clientWidth } = tagSelector\n\n    return css`\n      position: absolute;\n      top: ${offsetTop + clientHeight}px;\n      left: ${offsetLeft}px;\n      width: ${clientWidth}px;\n      max-height: 50vh;\n      overflow-y: scroll;\n    `\n  }\n\n  return \"\"\n}\n\nexport const ListWrapper = styled.div(\n  (props: { tagSelectorRef: HTMLDivElement | null; theme: ThemeType }) => css`\n    display: flex;\n    flex-direction: column;\n    ${sizeAndPosition(props.tagSelectorRef)};\n    background: lightgrey;\n    gap: 1px;\n    box-sizing: border-box;\n    border: ${props.theme.dimensions.borderWidth} ${props.theme.colors.accentColor} solid;\n    border-top: none;\n    border-radius: 0 0 3px 3px;\n    color: black;\n    z-index: 3;\n  `\n)\n\ninterface DropdownListProps {\n  tagSelectorRef: HTMLDivElement | null\n  entries: {\n    name: string\n    posts: number\n    types: TagType[]\n  }[]\n  onClick: (entry: TagDataClass) => void\n}\n\nexport default function DropdownList(props: DropdownListProps) {\n  const { tagSelectorRef, entries, onClick } = props\n\n  return entries && entries.length > 0 ? (\n    <ListWrapper tagSelectorRef={tagSelectorRef}>\n      {entries.map((entry) => (\n        <DropdownListEntry key={entry.name} onClick={() => onClick(entry)} {...entry} />\n      ))}\n    </ListWrapper>\n  ) : null\n}\n","import { useCallback, useState } from \"react\"\r\nimport { Modifier } from \"../../data/types\"\r\n\r\nconst order = [Modifier.PLUS, Modifier.MINUS, Modifier.OR]\r\n\r\n/**\r\n * Small utility hook to abstract the rotating modifier away\r\n * @param initialValue\r\n */\r\nexport default function useModifier(initialValue: Modifier = Modifier.PLUS): [Modifier, () => void] {\r\n  const [modifier, setModifier] = useState(initialValue)\r\n\r\n  const nextModifier = useCallback(() => {\r\n    const currentIndex = order.indexOf(modifier)\r\n    const nextIndex = currentIndex + 1\r\n\r\n    // make the value rotate\r\n    setModifier(order[nextIndex % order.length])\r\n  }, [modifier])\r\n\r\n  return [modifier, nextModifier]\r\n}\r\n","import React, { useState, useCallback } from \"react\"\r\nimport styled, { css } from \"styled-components\"\r\nimport api from \"../../misc/api\"\r\nimport { prepareTag } from \"../../misc/prepare\"\r\nimport { AddButton, ModifierButton } from \"../common/Buttons\"\r\nimport TagInput from \"./TagInput\"\r\nimport DropdownList from \"./DropdownList\"\r\nimport { normalizeTagname } from \"../tag/tagUtils\"\r\nimport { useDispatch, useSelector } from \"react-redux\"\r\nimport { addTag } from \"../../redux/actions\"\r\nimport { ThemeType } from \"../../misc/theme\"\r\nimport { selectPreferences } from \"../../redux/selectors\"\r\nimport useThrottledEffect from \"../../hooks/useThrottledEffect\"\r\nimport useModifier from \"./useModifier\"\r\n\r\nexport const TagSelectorWrapper = styled.div(\r\n  (props: { closed: boolean; ref: (ref: HTMLInputElement) => void; theme: ThemeType }) => css`\r\n    display: flex;\r\n    background: white;\r\n    ${props.closed\r\n      ? css`\r\n          border-radius: ${props.theme.dimensions.borderRadius};\r\n        `\r\n      : css`\r\n          border-radius: ${props.theme.dimensions.borderRadius} ${props.theme.dimensions.borderRadius} 0 0;\r\n\r\n          > ${AddButton} {\r\n            border-radius: 0 ${props.theme.dimensions.borderRadius} 0 0;\r\n          }\r\n\r\n          > ${ModifierButton} {\r\n            border-radius: ${props.theme.dimensions.borderRadius} 0 0 0;\r\n          }\r\n        `}\r\n  `\r\n)\r\n\r\nexport default function TagSelector() {\r\n  const dispatch = useDispatch()\r\n\r\n  const [value, setValue] = useState(\"\")\r\n  const [suggestions, setSuggestions] = useState([])\r\n  const [tagSelectorRef, setTagSelectorRef] = useState<HTMLDivElement | null>(null)\r\n  const [modifier, nextModifier] = useModifier()\r\n\r\n  const { tagSuggestionsCount } = useSelector(selectPreferences)\r\n\r\n  const activateTag = useCallback(\r\n    ({ name, posts, types }) => {\r\n      dispatch(\r\n        addTag(\r\n          prepareTag({\r\n            name,\r\n            types,\r\n            modifier,\r\n            count: posts,\r\n          })\r\n        )\r\n      )\r\n\r\n      setValue(\"\")\r\n      setSuggestions([])\r\n    },\r\n    [dispatch, modifier]\r\n  )\r\n\r\n  useThrottledEffect(\r\n    () => {\r\n      if (!value) {\r\n        setSuggestions([])\r\n        return\r\n      }\r\n\r\n      api.getTags(normalizeTagname(value), tagSuggestionsCount).then((newSuggestions) => {\r\n        setSuggestions(newSuggestions)\r\n      })\r\n    },\r\n    300,\r\n    [tagSuggestionsCount, value]\r\n  )\r\n\r\n  const onAddClick = useCallback(() => {\r\n    if (value && value.trim()) {\r\n      const suggestion = suggestions.find((s: { name: string }) => s.name === value) || {}\r\n      activateTag({ ...suggestion, name: value })\r\n    }\r\n  }, [value, activateTag, suggestions])\r\n\r\n  const onSuggestionClick = useCallback((entry) => activateTag(entry), [activateTag])\r\n\r\n  return (\r\n    <TagSelectorWrapper ref={setTagSelectorRef} closed={suggestions.length === 0}>\r\n      <ModifierButton onClick={nextModifier} aria-label=\"Tag Modifier\">\r\n        {modifier}\r\n      </ModifierButton>\r\n      <TagInput value={value} setValue={setValue} />\r\n      <AddButton onClick={onAddClick} aria-label=\"Add Tag\">\r\n        Add\r\n      </AddButton>\r\n      {suggestions.length > 0 && (\r\n        <DropdownList tagSelectorRef={tagSelectorRef} entries={suggestions} onClick={onSuggestionClick} />\r\n      )}\r\n    </TagSelectorWrapper>\r\n  )\r\n}\r\n","import { useEffect } from \"react\"\r\n\r\nexport default function useThrottledEffect(effect: (...arg: any) => void, timeout: number, deps: any[]) {\r\n  useEffect(() => {\r\n    const handle = setTimeout(effect, timeout)\r\n\r\n    return () => clearTimeout(handle)\r\n    // eslint-disable-next-line react-hooks/exhaustive-deps\r\n  }, [timeout, ...deps])\r\n}\r\n","import React, { MouseEventHandler } from \"react\"\nimport FlexPair from \"./FlexPair\"\nimport Toggle from \"./Toggle\"\n\ninterface LabeledToggleProps {\n  children: JSX.Element | string\n  value: boolean\n  onToggle: MouseEventHandler\n}\n\nexport default function LabeledToggle(props: LabeledToggleProps) {\n  const { children, value, onToggle } = props\n\n  return (\n    <FlexPair>\n      <Toggle value={value} onToggle={onToggle} />\n      <span>{children}</span>\n    </FlexPair>\n  )\n}\n","import React, { ChangeEventHandler, useCallback, useState } from \"react\"\r\nimport styled, { css } from \"styled-components\"\r\nimport LabeledToggle from \"../common/LabeledToggle\"\r\nimport { ThemeType } from \"../../misc/theme\"\r\nimport { RATED, RATEDTRESHOLD } from \"../../data/types\"\r\nimport usePreference from \"../../hooks/usePreference\"\r\n\r\nconst OptionsWrapper = styled.div(\r\n  ({ theme }) => css`\r\n    display: grid;\r\n    gap: ${theme.dimensions.gutter};\r\n  `\r\n)\r\n\r\nconst StyledInput = styled.input(\r\n  (props: { value: string; theme: ThemeType }) => css`\r\n    background: none;\r\n    border: none;\r\n    outline: none;\r\n    color: ${props.theme.colors.accentColor};\r\n    width: ${0.65 * props.value.length}em;\r\n    text-align: right;\r\n    font-size: ${props.theme.fontSizes.content};\r\n    margin: -1px 0.2em 0 0.2em;\r\n\r\n    ::-webkit-inner-spin-button,\r\n    ::-webkit-outer-spin-button {\r\n      -webkit-appearance: none;\r\n      margin: 0;\r\n    }\r\n    -moz-appearance: textfield;\r\n  `\r\n)\r\n\r\nexport default function Options() {\r\n  const [rated, setRated] = usePreference(RATED)\r\n  const [ratedTreshold, setRatedThreshold] = usePreference(RATEDTRESHOLD)\r\n  const toggleRated = useCallback(() => setRated(!rated), [rated, setRated])\r\n\r\n  const [ratedTresholdInternal, setRatedThresholdInternal] = useState(ratedTreshold.toString())\r\n\r\n  const onChange: ChangeEventHandler<HTMLInputElement> = useCallback(\r\n    (event) => setRatedThresholdInternal(event.target.value),\r\n    []\r\n  )\r\n  const onBlur = useCallback(() => setRatedThreshold(Number(ratedTresholdInternal)), [\r\n    ratedTresholdInternal,\r\n    setRatedThreshold,\r\n  ])\r\n\r\n  return (\r\n    <OptionsWrapper>\r\n      <LabeledToggle value={rated} onToggle={toggleRated}>\r\n        {rated ? (\r\n          <div style={{ display: \"flex\" }}>\r\n            <span>More than</span>\r\n            <StyledInput type=\"text\" value={ratedTresholdInternal} onChange={onChange} onBlur={onBlur} />\r\n            <span>likes</span>\r\n          </div>\r\n        ) : (\r\n          \"Only show Rated Posts\"\r\n        )}\r\n      </LabeledToggle>\r\n    </OptionsWrapper>\r\n  )\r\n}\r\n","import { createSelector } from \"reselect\"\r\nimport { PreferencesState } from \"./reducers/preferences\"\r\nimport { ReaderState } from \"./reducers/reader\"\r\nimport { ResultsState } from \"./reducers/results\"\r\nimport { TagsState } from \"./reducers/tags\"\r\n\r\ninterface RootState {\r\n  results: ResultsState\r\n  preferences: PreferencesState\r\n  tags: TagsState\r\n  reader: ReaderState\r\n}\r\n\r\n// Simple selectors\r\nexport const selectActiveTags = (state: RootState) => state.tags.active\r\nexport const selectResults = (state: RootState) => state.results\r\nexport const selectPosts = (state: RootState) => state.results.posts\r\nexport const selectCount = (state: RootState) => state.results.count\r\nexport const selectPageNumber = (state: RootState) => state.results.pageNumber\r\nexport const selectPreferences = (state: RootState) => state.preferences\r\nexport const selectInfinite = (state: RootState) => state.preferences.infinite\r\nexport const selectOriginals = (state: RootState) => state.preferences.originals\r\nexport const selectRated = (state: RootState) => state.preferences.rated\r\nexport const selectRatedThreshold = (state: RootState) => state.preferences.ratedTreshold\r\nexport const selectCookies = (state: RootState) => state.preferences.cookies\r\nexport const selectFullsceenState = (state: RootState) => state.reader.isEnabled\r\nexport const selectFullsceenPostId = (state: RootState) => state.reader.postId\r\nexport const selectAliases = (state: RootState) => state.tags.aliases\r\nexport const selectPageSize = (state: RootState) => state.preferences.pageSize\r\n\r\n// Memoized selectors\r\nexport const selectNumberOfActiveTags = createSelector(selectActiveTags, (tags) => Object.keys(tags).length)\r\nexport const selectAliasesAsList = createSelector(selectAliases, (aliases) => Object.values(aliases).flat())\r\n\r\nexport const selectHasResults = createSelector(selectPosts, (posts) => posts.length !== 0)\r\nexport const selectOutOfResults = createSelector(selectPosts, selectCount, (posts, count) => posts.length === count)\r\nexport const selectHasMoreResults = createSelector(selectOutOfResults, (outOfResults) => !outOfResults)\r\nexport const selectLastPage = createSelector(\r\n  selectCount,\r\n  selectPageSize,\r\n  (count, pageSize) => Math.ceil(count / pageSize) - 1\r\n)\r\n\r\n// Parameterized selectors\r\nexport const selectAliasesByTagName = (tagName: string) => (state: RootState) => state.tags.aliases[tagName]\r\n"],"sourceRoot":""}