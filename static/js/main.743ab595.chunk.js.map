{"version":3,"sources":["components/designsystem/ModifierStyledText.tsx","components/tag/TagName.tsx","components/tag/Alias.tsx","components/tag/AliasesList.tsx","components/tag/ChipWrapper.tsx","components/tag/TagChip.tsx","components/tag/Supertag.tsx","components/tag/BiasedTag.tsx","components/tag/Tag.tsx","components/tag/TagList.tsx","hooks/useToggle.ts","hooks/useToggleTag.tsx","components/tagSelector/DropdownListEntry.tsx","components/tagSelector/DropdownListError.tsx","components/tagSelector/DropdownList.tsx","components/tagSelector/TagInput.tsx","components/tagSelector/TagSelector.tsx","components/widgets/ResetButton.tsx","icons/OutOfResults.png","icons/Loading.tsx","icons/R34Icon.tsx","hooks/useModifier.tsx","components/widgets/ActiveTags.tsx","styled/mixins.tsx","hooks/useCheckIsActive.ts","hooks/useActivateTag.ts","redux/selectors.ts","components/features/ErrorBoundary.tsx","styled/themes/dark.ts","styled/themes/index.ts","styled/themes/light.ts","styled/themes/coffee.ts","styled/themes/electric.ts","styled/themes/deepsea.ts","GlobalStyles.tsx","components/pages/ErrorScreen.tsx","components/pages/LoadingScreen.tsx","components/pages/Terms.tsx","components/designsystem/Modal.tsx","icons/eeek.png","components/widgets/CellularWarningModal.tsx","components/widgets/CookieConfirmation.tsx","components/widgets/SupertagModal.tsx","analytics/events.ts","redux/middleware/persistence.ts","redux/middleware/analytics.ts","misc/api.ts","redux/middleware/requests.ts","redux/middleware/index.ts","redux/migrations.ts","redux/reducers/preferences.ts","redux/reducers/results.ts","redux/reducers/tags.ts","redux/reducers/fullscreen.ts","redux/reducers/likes.ts","redux/reducers/modals.ts","redux/reducers/suggestions.ts","redux/reducers/index.ts","redux/store.ts","App.tsx","hooks/useLoadPreferences.tsx","serviceWorkerRegistration.ts","index.tsx","data/tagUtils.ts","icons/FontAwesomeIcons.tsx","data/types.ts","components/designsystem/Buttons.tsx","firebase/analytics.ts","firebase/signIn.ts","data/encryption.ts","firebase/storage.ts","firebase/genericConverter.ts","firebase/index.ts","components/designsystem/Text.tsx","redux/actions.ts","data/utils.ts","data/browserUtils.ts","hooks/useAction.tsx","hooks/usePreference.tsx","components/designsystem/Lines.tsx","misc/formatting.ts","components/designsystem/Surface.tsx","hooks/useFirebaseAuthState.tsx","components/designsystem/FlexImage.tsx","components/designsystem/LabeledToggle.tsx","icons/TypeIcon.tsx","components/designsystem/FlexColumn.tsx","components/designsystem/Toggle.tsx","components/features/Header.tsx","components/designsystem/FlexPair.tsx"],"names":["modifierToStyle","css","ModifierStyledText","styled","span","modifier","TagName","props","name","count","tabIndex","formatTagnameAndCount","AliasWrapper","div","theme","flexRowWithGap","dimensions","bigSpacing","fontSizes","content","Alias","dispatch","useDispatch","handleClick","useCallback","event","stopPropagation","addTag","types","onClick","ListWrapper","parentRef","offsetTop","clientHeight","offsetLeft","clientWidth","borderRadius","borderWidth","colors","accentColor","backgroundColor2","backgroundColor","dropdownScrollbar","AliasesList","aliases","className","map","ChipWrapper","active","collapsed","primaryHover","focusBorderAndColor","switchingColors","gutter","blockHeight","DropdownArrow","ArrowDown","$collapsed","timings","transitionTime","TagChip","type","isActive","detailed","onContextMenu","useState","tagRef","setTagRef","useToggle","toggleCollapsed","resetCollapsed","preventDefault","handleArrowClick","handleEnter","key","handleContextMenu","React","e","onKeyDown","onMouseLeave","ref","TypeIcon","length","title","Supertag","tag","tags","Object","keys","BiasedTag","useSelector","selectAliases","getInterestingType","Tag","biasedTag","isSupertag","isBiased","bias","TagListWrapper","flexRowGap","flexColumnGap","TagList","children","onTagClick","getIsActive","onTagMenu","entries","initialValue","value","setValue","toggleValue","resetValue","useToggleTag","activeTags","selectActiveTags","removeTag","EntryWrapper","Name","Count","Icon","DropdownListEntry","unit","formatTagname","formatCount","DropdownListError","tagSelectorRef","flexColumn","tagSelector","sizeAndPosition","DropdownList","error","message","results","entry","Input","input","TagInput","onSubmit","handleChange","target","id","onChange","placeholder","TagSelectorWrapper","form","closed","AddButton","ModifierButton","TagSelector","showSupertags","setTagSelectorRef","useModifier","nextModifier","suggestions","selectSuggestions","selectSuggestionsError","activateTag","useThrottledEffect","setSuggestions","fetchSuggestions","handleAddClick","trim","sanitizedTagname","serializeTagname","suggestion","find","s","showList","ResetButton","reset","a","localStorage","clear","signOut","window","location","hash","reload","StyledSvg","svg","Loading","xmlns","xmlnsXlink","viewBox","xmlSpace","fill","stroke","cx","cy","r","attributeName","dur","values","repeatCount","begin","R34Icon","useTheme","width","size","height","transform","strokeWidth","strokeMiterlimit","strokeDasharray","strokeOpacity","fontStyle","fontWeight","fontSize","fontFamily","letterSpacing","wordSpacing","fillOpacity","x","y","fontVariant","fontStretch","order","selectSuggestionsModifier","setSuggestionsModifier","indexOf","ActiveTags","NO_OP","offerSupertags","numberOfActiveTags","selectNumberOfActiveTags","openSupertagModal","openModal","ModalId","CREATE_SUPERTAG","toggleTag","checkIsActive","useCheckIsActive","nextModifer","useEffect","defaultBorder","layer","layerBg","disabled","subduedText","accentColorHover","accentColorActive","flexColumnWithGap","gridWithGap","gap","amount","supportsGap","supportsFlexGap","centeredMaxWidth","bodyWidth","defaultBlock","flexMedia","preserveAspectRatio","supportsAspectRatio","boxShadow","shadow","radius","color","dropShadow","mediaStyle","activeSupertagsTags","selectActiveSupertagTags","useActivateTag","state","selectActiveThemeId","preferences","themeId","selectAutoPlay","autoPlay","selectCookies","cookies","selectCount","selectFullsceenIndex","fullscreen","currentIndex","selectHideSeen","hideSeen","selectOpenModalId","modals","selectOriginals","originals","selectPageNumber","pageNumber","selectPageSize","pageSize","selectPosts","posts","selectPreferences","selectPreloadVideos","preloadVideos","selectPreloadGifs","selectResultsLayout","resultsLayout","selectShowComments","showComments","selectShowMetadata","showMetadata","selectSort","sort","selectTagSuggestionCount","tagSuggestionsCount","selectUpdated","updated","selectAutoscrollDelay","autoscrollDelay","createSelector","selectAliasesAsList","flat","selectOutOfResults","selectHasMoreResults","outOfResults","selectLastPage","Math","ceil","selectFullScreenPost","fullScreenIndex","selectFullScreenIndex","fullScreenPost","selectMinRating","rated","ratedThreshold","selectSupertagModalOpen","selectedIndex","undefined","modalId","selectCellularWarningModalOpen","CELLULAR_WARNING","selectPostById","defaultMemoize","post","selectPostByIndex","index","selectLikedByPostId","tagName","likes","filter","reduce","result","ErrorBoundary","hasError","this","fallback","Component","dark","spacing","hugeSpacing","text","layerBgSolid","layerBgHighlight","liked","positive","negative","longTransitionTime","bigTitle","themes","light","coffee","electric","deepsea","defaultThemeId","createGlobalStyle","FullScreenCentered","ErrorScreen","GlobalStyles","FlexImage","src","outOfResultsPicture","alt","LoadingScreen","SectionBody","Surface","Section","FlexColumnWithSpacing","Terms","document","FlexColumn","Header","href","Wrapper","ModalSurface","Modal","close","useAction","closeModal","blockEvent","ButtonRow","CellularWarningModal","search","getResults","onConfirm","onCancel","usePreference","setAutoPlay","toggleAutoPlay","setPreloadVideos","togglePreloadVideos","setOriginals","toggleOriginals","eeek","LabeledToggle","onToggle","CookieWrapper","StyledSpan","CookieConfirmation","setCookies","handleAccept","StyledInput","SupertagModal","setName","description","setDescription","handleCreate","addSupertag","then","forEach","tagname","catch","err","console","AnalyticsEventId","saveTimeout","eventLogging","store","next","action","page_number","getState","ADD_POSTS","SET_POSTS","logEvent","SEARCH","payload","persistence","SET_PREFERENCE","clearTimeout","setTimeout","savePreferences","FETCH_PREFERENCES","firebaseFunctions","setPreferences","SAVE_PREFERENCES","sourceTags","ratingTags","api","defaultPageSize","apiLocal","apiUrl1","apiUrl2","version","activeApi","setActiveApi","searchTerm","limit","fetch","json","includeSupertags","doFuzzySearch","fetchTags","isSuggestionError","getSupertags","supertags","matchingSupertags","toLowerCase","includes","details","matchingRating","replace","matchingSourceTags","warn","minScore","firebase","auth","currentUser","getIdToken","idToken","url","buildPostUrl","headers","Authorization","apiResponse","data","encodeURIComponent","comments_url","comments","page","options","params","pid","getTagParameter","i","join","apiRequests","hasMoreResults","GET_RESULTS","minRating","getPosts","setPosts","GET_MORE_RESULTS","res","addPosts","ADD_TAG","getAliases","sanitizedAliases","b","alias","addAliases","getTags","LIKE_POST","postId","mode","FETCH_SUGGESTIONS","setSuggestionsError","FETCH_COMMENTS","getComments","setComments","middleware","composeWithDevTools","applyMiddleware","analytics","requests","migrations","reader","initialPreferencesState","setPreference","produce","draft","assign","SET_PREFERENCES","initialResultsState","Date","getTime","postCount","postIndex","findIndex","p","SET_COMMENTS","initialTagsState","newTag","forTag","REMOVE_TAG","ADD_ALIASES","initialFullscreenState","isEnabled","enterFullscreen","exitFullscreen","setIndex","initialLikesState","likePost","now","initialModalsState","setOpenModal","OPEN_MODAL","CLOSE_MODAL","initialSuggestionsState","setError","setModifier","SET_SUGGESTIONS","SET_SUGGESTIONS_ERROR","SET_SUGGESTIONS_MODIFIER","combineReducers","ENTER_FULLSCREEN","SET_FULLSCREEN_POST","EXIT_FULLSCREEN","getVersion","persistConfig","versionToNumber","storage","migrate","createMigrate","persistedReducer","persistReducer","rootReducer","createStore","persistor","persistStore","About","lazy","Privacy","Search","Settings","Share","Stories","App","loading","ThemedApp","isCellularWarningModalOpen","isSupertagModalOpen","useFirebaseAuthState","isSignedIn","fetchPreferences","useLoadPreferences","Helmet","exact","path","RouteName","ABOUT","component","PRIVACY","SETTINGS","STORIES","TERMS","SHARE","isLocalhost","Boolean","hostname","match","registerValidSW","swUrl","config","navigator","serviceWorker","register","registration","onupdatefound","installingWorker","installing","onstatechange","controller","log","onUpdate","onSuccess","Sentry","dsn","integrations","Integrations","BrowserTracing","tracesSampleRate","release","getVersionString","beforeBreadcrumb","breadcrumb","hint","category","startsWith","innerText","getAttribute","ReactDOM","render","getElementById","URL","process","origin","addEventListener","response","contentType","get","status","ready","unregister","checkValidServiceWorker","serviceWorkerRegistration","serializeAllTags","tagsByModifier","current","push","groupTagsByModifier","resolvedTags","flattenSupertags","normalTags","serializeTag","optionalTags","tagParts","t","encodeSupertag","supertag","encodeURI","m","Buffer","from","toString","decodeSupertag","base64","parts","substr","split","decodeURI","fromEntries","bindIcon","icon","faCaretDown","ArtistIcon","faPen","CalendarIcon","faCalendarDay","CharacterIcon","faUser","CheckIcon","faCheckSquare","CloseIcon","faTimes","CodeBranchIcon","faCodeBranch","CopyIcon","faCopy","CopyrightIcon","faCopyright","DeviantArtIcon","faDeviantart","DiscordIcon","faDiscord","DownloadIcon","faDownload","ExpandIcon","faExpand","ExternalLinkIcon","faExternalLinkAlt","FailedIcon","faTimesCircle","GithubIcon","faGithub","GoogleIcon","faGoogle","HeartIcon","faHeart","ImageIcon","faImage","LinkIcon","faLink","MetaDataIcon","faInfoCircle","PatreonIcon","faPatreon","PlusIcon","faPlus","RatingIcon","faRegistered","SearchIcon","faSearch","ShareIcon","faShareAlt","SignOutIcon","faSignOutAlt","SourceIcon","faHashtag","SuccessIcon","faCheckCircle","SupertagIcon","faTags","TumblrIcon","faTumblr","TwitterIcon","faTwitter","UndoIcon","faUndoAlt","WrenchIcon","faWrench","ForwardIcon","faForward","BackwardIcon","faBackward","TextButton","button","InvisButton","RedButton","BlockButton","googleAuthProvider","GoogleAuthProvider","signIn","signInWithPopup","code","sha256","msgBuffer","TextEncoder","encode","crypto","subtle","digest","hashBuffer","hashArray","Array","Uint8Array","hashHex","padStart","userConverter","snapshot","getUserDoc","email","userDoc","firestore","collection","doc","getUserData","withConverter","userSnap","userData","getPreferences","set","resetSeenPosts","snap","removeSupertag","delete","setTagsOfSupertag","update","useSupertags","setSupertags","setCollection","userInfo","col","docs","unsubscribe","onSnapshot","initializeApp","apiKey","authDomain","databaseURL","projectId","storageBucket","messagingSenderId","appId","measurementId","Title","h2","BigTitle","h1","SmallTitle","h3","Faded","fetchComments","getMoreResults","setFullscreenPost","listToMap","list","keyProp","parseUrl","majorMinorPatch","Number","download","filename","pop","Headers","Origin","blob","createElement","createObjectURL","body","appendChild","click","remove","REACT_APP_VERSION","boolToNumber","flex","style","display","flexDirection","rowGap","isSupported","scrollHeight","parentNode","removeChild","supportsObjectFit","supportsFullscreen","fullscreenEnabled","supportsNetworkInformationAPI","openFullscreen","element","fullscreenElement","requestFullscreen","Promise","resolve","actionCreator","HorizontalLine","VerticalLine","trunc","formatSource","source","host","formatDuration","duration","min","sec","z","formatDatetime","date","dd","getDate","MM","getMonth","yyyy","getFullYear","hh","getHours","mm","getMinutes","formatTime","milliseconds","formatUnit","unitSize","toFixed","unitString","authState","setAuthState","user","setUser","onAuthStateChanged","img","Track","Thumb","Toggle","role","HeaderWrapper","header","TitleBar","MenuBar","nav","LocationStyledLink","Link","to","useLocation","pathname","FlexPair"],"mappings":"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","file":"static/js/main.743ab595.chunk.js","sourcesContent":["import styled, { css } from 'styled-components'\r\nimport { TagModifier } from 'r34-types'\r\n\r\nconst modifierToStyle = {\r\n  '+': css``,\r\n  '-': css`\r\n    text-decoration: line-through;\r\n  `,\r\n  '~': css`\r\n    font-style: italic;\r\n  `,\r\n}\r\n\r\ninterface ModifierStyledTextProps {\r\n  modifier: TagModifier\r\n}\r\n\r\nexport const ModifierStyledText = styled.span(\r\n  ({ modifier = '+' }: ModifierStyledTextProps) => modifierToStyle[modifier]\r\n)\r\n","import { TagModifier } from 'r34-types'\nimport { formatTagnameAndCount } from '../../misc/formatting'\nimport { ModifierStyledText } from '../designsystem/ModifierStyledText'\n\ninterface TagNameProps {\n  modifier: TagModifier\n  name: string\n  count?: number\n}\n\nexport default function TagName(props: TagNameProps) {\n  const { modifier, name, count } = props\n\n  return (\n    <ModifierStyledText modifier={modifier} tabIndex={0}>\n      {formatTagnameAndCount(name, count)}\n    </ModifierStyledText>\n  )\n}\n","import React, { MouseEventHandler, useCallback } from 'react'\nimport { useDispatch } from 'react-redux'\nimport styled, { css } from 'styled-components'\nimport { TagModifier } from 'r34-types'\nimport { addTag } from '../../redux/actions'\nimport { flexRowWithGap } from '../../styled/mixins'\nimport TagName from './TagName'\n\ninterface AliasProps {\n  modifier: TagModifier\n  name: string\n  count: number\n}\n\nconst AliasWrapper = styled.div(\n  ({ theme }) => css`\n    ${flexRowWithGap({ theme })}\n    padding: ${theme.dimensions.bigSpacing};\n    font-size: ${theme.fontSizes.content};\n  `\n)\n\nexport default function Alias(props: AliasProps) {\n  const { name, count, modifier } = props\n\n  const dispatch = useDispatch()\n\n  const handleClick: MouseEventHandler = useCallback(\n    (event) => {\n      event.stopPropagation()\n      dispatch(addTag({ name, types: [], count, modifier }))\n    },\n    [count, dispatch, modifier, name]\n  )\n\n  return (\n    <AliasWrapper onClick={handleClick} data-name={`alias:${name}`}>\n      <TagName modifier={modifier} name={name} count={count} />\n    </AliasWrapper>\n  )\n}\n","import React from 'react'\nimport styled, { css, DefaultTheme } from 'styled-components'\nimport Alias from './Alias'\nimport * as r34 from 'r34-types'\nimport { dropdownScrollbar } from '../../styled/mixins'\n\nconst ListWrapper = styled.div(({ theme, parentRef }: { theme: DefaultTheme; parentRef: HTMLDivElement }) =>\n  parentRef\n    ? css`\n        position: absolute;\n        top: ${parentRef.offsetTop + parentRef.clientHeight + 4}px;\n        left: ${parentRef.offsetLeft}px;\n        width: ${parentRef.clientWidth + 4}px;\n\n        display: flex;\n        flex-direction: column;\n\n        border-bottom-left-radius: ${theme.dimensions.borderRadius};\n        border-bottom-right-radius: ${theme.dimensions.borderRadius};\n        border: ${theme.dimensions.borderWidth} solid ${theme.colors.accentColor};\n        border-top: none;\n\n        background: ${theme.colors.backgroundColor2};\n        z-index: 3;\n        color: ${theme.colors.backgroundColor};\n\n        > :not(:last-child) {\n          border-bottom: ${theme.dimensions.borderWidth} solid lightgray;\n        }\n\n        max-height: 30vh;\n\n        ${dropdownScrollbar}\n      `\n    : css`\n        display: none;\n      `\n)\n\ninterface AliasesListProps {\n  aliases: r34.AliasTag[]\n  modifier: r34.TagModifier\n  parentRef: HTMLDivElement\n}\n\nexport default function AliasesList(props: AliasesListProps) {\n  const { aliases, modifier, parentRef } = props\n\n  return (\n    <ListWrapper parentRef={parentRef} className='aliaslist'>\n      {aliases.map(({ name, count }) => (\n        <Alias key={'a_' + name} name={name} count={count} modifier={modifier} />\n      ))}\n    </ListWrapper>\n  )\n}\n","import { MouseEventHandler } from 'react'\nimport styled, { css, DefaultTheme } from 'styled-components'\nimport { TagIsActive } from '../../data/types'\nimport { flexRowWithGap, focusBorderAndColor, primaryHover } from '../../styled/mixins'\n\nconst dropdownBorderRadius = (collapsed: boolean, theme: DefaultTheme) =>\n  collapsed ? theme.dimensions.borderRadius : `${theme.dimensions.borderRadius} ${theme.dimensions.borderRadius} 0 0`\n\nconst switchingColors = (active: TagIsActive, collapsed: boolean, theme: DefaultTheme) => {\n  switch (active) {\n    case 'direct':\n      return css`\n        ${primaryHover}\n      `\n    case 'indirect':\n      return css`\n        color: ${theme.colors.accentColor};\n        background-color: ${theme.colors.accentColor}40;\n\n        :hover {\n          background-color: ${theme.colors.accentColor}60;\n        }\n\n        :active {\n          background-color: ${theme.colors.accentColor}50;\n        }\n\n        ${focusBorderAndColor}\n      `\n    case 'no':\n      return css`\n        color: ${theme.colors.accentColor};\n\n        :hover {\n          background-color: ${theme.colors.accentColor}40;\n        }\n\n        :active {\n          background-color: ${theme.colors.accentColor}20;\n        }\n\n        ${focusBorderAndColor}\n      `\n  }\n}\n\nexport const ChipWrapper = styled.div(\n  (props: { active: TagIsActive; collapsed: boolean; onMouseLeave: MouseEventHandler; theme: DefaultTheme }) =>\n    css`\n      cursor: pointer;\n      border: ${props.theme.colors.accentColor} ${props.theme.dimensions.borderWidth} solid;\n      ${flexRowWithGap({ theme: props.theme })}\n      ${switchingColors(props.active, props.collapsed, props.theme)}\n      padding: 0 ${props.theme.dimensions.gutter};\n      height: ${props.theme.dimensions.blockHeight};\n      border-radius: ${dropdownBorderRadius(props.collapsed, props.theme)};\n      font-size: ${props.theme.fontSizes.content};\n      user-select: none;\n\n      ${props.collapsed\n        ? ''\n        : css`\n            border-bottom-color: ${props.theme.colors.accentColor};\n          `}\n\n      .aliaslist {\n        border-color: ${props.theme.colors.backgroundColor2};\n      }\n    `\n)\n","import React, { KeyboardEventHandler, MouseEventHandler, SyntheticEvent, useCallback, useState } from 'react'\r\nimport styled, { DefaultTheme, css } from 'styled-components'\r\nimport { TagModifier, TagType, AliasTag } from 'r34-types'\r\nimport useToggle from '../../hooks/useToggle'\r\nimport { ArrowDown } from '../../icons/FontAwesomeIcons'\r\nimport TypeIcon from '../../icons/TypeIcon'\r\nimport AliasesList from './AliasesList'\r\nimport { ChipWrapper } from './ChipWrapper'\r\nimport TagName from './TagName'\r\nimport { TagIsActive } from '../../data/types'\r\n\r\nconst DropdownArrow = styled(ArrowDown)(\r\n  ({ $collapsed, theme }: { $collapsed: boolean; theme: DefaultTheme }) => css`\r\n    transition: all ${theme.timings.transitionTime} ease-out;\r\n    height: 32px;\r\n    width: 32px !important;\r\n    padding: 8px;\r\n    margin: 0 -8px;\r\n    ${$collapsed\r\n      ? css``\r\n      : css`\r\n          transform: rotate(180deg);\r\n        `}\r\n  `\r\n)\r\n\r\ninterface TagChipProps {\r\n  name: string\r\n  modifier: TagModifier\r\n  count?: number\r\n  type?: TagType\r\n  isActive: TagIsActive\r\n  detailed: boolean\r\n  onClick: React.EventHandler<SyntheticEvent>\r\n  onContextMenu?: React.EventHandler<SyntheticEvent>\r\n  aliases?: AliasTag[]\r\n}\r\n\r\nexport default function TagChip(props: TagChipProps) {\r\n  const { name, count, modifier, type, isActive, detailed, onClick, onContextMenu, aliases } = props\r\n\r\n  const [tagRef, setTagRef] = useState<HTMLDivElement | null>(null)\r\n  const [collapsed, toggleCollapsed, resetCollapsed] = useToggle(true)\r\n\r\n  const handleClick = useCallback(\r\n    (event: React.MouseEvent | React.KeyboardEvent) => {\r\n      event.preventDefault()\r\n      event.stopPropagation()\r\n      onClick(event)\r\n    },\r\n    [onClick]\r\n  )\r\n\r\n  const handleArrowClick: MouseEventHandler = useCallback(\r\n    (event) => {\r\n      event.stopPropagation()\r\n      toggleCollapsed()\r\n    },\r\n    [toggleCollapsed]\r\n  )\r\n\r\n  const handleEnter: KeyboardEventHandler = useCallback(\r\n    (event) => {\r\n      if (event.key === 'Enter') handleClick(event)\r\n    },\r\n    [handleClick]\r\n  )\r\n\r\n  const handleContextMenu = React.useCallback(\r\n    (e) => {\r\n      e.stopPropagation()\r\n      e.preventDefault()\r\n      onContextMenu?.(e)\r\n    },\r\n    [onContextMenu]\r\n  )\r\n\r\n  return (\r\n    <ChipWrapper\r\n      active={isActive}\r\n      collapsed={collapsed}\r\n      onClick={handleClick}\r\n      onKeyDown={handleEnter}\r\n      onMouseLeave={resetCollapsed}\r\n      onContextMenu={handleContextMenu}\r\n      ref={setTagRef}\r\n      tabIndex={0}\r\n    >\r\n      {detailed && <TypeIcon type={type} />}\r\n      <TagName modifier={modifier} name={name} count={count} />\r\n      {detailed && aliases && aliases.length > 0 && (\r\n        <>\r\n          <DropdownArrow onClick={handleArrowClick} $collapsed={collapsed} title='Show aliases' />\r\n          {!collapsed && tagRef && <AliasesList aliases={aliases} modifier={modifier} parentRef={tagRef} />}\r\n        </>\r\n      )}\r\n    </ChipWrapper>\r\n  )\r\n}\r\n","import React from 'react'\r\nimport * as r34 from 'r34-types'\r\nimport TagChip from './TagChip'\r\nimport { TagIsActive } from '../../data/types'\r\n\r\ninterface SupertagProps {\r\n  tag: r34.Supertag\r\n  isActive: TagIsActive\r\n  detailed: boolean\r\n  onClick: React.MouseEventHandler\r\n}\r\n\r\nexport default function Supertag(props: SupertagProps) {\r\n  const { tag, isActive, detailed, onClick } = props\r\n  const { name, tags } = tag\r\n\r\n  const count = Object.keys(tags).length\r\n\r\n  return (\r\n    <TagChip\r\n      name={name}\r\n      modifier='+'\r\n      type='supertag'\r\n      count={count}\r\n      isActive={isActive}\r\n      detailed={detailed}\r\n      onClick={onClick}\r\n    />\r\n  )\r\n}\r\n","import * as r34 from 'r34-types'\r\nimport TagChip from './TagChip'\r\nimport { getInterestingType } from '../../data/tagUtils'\r\nimport { TagIsActive } from '../../data/types'\r\nimport { useSelector } from 'react-redux'\r\nimport { selectAliases } from '../../redux/selectors'\r\n\r\ninterface TagProps {\r\n  tag: r34.BiasedTag\r\n  isActive: TagIsActive\r\n  detailed: boolean\r\n  onClick: React.MouseEventHandler\r\n  onContextMenu: React.MouseEventHandler\r\n}\r\n\r\nexport function BiasedTag(props: TagProps) {\r\n  const { tag, detailed, onClick, isActive, onContextMenu } = props\r\n  const { name, count, modifier, types } = tag\r\n\r\n  const aliases = useSelector(selectAliases)[name]\r\n\r\n  return (\r\n    <TagChip\r\n      name={name}\r\n      modifier={modifier}\r\n      type={getInterestingType(types)}\r\n      count={count}\r\n      isActive={isActive}\r\n      detailed={detailed}\r\n      onClick={onClick}\r\n      onContextMenu={onContextMenu}\r\n      aliases={aliases}\r\n    />\r\n  )\r\n}\r\n","import React, { MouseEventHandler, useCallback } from 'react'\r\nimport * as r34 from 'r34-types'\r\nimport { bias, isBiased, isSupertag } from '../../data/tagUtils'\r\nimport Supertag from './Supertag'\r\nimport { BiasedTag } from './BiasedTag'\r\nimport { TagIsActive } from '../../data/types'\r\n\r\ninterface TagProps {\r\n  tag: r34.AnyBiasedTag | r34.AnyTag\r\n  isActive: TagIsActive\r\n  detailed: boolean\r\n  onClick: (tag: r34.AnyBiasedTag) => void\r\n  onContextMenu: (tag: r34.AnyBiasedTag) => void\r\n}\r\n\r\nexport default function Tag(props: TagProps) {\r\n  const { tag, isActive, detailed, onClick, onContextMenu } = props\r\n\r\n  const biasedTag = isSupertag(tag) || isBiased(tag) ? tag : bias(tag, '+')\r\n\r\n  const handleClick: MouseEventHandler = useCallback(\r\n    (event) => {\r\n      event?.stopPropagation()\r\n      onClick(biasedTag)\r\n    },\r\n    [onClick, biasedTag]\r\n  )\r\n\r\n  const handleContextMenu: MouseEventHandler = useCallback(\r\n    (event) => {\r\n      onContextMenu(biasedTag)\r\n    },\r\n    [biasedTag, onContextMenu]\r\n  )\r\n\r\n  return isSupertag(biasedTag) ? (\r\n    <Supertag tag={biasedTag} isActive={isActive} detailed={detailed} onClick={handleClick} />\r\n  ) : (\r\n    <BiasedTag\r\n      tag={biasedTag}\r\n      isActive={isActive}\r\n      detailed={detailed}\r\n      onClick={handleClick}\r\n      onContextMenu={handleContextMenu}\r\n    />\r\n  )\r\n}\r\n","import React from 'react'\r\nimport styled, { css } from 'styled-components'\r\nimport { AnyBiasedTag, AnyTag } from 'r34-types'\r\nimport { flexRowGap, flexColumnGap } from '../../styled/mixins'\r\nimport Tag from './Tag'\r\nimport { TagIsActive } from '../../data/types'\r\n\r\nconst TagListWrapper = styled.div(\r\n  ({ theme }) => css`\r\n    display: inline-flex;\r\n    flex-wrap: wrap;\r\n    ${flexRowGap(theme.dimensions.gutter)}\r\n    ${flexColumnGap(theme.dimensions.gutter)}\r\n  `\r\n)\r\n\r\ninterface TagListProps {\r\n  /**\r\n   * The entries of the list. Must be a map to avoid duplicates\r\n   */\r\n  tags: Record<string, AnyTag>\r\n  /**\r\n   * Passthrough classname for styling from outside\r\n   */\r\n  className?: string\r\n  /**\r\n   * Setting detailed to true displays a type for some tags and provides the ability to add aliases.\r\n   */\r\n  detailed: boolean\r\n  /**\r\n   * Children will be added at the end of the list. Here you can provide additional functionality or information\r\n   */\r\n  children?: React.ReactNode\r\n\r\n  onTagClick: (tag: AnyBiasedTag) => void\r\n  onTagMenu: (tag: AnyBiasedTag) => void\r\n  getIsActive?: (tag: AnyTag) => TagIsActive\r\n}\r\n\r\n/**\r\n * This component can be used to display multiple tags in a list of chips/badges.\r\n *\r\n */\r\nexport default function TagList(props: TagListProps) {\r\n  const { tags, className, detailed, children = null, onTagClick, getIsActive, onTagMenu } = props\r\n\r\n  return (\r\n    <TagListWrapper className={className}>\r\n      {Object.entries(tags).map(([key, tag]) => (\r\n        <Tag\r\n          key={key}\r\n          detailed={detailed}\r\n          tag={tag}\r\n          onClick={onTagClick}\r\n          onContextMenu={onTagMenu}\r\n          isActive={getIsActive?.(tag) || 'no'}\r\n        />\r\n      ))}\r\n      {children}\r\n    </TagListWrapper>\r\n  )\r\n}\r\n","import { useCallback, useState } from 'react'\n\n/**\n * A small wrapper for a useState<boolean> that is primarily used for toggling.\n * Saves me a few useCallbacks.\n */\nexport default function useToggle(initialValue = false): [boolean, () => void, () => void] {\n  const [value, setValue] = useState<boolean>(initialValue)\n  const toggleValue = useCallback(() => setValue(!value), [value])\n  const resetValue = useCallback(() => setValue(initialValue), [initialValue])\n\n  return [value, toggleValue, resetValue]\n}\n","import { useCallback } from 'react'\r\nimport { useDispatch, useSelector } from 'react-redux'\r\nimport { removeTag, addTag } from '../redux/actions'\r\nimport { selectActiveTags } from '../redux/selectors'\r\nimport * as r34 from 'r34-types'\r\n\r\n/**\r\n * This hook allows you to add a tag to your search or remove it based on its current status.\r\n */\r\nexport default function useToggleTag() {\r\n  const dispatch = useDispatch()\r\n  const activeTags = useSelector(selectActiveTags)\r\n  const toggleTag = useCallback(\r\n    (tag: r34.AnyBiasedTag) => {\r\n      if (tag.name in activeTags) {\r\n        dispatch(removeTag(tag.name))\r\n      } else {\r\n        dispatch(addTag(tag))\r\n      }\r\n    },\r\n    [activeTags, dispatch]\r\n  )\r\n\r\n  return toggleTag\r\n}\r\n","import React from 'react'\nimport * as r34 from 'r34-types'\nimport styled, { css } from 'styled-components'\nimport { CountUnit } from '../../data/types'\nimport TypeIcon from '../../icons/TypeIcon'\nimport { formatCount, formatTagname } from '../../misc/formatting'\n\nconst EntryWrapper = styled.div(\n  ({ theme }) => css`\n    display: grid;\n    grid-template-columns: 48px 1fr auto;\n    background: ${theme.colors.backgroundColor2};\n    padding: ${theme.dimensions.bigSpacing} 0;\n    align-items: center;\n    cursor: pointer;\n  `\n)\n\nconst Name = styled.span`\n  grid-column: 2/3;\n`\n\nconst Count = styled.span(\n  ({ theme }) => css`\n    grid-column: 3/4;\n    padding-right: ${theme.dimensions.bigSpacing};\n  `\n)\n\nconst Icon = styled.div`\n  grid-column: 1/2;\n  text-align: center;\n`\n\ninterface EntryProps {\n  name: string\n  count: number\n  type?: r34.TagType\n  onClick: React.MouseEventHandler\n}\n\nexport default function DropdownListEntry(props: EntryProps) {\n  const { name, count, type, onClick } = props\n\n  const unit: CountUnit = type === 'supertag' ? 'tags' : 'posts'\n\n  return (\n    <EntryWrapper onClick={onClick}>\n      <Icon>\n        <TypeIcon type={type} />\n      </Icon>\n      <Name>{formatTagname(name)}</Name>\n      <Count title={`${count} ${unit}`}>\n        {count && formatCount(count)} {unit}\n      </Count>\n    </EntryWrapper>\n  )\n}\n","import styled, { css } from 'styled-components'\r\nimport { flexRowWithGap } from '../../styled/mixins'\r\n\r\nexport const DropdownListError = styled.div(\r\n  ({ theme }) => css`\r\n    ${flexRowWithGap}\r\n    flex-wrap: wrap;\r\n    min-height: ${theme.dimensions.blockHeight}; // COMPAT: Kiwi Browser\r\n    background: ${theme.colors.backgroundColor2};\r\n    padding: 6px;\r\n    align-items: center;\r\n    justify-content: center;\r\n    text-align: center;\r\n    cursor: pointer;\r\n  `\r\n)\r\n","import React from 'react'\nimport styled, { css, DefaultTheme } from 'styled-components'\nimport DropdownListEntry from './DropdownListEntry'\nimport { dropdownScrollbar, flexColumn, flexColumnGap } from '../../styled/mixins'\nimport * as r34 from 'r34-types'\nimport { getInterestingType, isSupertag } from '../../data/tagUtils'\nimport { SuggestionsError } from '../../data/types'\nimport { DropdownListError } from './DropdownListError'\n\nfunction sizeAndPosition(tagSelector: HTMLElement | null) {\n  if (tagSelector) {\n    const { offsetTop, clientHeight, offsetLeft, clientWidth } = tagSelector\n\n    return css`\n      position: absolute;\n      top: ${offsetTop + clientHeight}px;\n      left: ${offsetLeft}px;\n      width: ${clientWidth}px;\n      max-height: 50vh;\n    `\n  } else {\n    return css`\n      display: none;\n    `\n  }\n}\n\nconst ListWrapper = styled.div(\n  ({ theme, tagSelectorRef }: { tagSelectorRef: HTMLElement | null; theme: DefaultTheme }) => css`\n    ${flexColumn()}\n    ${flexColumnGap('1px')}\n    ${sizeAndPosition(tagSelectorRef)};\n    background: lightgrey;\n    box-sizing: border-box;\n    border: ${theme.dimensions.borderWidth} ${theme.colors.accentColor} solid;\n    border-top: none;\n    border-radius: 0 0 3px 3px;\n    color: black;\n    z-index: 3;\n\n    ${dropdownScrollbar}\n  `\n)\n\ninterface DropdownListProps {\n  tagSelectorRef: HTMLElement | null\n  entries: r34.AnyTag[]\n  onClick: (entry: r34.AnyTag) => void\n  error: SuggestionsError | null\n}\n\nexport default function DropdownList(props: DropdownListProps) {\n  const { tagSelectorRef, entries, onClick, error } = props\n\n  return (\n    <ListWrapper tagSelectorRef={tagSelectorRef}>\n      {error ? (\n        <DropdownListError>\n          <span>{error.message}.</span>\n          <span>{error.results} tags found</span>\n        </DropdownListError>\n      ) : (\n        entries.map((entry) => {\n          const type = isSupertag(entry) ? 'supertag' : getInterestingType(entry.types)\n          const count = isSupertag(entry) ? Object.keys(entry.tags).length : (entry.count as number)\n\n          return (\n            <DropdownListEntry\n              key={entry.name}\n              onClick={() => onClick(entry)}\n              name={entry.name}\n              type={type}\n              count={count}\n            />\n          )\n        })\n      )}\n    </ListWrapper>\n  )\n}\n","import React, { ChangeEventHandler, KeyboardEventHandler, useCallback } from 'react'\nimport styled, { css } from 'styled-components'\n\nconst Input = styled.input(\n  (props) => css`\n    width: 100%;\n    border: none;\n    outline: none;\n    background: none;\n    font-size: ${props.theme.fontSizes.content};\n    border-top: ${props.theme.colors.accentColor} ${props.theme.dimensions.borderWidth} solid;\n    border-bottom: ${props.theme.colors.accentColor} ${props.theme.dimensions.borderWidth} solid;\n  `\n)\n\ninterface TagInputProps {\n  value: string\n  setValue: (newValue: string) => void\n  onSubmit: () => void\n}\n\nexport default function TagInput(props: TagInputProps) {\n  const { value, setValue, onSubmit } = props\n\n  const handleChange: ChangeEventHandler<HTMLInputElement> = useCallback(\n    (event) => {\n      setValue(event.target.value)\n    },\n    [setValue]\n  )\n\n  const handleEnter: KeyboardEventHandler = useCallback(\n    (event: React.KeyboardEvent) => {\n      if (event.key === 'Enter') {\n        onSubmit()\n      }\n    },\n    [onSubmit]\n  )\n\n  return (\n    <Input\n      id='tag-input'\n      value={value}\n      onChange={handleChange}\n      onKeyDown={handleEnter}\n      placeholder='Search for tags'\n      aria-label='Search'\n    />\n  )\n}\n","import React from 'react'\nimport * as r34 from 'r34-types'\nimport { useDispatch, useSelector } from 'react-redux'\nimport styled, { css, DefaultTheme } from 'styled-components'\nimport useThrottledEffect from 'use-throttled-effect'\nimport { bias, isSupertag, serializeTagname } from '../../data/tagUtils'\nimport useModifier from '../../hooks/useModifier'\nimport { PlusIcon } from '../../icons/FontAwesomeIcons'\nimport { fetchSuggestions, setSuggestions } from '../../redux/actions'\nimport { selectSuggestions, selectSuggestionsError } from '../../redux/selectors'\nimport { AddButton, ModifierButton } from '../designsystem/Buttons'\nimport DropdownList from './DropdownList'\nimport TagInput from './TagInput'\n\nconst TagSelectorWrapper = styled.form(\n  (props: { closed: boolean; ref: (ref: HTMLInputElement) => void; theme: DefaultTheme }) => css`\n    display: flex;\n    background: white;\n    ${props.closed\n      ? css`\n          border-radius: ${props.theme.dimensions.borderRadius};\n        `\n      : css`\n          border-radius: ${props.theme.dimensions.borderRadius} ${props.theme.dimensions.borderRadius} 0 0;\n\n          > ${AddButton} {\n            border-radius: 0 ${props.theme.dimensions.borderRadius} 0 0;\n          }\n\n          > ${ModifierButton} {\n            border-radius: ${props.theme.dimensions.borderRadius} 0 0 0;\n          }\n        `}\n  `\n)\n\ninterface TagSelectorProps {\n  showSupertags: boolean\n  onSubmit: (tag: r34.AnyBiasedTag) => void\n}\n\nexport default function TagSelector(props: TagSelectorProps) {\n  const { onSubmit, showSupertags } = props\n\n  const dispatch = useDispatch()\n\n  const [value, setValue] = React.useState('')\n  const [tagSelectorRef, setTagSelectorRef] = React.useState<HTMLElement | null>(null)\n  const [modifier, nextModifier] = useModifier()\n\n  const suggestions = useSelector(selectSuggestions)\n  const error = useSelector(selectSuggestionsError)\n\n  const activateTag = React.useCallback(\n    (tag: r34.Tag | r34.Supertag) => {\n      const biasedTag = isSupertag(tag) ? tag : bias(tag, modifier)\n      onSubmit(biasedTag)\n      setValue('')\n    },\n    [modifier, onSubmit]\n  )\n\n  // This effect updates suggestions based on the input value\n  // if the value is empty, it clears suggestions\n  // if the value is not empty, it fetches suggestions from the backend\n  useThrottledEffect(\n    () => {\n      if (value === '') {\n        if (suggestions.length > 0) {\n          dispatch(setSuggestions([]))\n        }\n      } else {\n        dispatch(fetchSuggestions(value, showSupertags))\n      }\n    },\n    300,\n    [value]\n  )\n\n  const handleAddClick = React.useCallback(() => {\n    if (value.trim()) {\n      const sanitizedTagname = serializeTagname(value)\n      const suggestion: r34.AnyTag | undefined = suggestions.find((s) => s.name === sanitizedTagname)\n\n      if (suggestion) {\n        activateTag(suggestion)\n      } else {\n        activateTag({ name: sanitizedTagname, types: [] })\n      }\n    }\n  }, [value, activateTag, suggestions])\n\n  const showList = suggestions.length > 0 || error !== null\n\n  const preventDefault = React.useCallback((e) => e.preventDefault(), [])\n\n  return (\n    <TagSelectorWrapper ref={setTagSelectorRef} closed={!showList} onSubmit={preventDefault}>\n      <ModifierButton onClick={nextModifier} aria-label='Tag Modifier' title='Cycle tag modifier'>\n        {modifier}\n      </ModifierButton>\n      <TagInput value={value} setValue={setValue} onSubmit={handleAddClick} />\n      <AddButton onClick={handleAddClick} aria-label='Add Tag'>\n        <PlusIcon title='Add tag' />\n      </AddButton>\n      {showList && value.length > 0 && (\n        <DropdownList tagSelectorRef={tagSelectorRef} entries={suggestions} error={error} onClick={activateTag} />\n      )}\n    </TagSelectorWrapper>\n  )\n}\n","import React, { useCallback } from 'react'\r\nimport { signOut } from '../../firebase'\r\nimport { UndoIcon } from '../../icons/FontAwesomeIcons'\r\nimport { BlockButton } from '../designsystem/Buttons'\r\n\r\nexport default function ResetButton(props: any) {\r\n  const reset = useCallback(async () => {\r\n    localStorage.clear()\r\n    await signOut()\r\n\r\n    window.location.hash = ''\r\n    window.location.reload()\r\n  }, [])\r\n\r\n  return (\r\n    <BlockButton onClick={reset} {...props}>\r\n      <UndoIcon /> Reset Application\r\n    </BlockButton>\r\n  )\r\n}\r\n","export default __webpack_public_path__ + \"static/media/OutOfResults.9c71691c.png\";","import React from 'react'\nimport styled from 'styled-components'\n\n// Don't use theme here so the loadingScreen is independent\n// eg. Loading the theme displays this loading screen\nconst StyledSvg = styled.svg`\n  height: 32px;\n  padding: 8px;\n  color: white;\n`\n\nexport default function Loading() {\n  return (\n    <StyledSvg\n      xmlns='http://www.w3.org/2000/svg'\n      xmlnsXlink='http://www.w3.org/1999/xlink'\n      viewBox='0 0 50 20'\n      enable-background='new 0 0 0 0'\n      xmlSpace='preserve'\n    >\n      <circle fill='currentcolor' stroke='none' cx='6' cy='10' r='6'>\n        <animate attributeName='opacity' dur='1s' values='0;1;0' repeatCount='indefinite' begin='0.1' />\n      </circle>\n      <circle fill='currentcolor' stroke='none' cx='25' cy='10' r='6'>\n        <animate attributeName='opacity' dur='1s' values='0;1;0' repeatCount='indefinite' begin='0.2' />\n      </circle>\n      <circle fill='currentcolor' stroke='none' cx='44' cy='10' r='6'>\n        <animate attributeName='opacity' dur='1s' values='0;1;0' repeatCount='indefinite' begin='0.3' />\n      </circle>\n    </StyledSvg>\n  )\n}\n","import { useTheme } from 'styled-components'\n\nexport default function R34Icon(props: { size: number; className?: string }) {\n  const theme = useTheme()\n\n  return (\n    <svg\n      xmlns='http://www.w3.org/2000/svg'\n      width={props.size}\n      height={props.size}\n      viewBox='0 0 12.7 12.7'\n      className={props.className}\n    >\n      <g transform='translate(0,-284.3)'>\n        <circle\n          id='path18'\n          cx='6.3499999'\n          cy='290.65002'\n          fill='none'\n          stroke={theme.colors.accentColor}\n          strokeWidth='0.50848764'\n          strokeMiterlimit='4'\n          strokeDasharray='none'\n          strokeOpacity='1'\n          r='6.0957561'\n        />\n        <text\n          fontStyle='normal'\n          fontWeight='normal'\n          fontSize='8.3113203px'\n          fontFamily='sansSerif'\n          letterSpacing='0px'\n          wordSpacing='0px'\n          fill={theme.colors.accentColor}\n          fillOpacity='1'\n          x='2.1363549'\n          y='289.02704'\n          id='text4533'\n          transform='scale(0.98538224,1.0148346)'\n        >\n          <tspan\n            id='tspan4531'\n            x='2'\n            y='289.1'\n            fontStyle='normal'\n            fontVariant='normal'\n            fontWeight='300'\n            fontStretch='normal'\n            fontFamily='Calibri'\n            fill={theme.colors.accentColor}\n            fillOpacity='1'\n          >\n            34\n          </tspan>\n        </text>\n      </g>\n    </svg>\n  )\n}\n","import { useCallback } from 'react'\nimport { TagModifier } from 'r34-types'\nimport { useDispatch, useSelector } from 'react-redux'\nimport { selectSuggestionsModifier } from '../redux/selectors'\nimport { setSuggestionsModifier } from '../redux/actions'\n\nconst order: TagModifier[] = ['+', '-', '~']\n\n/**\n * Small utility hook to abstract the rotating modifier away\n */\nexport default function useModifier() {\n  const dispatch = useDispatch()\n  const modifier = useSelector(selectSuggestionsModifier)\n  const nextModifier = useCallback(\n    () => dispatch(setSuggestionsModifier(order[(order.indexOf(modifier) + 1) % order.length])),\n    [dispatch, modifier]\n  )\n\n  return [modifier, nextModifier] as const\n}\n","import React, { useCallback, useEffect } from 'react'\nimport * as r34 from 'r34-types'\nimport { useDispatch, useSelector } from 'react-redux'\nimport { isSupertag } from '../../data/tagUtils'\nimport { ModalId, NO_OP } from '../../data/types'\nimport { useCheckIsActive } from '../../hooks/useCheckIsActive'\nimport useToggleTag from '../../hooks/useToggleTag'\nimport { SupertagIcon } from '../../icons/FontAwesomeIcons'\nimport { addTag, openModal } from '../../redux/actions'\nimport { selectActiveTags, selectNumberOfActiveTags } from '../../redux/selectors'\nimport { RedButton } from '../designsystem/Buttons'\nimport TagList from '../tag/TagList'\n\ninterface ActiveTagsProps {\n  onChange?: () => void\n  offerSupertags?: boolean\n}\n\nexport default function ActiveTags(props: ActiveTagsProps) {\n  const { onChange = NO_OP, offerSupertags = false } = props\n\n  const dispatch = useDispatch()\n\n  const activeTags = useSelector(selectActiveTags)\n  const numberOfActiveTags = useSelector(selectNumberOfActiveTags)\n  const openSupertagModal = useCallback(() => dispatch(openModal(ModalId.CREATE_SUPERTAG)), [dispatch])\n\n  const toggleTag = useToggleTag()\n  const checkIsActive = useCheckIsActive()\n\n  const onTagMenu = React.useCallback(\n    (tag: r34.AnyBiasedTag) => {\n      if (!isSupertag(tag)) {\n        const order: r34.TagModifier[] = ['+', '-', '~']\n        const nextModifer = order[(order.indexOf(tag.modifier) + 1) % 3]\n        dispatch(addTag({ ...tag, modifier: nextModifer }))\n      }\n    },\n    [dispatch]\n  )\n\n  // Fire change event when tags change\n  // This is used to re-measure the height\n  useEffect(() => onChange(), [onChange, activeTags])\n\n  return numberOfActiveTags > 0 ? (\n    <TagList tags={activeTags} onTagClick={toggleTag} getIsActive={checkIsActive} onTagMenu={onTagMenu} detailed>\n      {offerSupertags && Object.keys(activeTags).length > 1 && (\n        <RedButton onClick={openSupertagModal} title='Create a supertag'>\n          <SupertagIcon />\n        </RedButton>\n      )}\n    </TagList>\n  ) : null\n}\n","import { css, DefaultTheme } from 'styled-components'\r\nimport { supportsAspectRatio, supportsFlexGap, supportsGap } from '../data/browserUtils'\r\n\r\nexport interface PropsWithTheme {\r\n  theme: DefaultTheme\r\n}\r\n\r\nexport interface SupportsDisable {\r\n  disabled: boolean\r\n}\r\n\r\n/**\r\n * Gives elements a border TODO: rename to defaultborder\r\n */\r\nexport function defaultBorder({ theme }: PropsWithTheme) {\r\n  return css`\r\n    border-color: ${theme.colors.accentColor};\r\n    border-width: ${theme.dimensions.borderWidth};\r\n    ${borderRadius({ theme })}\r\n    border-style: solid;\r\n  `\r\n}\r\n\r\n/**\r\n * Element will look like a new layer\r\n */\r\nexport function layer({ theme }: PropsWithTheme) {\r\n  return css`\r\n    background-color: ${theme.colors.layerBg};\r\n  `\r\n}\r\n\r\n/**\r\n * Element becomes accentColor on hover, and is highlighted when active/focused\r\n */\r\nexport function primaryHover({ theme, disabled }: PropsWithTheme & Partial<SupportsDisable>) {\r\n  return disabled\r\n    ? css`\r\n        color: ${theme.colors.backgroundColor};\r\n        border-color: transparent;\r\n        background-color: ${theme.colors.subduedText};\r\n      `\r\n    : css`\r\n        color: ${theme.colors.backgroundColor};\r\n        border-color: ${theme.colors.accentColor};\r\n        background-color: ${theme.colors.accentColor};\r\n\r\n        transition: color ${theme.timings.transitionTime} linear, border-color ${theme.timings.transitionTime} linear,\r\n          background-color ${theme.timings.transitionTime} linear;\r\n\r\n        :hover {\r\n          border-color: ${theme.colors.accentColorHover};\r\n          background-color: ${theme.colors.accentColorHover};\r\n        }\r\n\r\n        :active {\r\n          border-color: ${theme.colors.accentColorActive};\r\n          background-color: ${theme.colors.accentColorActive};\r\n        }\r\n\r\n        ${focusBorderAndColor}\r\n      `\r\n}\r\n\r\nexport function focusBorderAndColor({ theme }: PropsWithTheme) {\r\n  return css`\r\n    :focus,\r\n    :focus-within {\r\n      color: ${theme.colors.backgroundColor2};\r\n      border-color: ${theme.colors.backgroundColor2};\r\n    }\r\n  `\r\n}\r\n\r\nexport function flexColumn() {\r\n  return css`\r\n    display: flex;\r\n    flex-direction: column;\r\n  `\r\n}\r\n\r\nexport function flexColumnWithGap({ theme }: PropsWithTheme) {\r\n  return css`\r\n    display: flex;\r\n    flex-direction: column;\r\n    ${flexColumnGap(theme.dimensions.gutter)};\r\n  `\r\n}\r\n\r\nexport function gridWithGap({ theme }: PropsWithTheme) {\r\n  return css`\r\n    display: grid;\r\n    ${gap(theme.dimensions.gutter)}\r\n  `\r\n}\r\n\r\nexport function flexRowWithGap({ theme }: PropsWithTheme) {\r\n  return css`\r\n    display: flex;\r\n    align-items: center;\r\n    ${flexRowGap(theme.dimensions.gutter)};\r\n  `\r\n}\r\n\r\nexport function gap(amount: string) {\r\n  return supportsGap\r\n    ? css`\r\n        gap: ${amount};\r\n      `\r\n    : css`\r\n        > :not(:last-child) {\r\n          margin-right: ${amount};\r\n          margin-bottom: ${amount};\r\n        }\r\n      `\r\n}\r\n\r\nexport function flexRowGap(amount: string) {\r\n  return supportsFlexGap\r\n    ? css`\r\n        gap: ${amount};\r\n      `\r\n    : css`\r\n        > :not(:last-child) {\r\n          margin-right: ${amount};\r\n        }\r\n      `\r\n}\r\n\r\nexport function flexColumnGap(amount: string) {\r\n  return supportsFlexGap\r\n    ? css`\r\n        gap: ${amount};\r\n      `\r\n    : css`\r\n        > :not(:last-child) {\r\n          margin-bottom: ${amount};\r\n        }\r\n      `\r\n}\r\n\r\n/**\r\n * Default spacing for grid and flex\r\n */\r\nexport function gutter({ theme }: PropsWithTheme) {\r\n  return css`\r\n    ${gap(theme.dimensions.gutter)};\r\n    padding: ${theme.dimensions.gutter};\r\n  `\r\n}\r\n\r\n/**\r\n * Limits content to a maximum width and centers it\r\n */\r\nexport function centeredMaxWidth({ theme }: PropsWithTheme) {\r\n  return css`\r\n    width: 100%;\r\n    max-width: ${theme.dimensions.bodyWidth};\r\n    margin-left: auto;\r\n    margin-right: auto;\r\n  `\r\n}\r\n\r\n/**\r\n * Fixed height and padding\r\n */\r\nexport function defaultBlock({ theme }: PropsWithTheme) {\r\n  return css`\r\n    height: ${theme.dimensions.blockHeight};\r\n    padding: 0 ${theme.dimensions.gutter};\r\n  `\r\n}\r\n\r\n/**\r\n * Preserves aspect ratio of the element and ensures it is displayed as big as possible\r\n */\r\nexport function flexMedia() {\r\n  return css`\r\n    width: 100%;\r\n    height: 100%;\r\n    display: block;\r\n    object-fit: contain;\r\n  `\r\n}\r\n\r\ninterface Size {\r\n  width: number\r\n  height: number\r\n}\r\n\r\nexport function preserveAspectRatio({ width, height }: Partial<Size>) {\r\n  if (!width || !height) {\r\n    return ''\r\n  }\r\n\r\n  return supportsAspectRatio\r\n    ? css`\r\n        aspect-ratio: ${width} / ${height};\r\n      `\r\n    : css`\r\n        max-width: 100%;\r\n        height: auto;\r\n      `\r\n}\r\n\r\nexport function borderRadius({ theme }: PropsWithTheme) {\r\n  return css`\r\n    border-radius: ${theme.dimensions.borderRadius};\r\n  `\r\n}\r\n\r\nexport function boxShadow({ theme }: PropsWithTheme) {\r\n  return css`\r\n    box-shadow: 0 1px ${theme.shadow.radius} ${theme.shadow.color};\r\n  `\r\n}\r\n\r\nexport function dropShadow({ theme }: PropsWithTheme) {\r\n  return css`\r\n    filter: drop-shadow(0 1px ${theme.shadow.radius} ${theme.shadow.color});\r\n  `\r\n}\r\n\r\nexport function mediaStyle() {\r\n  return css`\r\n    ${borderRadius}\r\n    ${boxShadow}\r\n    grid-area: 1/1/2/2;\r\n    z-index: 1;\r\n  `\r\n}\r\n\r\nexport function dropdownScrollbar({ theme }: PropsWithTheme) {\r\n  return css`\r\n    overflow-x: hidden;\r\n    overflow-y: auto;\r\n\r\n    ::-webkit-scrollbar {\r\n      width: 8px;\r\n\r\n      :hover {\r\n        background: ${theme.colors.layerBg};\r\n      }\r\n    }\r\n\r\n    /* Track */\r\n    ::-webkit-scrollbar-track {\r\n      background: ${theme.colors.backgroundColor2};\r\n      border-left: 1px lightgray solid;\r\n    }\r\n\r\n    /* Handle */\r\n    :hover {\r\n      ::-webkit-scrollbar {\r\n        background: ${theme.colors.backgroundColor}20;\r\n      }\r\n    }\r\n\r\n    ::-webkit-scrollbar-thumb {\r\n      background: ${theme.colors.backgroundColor}40;\r\n      border-radius: 100px;\r\n\r\n      :hover {\r\n        background: ${theme.colors.backgroundColor}30;\r\n      }\r\n    }\r\n  `\r\n}\r\n","import { useCallback } from 'react'\r\nimport { useSelector } from 'react-redux'\r\nimport { AnyTag } from 'r34-types'\r\nimport { TagIsActive } from '../data/types'\r\nimport { selectActiveSupertagTags, selectActiveTags } from '../redux/selectors'\r\n\r\nexport const useCheckIsActive = () => {\r\n  const activeTags = useSelector(selectActiveTags)\r\n  const activeSupertagsTags = useSelector(selectActiveSupertagTags)\r\n\r\n  return useCallback(\r\n    (tag: AnyTag): TagIsActive => {\r\n      if (tag.name in activeTags) return 'direct'\r\n      if (tag.name in activeSupertagsTags) return 'indirect'\r\n      else return 'no'\r\n    },\r\n    [activeSupertagsTags, activeTags]\r\n  )\r\n}\r\n","import * as r34 from 'r34-types'\r\nimport { useCallback } from 'react'\r\nimport { useDispatch } from 'react-redux'\r\nimport { addTag } from '../redux/actions'\r\n\r\nexport const useActivateTag = () => {\r\n  const dispatch = useDispatch()\r\n\r\n  return useCallback(\r\n    (tag: r34.AnyBiasedTag) => {\r\n      dispatch(addTag(tag))\r\n    },\r\n    [dispatch]\r\n  )\r\n}\r\n","import * as r34 from 'r34-types'\r\nimport { createSelector, defaultMemoize } from 'reselect'\r\nimport { isSupertag } from '../data/tagUtils'\r\nimport { ModalId } from '../data/types'\r\nimport { AppState } from './appState'\r\n\r\n// Simple selectors\r\nexport const selectActiveTags = (state: AppState) => state.tags.active\r\nexport const selectActiveThemeId = (state: AppState) => state.preferences.themeId\r\nexport const selectAliases = (state: AppState) => state.tags.aliases\r\nexport const selectAutoPlay = (state: AppState) => state.preferences.autoPlay\r\nexport const selectCookies = (state: AppState) => state.preferences.cookies\r\nexport const selectCount = (state: AppState) => state.results.count\r\nexport const selectFullsceenIndex = (state: AppState) => state.fullscreen.currentIndex\r\nexport const selectFullsceenState = (state: AppState) => state.fullscreen.isEnabled\r\nexport const selectHideSeen = (state: AppState) => state.preferences.hideSeen\r\nexport const selectOpenModalId = (state: AppState) => state.modals.openModal\r\nexport const selectOriginals = (state: AppState) => state.preferences.originals\r\nexport const selectPageNumber = (state: AppState) => state.results.pageNumber\r\nexport const selectPageSize = (state: AppState) => state.preferences.pageSize\r\nexport const selectPosts = (state: AppState) => state.results.posts\r\nexport const selectPreferences = (state: AppState) => state.preferences\r\nexport const selectPreloadVideos = (state: AppState) => state.preferences.preloadVideos\r\nexport const selectPreloadGifs = (state: AppState) => state.preferences.preloadVideos\r\nexport const selectRated = (state: AppState) => state.preferences.rated\r\nexport const selectRatedThreshold = (state: AppState) => state.preferences.ratedThreshold\r\nexport const selectResults = (state: AppState) => state.results\r\nexport const selectResultsLayout = (state: AppState) => state.preferences.resultsLayout\r\nexport const selectShowComments = (state: AppState) => state.preferences.showComments\r\nexport const selectShowMetadata = (state: AppState) => state.preferences.showMetadata\r\nexport const selectSort = (state: AppState) => state.preferences.sort\r\nexport const selectSuggestions = (state: AppState) => state.suggestions.entries\r\nexport const selectSuggestionsError = (state: AppState) => state.suggestions.error\r\nexport const selectSuggestionsModifier = (state: AppState) => state.suggestions.modifier\r\nexport const selectTagSuggestionCount = (state: AppState) => state.preferences.tagSuggestionsCount\r\nexport const selectUpdated = (state: AppState) => state.results.updated\r\nexport const selectAutoscrollDelay = (state: AppState) => state.preferences.autoscrollDelay\r\n\r\n// Memoized selectors\r\nexport const selectNumberOfActiveTags = createSelector(selectActiveTags, (tags) => Object.keys(tags).length)\r\nexport const selectAliasesAsList = createSelector(selectAliases, (aliases) => Object.values(aliases).flat())\r\nexport const selectHasResults = createSelector(selectPosts, (posts) => posts.length !== 0)\r\nexport const selectOutOfResults = createSelector(selectPosts, selectCount, (posts, count) => posts.length === count)\r\nexport const selectHasMoreResults = createSelector(selectOutOfResults, (outOfResults) => !outOfResults)\r\nexport const selectLastPage = createSelector(\r\n  selectCount,\r\n  selectPageSize,\r\n  (count, pageSize) => Math.ceil(count / pageSize) - 1\r\n)\r\nexport const selectFullScreenPost = createSelector(\r\n  selectPosts,\r\n  selectFullsceenIndex,\r\n  (posts, fullScreenIndex) => posts[fullScreenIndex]\r\n)\r\nexport const selectFullScreenIndex = createSelector(selectPosts, selectFullScreenPost, (posts, fullScreenPost) =>\r\n  fullScreenPost ? posts.indexOf(fullScreenPost) : -1\r\n)\r\nexport const selectMinRating = createSelector(selectRated, selectRatedThreshold, (rated, ratedThreshold) =>\r\n  rated ? ratedThreshold : 0\r\n)\r\nexport const selectNextIndex = createSelector(selectPosts, selectFullScreenIndex, (posts, selectedIndex) =>\r\n  selectedIndex + 1 < posts.length ? selectedIndex + 1 : undefined\r\n)\r\nexport const selectPreviousIndex = createSelector(selectFullScreenIndex, (selectedIndex) =>\r\n  selectedIndex > 0 ? selectedIndex - 1 : undefined\r\n)\r\nexport const selectSupertagModalOpen = createSelector(\r\n  selectOpenModalId,\r\n  (modalId) => modalId === ModalId.CREATE_SUPERTAG\r\n)\r\nexport const selectCellularWarningModalOpen = createSelector(\r\n  selectOpenModalId,\r\n  (modalId) => modalId === ModalId.CELLULAR_WARNING\r\n)\r\n\r\n// Parameterized selectors\r\nexport const selectPostById = defaultMemoize((id: number) => {\r\n  return createSelector(selectPosts, (posts) => {\r\n    return posts.find((post) => post.id === id) as r34.Post\r\n  })\r\n})\r\nexport const selectPostByIndex = defaultMemoize((index: number) => {\r\n  return createSelector(selectPosts, (posts) => {\r\n    return posts[index]\r\n  })\r\n})\r\n\r\nexport const selectAliasesByTagName = defaultMemoize((tagName: string) => {\r\n  return createSelector(selectAliases, (aliases) => {\r\n    return aliases[tagName]\r\n  })\r\n})\r\n\r\nexport const selectLikedByPostId = defaultMemoize((id: number) => (state: AppState) => id in state.likes)\r\n\r\nexport const selectActiveSupertagTags = createSelector(selectActiveTags, (activeTags) =>\r\n  Object.values(activeTags)\r\n    .filter(isSupertag)\r\n    .reduce((result, tag) => ({ ...result, ...tag.tags }), {})\r\n)\r\n","import React, { ReactNode } from 'react'\r\n\r\ninterface ErrorBoundaryProps {\r\n  fallback: ReactNode\r\n  children: ReactNode\r\n}\r\n\r\ninterface ErrorBoundaryState {\r\n  hasError: boolean\r\n}\r\n\r\nexport default class ErrorBoundary extends React.Component<ErrorBoundaryProps, ErrorBoundaryState> {\r\n  constructor(props: ErrorBoundaryProps) {\r\n    super(props)\r\n    this.state = { hasError: false }\r\n  }\r\n\r\n  static getDerivedStateFromError(error: Error) {\r\n    return { hasError: true }\r\n  }\r\n\r\n  render() {\r\n    if (this.state.hasError) {\r\n      return this.props.fallback\r\n    }\r\n\r\n    return this.props.children\r\n  }\r\n}\r\n","import { DefaultTheme } from 'styled-components'\r\n\r\nconst dark: DefaultTheme = {\r\n  dimensions: {\r\n    borderRadius: '3px',\r\n    borderWidth: '2px',\r\n    spacing: '4px',\r\n    bigSpacing: '8px',\r\n    hugeSpacing: '16px',\r\n    gutter: '8px',\r\n    blockHeight: '32px',\r\n    bodyWidth: '1000px',\r\n  },\r\n  colors: {\r\n    //basic\r\n    text: '#ffffff',\r\n    backgroundColor: '#121212',\r\n    backgroundColor2: '#ffffff',\r\n    subduedText: '#ffffff80',\r\n    layerBg: '#ffffff11',\r\n    layerBgSolid: '#222222',\r\n    layerBgHighlight: '#ffffff22',\r\n\r\n    // theme\r\n    accentColor: '#ee3344',\r\n    accentColorHover: '#f74555',\r\n    accentColorActive: '#d93847',\r\n\r\n    // semantic\r\n    liked: '#ff0d50',\r\n    positive: '#3fb950',\r\n    negative: '#f85149',\r\n  },\r\n  shadow: {\r\n    radius: '6px',\r\n    color: '#00000080',\r\n  },\r\n  timings: {\r\n    transitionTime: '0.2s',\r\n    longTransitionTime: '0.2s',\r\n  },\r\n  fontSizes: {\r\n    content: '15px',\r\n    bigTitle: '24px',\r\n  },\r\n}\r\n\r\nexport default dark\r\n","import { DefaultTheme } from 'styled-components'\r\nimport { Theme } from 'r34-types'\r\nimport light from './light'\r\nimport dark from './dark'\r\nimport coffee from './coffee'\r\nimport electric from './electric'\r\nimport deepsea from './deepsea'\r\n\r\nconst themes: Record<Theme, DefaultTheme> = {\r\n  dark,\r\n  light,\r\n  coffee,\r\n  electric,\r\n  deepsea,\r\n}\r\n\r\nexport default themes\r\n\r\nexport const defaultThemeId = 'dark'\r\n","import dark from './dark'\r\n\r\nconst light = {\r\n  ...dark,\r\n  colors: {\r\n    ...dark.colors,\r\n    text: '#000',\r\n    backgroundColor: '#eee',\r\n    backgroundColor2: '#eee',\r\n    subduedText: '#00000080',\r\n    layerBg: '#ffffff',\r\n    layerBgSolid: '#ffffff',\r\n    layerBgHighlight: '#00000022',\r\n  },\r\n  shadow: {\r\n    ...dark.shadow,\r\n    color: 'transparent',\r\n  },\r\n}\r\n\r\nexport default light\r\n","import dark from './dark'\r\n\r\nconst coffee = {\r\n  ...dark,\r\n  colors: {\r\n    ...dark.colors,\r\n    backgroundColor: '#161410',\r\n    backgroundColor2: '#fff',\r\n    layerBg: '#ffffff11',\r\n    layerBgSolid: '#262420',\r\n    layerBgHighlight: '#ffffff22',\r\n  },\r\n}\r\n\r\nexport default coffee\r\n","import dark from './dark'\r\n\r\nconst electric = {\r\n  ...dark,\r\n  colors: {\r\n    ...dark.colors,\r\n    accentColor: '#2ae',\r\n    accentColorHover: '#39b8f7',\r\n    accentColorActive: '#1e99d6',\r\n  },\r\n}\r\n\r\nexport default electric\r\n","import dark from './dark'\r\n\r\nconst deepsea = {\r\n  ...dark,\r\n  colors: {\r\n    ...dark.colors,\r\n    backgroundColor: '#010917',\r\n    backgroundColor2: '#eef',\r\n    layerBg: '#ffffff11',\r\n    layerBgSolid: '#111929',\r\n    layerBgHighlight: '#ffffff22',\r\n    accentColor: '#4090bb',\r\n    accentColorHover: '#55aecf',\r\n    accentColorActive: '#3b7a9c',\r\n  },\r\n}\r\n\r\nexport default deepsea\r\n","import { createGlobalStyle, css } from 'styled-components'\n\nexport default createGlobalStyle(\n  ({ theme }) => css`\n    * {\n      margin: 0;\n      padding: 0;\n      box-sizing: border-box;\n\n      font-family: 'Raleway', sans-serif;\n      -webkit-font-smoothing: antialiased;\n      -moz-osx-font-smoothing: grayscale;\n\n      :focus {\n        outline: none;\n      }\n    }\n\n    html,\n    body,\n    #app-root {\n      width: 100%;\n      height: 100%;\n    }\n\n    body {\n      font-size: ${theme.fontSizes.content};\n      color: ${theme.colors.text};\n      background-color: ${theme.colors.backgroundColor};\n      transition: color 0.4s, background-color 0.4s;\n\n      // always show scrollbar to prevent layout shifts when changing pages\n      overflow-y: scroll;\n    }\n\n    a {\n      color: ${theme.colors.accentColor};\n      text-decoration: none;\n    }\n\n    // Not a touch device\n    // Touch devices have nice scrollbars by default\n    @media (pointer: fine) {\n      // Underline stuff that is focused on non-touch devices\n      // makes keyboard navigation clearer\n      button,\n      input {\n        &:focus {\n          text-decoration: underline;\n        }\n      }\n\n      ::-webkit-scrollbar {\n        height: 8px;\n        transition: all ${theme.timings.transitionTime} ease-in-out;\n\n        :hover {\n          background: ${theme.colors.layerBg};\n        }\n      }\n\n      /* Track */\n      ::-webkit-scrollbar-track {\n        background: transparent;\n      }\n\n      /* Handle */\n      :hover {\n        ::-webkit-scrollbar {\n          background: ${theme.colors.layerBg};\n        }\n      }\n\n      ::-webkit-scrollbar-thumb {\n        background: ${theme.colors.layerBg};\n        border-radius: 1000px;\n\n        :hover {\n          background: ${theme.colors.layerBgHighlight};\n        }\n      }\n    }\n  `\n)\n","import React from 'react'\r\nimport styled from 'styled-components'\r\nimport ResetButton from '../widgets/ResetButton'\r\nimport outOfResultsPicture from '../../icons/OutOfResults.png'\r\nimport FlexImage from '../designsystem/FlexImage'\r\nimport themes, { defaultThemeId } from '../../styled/themes'\r\nimport GlobalStyles from '../../GlobalStyles'\r\n\r\nconst FullScreenCentered = styled.div`\r\n  height: 100vh;\r\n  width: 100%;\r\n  display: grid;\r\n  place-items: center;\r\n  align-content: center;\r\n  padding: 30px;\r\n  background: ${({ theme }) => theme.colors.backgroundColor};\r\n\r\n  > * {\r\n    margin-bottom: 10px;\r\n  }\r\n`\r\n\r\nexport default function ErrorScreen() {\r\n  const theme = themes[defaultThemeId]\r\n\r\n  return (\r\n    <FullScreenCentered theme={theme}>\r\n      <GlobalStyles theme={theme} />\r\n      <FlexImage src={outOfResultsPicture} alt='Shironeko does not understand' />\r\n      <h1>Sorry about that...</h1>\r\n      <ResetButton theme={theme} />\r\n    </FullScreenCentered>\r\n  )\r\n}\r\n","import React from 'react'\r\nimport styled from 'styled-components'\r\nimport Loading from '../../icons/Loading'\r\n\r\nconst FullScreenCentered = styled.div`\r\n  height: 100%;\r\n  width: 100%;\r\n  display: grid;\r\n  place-items: center;\r\n`\r\n\r\nexport default function LoadingScreen() {\r\n  return (\r\n    <FullScreenCentered>\r\n      <Loading />\r\n    </FullScreenCentered>\r\n  )\r\n}\r\n","import styled, { css } from 'styled-components'\r\nimport { gap } from '../../styled/mixins'\r\nimport FlexColumn, { FlexColumnWithSpacing } from '../designsystem/FlexColumn'\r\nimport Surface from '../designsystem/Surface'\r\nimport { Faded, Title } from '../designsystem/Text'\r\nimport Header from '../features/Header'\r\n\r\nconst SectionBody = styled(Surface)(\r\n  ({ theme }) => css`\r\n    padding: ${theme.dimensions.hugeSpacing};\r\n    ${gap(theme.dimensions.hugeSpacing)};\r\n  `\r\n)\r\n\r\nconst Section = styled(FlexColumnWithSpacing)`\r\n  flex-grow: 1;\r\n`\r\n\r\nexport default function Terms() {\r\n  document.title = 'R34 React - Terms of Service'\r\n\r\n  return (\r\n    <FlexColumn>\r\n      <Header />\r\n      <Section>\r\n        <Title>Terms of Service</Title>\r\n        <SectionBody>\r\n          <p>\r\n            This website does not impose any additional terms on you. However, terms for the technologies this app uses\r\n            still apply. Therefore, you should read the following terms.\r\n          </p>\r\n          <a href='https://policies.google.com/terms'>Google - Privacy & Terms</a>\r\n          <a href='https://rule34.xxx/tos.php'>Rule34 - Terms of Serivce</a>\r\n          <Faded>If you have any questions feel free to contact me via Discord. See \"about\" section.</Faded>\r\n        </SectionBody>\r\n      </Section>\r\n    </FlexColumn>\r\n  )\r\n}\r\n","import React, { useCallback } from 'react'\r\nimport styled from 'styled-components'\r\nimport useAction from '../../hooks/useAction'\r\nimport { closeModal } from '../../redux/actions'\r\nimport Surface from './Surface'\r\n\r\nconst Wrapper = styled.div`\r\n  position: fixed;\r\n  display: grid;\r\n  place-items: center;\r\n\r\n  bottom: 0;\r\n  left: 0;\r\n  width: 100vw;\r\n  height: 100vh;\r\n  padding: 20px;\r\n\r\n  z-index: 1000;\r\n\r\n  background: #000000d0;\r\n`\r\n\r\nconst ModalSurface = styled(Surface)`\r\n  max-width: 500px;\r\n  background-color: ${(props) => props.theme.colors.layerBgSolid};\r\n`\r\n\r\ninterface ModalProps {\r\n  children: React.ReactNode\r\n}\r\n\r\nexport default function Modal(props: ModalProps) {\r\n  const { children } = props\r\n\r\n  const close = useAction(closeModal)\r\n  const blockEvent = useCallback((e) => e.stopPropagation(), [])\r\n\r\n  return (\r\n    <Wrapper onClick={close} title='Close modal'>\r\n      <ModalSurface onClick={blockEvent}>{children}</ModalSurface>\r\n    </Wrapper>\r\n  )\r\n}\r\n","export default __webpack_public_path__ + \"static/media/eeek.ff41d889.png\";","import React, { useCallback } from 'react'\r\nimport useAction from '../../hooks/useAction'\r\nimport { closeModal, getResults } from '../../redux/actions'\r\nimport Modal from '../designsystem/Modal'\r\nimport eeek from '../../icons/eeek.png'\r\nimport FlexImage from '../designsystem/FlexImage'\r\nimport { Faded, Title } from '../designsystem/Text'\r\nimport { flexRowWithGap } from '../../styled/mixins'\r\nimport { RedButton } from '../designsystem/Buttons'\r\nimport styled from 'styled-components'\r\nimport { FailedIcon, SuccessIcon } from '../../icons/FontAwesomeIcons'\r\nimport LabeledToggle from '../designsystem/LabeledToggle'\r\nimport usePreference from '../../hooks/usePreference'\r\n\r\nconst ButtonRow = styled.div`\r\n  ${flexRowWithGap}\r\n\r\n  > button {\r\n    flex-grow: 1;\r\n  }\r\n`\r\n\r\nexport default function CellularWarningModal() {\r\n  const close = useAction(closeModal)\r\n  const search = useAction(getResults)\r\n\r\n  const onConfirm = useCallback(() => {\r\n    search()\r\n    close()\r\n  }, [close, search])\r\n\r\n  const onCancel = useCallback(() => {\r\n    close()\r\n  }, [close])\r\n\r\n  const [autoPlay, setAutoPlay] = usePreference('autoPlay')\r\n  const toggleAutoPlay = useCallback(() => setAutoPlay(!autoPlay), [autoPlay, setAutoPlay])\r\n  const [preloadVideos, setPreloadVideos] = usePreference('preloadVideos')\r\n  const togglePreloadVideos = useCallback(() => setPreloadVideos(!preloadVideos), [preloadVideos, setPreloadVideos])\r\n  const [originals, setOriginals] = usePreference('originals')\r\n  const toggleOriginals = useCallback(() => setOriginals(!originals), [originals, setOriginals])\r\n\r\n  return (\r\n    <Modal>\r\n      <FlexImage src={eeek} />\r\n      <Title>Wait!</Title>\r\n      <Faded>\r\n        You are on cellular and have some features enabled that will consume a lot of data. Are you sure this is\r\n        intended?\r\n      </Faded>\r\n      <LabeledToggle value={autoPlay} onToggle={toggleAutoPlay}>\r\n        Auto-play Animations\r\n      </LabeledToggle>\r\n      <LabeledToggle value={preloadVideos} onToggle={togglePreloadVideos}>\r\n        Preload Animations\r\n      </LabeledToggle>\r\n      <LabeledToggle value={originals} onToggle={toggleOriginals}>\r\n        Load original sizes\r\n      </LabeledToggle>\r\n      <ButtonRow>\r\n        <RedButton onClick={onConfirm}>\r\n          <SuccessIcon /> Yes\r\n        </RedButton>\r\n        <RedButton onClick={onCancel}>\r\n          <FailedIcon /> No\r\n        </RedButton>\r\n      </ButtonRow>\r\n    </Modal>\r\n  )\r\n}\r\n","import React, { useCallback } from 'react'\nimport styled, { css } from 'styled-components'\nimport { RedButton } from '../designsystem/Buttons'\nimport usePreference from '../../hooks/usePreference'\n\nconst CookieWrapper = styled.div(\n  ({ theme }) => css`\n    position: fixed;\n    bottom: 0;\n    left: 0;\n    width: 100%;\n    display: flex;\n    align-items: center;\n    justify-content: space-between;\n    color: ${theme.colors.text};\n    background: ${theme.colors.layerBgSolid};\n    padding: ${theme.dimensions.gutter};\n    z-index: 100;\n  `\n)\n\nconst StyledSpan = styled.span`\n  height: min-content;\n`\n\nexport default function CookieConfirmation() {\n  const [, setCookies] = usePreference('cookies')\n\n  const handleAccept = useCallback(() => setCookies(true), [setCookies])\n\n  return (\n    <CookieWrapper>\n      <StyledSpan>This website uses cookies.</StyledSpan>\n      <RedButton onClick={handleAccept} aria-label='Allow Cookies' title='Accept Cookie usage'>\n        Okay\n      </RedButton>\n    </CookieWrapper>\n  )\n}\n","import React, { useCallback, useState } from 'react'\r\nimport { useDispatch, useSelector } from 'react-redux'\r\nimport styled, { css } from 'styled-components'\r\nimport { addSupertag } from '../../firebase'\r\nimport { selectActiveTags } from '../../redux/selectors'\r\nimport { defaultBlock, defaultBorder } from '../../styled/mixins'\r\nimport { BlockButton } from '../designsystem/Buttons'\r\nimport { HorizontalLine } from '../designsystem/Lines'\r\nimport { Title } from '../designsystem/Text'\r\nimport TagSelector from '../tagSelector/TagSelector'\r\nimport ActiveTags from './ActiveTags'\r\nimport * as r34 from 'r34-types'\r\nimport { isSupertag } from '../../data/tagUtils'\r\nimport { useActivateTag } from '../../hooks/useActivateTag'\r\nimport { closeModal, removeTag } from '../../redux/actions'\r\nimport useAction from '../../hooks/useAction'\r\nimport Modal from '../designsystem/Modal'\r\n\r\nconst StyledInput = styled.input(\r\n  ({ theme }) => css`\r\n    ${defaultBorder}\r\n    background-color: ${theme.colors.backgroundColor2};\r\n    ${defaultBlock}\r\n    text-align: left;\r\n  `\r\n)\r\n\r\nexport default function SupertagModal() {\r\n  const [name, setName] = useState('')\r\n  const [description, setDescription] = useState('')\r\n  const activeTags = useSelector(selectActiveTags)\r\n  const dispatch = useDispatch()\r\n  const activateTag = useActivateTag()\r\n  const close = useAction(closeModal)\r\n\r\n  const tags: Record<string, r34.TagModifier> = Object.values(activeTags)\r\n    .filter((tag): tag is r34.BiasedTag => !isSupertag(tag))\r\n    .reduce((result, tag) => ({ ...result, [tag.name]: tag.modifier }), {})\r\n\r\n  const handleCreate = useCallback(() => {\r\n    addSupertag(name, description, tags)\r\n      .then(() => {\r\n        Object.keys(tags).forEach((tagname) => dispatch(removeTag(tagname)))\r\n        activateTag({ name, description, tags })\r\n        close()\r\n      })\r\n      .catch((err) => console.error('Failed to create supertag', err))\r\n  }, [activateTag, close, description, dispatch, name, tags])\r\n\r\n  return (\r\n    <Modal>\r\n      <Title>Create Supertag</Title>\r\n      <HorizontalLine />\r\n      <StyledInput type='text' placeholder='Name' value={name} onChange={(e) => setName(e.target.value)} />\r\n      <StyledInput\r\n        type='text'\r\n        placeholder='Description'\r\n        value={description}\r\n        onChange={(e) => setDescription(e.target.value)}\r\n      />\r\n      <TagSelector showSupertags={false} onSubmit={activateTag} />\r\n      <ActiveTags />\r\n      <BlockButton onClick={handleCreate}>Create</BlockButton>\r\n    </Modal>\r\n  )\r\n}\r\n","enum AnalyticsEventId {\n  SEARCH = 'r34_search',\n}\n\nexport type SearchEvent = {\n  id: AnalyticsEventId.SEARCH\n  payload: {\n    page_number: number\n  }\n}\n\n/**\n * Should be called whenever a new search is started.\n */\nexport const searchEvent = (page_number: number): SearchEvent => ({\n  id: AnalyticsEventId.SEARCH,\n  payload: {\n    page_number,\n  },\n})\n","import { MiddlewareAPI } from 'redux'\r\nimport { Dispatch } from 'react'\r\nimport {\r\n  AppAction,\r\n  FETCH_PREFERENCES,\r\n  savePreferences,\r\n  SAVE_PREFERENCES,\r\n  setPreferences,\r\n  SET_PREFERENCE,\r\n} from '../actions'\r\nimport * as firebaseFunctions from '../../firebase'\r\n\r\nlet saveTimeout: NodeJS.Timeout\r\n\r\nconst persistence = (store: MiddlewareAPI) => (next: Dispatch<AppAction>) => async (action: AppAction) => {\r\n  if (action.type === SET_PREFERENCE) {\r\n    if (saveTimeout) {\r\n      clearTimeout(saveTimeout)\r\n    }\r\n\r\n    saveTimeout = setTimeout(() => {\r\n      store.dispatch(savePreferences())\r\n    }, 10000)\r\n  }\r\n\r\n  if (action.type === FETCH_PREFERENCES) {\r\n    const preferences = await firebaseFunctions.getPreferences()\r\n\r\n    if (preferences) {\r\n      store.dispatch(setPreferences(preferences))\r\n    }\r\n  }\r\n\r\n  if (action.type === SAVE_PREFERENCES) {\r\n    const { preferences } = store.getState()\r\n    firebaseFunctions.setPreferences(preferences)\r\n  }\r\n\r\n  next(action)\r\n}\r\n\r\nexport default persistence\r\n","import { AppAction, SET_POSTS, ADD_POSTS } from '../actions'\r\n\r\nimport { searchEvent } from '../../analytics/events'\r\nimport { selectPageNumber, selectCookies } from '../selectors'\r\nimport { MiddlewareAPI, Dispatch } from 'redux'\r\nimport { logEvent } from '../../firebase'\r\n\r\nconst eventLogging = (store: MiddlewareAPI<any>) => (next: Dispatch<AppAction>) => (action: AppAction) => {\r\n  const state = store.getState()\r\n  const cookies = selectCookies(state)\r\n\r\n  // Only send analytics if the user consented\r\n  if (cookies) {\r\n    if (action.type === ADD_POSTS || action.type === SET_POSTS) {\r\n      const pageNumber = selectPageNumber(state)\r\n      logEvent(searchEvent(pageNumber))\r\n    }\r\n  }\r\n\r\n  next(action)\r\n}\r\n\r\nexport default eventLogging\r\n","import firebase from 'firebase/app'\nimport 'firebase/auth'\nimport { getSupertags } from '../firebase'\nimport * as r34 from 'r34-types'\nimport { getTagParameter, isSuggestionError } from '../data/tagUtils'\nimport { SuggestionsError } from '../data/types'\n\ntype Version = 'v1' | 'v2'\ntype Target = 'local' | 'live'\n\nconst sourceTags: r34.Tag[] = [\n  { name: 'source:*patreon*', count: 12711, types: ['source'] },\n  { name: 'source:*twitter*', count: 99927, types: ['source'] },\n  { name: 'source:*pixiv*', count: 185080, types: ['source'] },\n]\n\nconst ratingTags: r34.Tag[] = [\n  { name: 'rating:safe', count: 14293, types: ['rating'] },\n  { name: 'rating:questionable', count: 219552, types: ['rating'] },\n  { name: 'rating:explicit', count: 3821144, types: ['rating'] },\n]\n\nclass API {\n  readonly defaultPageSize = 20\n  readonly apiLocal = 'http://localhost:8080'\n  readonly apiUrl1 = 'https://r34-json.herokuapp.com'\n  readonly apiUrl2 = 'https://r34-api-clone.herokuapp.com'\n\n  private target: Target = 'live'\n  private version: Version = 'v2'\n  private activeApi!: string\n\n  constructor() {\n    this.setActiveApi()\n  }\n\n  /**\n   * Switches between remote prod api and local dev api\n   */\n  setTarget(target: 'live' | 'local') {\n    this.target = target\n    this.setActiveApi()\n  }\n\n  /**\n   * Sets the api version to use.\n   */\n  setVersion(version: 'v1' | 'v2') {\n    this.version = version\n    this.setActiveApi()\n  }\n\n  /**\n   * Updates the base url with new configuration.\n   */\n  setActiveApi() {\n    if (this.target === 'local') {\n      this.activeApi = `${this.apiLocal}/${this.version}`\n    } else {\n      this.activeApi = `${this.apiUrl1}/${this.version}`\n    }\n  }\n\n  /**\n   * Retrieves tags given a searchTerm\n   */\n  private async fetchTags(searchTerm: string, limit: number): Promise<r34.Tag[] | SuggestionsError> {\n    return await (await fetch(`${this.activeApi}/tags?limit=${limit}&name=${searchTerm}&sort=count`)).json()\n  }\n\n  async getTags(searchTerm: string, limit: number = this.defaultPageSize, includeSupertags = false) {\n    const doFuzzySearch = searchTerm.length > 3\n    try {\n      const result = await this.fetchTags(doFuzzySearch ? `*${searchTerm}*` : searchTerm, limit)\n\n      if (isSuggestionError(result)) {\n        return result\n      }\n\n      let tags = result as r34.AnyTag[]\n\n      if (includeSupertags) {\n        try {\n          const supertags = await getSupertags()\n          if (supertags) {\n            const matchingSupertags = Object.entries(supertags)\n              .filter(([name, details]) => name.toLowerCase().includes(searchTerm.toLowerCase()))\n              .map(([name, details]) => ({\n                name,\n                ...details,\n              }))\n            tags = [...matchingSupertags, ...tags]\n          }\n        } catch {\n          // do nothing as supertags are only for registered users.\n        }\n      }\n\n      // HACKY: Inject suggestions for ratings and some sources\n      const matchingRating = ratingTags.filter((tag) => tag.name.includes(searchTerm.replace('rating:', '')))\n      tags = [...matchingRating, ...tags]\n\n      const matchingSourceTags = sourceTags.filter((tag) => tag.name.includes(searchTerm.replace('source:', '')))\n      tags = [...matchingSourceTags, ...tags]\n\n      return tags\n    } catch (err) {\n      console.warn('Failed to get tags:', err)\n      return []\n    }\n  }\n\n  /**\n   * This function can be used to retrieve a number of posts from the backend.\n   */\n  async getPosts(\n    tags: Record<string, r34.AnyBiasedTag>,\n    limit: number = this.defaultPageSize,\n    pageNumber = 0,\n    minScore = 0,\n    sort: r34.PostsSort = 'date',\n    hideSeen = false\n  ) {\n    try {\n      const idToken = await firebase.auth().currentUser?.getIdToken()\n      const url = this.buildPostUrl(pageNumber, tags, { minScore, limit, sort, hideSeen })\n      const apiResponse = await fetch(url, {\n        headers: {\n          Authorization: 'Bearer ' + idToken,\n        },\n      })\n      const data: r34.PostsResponse = await apiResponse.json()\n\n      return data\n    } catch (err) {\n      console.warn('Failed to get posts:', err)\n      return { count: 0, posts: [] }\n    }\n  }\n\n  /**\n   * Returns all aliases for a given tag\n   */\n  async getAliases(tagName: string) {\n    try {\n      const aliases: r34.AliasTag[] = await (\n        await fetch(`${this.activeApi}/alias/${encodeURIComponent(tagName)}`)\n      ).json()\n\n      return aliases\n    } catch (err) {\n      console.warn('Failed to get aliases:', err)\n      return []\n    }\n  }\n\n  /**\n   * Returns all comments for a given post.\n   */\n  async getComments(post: r34.Post) {\n    try {\n      const comments: r34.Comment[] = await (await fetch(post.comments_url)).json()\n\n      return comments\n    } catch (err) {\n      console.warn('Failed to get comments:', err)\n      return []\n    }\n  }\n\n  /**\n   * Constructs an api url that will return posts that match your parameters\n   */\n  buildPostUrl(\n    page: number,\n    tags: Record<string, r34.QueryTag | r34.Supertag>,\n    options: {\n      minScore?: number\n      limit?: number\n      sort?: r34.PostsSort\n      hideSeen?: boolean\n    } = {}\n  ) {\n    const { minScore = 0, limit = api.defaultPageSize, sort = 'date', hideSeen = false } = options\n    const params = {\n      pid: page,\n      limit,\n      hideSeen,\n      tags: getTagParameter(tags, minScore, sort),\n    }\n\n    return `${api.activeApi}/posts?${Object.entries(params)\n      .map(([key, value]) => (value === '' || value === false ? null : `${key}=${value}`))\n      .filter((i) => i !== null)\n      .join('&')}`\n  }\n}\n\nexport const api = new API()\n","import { Dispatch } from 'react'\nimport { MiddlewareAPI } from 'redux'\nimport { isSuggestionError, isSupertag, serializeTagname } from '../../data/tagUtils'\nimport { api } from '../../misc/api'\nimport {\n  addAliases,\n  addPosts,\n  ADD_TAG,\n  AppAction,\n  FETCH_COMMENTS,\n  FETCH_SUGGESTIONS,\n  GET_MORE_RESULTS,\n  GET_RESULTS,\n  LIKE_POST,\n  setComments,\n  setPosts,\n  setSuggestions,\n  setSuggestionsError,\n} from '../actions'\nimport {\n  selectActiveTags,\n  selectHasMoreResults,\n  selectHideSeen,\n  selectMinRating,\n  selectPageNumber,\n  selectPageSize,\n  selectPostById,\n  selectSort,\n  selectTagSuggestionCount,\n} from '../selectors'\n\nconst apiRequests = (store: MiddlewareAPI) => (next: Dispatch<AppAction>) => async (action: AppAction) => {\n  const state = store.getState()\n  const hasMoreResults = selectHasMoreResults(state)\n\n  if (action.type === GET_RESULTS) {\n    const activeTags = selectActiveTags(state)\n    const pageSize = selectPageSize(state)\n    const minRating = selectMinRating(state)\n    const sort = selectSort(state)\n    const hideSeen = selectHideSeen(state)\n\n    const result = await api.getPosts(activeTags, pageSize, action.pageNumber, minRating, sort, hideSeen)\n\n    store.dispatch(setPosts(result.posts, result.count, action.pageNumber))\n  }\n\n  if (action.type === GET_MORE_RESULTS && hasMoreResults) {\n    const activeTags = selectActiveTags(state)\n    const pageNumber = selectPageNumber(state)\n    const pageSize = selectPageSize(state)\n    const minRating = selectMinRating(state)\n    const sort = selectSort(state)\n    const hideSeen = selectHideSeen(state)\n\n    const res = await api.getPosts(activeTags, pageSize, pageNumber + 1, minRating, sort, hideSeen)\n\n    store.dispatch(addPosts(res.posts))\n  }\n\n  if (action.type === ADD_TAG) {\n    const activeTags = selectActiveTags(state)\n    const aliases = await api.getAliases(action.tag.name)\n\n    const sanitizedAliases = aliases\n      .sort((a, b) => b.count - a.count)\n      .filter((alias) => !(alias.name in activeTags))\n      .map(({ name, count }) => ({ name, count, types: [] }))\n\n    store.dispatch(addAliases(sanitizedAliases, action.tag.name))\n\n    // Request types for newly added tag\n    if (!isSupertag(action.tag) && action.tag.types.length === 0) {\n      const data = await api.getTags(action.tag.name, 1, false)\n      if (!isSuggestionError(data)) {\n        const tag = data.find((tag) => tag.name === action.tag.name)\n\n        if (tag && !isSupertag(tag)) {\n          action.tag.types = tag.types\n          action.tag.count = tag.count\n        }\n      }\n    }\n  }\n\n  if (action.type === LIKE_POST) {\n    fetch(`https://rule34.xxx/index.php?page=post&s=vote&id=${action.postId}&type=up`, { mode: 'no-cors' })\n      .then(() => {\n        // nothing to do, I update the state in advance\n      })\n      .catch((err) => {\n        console.warn('Upvote rejected', err)\n      })\n  }\n\n  if (action.type === FETCH_SUGGESTIONS) {\n    const limit = selectTagSuggestionCount(state)\n    const result = await api.getTags(serializeTagname(action.value), limit, action.includeSupertags)\n\n    if (isSuggestionError(result)) {\n      store.dispatch(setSuggestionsError(result))\n    } else {\n      store.dispatch(setSuggestions(result))\n    }\n  }\n\n  if (action.type === FETCH_COMMENTS) {\n    const post = selectPostById(action.postId)(state)\n\n    if (post) {\n      const comments = await api.getComments(post)\n      store.dispatch(setComments(action.postId, comments))\n    }\n  }\n\n  next(action)\n}\n\nexport default apiRequests\n","import { applyMiddleware } from 'redux'\r\nimport analytics from './analytics'\r\nimport persistence from './persistence'\r\nimport requests from './requests'\r\nimport { composeWithDevTools } from 'redux-devtools-extension'\r\n\r\nconst middleware = composeWithDevTools(applyMiddleware(analytics, requests, persistence))\r\n\r\nexport default middleware\r\n","export const migrations = {\r\n  // Delete reader state\r\n  278: (state: any) => {\r\n    return {\r\n      ...state,\r\n      reader: undefined,\r\n    }\r\n  },\r\n  // Add autoscroll delay\r\n  279: (state: any) => {\r\n    return {\r\n      ...state,\r\n      preferences: {\r\n        ...state.preferences,\r\n        autoscrollDelay: 10,\r\n      },\r\n    }\r\n  },\r\n}\r\n","import produce from 'immer'\r\nimport * as r34 from 'r34-types'\r\nimport { AppAction, SET_PREFERENCE, SET_PREFERENCES } from '../actions'\r\n\r\nexport interface PreferencesState {\r\n  rated: boolean\r\n  ratedThreshold: number\r\n  originals: boolean\r\n  cookies: boolean\r\n  preloadVideos: boolean\r\n  tagSuggestionsCount: number\r\n  resultsLayout: r34.ResultsLayout\r\n  pageSize: number\r\n  showMetadata: boolean\r\n  showComments: boolean\r\n  sort: r34.PostsSort\r\n  themeId: r34.Theme\r\n  autoPlay: boolean\r\n  hideSeen: boolean\r\n  autoscrollDelay: number\r\n}\r\n\r\nconst initialPreferencesState: PreferencesState = {\r\n  rated: false,\r\n  ratedThreshold: 1,\r\n  originals: false,\r\n  cookies: false,\r\n  preloadVideos: false,\r\n  tagSuggestionsCount: 20,\r\n  resultsLayout: 'infinite_column',\r\n  pageSize: 20,\r\n  showMetadata: false,\r\n  showComments: false,\r\n  sort: 'date',\r\n  themeId: 'dark',\r\n  autoPlay: false,\r\n  hideSeen: false,\r\n  autoscrollDelay: 10,\r\n}\r\n\r\nfunction setPreference<T extends r34.PreferenceKey>(state: PreferencesState, key: T, value: PreferencesState[T]) {\r\n  return produce(state, (draft) => {\r\n    draft[key] = value\r\n  })\r\n}\r\n\r\nfunction setPreferences(state: PreferencesState, preferences: Partial<PreferencesState>) {\r\n  return produce(state, (draft) => {\r\n    Object.assign(draft, preferences)\r\n  })\r\n}\r\n\r\nconst preferences = (state: PreferencesState = initialPreferencesState, action: AppAction): PreferencesState => {\r\n  switch (action.type) {\r\n    case SET_PREFERENCE:\r\n      return setPreference(state, action.key, action.value)\r\n    case SET_PREFERENCES:\r\n      return setPreferences(state, action.preferences)\r\n    default:\r\n      return state\r\n  }\r\n}\r\n\r\nexport default preferences\r\n","import produce from 'immer'\nimport { Comment, Post } from 'r34-types'\nimport { SET_POSTS, ADD_POSTS, SET_COMMENTS, AppAction } from '../actions'\n\nexport interface ResultsState {\n  posts: Post[]\n  pageNumber: number\n  count: number\n  updated: number\n}\n\nconst initialResultsState: ResultsState = {\n  posts: [],\n  pageNumber: 0,\n  count: 0,\n  updated: 0,\n}\n\nconst addPosts = (state: ResultsState, posts: Post[]) =>\n  produce(state, (draft) => {\n    draft.posts = [...state.posts, ...posts]\n    draft.pageNumber = state.pageNumber + 1\n    draft.updated = new Date().getTime()\n  })\n\nconst setPosts = (state: ResultsState, posts: Post[], postCount: number, pageNumber: number = 0) =>\n  produce(state, (draft) => {\n    draft.posts = posts\n    draft.count = postCount\n    draft.pageNumber = pageNumber\n    draft.updated = new Date().getTime()\n  })\n\nconst setComments = (state: ResultsState, postId: number, comments: Comment[]) =>\n  produce(state, (draft) => {\n    const postIndex = state.posts.findIndex((p) => p.id === postId)\n    if (postIndex >= 0) {\n      draft.posts[postIndex].comments = comments\n    }\n  })\n\nconst results = (state: ResultsState = initialResultsState, action: AppAction): ResultsState => {\n  switch (action.type) {\n    case ADD_POSTS:\n      return addPosts(state, action.posts)\n    case SET_POSTS:\n      return setPosts(state, action.posts, action.count, action.pageNumber)\n    case SET_COMMENTS:\n      return setComments(state, action.postId, action.comments)\n    default:\n      return state\n  }\n}\n\nexport default results\n","import produce from 'immer'\nimport { AliasTag, AnyBiasedTag } from 'r34-types'\nimport { ADD_TAG, AppAction, REMOVE_TAG, ADD_ALIASES } from '../actions'\n\nexport interface TagsState {\n  active: Record<string, AnyBiasedTag>\n  aliases: Record<string, AliasTag[]>\n}\n\nconst initialTagsState: TagsState = {\n  active: {},\n  aliases: {},\n}\n\nconst addTag = (state: TagsState, newTag: AnyBiasedTag) =>\n  produce(state, (draft) => {\n    draft.active[newTag.name] = { ...state.active[newTag.name], ...newTag }\n  })\n\nconst addAliases = (state: TagsState, aliases: AliasTag[], forTag: string) =>\n  produce(state, (draft) => {\n    draft.aliases[forTag] = aliases\n  })\n\nconst removeTag = (state: TagsState, tagName: string) =>\n  produce(state, (draft) => {\n    delete draft.active[tagName]\n    delete draft.aliases[tagName]\n  })\n\nconst tags = (state: TagsState = initialTagsState, action: AppAction): TagsState => {\n  switch (action.type) {\n    case ADD_TAG:\n      return addTag(state, action.tag)\n    case REMOVE_TAG:\n      return removeTag(state, action.tagName)\n    case ADD_ALIASES:\n      return addAliases(state, action.aliases, action.forTag)\n    default:\n      return state\n  }\n}\n\nexport default tags\n","import produce from 'immer'\nimport { ENTER_FULLSCREEN, EXIT_FULLSCREEN, SET_FULLSCREEN_POST, AppAction } from '../actions'\n\nexport interface FullscreenState {\n  isEnabled: boolean\n  currentIndex: number\n}\n\nconst initialFullscreenState: FullscreenState = {\n  isEnabled: false,\n  currentIndex: 0,\n}\n\nconst enterFullscreen = (state: FullscreenState, index: number) =>\n  produce(state, (draft) => {\n    draft.isEnabled = true\n    draft.currentIndex = index\n  })\n\nconst exitFullscreen = (state: FullscreenState) =>\n  produce(state, (draft) => {\n    draft.isEnabled = false\n  })\n\nconst setIndex = (state: FullscreenState, index: number) =>\n  produce(state, (draft) => {\n    draft.currentIndex = index\n  })\n\nexport const fullscreen = (state: FullscreenState = initialFullscreenState, action: AppAction): FullscreenState => {\n  switch (action.type) {\n    case ENTER_FULLSCREEN:\n      return enterFullscreen(state, action.postId)\n    case SET_FULLSCREEN_POST:\n      return setIndex(state, action.index)\n    case EXIT_FULLSCREEN:\n      return exitFullscreen(state)\n    default:\n      return state\n  }\n}\n","import produce from 'immer'\r\nimport { AppAction, LIKE_POST } from '../actions'\r\n\r\n/**\r\n * Key is postId, Value is time of like\r\n */\r\nexport type LikesState = Record<number, number>\r\n\r\nconst initialLikesState: LikesState = {}\r\n\r\nconst likePost = (state: LikesState, postId: number) =>\r\n  produce(state, (draft) => {\r\n    if (!(postId in state)) {\r\n      draft[postId] = Date.now()\r\n    }\r\n\r\n    // NOTE: Might need to introduce a cap here...\r\n    // Like 1000 likes max, delete oldest when more are added?\r\n  })\r\n\r\nconst likes = (state: LikesState = initialLikesState, action: AppAction): LikesState => {\r\n  switch (action.type) {\r\n    case LIKE_POST:\r\n      return likePost(state, action.postId)\r\n    default:\r\n      return state\r\n  }\r\n}\r\n\r\nexport default likes\r\n","import produce from 'immer'\r\nimport { ModalId } from '../../data/types'\r\nimport { AppAction, CLOSE_MODAL, OPEN_MODAL } from '../actions'\r\n\r\n/**\r\n * Key is postId, Value is time of like\r\n */\r\nexport interface ModalsState {\r\n  openModal: ModalId | null\r\n}\r\n\r\nconst initialModalsState: ModalsState = {\r\n  openModal: null,\r\n}\r\n\r\nconst setOpenModal = (state: ModalsState, modalId: ModalId | null) =>\r\n  produce(state, (draft) => {\r\n    draft.openModal = modalId\r\n  })\r\n\r\nconst modals = (state: ModalsState = initialModalsState, action: AppAction): ModalsState => {\r\n  switch (action.type) {\r\n    case OPEN_MODAL:\r\n      return setOpenModal(state, action.modalId)\r\n    case CLOSE_MODAL:\r\n      return setOpenModal(state, null)\r\n    default:\r\n      return state\r\n  }\r\n}\r\n\r\nexport default modals\r\n","import produce from 'immer'\r\nimport * as r34 from 'r34-types'\r\nimport { SuggestionsError } from '../../data/types'\r\nimport { AppAction, SET_SUGGESTIONS, SET_SUGGESTIONS_ERROR, SET_SUGGESTIONS_MODIFIER } from '../actions'\r\n\r\nexport interface SuggestionsState {\r\n  entries: r34.AnyTag[]\r\n  error: SuggestionsError | null\r\n  modifier: r34.TagModifier\r\n}\r\n\r\nconst initialSuggestionsState: SuggestionsState = {\r\n  entries: [],\r\n  error: null,\r\n  modifier: '+',\r\n}\r\n\r\nconst setSuggestions = (state: SuggestionsState, suggestions: r34.AnyTag[]) =>\r\n  produce(state, (draft) => {\r\n    draft.entries = suggestions\r\n    draft.error = null\r\n  })\r\n\r\nconst setError = (state: SuggestionsState, error: SuggestionsError) =>\r\n  produce(state, (draft) => {\r\n    draft.entries = []\r\n    draft.error = error\r\n  })\r\n\r\nconst setModifier = (state: SuggestionsState, modifier: r34.TagModifier) =>\r\n  produce(state, (draft) => {\r\n    draft.modifier = modifier\r\n  })\r\n\r\nconst suggestions = (state: SuggestionsState = initialSuggestionsState, action: AppAction): SuggestionsState => {\r\n  switch (action.type) {\r\n    case SET_SUGGESTIONS:\r\n      return setSuggestions(state, action.suggestions)\r\n    case SET_SUGGESTIONS_ERROR:\r\n      return setError(state, action.error)\r\n    case SET_SUGGESTIONS_MODIFIER:\r\n      return setModifier(state, action.modifier)\r\n    default:\r\n      return state\r\n  }\r\n}\r\n\r\nexport default suggestions\r\n","import { combineReducers } from 'redux'\nimport preferences from './preferences'\nimport results from './results'\nimport tags from './tags'\nimport { fullscreen } from './fullscreen'\nimport likes from './likes'\nimport modals from './modals'\nimport suggestions from './suggestions'\n\nexport default combineReducers({ tags, results, preferences, fullscreen, likes, suggestions, modals })\n","import { createStore } from 'redux'\nimport { createMigrate, persistReducer, persistStore } from 'redux-persist'\nimport storage from 'redux-persist/lib/storage'\nimport { getVersion, versionToNumber } from '../data/utils'\nimport middleware from './middleware'\nimport { migrations } from './migrations'\nimport rootReducer from './reducers'\n\nconst version = getVersion()\n\nconst persistConfig = {\n  key: 'appstate',\n  version: versionToNumber(version),\n  storage,\n  migrate: createMigrate(migrations),\n}\n\nconst persistedReducer = persistReducer(persistConfig, rootReducer)\n\nexport const store = createStore(persistedReducer, middleware)\n\nexport const persistor = persistStore(store)\n","import React, { Suspense } from 'react'\r\nimport { Helmet } from 'react-helmet'\r\nimport { Provider, useSelector } from 'react-redux'\r\nimport { HashRouter, Route, Switch } from 'react-router-dom'\r\nimport { PersistGate } from 'redux-persist/integration/react'\r\nimport { ThemeProvider } from 'styled-components'\r\nimport ErrorBoundary from './components/features/ErrorBoundary'\r\nimport ErrorScreen from './components/pages/ErrorScreen'\r\nimport LoadingScreen from './components/pages/LoadingScreen'\r\nimport Terms from './components/pages/Terms'\r\nimport CellularWarningModal from './components/widgets/CellularWarningModal'\r\nimport CookieConfirmation from './components/widgets/CookieConfirmation'\r\nimport SupertagModal from './components/widgets/SupertagModal'\r\nimport { RouteName } from './data/types'\r\nimport './firebase' // init firebase immediately\r\nimport GlobalStyles from './GlobalStyles'\r\nimport { useLoadPreferences } from './hooks/useLoadPreferences'\r\nimport {\r\n  selectActiveThemeId,\r\n  selectCellularWarningModalOpen,\r\n  selectCookies,\r\n  selectSupertagModalOpen,\r\n} from './redux/selectors'\r\nimport { persistor, store } from './redux/store'\r\nimport themes, { defaultThemeId } from './styled/themes'\r\n\r\nconst About = React.lazy(() => import('./components/pages/About'))\r\nconst Privacy = React.lazy(() => import('./components/pages/Privacy'))\r\nconst Search = React.lazy(() => import('./components/pages/Search'))\r\nconst Settings = React.lazy(() => import('./components/pages/Settings'))\r\nconst Share = React.lazy(() => import('./components/pages/Share'))\r\nconst Stories = React.lazy(() => import('./components/pages/Stories'))\r\n\r\nexport default function App() {\r\n  return (\r\n    <ErrorBoundary fallback={<ErrorScreen />}>\r\n      <Provider store={store}>\r\n        <PersistGate loading={<LoadingScreen />} persistor={persistor}>\r\n          <ThemedApp />\r\n        </PersistGate>\r\n      </Provider>\r\n    </ErrorBoundary>\r\n  )\r\n}\r\n\r\nfunction ThemedApp() {\r\n  const cookies = useSelector(selectCookies)\r\n  const isCellularWarningModalOpen = useSelector(selectCellularWarningModalOpen)\r\n  const isSupertagModalOpen = useSelector(selectSupertagModalOpen)\r\n  const themeId = useSelector(selectActiveThemeId)\r\n  const theme = themes[themeId] || defaultThemeId\r\n\r\n  useLoadPreferences()\r\n\r\n  return (\r\n    <ThemeProvider theme={theme}>\r\n      <GlobalStyles />\r\n      <Helmet>\r\n        <meta name='theme-color' content={theme.colors.layerBgSolid} />\r\n      </Helmet>\r\n      <HashRouter>\r\n        <Suspense fallback={<LoadingScreen />}>\r\n          <Switch>\r\n            <Route exact path={RouteName.ABOUT} component={About} />\r\n            <Route exact path={RouteName.PRIVACY} component={Privacy} />\r\n            <Route exact path={RouteName.SETTINGS} component={Settings} />\r\n            <Route exact path={RouteName.STORIES} component={Stories} />\r\n            <Route exact path={RouteName.TERMS} component={Terms} />\r\n            <Route exact path={RouteName.SHARE} component={Share} />\r\n            <Route path={RouteName.SEARCH} component={Search} />\r\n          </Switch>\r\n        </Suspense>\r\n\r\n        {isSupertagModalOpen && <SupertagModal />}\r\n        {isCellularWarningModalOpen && <CellularWarningModal />}\r\n        {!cookies && <CookieConfirmation />}\r\n      </HashRouter>\r\n    </ThemeProvider>\r\n  )\r\n}\r\n","import React from 'react'\r\nimport { useDispatch } from 'react-redux'\r\nimport { fetchPreferences } from '../redux/actions'\r\nimport useFirebaseAuthState from './useFirebaseAuthState'\r\n\r\nexport function useLoadPreferences() {\r\n  const dispatch = useDispatch()\r\n  const [isSignedIn] = useFirebaseAuthState()\r\n\r\n  React.useEffect(() => {\r\n    if (isSignedIn) {\r\n      dispatch(fetchPreferences())\r\n    }\r\n  }, [dispatch, isSignedIn])\r\n}\r\n","// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read https://cra.link/PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.0/8 are considered localhost for IPv4.\n    window.location.hostname.match(/^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/)\n);\n\ntype Config = {\n  onSuccess?: (registration: ServiceWorkerRegistration) => void;\n  onUpdate?: (registration: ServiceWorkerRegistration) => void;\n};\n\nexport function register(config?: Config) {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(process.env.PUBLIC_URL, window.location.href);\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit https://cra.link/PWA'\n          );\n        });\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl: string, config?: Config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then((registration) => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        if (installingWorker == null) {\n          return;\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                'New content is available and will be used when all ' +\n                  'tabs for this page are closed. See https://cra.link/PWA.'\n              );\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration);\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.');\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration);\n              }\n            }\n          }\n        };\n      };\n    })\n    .catch((error) => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl: string, config?: Config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl, {\n    headers: { 'Service-Worker': 'script' },\n  })\n    .then((response) => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get('content-type');\n      if (\n        response.status === 404 ||\n        (contentType != null && contentType.indexOf('javascript') === -1)\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then((registration) => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config);\n      }\n    })\n    .catch(() => {\n      console.log('No internet connection found. App is running in offline mode.');\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready\n      .then((registration) => {\n        registration.unregister();\n      })\n      .catch((error) => {\n        console.error(error.message);\n      });\n  }\n}\n","// Polyfills\nimport 'whatwg-fetch'\n\nimport * as Sentry from '@sentry/react'\nimport { Integrations } from '@sentry/tracing'\nimport React from 'react'\nimport ReactDOM from 'react-dom'\nimport App from './App'\nimport { getVersionString } from './data/utils'\nimport * as serviceWorkerRegistration from './serviceWorkerRegistration'\n\nSentry.init({\n  dsn: 'https://1a2933d829da41fe84d4dab5fcc520ae@o955708.ingest.sentry.io/5905045',\n  integrations: [new Integrations.BrowserTracing()],\n  tracesSampleRate: 1.0,\n  release: getVersionString(),\n  beforeBreadcrumb(breadcrumb, hint) {\n    try {\n      if (breadcrumb?.category?.startsWith('ui')) {\n        const target = hint?.event.target as HTMLElement\n        const tag = target.tagName.toLowerCase()\n        if (target.innerText) {\n          breadcrumb.message = `${tag}: ${target.innerText}`\n        } else if (target.id) {\n          breadcrumb.message = `${tag}: ${target.id}`\n        } else if (target.getAttribute('name')) {\n          breadcrumb.message = `${tag}: ${target.getAttribute('name')}`\n        } else if (target.title) {\n          breadcrumb.message = `${tag}: ${target.title}`\n        } else if (target.getAttribute('aria-label')) {\n          breadcrumb.message = `${tag}: ${target.getAttribute('aria-label')}`\n        } else if (target.getAttribute('data-name')) {\n          breadcrumb.message = `${tag}: ${target.getAttribute('data-name')}`\n        }\n      }\n    } catch (err) {\n      // fancy breadcrumbs are optional\n    }\n    return breadcrumb\n  },\n})\n\nReactDOM.render(\n  // <React.StrictMode>\n  <App />,\n  // </React.StrictMode>\n  document.getElementById('app-root')\n)\n\nserviceWorkerRegistration.register()\n","import * as r34 from 'r34-types'\r\nimport { SuggestionsError } from './types'\r\n\r\n//#region Tag serialization\r\n\r\n/**\r\n * Accepts a map of all tags and serializes them into a string that can be used as a Querystring parameter\r\n */\r\nexport function serializeAllTags(tags: Record<string, r34.QueryTag | r34.Supertag>) {\r\n  const resolvedTags = flattenSupertags(Object.values(tags))\r\n  const tagsByModifier = groupTagsByModifier(resolvedTags)\r\n  const normalTags = [...tagsByModifier['+'], ...tagsByModifier['-']].map(serializeTag).join(' + ')\r\n  const optionalTags =\r\n    tagsByModifier['~'].length > 0 ? ` + ( ${tagsByModifier['~'].map(serializeTag).join(' ~ ')} )` : ''\r\n\r\n  return `${normalTags}${optionalTags}`\r\n}\r\n\r\n/**\r\n * Accepts a list that holds normal tags and supertags and unpacks all supertags.\r\n * The result contains all normal tags given plus all contents of the supertags given.\r\n */\r\nexport function flattenSupertags(tags: Array<r34.QueryTag | r34.Supertag>) {\r\n  let resolvedTags: r34.QueryTag[] = []\r\n\r\n  tags.forEach((tag) => {\r\n    if (isSupertag(tag)) {\r\n      Object.entries(tag.tags).forEach(([name, modifier]) => {\r\n        resolvedTags.push({ name, modifier })\r\n      })\r\n    } else {\r\n      resolvedTags.push(tag)\r\n    }\r\n  })\r\n\r\n  return resolvedTags\r\n}\r\n\r\n/**\r\n * Given a list of tags this function returns a record with an entry for each modifier countaining all tags of the original list that match that modifier.\r\n */\r\nexport function groupTagsByModifier(tags: r34.QueryTag[]) {\r\n  return tags.reduce(\r\n    (result, current) => {\r\n      if (!(current.modifier in result)) result[current.modifier] = []\r\n\r\n      result[current.modifier]?.push(current)\r\n\r\n      return result\r\n    },\r\n    { '+': [], '-': [], '~': [] } as Record<r34.TagModifier, r34.QueryTag[]>\r\n  )\r\n}\r\n\r\n/**\r\n * Serializes a tag for use in urls\r\n */\r\nexport function serializeTag(tag: r34.QueryTag) {\r\n  return `${tag.modifier === '-' ? '-' : ''}${serializeTagname(tag.name)}`\r\n}\r\n\r\n/**\r\n * Serializes tag names for use in api requests.\r\n */\r\nexport function serializeTagname(tagname: string) {\r\n  return encodeURIComponent(tagname.toLowerCase().replace(/ /g, '_'))\r\n}\r\n\r\n//#endregion\r\n\r\n//#region Query parameter construction\r\n\r\n/**\r\n * Constructs the tag parameter for getting posts from the api\r\n */\r\nexport function getTagParameter(\r\n  tags: Record<string, r34.QueryTag | r34.Supertag>,\r\n  minScore: number,\r\n  sort: r34.PostsSort\r\n) {\r\n  const tagParts = []\r\n\r\n  if (Object.keys(tags).length > 0) {\r\n    tagParts.push(serializeAllTags(tags))\r\n  }\r\n\r\n  if (minScore > 0) {\r\n    tagParts.push(encodeURIComponent(`score:>=${minScore}`))\r\n  }\r\n\r\n  if (sort !== 'date') {\r\n    tagParts.push(encodeURIComponent(`sort:${sort}:desc`))\r\n  }\r\n\r\n  return tagParts.join(' + ')\r\n}\r\n\r\n//#endregion\r\n\r\n//#region Typing\r\n\r\nexport function bias(tag: r34.Tag, modifier: r34.TagModifier): r34.BiasedTag {\r\n  return { ...tag, modifier }\r\n}\r\n\r\nexport function isBiased(tag: r34.Tag | r34.BiasedTag): tag is r34.BiasedTag {\r\n  return (tag as r34.BiasedTag).modifier !== undefined\r\n}\r\n\r\nexport function isSupertag(tag: unknown): tag is r34.Supertag {\r\n  return (tag as r34.Supertag).tags !== undefined\r\n}\r\n\r\nexport function getInterestingType(types: r34.TagType[]) {\r\n  return types.find((t) => !t.match(/^[general|ambiguous]$/))\r\n}\r\n\r\nexport function isSuggestionError(value: unknown): value is SuggestionsError {\r\n  return (value as SuggestionsError).message !== undefined\r\n}\r\n\r\n//#endregion\r\n\r\n//#region Compression\r\n\r\nfunction removeLeadingHastag(value: string) {\r\n  if (value[0] === '#') return value.substr(1)\r\n  else return value\r\n}\r\n\r\nexport function encodeSupertag(supertag: r34.Supertag) {\r\n  const payload = `${encodeURI(supertag.name)}/${encodeURI(supertag.description)}/${encodeURI(\r\n    Object.entries(supertag.tags)\r\n      .map(([t, m]) => `${t},${m}`)\r\n      .join(';')\r\n  )}`\r\n\r\n  return Buffer.from(payload).toString('base64')\r\n}\r\n\r\nexport function decodeSupertag(base64: string) {\r\n  const payload = Buffer.from(removeLeadingHastag(base64), 'base64').toString()\r\n\r\n  const parts = payload.split('/').map(decodeURI)\r\n\r\n  const supertag: r34.Supertag = {\r\n    name: parts[0],\r\n    description: parts[1],\r\n    tags: Object.fromEntries(parts[2].split(';').map((e) => e.split(','))),\r\n  }\r\n\r\n  return supertag\r\n}\r\n\r\n//#endregion\r\n","import { IconProp } from '@fortawesome/fontawesome-svg-core'\r\nimport {\r\n  faDeviantart,\r\n  faDiscord,\r\n  faGithub,\r\n  faGoogle,\r\n  faPatreon,\r\n  faTumblr,\r\n  faTwitter,\r\n} from '@fortawesome/free-brands-svg-icons'\r\nimport {\r\n  faBackward,\r\n  faCalendarDay,\r\n  faCaretDown,\r\n  faCheckCircle,\r\n  faCheckSquare,\r\n  faCodeBranch,\r\n  faCopy,\r\n  faCopyright,\r\n  faDownload,\r\n  faExpand,\r\n  faExternalLinkAlt,\r\n  faForward,\r\n  faHashtag,\r\n  faHeart,\r\n  faImage,\r\n  faInfoCircle,\r\n  faLink,\r\n  faPen,\r\n  faPlus,\r\n  faRegistered,\r\n  faSearch,\r\n  faShareAlt,\r\n  faSignOutAlt,\r\n  faTags,\r\n  faTimes,\r\n  faTimesCircle,\r\n  faUndoAlt,\r\n  faUser,\r\n  faWrench,\r\n} from '@fortawesome/free-solid-svg-icons'\r\nimport { FontAwesomeIcon, FontAwesomeIconProps } from '@fortawesome/react-fontawesome'\r\n\r\n/**\r\n * Component factory that shortens the definition of a new icon considerably\r\n */\r\nconst bindIcon = (icon: IconProp) => (props: Omit<FontAwesomeIconProps, 'icon'>) =>\r\n  <FontAwesomeIcon data-testid='icon' icon={icon} {...props} />\r\n\r\nexport const ArrowDown = bindIcon(faCaretDown)\r\nexport const ArtistIcon = bindIcon(faPen)\r\nexport const CalendarIcon = bindIcon(faCalendarDay)\r\nexport const CharacterIcon = bindIcon(faUser)\r\nexport const CheckIcon = bindIcon(faCheckSquare)\r\nexport const CloseIcon = bindIcon(faTimes)\r\nexport const CodeBranchIcon = bindIcon(faCodeBranch)\r\nexport const CopyIcon = bindIcon(faCopy)\r\nexport const CopyrightIcon = bindIcon(faCopyright)\r\nexport const DeviantArtIcon = bindIcon(faDeviantart)\r\nexport const DiscordIcon = bindIcon(faDiscord)\r\nexport const DownloadIcon = bindIcon(faDownload)\r\nexport const ExpandIcon = bindIcon(faExpand)\r\nexport const ExternalLinkIcon = bindIcon(faExternalLinkAlt)\r\nexport const FailedIcon = bindIcon(faTimesCircle)\r\nexport const GithubIcon = bindIcon(faGithub)\r\nexport const GoogleIcon = bindIcon(faGoogle)\r\nexport const HeartIcon = bindIcon(faHeart)\r\nexport const ImageIcon = bindIcon(faImage)\r\nexport const LinkIcon = bindIcon(faLink)\r\nexport const MetaDataIcon = bindIcon(faInfoCircle)\r\nexport const PatreonIcon = bindIcon(faPatreon)\r\nexport const PlusIcon = bindIcon(faPlus)\r\nexport const RatingIcon = bindIcon(faRegistered)\r\nexport const SearchIcon = bindIcon(faSearch)\r\nexport const ShareIcon = bindIcon(faShareAlt)\r\nexport const SignOutIcon = bindIcon(faSignOutAlt)\r\nexport const SourceIcon = bindIcon(faHashtag)\r\nexport const SuccessIcon = bindIcon(faCheckCircle)\r\nexport const SupertagIcon = bindIcon(faTags)\r\nexport const TumblrIcon = bindIcon(faTumblr)\r\nexport const TwitterIcon = bindIcon(faTwitter)\r\nexport const UndoIcon = bindIcon(faUndoAlt)\r\nexport const WrenchIcon = bindIcon(faWrench)\r\nexport const ForwardIcon = bindIcon(faForward)\r\nexport const BackwardIcon = bindIcon(faBackward)\r\n","/**\r\n * Tabs displayed in Post details\r\n */\r\nexport type ActiveTab = 'tags' | 'comments' | 'metadata'\r\n\r\n/**\r\n * All routes of the app.\r\n */\r\nexport enum RouteName {\r\n  SEARCH = '/',\r\n  SETTINGS = '/settings',\r\n  ABOUT = '/about',\r\n  PRIVACY = '/privacy',\r\n  TERMS = '/terms',\r\n  STORIES = '/stories',\r\n  SHARE = '/share',\r\n}\r\n\r\n/**\r\n * All modals the app can display.\r\n */\r\nexport enum ModalId {\r\n  CREATE_SUPERTAG,\r\n  CELLULAR_WARNING,\r\n}\r\n\r\nexport type EmptyCallback = () => void\r\n\r\n/**\r\n * One-time definition of an empty function. Reusing this improves React's performance as it does not break memoization.\r\n */\r\nexport const NO_OP = () => {}\r\n\r\n/**\r\n * Error sent from the backend when too many tag results were found\r\n */\r\nexport type SuggestionsError = { message: string; results: number }\r\n\r\n/**\r\n * direct: Tag is part of active tags\r\n * indirect: Tag is part of a supertag that is in active tags\r\n * no: Tag is not part of supertags at all\r\n */\r\nexport type TagIsActive = 'direct' | 'indirect' | 'no'\r\n\r\n/**\r\n * Unit for display in the TagSelector dropdown\r\n */\r\nexport type CountUnit = 'tags' | 'posts'\r\n","import styled, { css } from 'styled-components'\nimport { defaultBorder, dropShadow, primaryHover } from '../../styled/mixins'\n\nconst TextButton = styled.button(\n  ({ theme }) => css`\n    height: ${theme.dimensions.blockHeight};\n    padding: 0 ${theme.dimensions.bigSpacing};\n    font-size: ${theme.fontSizes.content};\n    ${defaultBorder({ theme })}\n    display: inline-flex;\n    gap: ${theme.dimensions.gutter};\n    align-items: center;\n    place-content: center;\n    cursor: pointer;\n    transition: all ${theme.timings.longTransitionTime} ease-out;\n  `\n)\n\nexport const InvisButton = styled.button(\n  ({ theme }) => css`\n    background-color: transparent;\n    border: none;\n    padding: ${theme.dimensions.gutter};\n    cursor: pointer;\n    ${dropShadow({ theme })}\n    color: ${theme.colors.text};\n\n    svg {\n      transition: all ${theme.timings.transitionTime} ease-out;\n    }\n  `\n)\n\nexport const RedButton = styled(TextButton)`\n  ${primaryHover}\n`\n\nexport const BlockButton = styled(RedButton)`\n  width: 100%;\n`\n\nexport const AddButton = styled(RedButton)(\n  ({ theme }) => css`\n    border-radius: 0 ${theme.dimensions.borderRadius} ${theme.dimensions.borderRadius} 0;\n  `\n)\n\nexport const ModifierButton = styled(TextButton)(\n  ({ theme }) => css`\n    background-color: transparent;\n    min-width: 48px;\n    font-weight: bold;\n\n    ${defaultBorder({ theme })}\n    border-right-width: 0;\n    border-radius: ${theme.dimensions.borderRadius} 0 0 ${theme.dimensions.borderRadius};\n  `\n)\n","import firebase from 'firebase/app'\r\nimport 'firebase/analytics'\r\nimport { SearchEvent } from '../analytics/events'\r\n\r\nexport async function logEvent(event: SearchEvent) {\r\n  firebase.analytics().logEvent<typeof event.id>(event.id, event.payload)\r\n}\r\n","import firebase from 'firebase/app'\r\nimport 'firebase/auth'\r\n\r\nconst googleAuthProvider = new firebase.auth.GoogleAuthProvider()\r\n\r\nexport function signIn() {\r\n  firebase\r\n    .auth()\r\n    .signInWithPopup(googleAuthProvider)\r\n    .catch((error) => {\r\n      console.error('Sign in failed:', error.code, error.message)\r\n    })\r\n}\r\n\r\nexport async function signOut() {\r\n  return await firebase.auth().signOut()\r\n}\r\n","export async function sha256(message: string) {\r\n  const msgBuffer = new TextEncoder().encode(message)\r\n  const hashBuffer = await crypto.subtle.digest('SHA-256', msgBuffer)\r\n  const hashArray = Array.from(new Uint8Array(hashBuffer))\r\n  const hashHex = hashArray.map((b) => b.toString(16).padStart(2, '0')).join('')\r\n\r\n  return hashHex\r\n}\r\n","import firebase from 'firebase/app'\r\nimport 'firebase/auth'\r\nimport 'firebase/firestore'\r\nimport { useEffect, useState } from 'react'\r\nimport { SupertagData, TagModifier, User } from 'r34-types'\r\nimport { sha256 } from '../data/encryption'\r\nimport useFirebaseAuthState from '../hooks/useFirebaseAuthState'\r\nimport { PreferencesState } from '../redux/reducers/preferences'\r\nimport { GenericConverter } from './genericConverter'\r\n\r\nconst userConverter = new GenericConverter<User>()\r\n\r\nasync function getUserDoc() {\r\n  try {\r\n    const { currentUser } = firebase.auth()\r\n    const email = currentUser?.email\r\n\r\n    if (email) {\r\n      const key = await sha256(email)\r\n      const userDoc = firebase.firestore().collection('users').doc(key)\r\n      return userDoc\r\n    }\r\n\r\n    return undefined\r\n  } catch (err) {\r\n    console.warn('Failed to get user document:', err)\r\n    return undefined\r\n  }\r\n}\r\n\r\nasync function getUserData() {\r\n  const userDoc = await getUserDoc()\r\n\r\n  if (userDoc) {\r\n    let userSnap = await userDoc.withConverter(userConverter).get()\r\n\r\n    const userData = userSnap.data()\r\n    return userData\r\n  }\r\n\r\n  return undefined\r\n}\r\n\r\nexport async function getPreferences() {\r\n  const userData = await getUserData()\r\n\r\n  if (userData) return userData.preferences\r\n\r\n  return undefined\r\n}\r\n\r\nexport async function setPreferences(preferences: PreferencesState) {\r\n  const userDoc = await getUserDoc()\r\n\r\n  await userDoc?.set({ preferences: preferences })\r\n}\r\n\r\nexport async function resetSeenPosts() {\r\n  console.warn('broken')\r\n}\r\n\r\nexport async function getSupertags() {\r\n  const userDoc = await getUserDoc()\r\n\r\n  if (userDoc) {\r\n    const snap = await userDoc.collection('supertags').get()\r\n    const result: Record<string, SupertagData> = {}\r\n\r\n    snap.forEach((doc) => {\r\n      result[doc.id] = doc.data() as SupertagData\r\n    })\r\n\r\n    return result\r\n  }\r\n\r\n  return undefined\r\n}\r\n\r\nexport async function addSupertag(name: string, description: string, tags: Record<string, TagModifier>) {\r\n  const userDoc = await getUserDoc()\r\n\r\n  userDoc?.collection('supertags').doc(name).set({ description, tags })\r\n}\r\n\r\nexport async function removeSupertag(name: string) {\r\n  const userDoc = await getUserDoc()\r\n\r\n  userDoc?.collection('supertags').doc(name).delete()\r\n}\r\n\r\nexport async function setTagsOfSupertag(name: string, tags: Record<string, TagModifier>) {\r\n  const userDoc = await getUserDoc()\r\n\r\n  userDoc?.collection('supertags').doc(name).update({ tags })\r\n}\r\n\r\nexport function useSupertags() {\r\n  const [supertags, setSupertags] = useState<Record<string, SupertagData>>({})\r\n  const [collection, setCollection] = useState<firebase.firestore.CollectionReference>()\r\n\r\n  const [, userInfo] = useFirebaseAuthState()\r\n\r\n  useEffect(() => {\r\n    if (userInfo?.email) {\r\n      sha256(userInfo.email)\r\n        .then((hash) => {\r\n          const col = firebase.firestore().collection(`users/${hash}/supertags`)\r\n          setCollection(col)\r\n          return col.get()\r\n        })\r\n        .then((snapshot) => {\r\n          const result = snapshot.docs.reduce((result, doc) => {\r\n            result[doc.id] = doc.data() as SupertagData\r\n            return result\r\n          }, {} as Record<string, SupertagData>)\r\n\r\n          setSupertags(result)\r\n        })\r\n        .catch((err) => {\r\n          console.error('Error with useSupertags', err)\r\n        })\r\n    }\r\n  }, [userInfo?.email])\r\n\r\n  useEffect(() => {\r\n    if (collection) {\r\n      const unsubscribe = collection.onSnapshot((snapshot) => {\r\n        const result = snapshot.docs.reduce((result, doc) => {\r\n          const userSupertags = doc\r\n          result[userSupertags.id] = doc.data() as SupertagData\r\n          return result\r\n        }, {} as Record<string, SupertagData>)\r\n\r\n        setSupertags(result)\r\n      })\r\n\r\n      return () => {\r\n        unsubscribe()\r\n      }\r\n    }\r\n  }, [collection])\r\n\r\n  return supertags\r\n}\r\n","import firebase from 'firebase/app'\r\n\r\nexport class GenericConverter<T> {\r\n  toFirestore(data: T): firebase.firestore.DocumentData {\r\n    return data\r\n  }\r\n  fromFirestore(snapshot: firebase.firestore.QueryDocumentSnapshot, options: firebase.firestore.SnapshotOptions): T {\r\n    const data = snapshot.data(options)!\r\n    return data as T\r\n  }\r\n}\r\n","import firebase from 'firebase/app'\r\nimport 'firebase/analytics'\r\nimport 'firebase/auth'\r\nimport 'firebase/firestore'\r\n\r\nconst firebaseConfig = {\r\n  apiKey: 'AIzaSyBHdepwE7M4Byu2lFtX2s__9COcMdvXu7Q',\r\n  authDomain: 'r34-react.firebaseapp.com',\r\n  databaseURL: 'https://r34-react.firebaseio.com',\r\n  projectId: 'r34-react',\r\n  storageBucket: 'r34-react.appspot.com',\r\n  messagingSenderId: '844749417844',\r\n  appId: '1:844749417844:web:11fa1fda0e14f1ac2dd021',\r\n  measurementId: 'G-27J3QXZ8YR',\r\n}\r\n\r\nfirebase.initializeApp(firebaseConfig)\r\n\r\nexport * from './analytics'\r\nexport * from './signIn'\r\nexport * from './storage'\r\n","import styled, { css } from 'styled-components'\nimport { flexRowWithGap } from '../../styled/mixins'\n\nexport const Title = styled.h2(\n  ({ theme }) => css`\n    font-size: ${theme.fontSizes.bigTitle};\n    font-weight: lighter;\n    text-align: center;\n  `\n)\n\nexport const BigTitle = styled.h1(\n  ({ theme }) => css`\n    ${flexRowWithGap({ theme })}\n\n    justify-content: center;\n    font-size: ${theme.fontSizes.bigTitle};\n    font-weight: lighter;\n    text-align: center;\n  `\n)\n\nexport const SmallTitle = styled.h3(\n  ({ theme }) => css`\n    font-size: ${theme.fontSizes.content};\n  `\n)\n\nexport const Faded = styled.span(\n  ({ theme }) => css`\n    color: ${theme.colors.subduedText};\n  `\n)\n","import { ModalId, SuggestionsError } from '../data/types'\nimport * as r34 from 'r34-types'\nimport { PreferencesState } from './reducers/preferences'\n\n// Action Names\nexport const ADD_ALIASES = `r34-react/ADD_ALIASES`\nexport const ADD_POSTS = `r34-react/ADD_POSTS`\nexport const ADD_TAG = `r34-react/ADD_TAG`\nexport const CLOSE_MODAL = `r34-react/CLOSE_MODAL`\nexport const ENTER_FULLSCREEN = `r34-react/ENTER_FULLSCREEN`\nexport const EXIT_FULLSCREEN = 'r34-react/EXIT_FULLSCREEN'\nexport const FETCH_COMMENTS = `r34-react/FETCH_COMMENTS`\nexport const FETCH_PREFERENCES = `r34-react/FETCH_PREFERENCES`\nexport const FETCH_SUGGESTIONS = `r34-react/FETCH_SUGGESTIONS`\nexport const GET_MORE_RESULTS = `r34-react/GET_MORE_RESULTS`\nexport const GET_RESULTS = `r34-react/GET_RESULTS`\nexport const LIKE_POST = `r34-react/LIKE_POST`\nexport const OPEN_MODAL = `r34-react/OPEN_MODAL`\nexport const REMOVE_TAG = `r34-react/REMOVE_TAG`\nexport const SAVE_PREFERENCES = 'r34-react/SAVE_PREFERENCES'\nexport const SET_COMMENTS = `r34-react/SET_COMMENTS`\nexport const SET_FULLSCREEN_POST = `r34-react/SET_FULLSCREEN_POST`\nexport const SET_POSTS = `r34-react/SET_POSTS`\nexport const SET_PREFERENCE = `r34-react/SET_PREFERENCE`\nexport const SET_PREFERENCES = `r34-react/SET_PREFERENCES`\nexport const SET_SUGGESTIONS = `r34-react/SET_SUGGESTIONS`\nexport const SET_SUGGESTIONS_ERROR = `r34-react/SET_SUGGESTIONS_ERROR`\nexport const SET_SUGGESTIONS_MODIFIER = 'r34-react/SET_SUGGESTIONS_MODIFIER'\n\n// Action Types\ninterface AddTagAction {\n  type: typeof ADD_TAG\n  tag: r34.AnyBiasedTag\n}\n\ninterface RemoveTagAction {\n  type: typeof REMOVE_TAG\n  tagName: string\n}\n\ninterface AddAliasesAction {\n  type: typeof ADD_ALIASES\n  aliases: r34.AliasTag[]\n  forTag: string\n}\n\nexport interface AddPostsAction {\n  type: typeof ADD_POSTS\n  posts: r34.Post[]\n}\n\nexport interface SetPostsAction {\n  type: typeof SET_POSTS\n  posts: r34.Post[]\n  count: number\n  pageNumber?: number\n}\n\ninterface SetCommentsAction {\n  type: typeof SET_COMMENTS\n  postId: number\n  comments: r34.Comment[]\n}\n\ninterface FetchCommentsAction {\n  type: typeof FETCH_COMMENTS\n  postId: number\n}\n\ninterface SetPreferenceAction {\n  type: typeof SET_PREFERENCE\n  key: r34.PreferenceKey\n  value: any\n}\n\ninterface SetPreferencesAction {\n  type: typeof SET_PREFERENCES\n  preferences: Partial<PreferencesState>\n}\n\ninterface GetResultsAction {\n  type: typeof GET_RESULTS\n  pageNumber: number\n}\n\ninterface GetMoreResultsAction {\n  type: typeof GET_MORE_RESULTS\n}\n\ninterface EnterFullcreenAction {\n  type: typeof ENTER_FULLSCREEN\n  postId: number\n}\n\ninterface SetFullScreenPostAction {\n  type: typeof SET_FULLSCREEN_POST\n  index: number\n}\n\ninterface ExitFullscreenAction {\n  type: typeof EXIT_FULLSCREEN\n}\n\ninterface LikePostAction {\n  type: typeof LIKE_POST\n  postId: number\n}\n\ninterface OpenModalAction {\n  type: typeof OPEN_MODAL\n  modalId: ModalId\n}\n\ninterface CloseModalAction {\n  type: typeof CLOSE_MODAL\n}\n\ninterface SetSuggestionsAction {\n  type: typeof SET_SUGGESTIONS\n  suggestions: r34.AnyTag[]\n}\n\ninterface SetSuggestionsErrorAction {\n  type: typeof SET_SUGGESTIONS_ERROR\n  error: SuggestionsError\n}\n\ninterface FetchSuggestionsAction {\n  type: typeof FETCH_SUGGESTIONS\n  value: string\n  includeSupertags: boolean\n}\n\ninterface FetchPreferencesAction {\n  type: typeof FETCH_PREFERENCES\n}\n\ninterface SavePreferencesAction {\n  type: typeof SAVE_PREFERENCES\n}\n\ninterface SetSuggestionsModifierAction {\n  type: typeof SET_SUGGESTIONS_MODIFIER\n  modifier: r34.TagModifier\n}\n\nexport type AppAction =\n  | AddAliasesAction\n  | AddPostsAction\n  | AddTagAction\n  | CloseModalAction\n  | EnterFullcreenAction\n  | ExitFullscreenAction\n  | FetchCommentsAction\n  | FetchPreferencesAction\n  | FetchSuggestionsAction\n  | GetMoreResultsAction\n  | GetResultsAction\n  | LikePostAction\n  | OpenModalAction\n  | RemoveTagAction\n  | SavePreferencesAction\n  | SetCommentsAction\n  | SetFullScreenPostAction\n  | SetPostsAction\n  | SetPreferenceAction\n  | SetPreferencesAction\n  | SetSuggestionsAction\n  | SetSuggestionsErrorAction\n  | SetSuggestionsModifierAction\n\n// Action Creators\nexport function addTag(tag: r34.AnyBiasedTag): AddTagAction {\n  return {\n    type: ADD_TAG,\n    tag,\n  }\n}\n\nexport function removeTag(tagName: string): RemoveTagAction {\n  return {\n    type: REMOVE_TAG,\n    tagName,\n  }\n}\n\nexport function addAliases(aliases: r34.AliasTag[], forTag: string): AddAliasesAction {\n  return {\n    type: ADD_ALIASES,\n    aliases,\n    forTag,\n  }\n}\n\nexport function addPosts(posts: r34.Post[]): AddPostsAction {\n  return {\n    type: ADD_POSTS,\n    posts,\n  }\n}\n\nexport function setPosts(posts: r34.Post[], count: number, pageNumber: number = 0): SetPostsAction {\n  return {\n    type: SET_POSTS,\n    posts,\n    count,\n    pageNumber,\n  }\n}\n\nexport function setComments(postId: number, comments: r34.Comment[]): SetCommentsAction {\n  return {\n    type: SET_COMMENTS,\n    postId,\n    comments,\n  }\n}\n\nexport function fetchComments(postId: number): FetchCommentsAction {\n  return {\n    type: FETCH_COMMENTS,\n    postId,\n  }\n}\n\nexport function setPreference(key: r34.PreferenceKey, value: any): SetPreferenceAction {\n  return {\n    type: SET_PREFERENCE,\n    key,\n    value,\n  }\n}\n\nexport function setPreferences(preferences: Partial<PreferencesState>): SetPreferencesAction {\n  return {\n    type: SET_PREFERENCES,\n    preferences,\n  }\n}\n\nexport function getResults(pageNumber: number = 0): GetResultsAction {\n  return {\n    type: GET_RESULTS,\n    pageNumber,\n  }\n}\n\nexport function getMoreResults(): GetMoreResultsAction {\n  return {\n    type: GET_MORE_RESULTS,\n  }\n}\n\nexport function enterFullscreen(postId: number): EnterFullcreenAction {\n  return {\n    type: ENTER_FULLSCREEN,\n    postId,\n  }\n}\n\nexport function exitFullscreen(): ExitFullscreenAction {\n  return {\n    type: EXIT_FULLSCREEN,\n  }\n}\n\nexport function setFullscreenPost(index: number): SetFullScreenPostAction {\n  return {\n    type: SET_FULLSCREEN_POST,\n    index,\n  }\n}\n\nexport function likePost(postId: number): LikePostAction {\n  return {\n    type: LIKE_POST,\n    postId,\n  }\n}\n\nexport function openModal(modalId: ModalId): OpenModalAction {\n  return {\n    type: OPEN_MODAL,\n    modalId,\n  }\n}\n\nexport function closeModal(): CloseModalAction {\n  return {\n    type: CLOSE_MODAL,\n  }\n}\n\nexport function setSuggestions(suggestions: r34.AnyTag[]): SetSuggestionsAction {\n  return {\n    type: SET_SUGGESTIONS,\n    suggestions,\n  }\n}\n\nexport function setSuggestionsError(error: SuggestionsError): SetSuggestionsErrorAction {\n  return {\n    type: SET_SUGGESTIONS_ERROR,\n    error,\n  }\n}\n\nexport function fetchSuggestions(value: string, includeSupertags: boolean): FetchSuggestionsAction {\n  return {\n    type: FETCH_SUGGESTIONS,\n    value,\n    includeSupertags,\n  }\n}\n\nexport function fetchPreferences(): FetchPreferencesAction {\n  return {\n    type: FETCH_PREFERENCES,\n  }\n}\n\nexport function savePreferences(): SavePreferencesAction {\n  return {\n    type: SAVE_PREFERENCES,\n  }\n}\n\nexport function setSuggestionsModifier(modifier: r34.TagModifier): SetSuggestionsModifierAction {\n  return {\n    type: SET_SUGGESTIONS_MODIFIER,\n    modifier,\n  }\n}\n","/**\n * Converts a list of objects into a map.\n * @param list The original list\n * @param keyProp The keyProp parameter defines which property of the objects will be used as the index for the map\n */\nexport const listToMap = <T>(list: T[], keyProp: string): Record<string, T> => {\n  return list.reduce((result: Record<string, T>, current: any) => {\n    result[current[keyProp]] = current\n    return result\n  }, {})\n}\n\n/**\n * Returns a URL object when the value is a hyperlink. Else undefined\n */\nexport function parseUrl(value: string) {\n  try {\n    return new URL(value)\n  } catch (err) {\n    // This is expected. If this method cannot parse the url it will return undefined.\n    return undefined\n  }\n}\n\n/**\n * converts a version like \"1.2.7\" into 127\n */\nexport function versionToNumber(majorMinorPatch: string) {\n  return Number(majorMinorPatch.split('.').join(''))\n}\n\n/**\n * Hacky ass way to download images cross origin. Could solve this by hosting both the app and the api on the same domain.\n */\nexport function download(url: string) {\n  const filename = url.split('/').pop() || ''\n\n  fetch(url, {\n    headers: new Headers({\n      Origin: window.location.origin,\n    }),\n    mode: 'cors',\n  })\n    .then((response) => response.blob())\n    .then((blob) => {\n      var a = document.createElement('a')\n      a.download = filename\n      a.href = window.URL.createObjectURL(blob)\n      document.body.appendChild(a)\n      a.click()\n      a.remove()\n    })\n    .catch((e) => console.error('Download error:', e))\n}\n\n/**\n * Returns the current version of the project\n */\nexport function getVersion() {\n  // Some browsers fail to get environment variables. In that case return unknown.\n  if (process?.env?.REACT_APP_VERSION) {\n    return process.env.REACT_APP_VERSION\n  }\n\n  return 'unknown'\n}\n\n/**\n * Render ready version.\n */\nexport function getVersionString() {\n  const version = getVersion()\n\n  return version === 'unknown' ? 'Latest Release' : `Version ${version}`\n}\n\n/**\n * Returns the correct source based on preferences\n */\nexport function getCorrectSource(loadOriginal: boolean, big_src: string, small_src: string) {\n  const source = loadOriginal ? big_src : small_src\n  return source\n}\n\nexport function boolToNumber(value: boolean) {\n  return value ? 1 : 0\n}\n","export const supportsFlexGap = (() => {\r\n  // create flex container with row-gap set\r\n  var flex = document.createElement('div')\r\n  flex.style.display = 'flex'\r\n  flex.style.flexDirection = 'column'\r\n  flex.style.rowGap = '1px'\r\n\r\n  // create two, elements inside it\r\n  flex.appendChild(document.createElement('div'))\r\n  flex.appendChild(document.createElement('div'))\r\n\r\n  // append to the DOM (needed to obtain scrollHeight)\r\n  document.body.appendChild(flex)\r\n  var isSupported = flex.scrollHeight === 1 // flex container should be 1px high from the row-gap\r\n  //@ts-expect-error\r\n  flex.parentNode.removeChild(flex)\r\n\r\n  return isSupported\r\n})()\r\n\r\nexport const supportsGap = 'gap' in document.body.style\r\nexport const supportsAspectRatio = 'aspect-ratio' in document.body.style\r\nexport const supportsObjectFit = 'object-fit' in document.body.style\r\nexport const supportsFullscreen = document.fullscreenEnabled\r\nexport const supportsNetworkInformationAPI =\r\n  'connection' in navigator || 'mozConnection' in navigator || 'webkitConnection' in navigator\r\n\r\nexport async function openFullscreen(element: Element) {\r\n  if (document.fullscreenEnabled && document.fullscreenElement === null) {\r\n    try {\r\n      const result = element.requestFullscreen()\r\n\r\n      if ('then' in result) {\r\n        return await result\r\n      }\r\n\r\n      return Promise.resolve(result)\r\n    } catch (err) {\r\n      // this causes a warning in console. So nothing to do for me here.\r\n    }\r\n  }\r\n\r\n  return null\r\n}\r\n\r\nexport async function closeFullscreen() {\r\n  if (document.fullscreenEnabled && document.fullscreenElement !== null) {\r\n    try {\r\n      const result = document.exitFullscreen()\r\n\r\n      if ('then' in result) {\r\n        return await result\r\n      }\r\n\r\n      return Promise.resolve(result)\r\n    } catch (err) {\r\n      // this causes a warning in console. So nothing to do for me here.\r\n    }\r\n  }\r\n\r\n  return null\r\n}\r\n","import { useCallback } from 'react'\nimport { useDispatch } from 'react-redux'\nimport { AnyAction } from 'redux'\n\n/**\n * A hook that simplifies usage of simple (unparameterized) Redux actions\n */\nexport default function useAction<T extends () => AnyAction>(actionCreator: T) {\n  const dispatch = useDispatch()\n\n  return useCallback(() => dispatch(actionCreator()), [actionCreator, dispatch])\n}\n","import { useCallback } from 'react'\nimport { PreferenceKey } from 'r34-types'\nimport { useDispatch, useSelector } from 'react-redux'\nimport { setPreference } from '../redux/actions'\nimport { PreferencesState } from '../redux/reducers/preferences'\nimport { selectPreferences } from '../redux/selectors'\n\n/**\n * useState for preferences using redux instead of local state.\n */\nexport default function usePreference<T extends PreferenceKey>(\n  key: T\n): [PreferencesState[T], (value: PreferencesState[T]) => void] {\n  const dispatch = useDispatch()\n  const preferences = useSelector(selectPreferences)\n  const setValue = useCallback((value: any) => dispatch(setPreference(key, value)), [dispatch, key])\n\n  return [preferences[key], setValue]\n}\n","import styled, { css } from 'styled-components'\n\nexport const HorizontalLine = styled.div(\n  (props) => css`\n    align-self: stretch;\n    height: 1px;\n    background: ${props.theme.colors.layerBg};\n  `\n)\n\nexport const VerticalLine = styled.div(\n  (props) => css`\n    width: 1px;\n    align-self: stretch;\n    background: ${props.theme.colors.layerBg};\n  `\n)\n","import { parseUrl } from '../data/utils'\n\n/**\n * Transforms a number into a shortened version for rendering.\n * Useful as it takes up less space.\n */\nexport const formatCount = (value: number) => {\n  if (value / 1e6 >= 1) {\n    return `${Math.trunc(value / 1e6)}M`\n  }\n\n  if (value >= 1e3) {\n    return `${Math.trunc(value / 1e3)}K`\n  }\n\n  return value.toString()\n}\n\n/**\n * Formats source strings for rendering\n */\nexport const formatSource = (source: string) => {\n  const url = parseUrl(source)\n  return url ? url.host : source\n}\n\n/**\n * Seconds to mm:ss formatter\n */\nexport function formatDuration(duration: number) {\n  const min = Math.trunc(duration / 60)\n  const sec = Math.trunc(duration % 60)\n\n  return min + ':' + (sec < 10 ? '0' : '') + sec\n}\n\n/**\n * Formats tag names for rendering.\n */\nexport function formatTagname(tagname: string) {\n  return tagname\n    .replace(/_/g, ' ')\n    .replace(/source:/g, '')\n    .replace(/rating:/g, '')\n}\n\n/**\n * Formats tags with their count if possible\n */\nexport function formatTagnameAndCount(name: string, count?: number) {\n  return count ? `${formatTagname(name)} (${formatCount(count)})` : formatTagname(name)\n}\n\nconst z = (value: number) => (value < 10 ? `0${value}` : value.toString())\n\n/**\n * Returns a string containing date and time of agiven Date object\n */\nexport function formatDatetime(date: Date) {\n  const dd = z(date.getDate())\n  const MM = z(date.getMonth() + 1) // zero indexed\n  const yyyy = date.getFullYear()\n  const hh = z(date.getHours())\n  const mm = z(date.getMinutes())\n\n  return `${dd}/${MM}/${yyyy} ${hh}:${mm}`\n}\n\n/**\n * Returns a human friendly approximation of a given time\n */\nexport function formatTime(milliseconds: number) {\n  if (milliseconds >= 315576e5) {\n    return formatUnit(milliseconds, 315576e5, 'year')\n  }\n\n  if (milliseconds >= 26297568e2) {\n    return formatUnit(milliseconds, 26297568e2, 'month')\n  }\n\n  if (milliseconds >= 6048e5) {\n    return formatUnit(milliseconds, 6048e5, 'week')\n  }\n\n  if (milliseconds >= 854e5) {\n    return formatUnit(milliseconds, 854e5, 'day')\n  }\n\n  if (milliseconds >= 36e5) {\n    return formatUnit(milliseconds, 36e5, 'hour')\n  }\n\n  if (milliseconds >= 6e4) {\n    return formatUnit(milliseconds, 6e4, 'minute')\n  }\n\n  if (milliseconds >= 1e3) {\n    return formatUnit(milliseconds, 1e3, 'second')\n  }\n\n  return `${milliseconds} ms`\n}\n\nexport function formatUnit(value: number, unitSize: number, unit: string) {\n  const result = (value / unitSize).toFixed(0)\n\n  const unitString = result === '1' ? unit : `${unit}s`\n\n  return `${result} ${unitString}`\n}\n","import styled from 'styled-components'\nimport { borderRadius, gutter, layer } from '../../styled/mixins'\n\nexport default styled.div`\n  display: grid;\n  ${gutter}\n  ${layer}\n  ${borderRadius}\n  width: 100%;\n`\n","import firebase from 'firebase/app'\r\nimport 'firebase/auth'\r\nimport { useEffect, useState } from 'react'\r\n\r\n/**\r\n * A hook that provides the firebase authentication status for use in functional components.\r\n */\r\nexport default function useFirebaseAuthState() {\r\n  const [authState, setAuthState] = useState(false)\r\n  const [user, setUser] = useState<firebase.User | null>(null)\r\n\r\n  useEffect(() => {\r\n    const unsubscribe = firebase.auth().onAuthStateChanged((user) => {\r\n      if (user) {\r\n        setAuthState(true)\r\n        setUser(user)\r\n      } else {\r\n        setAuthState(false)\r\n        setUser(null)\r\n      }\r\n    })\r\n    return () => {\r\n      unsubscribe()\r\n    }\r\n  }, [])\r\n\r\n  return [authState, user] as const\r\n}\r\n","import styled from 'styled-components'\nimport { preserveAspectRatio, flexMedia } from '../../styled/mixins'\n\nconst FlexImage = styled.img`\n  ${flexMedia}\n  ${preserveAspectRatio}\n`\n\nexport default FlexImage\n","import React, { MouseEventHandler } from 'react'\nimport FlexPair from './FlexPair'\nimport Toggle from './Toggle'\n\ninterface LabeledToggleProps {\n  children: React.ReactNode\n  value: boolean\n  onToggle: MouseEventHandler\n}\n\nexport default function LabeledToggle(props: LabeledToggleProps) {\n  const { children, value, onToggle } = props\n\n  return (\n    <FlexPair>\n      <Toggle value={value} onToggle={onToggle} />\n      <span>{children}</span>\n    </FlexPair>\n  )\n}\n","import { TagType } from 'r34-types'\nimport React from 'react'\nimport {\n  CharacterIcon,\n  CopyrightIcon,\n  ArtistIcon,\n  RatingIcon,\n  SourceIcon,\n  MetaDataIcon,\n  SupertagIcon,\n} from './FontAwesomeIcons'\n\ninterface TypeIconProps {\n  type?: TagType\n  className?: string\n}\n\nexport default function TypeIcon(props: TypeIconProps) {\n  const { type, className = '' } = props\n\n  switch (type) {\n    case 'character':\n      return <CharacterIcon className={className} />\n    case 'copyright':\n      return <CopyrightIcon className={className} />\n    case 'artist':\n      return <ArtistIcon className={className} />\n    case 'rating':\n      return <RatingIcon className={className} />\n    case 'source':\n      return <SourceIcon className={className} />\n    case 'metadata':\n      return <MetaDataIcon className={className} />\n    case 'supertag':\n      return <SupertagIcon className={className} />\n    default:\n      return null\n  }\n}\n","import styled from 'styled-components'\nimport { flexColumn, gutter, centeredMaxWidth } from '../../styled/mixins'\n\nconst FlexColumn = styled.div`\n  ${flexColumn}\n  width: 100%;\n  min-height: 100%;\n`\n\nexport default FlexColumn\n\nexport const FlexColumnWithSpacing = styled(FlexColumn)`\n  ${gutter}\n  ${centeredMaxWidth}\n`\n","import React, { MouseEventHandler } from 'react'\nimport styled, { css, DefaultTheme } from 'styled-components'\nimport { supportsAspectRatio } from '../../data/browserUtils'\nimport { defaultBorder } from '../../styled/mixins'\n\nconst Track = styled.div(\n  (props) => css`\n    height: 24px;\n    width: 50px;\n    ${defaultBorder(props)}\n    border-radius: 30px;\n    background-color: transparent;\n    transition: transform ${props.theme.timings.longTransitionTime} ease-in-out;\n    cursor: pointer;\n  `\n)\n\n/**\n * CSS helper that falls back to less fancy styling on older browsers\n */\nfunction circle() {\n  return supportsAspectRatio\n    ? css`\n        height: 100%;\n        aspect-ratio: 1/1;\n      `\n    : css`\n        height: 100%;\n        width: 22px;\n      `\n}\n\nconst Thumb = styled.div(\n  (props: { value: boolean; theme: DefaultTheme }) => css`\n    ${circle()}\n    background-color: ${props.value ? props.theme.colors.accentColor : props.theme.colors.backgroundColor2};\n    border-radius: 100px;\n    transition: all 0.2s ease-in-out;\n    transform: translate(${props.value ? '26px' : '0px'});\n  `\n)\n\ninterface ToggleProps {\n  value: boolean\n  onToggle: MouseEventHandler\n}\n\nexport default function Toggle(props: ToggleProps) {\n  const { value, onToggle } = props\n\n  return (\n    <Track onClick={onToggle} role='checkbox'>\n      <Thumb value={value} />\n    </Track>\n  )\n}\n","import React, { RefAttributes } from 'react'\nimport { Link, LinkProps, useLocation } from 'react-router-dom'\nimport styled, { css, ThemeProps } from 'styled-components'\nimport { RouteName } from '../../data/types'\nimport R34Icon from '../../icons/R34Icon'\nimport { flexColumn, flexColumnGap, flexRowGap, flexRowWithGap } from '../../styled/mixins'\nimport { VerticalLine } from '../designsystem/Lines'\nimport { BigTitle } from '../designsystem/Text'\n\nconst HeaderWrapper = styled.header(\n  ({ theme }) => css`\n    ${flexColumn()}\n    ${flexColumnGap(theme.dimensions.bigSpacing)}\n  `\n)\n\nconst TitleBar = styled.div(\n  ({ theme }) => css`\n    ${flexRowWithGap({ theme })}\n    justify-content: center;\n    background: ${theme.colors.layerBgSolid};\n    padding: ${theme.dimensions.gutter} 0;\n  `\n)\n\nconst MenuBar = styled.nav(\n  ({ theme }) => css`\n    display: flex;\n    justify-content: center;\n    padding: ${theme.dimensions.bigSpacing};\n    ${flexRowGap(theme.dimensions.hugeSpacing)}\n  `\n)\n\ntype LocationStyledLinkProps = LinkProps<unknown> &\n  RefAttributes<HTMLAnchorElement> &\n  ThemeProps<any> & { current: string }\n\nconst LocationStyledLink = styled(Link)(\n  ({ to, current, theme }: LocationStyledLinkProps) => css`\n    color: ${to === current ? theme.colors.accentColor : theme.colors.text};\n  `\n)\n\nexport default function Header() {\n  const current = useLocation().pathname\n\n  return (\n    <HeaderWrapper role='cell'>\n      <TitleBar>\n        <R34Icon size={32} />\n        <VerticalLine />\n        <BigTitle>\n          <span>Browse</span> <a href='https://rule34.xxx'>Rule34</a>\n        </BigTitle>\n      </TitleBar>\n\n      <MenuBar>\n        <LocationStyledLink current={current} to={RouteName.SEARCH}>\n          Search\n        </LocationStyledLink>\n        <VerticalLine />\n        <LocationStyledLink current={current} to={RouteName.SETTINGS}>\n          Settings\n        </LocationStyledLink>\n        <VerticalLine />\n        <LocationStyledLink current={current} to={RouteName.ABOUT}>\n          About\n        </LocationStyledLink>\n      </MenuBar>\n    </HeaderWrapper>\n  )\n}\n","import styled from 'styled-components'\nimport { flexRowWithGap } from '../../styled/mixins'\n\nconst FlexPair = styled.div`\n  ${flexRowWithGap}\n`\n\nexport default FlexPair\n"],"sourceRoot":""}