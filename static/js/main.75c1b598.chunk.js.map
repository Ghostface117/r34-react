{"version":3,"sources":["icons/OutOfResults.png","redux/actions.ts","redux/reducers/misc.ts","data/types.ts","redux/reducers/preferences.ts","redux/reducers/results.ts","redux/reducers/tags.ts","redux/reducers/index.ts","analytics/events.ts","redux/selectors.ts","redux/middleware/eventLogging.ts","misc/api.ts","data/Post.ts","data/Tag.ts","misc/prepare.ts","redux/middleware/apiRequests.ts","redux/store.ts","components/common/Title.tsx","components/common/Surface.tsx","components/common/Button.tsx","components/tagSelector/TagInput.tsx","components/tag/tagUtils.ts","misc/formatting.ts","misc/useToggle.ts","components/tag/Tag.tsx","icons/Icons.tsx","data/constants.ts","icons/TypeIcon.tsx","components/tagSelector/DropdownList.tsx","components/tagSelector/TagSelector.tsx","components/common/Toggle.tsx","components/common/LabeledToggle.tsx","components/features/Options.tsx","components/tag/TagList.tsx","icons/R34Icon.tsx","components/features/Header.tsx","components/features/Footer.tsx","components/common/FlexColumn.tsx","pages/Help.tsx","components/common/Setting.tsx","components/common/SmallTextInput.tsx","pages/Settings.tsx","components/layout/InfiniteColumn.tsx","components/common/IconAndText.tsx","components/post/widgets/Rating.tsx","components/post/widgets/Score.tsx","components/post/widgets/Source.tsx","components/post/Details.tsx","data/utils.ts","components/player/FlexVideo.tsx","components/styled/animations.tsx","components/player/Overlay.tsx","components/player/Video.tsx","components/player/utils.ts","components/player/FlexImage.tsx","components/player/Gif.tsx","components/player/Picture.tsx","components/player/Player.tsx","components/common/MaxWidthStyle.tsx","components/post/Post.tsx","components/features/SearchButton.tsx","components/features/ActiveTags.tsx","components/features/Config.tsx","components/layout/LayoutHeader.tsx","components/layout/LayoutOutOfItems.tsx","icons/Loading.tsx","components/layout/LayoutLoadingItem.tsx","pages/Search.tsx","components/features/CookieConfirmation.tsx","hooks/useAction.tsx","AppContent.tsx","misc/theme.ts","GlobalStyles.tsx","App.tsx","index.tsx"],"names":["module","exports","addTag","tag","type","setOption","key","value","allowCookiesAction","initialMiscState","activeMenu","initialPreferencesState","infinite","rated","ratedTreshold","originals","cookies","preloadVideos","tagSuggestionsCount","state","produce","draft","initialResultsState","posts","pageNumber","count","initialTagsState","active","aliases","combineReducers","tags","action","newTag","name","tagToRemove","removeTag","forTag","addAliases","results","window","addPosts","postCount","Number","setPosts","preferences","misc","menu","setActiveMenu","selectActiveTags","selectPosts","selectCount","selectPageNumber","selectPreferences","selectOriginals","selectCookies","selectAliases","Object","values","flat","selectOutOfResults","keys","length","config","apiKey","authDomain","databaseURL","projectId","storageBucket","messagingSenderId","appId","measurementId","firebaseApp","analytics","store","activeApi","fetch","catch","getTags","searchTerm","limit","res","json","getPosts","minScore","buildPostUrl","getAliases","tagName","page","tagString","map","modifier","encodeURIComponent","join","url","PostDataClass","constructor","id","score","rating","source","media_type","media_src","file_url","thumbnail_src","width","height","creator_id","creator_url","status","parent_id","has_children","has_comments","comments_url","has_notes","created_at","change","small_src","big_src","this","TagDataClass","types","preparePost","post","sample_url","preview_url","t","Boolean","persistConfig","storage","blacklist","persistedReducer","persistReducer","rootReducer","createStore","composeWithDevTools","applyMiddleware","next","getState","firebase","initializeApp","payload","logEvent","activeTags","page_number","active_tags","sort","searchEvent","api","then","dispatch","isOutOfResults","persistor","persistStore","styled","h2","BigTitle","h1","SmallTitle","h3","props","css","theme","fontSizes","content","div","dimensions","gutter","layer","shadow","box","borderRadius","Line","BasicButton","button","InvisibleButton","spacing","drop","timings","transitionTime","RedButton","blockHeight","colors","accentColor","backgroundColor","borderWidth","bigSpacing","longTransitionTime","backgroundColor2","BlockButton","AddButton","ModifierButton","Button","children","onClick","disabled","label","className","TypedButton","getButtonByType","aria-label","Input","input","TagInput","setValue","onChange","event","target","placeholder","prettifyTagname","tagname","replace","formatCount","numberString","number","toFixed","useToggle","initialValue","useState","toggleValue","useCallback","resetValue","TagWrapper","collapsed","fg","bg","switchingColors","IconWrapper","span","left","right","TagText","useDispatch","text","useSelector","stopPropagation","Alias","Tag","loadAliases","toggleCollapsed","resetCollapsed","useEffect","newAliases","a","b","filtered","filter","alias","isActive","showAliases","onMouseLeave","TypeIcon","ArrowIcon","aname","acount","StyledIcon","i","color","size","StyledSvg","svg","Icon","icon","prefix","CharacterIcon","attrs","ArtistIcon","CopyrightIcon","ExpandIcon","memo","ExternalLinkIcon","SourceIcon","RatingIcon","HeartIcon","TwitterIcon","LinkIcon","PlayIcon","PauseIcon","PixivIcon","viewBox","xmlns","fill","d","NO_OP","find","match","ListWrapper","tagSelector","offsetTop","clientHeight","offsetLeft","clientWidth","sizeAndPosition","tagSelectorRef","DropdownList","entries","entry","Entry","EntryWrapper","TypeWrapper","style","flexGrow","paddingRight","TagSelectorWrapper","closed","TagSelector","setModifier","suggestions","setSuggestions","setTagSelectorRef","activateTag","suggestion","dirtyTag","prepareTag","handle","setTimeout","toLowerCase","newSuggestions","clearTimeout","onModifierClick","onAddClick","trim","s","ref","Wrapper","Thumb","Toggle","onToggle","ToggleWrapper","LabeledToggle","OptionsWrapper","StyledInput","String","Options","ratedInputValue","setRatedInputValue","toggleRated","setRatedThreshold","display","onBlur","TagListWrapper","padding","TagList","R34Icon","useTheme","transform","cx","cy","stroke","strokeWidth","strokeMiterlimit","strokeDasharray","strokeOpacity","r","fontStyle","fontWeight","fontSize","fontFamily","letterSpacing","wordSpacing","fillOpacity","x","y","fontVariant","fontStretch","HeaderWrapper","header","Divider","TitleBar","MenuBar","nav","LocationStyledLink","Link","to","current","Header","useLocation","pathname","role","href","FotterWrapper","footer","CenteredA","Footer","FlexColumn","FlexColumnWithSpacing","StyledOl","ol","Help","Title","Surface","SettingGrid","SettingTitle","SettingBody","p","SettingControl","Setting","title","description","TextInput","SmallTextInput","Settings","togglePreloadVideos","toggleOriginals","setTagSuggestionCount","reset","localStorage","clear","location","reload","InifinteColumn","items","LoadingItem","hasMoreRows","ItemComponent","loadMore","OutOfItems","isLoading","setLoading","listRef","setListRef","cache","useMemo","CellMeasurerCache","fixedWidth","prependedRows","rowCount","isRowLoaded","index","listener","measureAllRows","recomputeRowHeights","forceUpdateGrid","addEventListener","removeEventListener","rowRenderer","parent","columnIndex","rowIndex","measure","registerChild","virtualRef","onLoad","console","warn","loadMoreRows","params","Promise","reject","resolve","onRowsRendered","child","deferredMeasurementCache","overscanRowCount","rowHeight","innerWidth","innerHeight","IconAndText","toUpperCase","ColoredA","startsWith","includes","TwitterLink","PixivSource","DefaultLink","FallbackSource","rel","sourceString","semiSanitized","substring","indexOf","formatSource","split","Bar","DetailsTagList","Details","tagsForRendering","listToMap","keyProp","reduce","result","Rating","Score","Source","FlexVideo","video","fadeOut","keyframes","isVisible","ProgressBar","OverlayButton","FullScreenButton","OpenExternalButton","PlayButton","Overlay","onFullscreen","togglePlay","isPaused","isPlayable","currentTime","duration","openInNewTab","toggleVisible","Video","src","videoRef","setVideoRef","Date","now","setTime","intervalId","setIntervalId","play","setInterval","pause","clearInterval","requestFullscreen","paused","controls","loop","preload","onLoadedMetadata","undefined","FlexImage","img","Gif","setPaused","usedSource","alt","loading","Picture","Player","URL","searchParams","get","open","media","MediaComponent","getMediaType","getMedia","ItemWrapper","PositonWrapper","MaxWidthStyle","PostWrapper","Post","loadOriginal","getCorrectSource","setCollapsed","toggleDetails","details","SearchButton","search","ActiveTags","ConfigWrapper","section","Config","htmlFor","LayoutHeader","fullNumber","toggleFullNumber","toLocaleString","LayoutOutOfItems","aliasesForRendering","outOfResultsPicture","textAlign","Loading","version","xmlnsXlink","enable-background","xmlSpace","attributeName","dur","repeatCount","begin","LayoutLoadingItem","Search","hasMorePosts","CookieWrapper","StyledSpan","CookieConfirmation","actionCreator","useAction","AppContent","basename","path","appMargin","hoverAccent","transistionTime","longTransistionTime","createGlobalStyle","App","GlobalStyles","ReactDOM","render","document","getElementById"],"mappings":"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","file":"static/js/main.75c1b598.chunk.js","sourcesContent":["module.exports = __webpack_public_path__ + \"static/media/OutOfResults.00a98fae.png\";","import { MenuType, PreferenceKey } from \"../data/types\";\r\nimport TagDataClass from \"../data/Tag\";\r\nimport PostDataClass from \"../data/Post\";\r\n\r\n/////////////////////////////////////////////////////////\r\n\r\nexport const RESET = \"R34_RESET\";\r\nexport const SET_ACTIVE_MENU = \"R34_SET_ACTIVE_MENU\";\r\nexport const ADD_TAG = \"R34_ADD_TAG\";\r\nexport const REMOVE_TAG = \"R34_REMOVE_TAG\";\r\nexport const ADD_ALIASES = \"R34_ADD_ALIASES\";\r\nexport const ADD_POSTS = \"R34_ADD_POSTS\";\r\nexport const SET_POSTS = \"R34_SET_POSTS\";\r\nexport const SET_OPTION = \"R34_SET_OPTION\";\r\nexport const GET_RESULTS = \"R34_GET_RESULTS\";\r\nexport const GET_MORE_RESULTS = \"R34_GET_MORE_RESULTS\";\r\nexport const ALLOW_COOKIES = \"R34_ALLOW_COOKIES\";\r\n\r\n/////////////////////////////////////////////////////////\r\n\r\ninterface ResetAction {\r\n  type: typeof RESET;\r\n}\r\n\r\ninterface SetActiveMenuAction {\r\n  type: typeof SET_ACTIVE_MENU;\r\n  menu: MenuType;\r\n}\r\n\r\ninterface AddTagAction {\r\n  type: typeof ADD_TAG;\r\n  tag: TagDataClass;\r\n}\r\n\r\ninterface RemoveTagAction {\r\n  type: typeof REMOVE_TAG;\r\n  tag: TagDataClass;\r\n}\r\n\r\ninterface AddAliasesAction {\r\n  type: typeof ADD_ALIASES;\r\n  aliases: TagDataClass[];\r\n  forTag: string;\r\n}\r\n\r\ninterface AddPostsAction {\r\n  type: typeof ADD_POSTS;\r\n  posts: PostDataClass[];\r\n}\r\n\r\ninterface SetPostsAction {\r\n  type: typeof SET_POSTS;\r\n  posts: PostDataClass[];\r\n  count: string;\r\n}\r\n\r\ninterface SetOptionAction {\r\n  type: typeof SET_OPTION;\r\n  key: PreferenceKey;\r\n  value: any;\r\n}\r\n\r\ninterface GetResultsAction {\r\n  type: typeof GET_RESULTS;\r\n}\r\n\r\ninterface GetMoreResultsAction {\r\n  type: typeof GET_MORE_RESULTS;\r\n}\r\n\r\ninterface AllowCookiesAction {\r\n  type: typeof ALLOW_COOKIES;\r\n  value: boolean;\r\n}\r\n\r\n/////////////////////////////////////////////////////////\r\n\r\nexport const reset = () => ({\r\n  type: RESET,\r\n});\r\n\r\nexport const setActiveMenu = (menu: MenuType) => ({\r\n  type: SET_ACTIVE_MENU,\r\n  menu,\r\n});\r\n\r\nexport const addTag = (tag: TagDataClass) => ({\r\n  type: ADD_TAG,\r\n  tag,\r\n});\r\n\r\nexport const removeTag = (tag: TagDataClass) => ({\r\n  type: REMOVE_TAG,\r\n  tag,\r\n});\r\n\r\nexport const addAliases = (aliases: TagDataClass[], forTag: string) => ({\r\n  type: ADD_ALIASES,\r\n  aliases,\r\n  forTag,\r\n});\r\n\r\nexport const addPosts = (posts: PostDataClass[]) => ({\r\n  type: ADD_POSTS,\r\n  posts,\r\n});\r\n\r\nexport const setPosts = (posts: PostDataClass[], count: string) => ({\r\n  type: SET_POSTS,\r\n  posts,\r\n  count,\r\n});\r\n\r\nexport const setOption = (key: PreferenceKey, value: any) => ({\r\n  type: SET_OPTION,\r\n  key,\r\n  value,\r\n});\r\n\r\nexport const getResults = () => ({\r\n  type: GET_RESULTS,\r\n});\r\n\r\nexport const getMoreResults = () => ({\r\n  type: GET_MORE_RESULTS,\r\n});\r\n\r\nexport const allowCookiesAction = () => ({\r\n  type: ALLOW_COOKIES,\r\n  value: true,\r\n});\r\n\r\n/////////////////////////////////////////////////////////\r\n\r\nexport type AppAction =\r\n  | ResetAction\r\n  | SetActiveMenuAction\r\n  | AddTagAction\r\n  | RemoveTagAction\r\n  | AddAliasesAction\r\n  | AddPostsAction\r\n  | SetPostsAction\r\n  | SetOptionAction\r\n  | GetResultsAction\r\n  | GetMoreResultsAction\r\n  | AllowCookiesAction;\r\n","import produce from \"immer\";\r\nimport { MenuType } from \"../../data/types\";\r\nimport { SET_ACTIVE_MENU, AppAction } from \"../actions\";\r\n\r\nexport interface MiscState {\r\n  activeMenu: MenuType;\r\n}\r\n\r\nexport const initialMiscState: MiscState = {\r\n  activeMenu: \"search\",\r\n};\r\n\r\nconst setActiveMenu = (state: MiscState, menu: MenuType) =>\r\n  produce(state, (draft) => {\r\n    draft.activeMenu = menu;\r\n  });\r\n\r\nexport default (\r\n  state: MiscState = initialMiscState,\r\n  action: AppAction\r\n): MiscState => {\r\n  switch (action.type) {\r\n    case SET_ACTIVE_MENU:\r\n      return setActiveMenu(state, action.menu);\r\n    default:\r\n      return state;\r\n  }\r\n};\r\n","export const GENERAL = \"general\";\r\nexport const CHARACTER = \"character\";\r\nexport const AMBIGUOUS = \"ambiguous\";\r\nexport const ARTIST = \"artist\";\r\nexport const COPYRIGHT = \"copyright\";\r\nexport type TagType =\r\n  | typeof GENERAL\r\n  | typeof CHARACTER\r\n  | typeof AMBIGUOUS\r\n  | typeof ARTIST\r\n  | typeof COPYRIGHT;\r\n\r\nexport const PLUS = \"+\";\r\nexport const MINUS = \"-\";\r\nexport type Modifier = typeof PLUS | typeof MINUS;\r\n\r\nexport const VIDEO = \"video\";\r\nexport const IMAGE = \"image\";\r\nexport type PostType = typeof VIDEO | typeof IMAGE;\r\n\r\nexport const PICTURE = \"picture\";\r\nexport const GIF = \"gif\";\r\nexport type MediaType = typeof VIDEO | typeof PICTURE | typeof GIF;\r\n\r\nexport const SEARCH = \"search\";\r\nexport const HELP = \"help\";\r\nexport const SETTINGS = \"settings\";\r\nexport type MenuType = typeof SEARCH | typeof HELP | typeof SETTINGS;\r\n\r\nexport const INVISIBLE = \"invisible\";\r\nexport const BLOCK = \"block\";\r\nexport const MODIFIER = \"modifier\";\r\nexport const ADD = \"add\";\r\nexport const RED = \"red\";\r\nexport type ButtonType =\r\n  | typeof INVISIBLE\r\n  | typeof BLOCK\r\n  | typeof MODIFIER\r\n  | typeof ADD\r\n  | typeof RED;\r\n\r\nexport const SAFE = \"safe\";\r\nexport const QUESTIONABLE = \"questionable\";\r\nexport const EXPLICIT = \"explicit\";\r\nexport type RatingType = typeof SAFE | typeof QUESTIONABLE | typeof EXPLICIT;\r\n\r\nexport const INFINITE = \"infinite\";\r\nexport const RATED = \"rated\";\r\nexport const RATEDTRESHOLD = \"ratedTreshold\";\r\nexport const ORIGINALS = \"originals\";\r\nexport const COOKIES = \"cookies\";\r\nexport const PRELOAD_VIDEOS = \"preload_videos\";\r\nexport const TAG_SUGGESTION_COUNT = \"tag_suggestion_count\";\r\n\r\nexport type PreferenceKey =\r\n  | typeof INFINITE\r\n  | typeof RATED\r\n  | typeof RATEDTRESHOLD\r\n  | typeof ORIGINALS\r\n  | typeof COOKIES\r\n  | typeof PRELOAD_VIDEOS\r\n  | typeof TAG_SUGGESTION_COUNT;\r\n\r\nexport interface SimpleMap<V> {\r\n  [key: string]: V;\r\n}\r\n\r\nexport interface SimpleList<V> {\r\n  [key: number]: V;\r\n}\r\n","import produce from \"immer\";\r\nimport {\r\n  PreferenceKey,\r\n  INFINITE,\r\n  RATED,\r\n  RATEDTRESHOLD,\r\n  ORIGINALS,\r\n  COOKIES,\r\n  PRELOAD_VIDEOS,\r\n  TAG_SUGGESTION_COUNT,\r\n} from \"../../data/types\";\r\nimport { AppAction, SET_OPTION, ALLOW_COOKIES } from \"../actions\";\r\n\r\nexport interface PreferencesState {\r\n  infinite: boolean;\r\n  rated: boolean;\r\n  ratedTreshold: number;\r\n  originals: boolean;\r\n  cookies: boolean;\r\n  preloadVideos: boolean;\r\n  tagSuggestionsCount: number;\r\n}\r\n\r\nexport const initialPreferencesState: PreferencesState = {\r\n  infinite: true,\r\n  rated: false,\r\n  ratedTreshold: 1,\r\n  originals: false,\r\n  cookies: false,\r\n  preloadVideos: false,\r\n  tagSuggestionsCount: 20,\r\n};\r\n\r\nconst setOption = (state: PreferencesState, key: PreferenceKey, value: any) =>\r\n  produce(state, (draft) => {\r\n    switch (key) {\r\n      case INFINITE:\r\n        draft.infinite = value;\r\n        break;\r\n      case RATED:\r\n        draft.rated = value;\r\n        break;\r\n      case RATEDTRESHOLD:\r\n        draft.ratedTreshold = value;\r\n        break;\r\n      case ORIGINALS:\r\n        draft.originals = value;\r\n        break;\r\n      case COOKIES:\r\n        draft.cookies = value;\r\n        break;\r\n      case PRELOAD_VIDEOS:\r\n        draft.preloadVideos = value;\r\n        break;\r\n      case TAG_SUGGESTION_COUNT:\r\n        draft.tagSuggestionsCount = value;\r\n        break;\r\n    }\r\n  });\r\n\r\nexport default (\r\n  state: PreferencesState = initialPreferencesState,\r\n  action: AppAction\r\n): PreferencesState => {\r\n  switch (action.type) {\r\n    case SET_OPTION:\r\n      return setOption(state, action.key, action.value);\r\n    case ALLOW_COOKIES:\r\n      return setOption(state, COOKIES, action.value);\r\n    default:\r\n      return state;\r\n  }\r\n};\r\n","import produce from \"immer\";\r\nimport PostDataClass from \"../../data/Post\";\r\nimport { SET_POSTS, ADD_POSTS, AppAction } from \"../actions\";\r\n\r\nexport interface ResultsState {\r\n  posts: PostDataClass[];\r\n  pageNumber: number;\r\n  count: number;\r\n}\r\n\r\nexport const initialResultsState: ResultsState = {\r\n  posts: [],\r\n  pageNumber: 0,\r\n  count: 0,\r\n};\r\n\r\nconst addPosts = (state: ResultsState, posts: PostDataClass[]) =>\r\n  produce(state, (draft) => {\r\n    draft.posts = [...state.posts, ...posts];\r\n    draft.pageNumber = state.pageNumber + 1;\r\n\r\n    //@ts-expect-error\r\n    window.posts = draft.posts;\r\n  });\r\n\r\nconst setPosts = (\r\n  state: ResultsState,\r\n  posts: PostDataClass[],\r\n  postCount: string\r\n) =>\r\n  produce(state, (draft) => {\r\n    draft.posts = posts;\r\n    draft.count = Number(postCount);\r\n    draft.pageNumber = 0;\r\n\r\n    //@ts-expect-error\r\n    window.posts = draft.posts;\r\n  });\r\n\r\nexport default (\r\n  state: ResultsState = initialResultsState,\r\n  action: AppAction\r\n): ResultsState => {\r\n  switch (action.type) {\r\n    case ADD_POSTS:\r\n      return addPosts(state, action.posts);\r\n    case SET_POSTS:\r\n      return setPosts(state, action.posts, action.count);\r\n    default:\r\n      return state;\r\n  }\r\n};\r\n","import produce from \"immer\";\r\nimport TagDataClass from \"../../data/Tag\";\r\nimport { SimpleMap } from \"../../data/types\";\r\nimport { ADD_TAG, AppAction, REMOVE_TAG, ADD_ALIASES } from \"../actions\";\r\n\r\nexport interface TagsState {\r\n  active: SimpleMap<TagDataClass>;\r\n  aliases: SimpleMap<TagDataClass[]>;\r\n}\r\n\r\nexport const initialTagsState: TagsState = {\r\n  active: {},\r\n  aliases: {},\r\n};\r\n\r\nconst addTag = (state: TagsState, newTag: TagDataClass) =>\r\n  produce(state, (draft) => {\r\n    draft.active[newTag.name] = { ...state.active[newTag.name], ...newTag };\r\n  });\r\n\r\nconst addAliases = (\r\n  state: TagsState,\r\n  aliases: TagDataClass[],\r\n  forTag: string\r\n) =>\r\n  produce(state, (draft) => {\r\n    draft.aliases[forTag] = aliases;\r\n  });\r\n\r\nconst removeTag = (state: TagsState, tagToRemove: TagDataClass) =>\r\n  produce(state, (draft) => {\r\n    delete draft.active[tagToRemove.name];\r\n    delete draft.aliases[tagToRemove.name];\r\n  });\r\n\r\nexport default (\r\n  state: TagsState = initialTagsState,\r\n  action: AppAction\r\n): TagsState => {\r\n  switch (action.type) {\r\n    case ADD_TAG:\r\n      return addTag(state, action.tag);\r\n    case REMOVE_TAG:\r\n      return removeTag(state, action.tag);\r\n    case ADD_ALIASES:\r\n      return addAliases(state, action.aliases, action.forTag);\r\n    default:\r\n      return state;\r\n  }\r\n};\r\n","import { combineReducers } from \"redux\";\r\nimport misc from \"./misc\";\r\nimport preferences from \"./preferences\";\r\nimport results from \"./results\";\r\nimport tags from \"./tags\";\r\n\r\nexport default combineReducers({ tags, results, preferences, misc });\r\n","import { Modifier, SimpleMap } from \"../data/types\";\r\nimport TagDataClass from \"../data/Tag\";\r\nimport { PreferencesState } from \"../redux/reducers/preferences\";\r\n\r\nconst SEARCH = \"r34_search\";\r\nconst ADD_TAG = \"r34_add_tag\";\r\n\r\ninterface SearchEvent {\r\n  id: typeof SEARCH;\r\n  payload: {\r\n    tags: string[];\r\n  };\r\n}\r\n\r\ninterface TagActivateEvent {\r\n  id: typeof ADD_TAG;\r\n  payload: {\r\n    name: string;\r\n    modifier: Modifier | undefined;\r\n  };\r\n}\r\n\r\nexport const searchEvent = (\r\n  activeTags: SimpleMap<TagDataClass>,\r\n  page_number: number,\r\n  preferences: PreferencesState\r\n) => ({\r\n  id: SEARCH,\r\n  payload: {\r\n    active_tags: Object.values(activeTags)\r\n      .map((tag) => `${tag.modifier}${tag.name}`)\r\n      .sort(),\r\n    page_number,\r\n    preferences,\r\n  },\r\n});\r\n\r\nexport const addTagEvent = (tag: TagDataClass) => ({\r\n  id: ADD_TAG,\r\n  payload: {\r\n    name: tag.name,\r\n    modifier: tag.modifier,\r\n  },\r\n});\r\n\r\nexport type EventType = SearchEvent | TagActivateEvent;\r\n","import { TagsState } from \"./reducers/tags\";\r\nimport { MiscState } from \"./reducers/misc\";\r\nimport { ResultsState } from \"./reducers/results\";\r\nimport { PreferencesState } from \"./reducers/preferences\";\r\n\r\ninterface RootState {\r\n  misc: MiscState;\r\n  results: ResultsState;\r\n  preferences: PreferencesState;\r\n  tags: TagsState;\r\n}\r\nexport const selectActiveTags = (state: RootState) => state.tags.active;\r\nexport const selectResults = (state: RootState) => state.results;\r\nexport const selectPosts = (state: RootState) => state.results.posts;\r\nexport const selectCount = (state: RootState) => state.results.count;\r\nexport const selectPageNumber = (state: RootState) => state.results.pageNumber;\r\nexport const selectPreferences = (state: RootState) => state.preferences;\r\nexport const selectInfinite = (state: RootState) => state.preferences.infinite;\r\nexport const selectOriginals = (state: RootState) =>\r\n  state.preferences.originals;\r\nexport const selectRated = (state: RootState) => state.preferences.rated;\r\nexport const selectRatedThreshold = (state: RootState) =>\r\n  state.preferences.ratedTreshold;\r\nexport const selectCookies = (state: RootState) => state.preferences.cookies;\r\nexport const selectActiveMenu = (state: RootState) => state.misc.activeMenu;\r\n\r\nexport const selectAliases = (state: RootState) =>\r\n  Object.values(state.tags.aliases).flat();\r\nexport const selectHasResults = (state: RootState) =>\r\n  Object.keys(state.results.posts).length !== 0;\r\nexport const selectOutOfResults = (state: RootState) =>\r\n  Object.keys(state.results.posts).length === state.results.count;\r\n\r\nexport const selectAliasesByTagName = (tagName: string) => (state: RootState) =>\r\n  state.tags.aliases[tagName];\r\n","import { ADD_TAG, AppAction, SET_POSTS, ADD_POSTS } from \"../actions\";\r\nimport firebase from \"firebase/app\";\r\nimport \"firebase/analytics\";\r\nimport { addTagEvent, searchEvent } from \"../../analytics/events\";\r\nimport {\r\n  selectActiveTags,\r\n  selectPreferences,\r\n  selectPageNumber,\r\n  selectCookies,\r\n} from \"../selectors\";\r\nimport { MiddlewareAPI, Dispatch } from \"redux\";\r\n\r\nconst config = {\r\n  apiKey: \"AIzaSyBHdepwE7M4Byu2lFtX2s__9COcMdvXu7Q\",\r\n  authDomain: \"r34-react.firebaseapp.com\",\r\n  databaseURL: \"https://r34-react.firebaseio.com\",\r\n  projectId: \"r34-react\",\r\n  storageBucket: \"r34-react.appspot.com\",\r\n  messagingSenderId: \"844749417844\",\r\n  appId: \"1:844749417844:web:11fa1fda0e14f1ac2dd021\",\r\n  measurementId: \"G-27J3QXZ8YR\",\r\n};\r\n\r\nlet firebaseApp: firebase.app.App;\r\nlet analytics: firebase.analytics.Analytics;\r\n\r\nexport default (store: MiddlewareAPI<any>) => (next: Dispatch<AppAction>) => (\r\n  action: AppAction\r\n) => {\r\n  const cookies = selectCookies(store.getState());\r\n\r\n  if (cookies) {\r\n    if (!firebaseApp) {\r\n      firebaseApp = firebase.initializeApp(config);\r\n      analytics = firebaseApp.analytics();\r\n    }\r\n\r\n    if (action.type === ADD_TAG) {\r\n      const { id, payload } = addTagEvent(action.tag);\r\n      analytics.logEvent<typeof id>(id, payload);\r\n    }\r\n\r\n    if (action.type === ADD_POSTS || action.type === SET_POSTS) {\r\n      const activeTags = selectActiveTags(store.getState());\r\n      const pageNumber = selectPageNumber(store.getState());\r\n      const preferences = selectPreferences(store.getState());\r\n      const { id, payload } = searchEvent(\r\n        activeTags,\r\n        action.type === SET_POSTS ? 0 : pageNumber + 1,\r\n        preferences\r\n      );\r\n      analytics.logEvent<typeof id>(id, payload);\r\n    }\r\n  }\r\n\r\n  next(action);\r\n};\r\n","import TagDataClass from \"../data/Tag\";\r\nimport { SimpleMap } from \"../data/types\";\r\n\r\nexport const pageSize = 20;\r\nconst apiUrl1 = \"https://r34-json.herokuapp.com\";\r\nconst apiUrl2 = \"https://r34-api-clone.herokuapp.com\";\r\n\r\nlet activeApi = apiUrl1;\r\n\r\n// Failover to apiUrl2\r\nfetch(activeApi).catch(() => (activeApi = apiUrl2));\r\n\r\nexport default {\r\n  async getTags(searchTerm: string, limit: number = pageSize) {\r\n    const res = await fetch(\r\n      `${activeApi}/tags?limit=${limit}&name=${searchTerm}*&order_by=posts`\r\n    );\r\n\r\n    return await res.json();\r\n  },\r\n\r\n  async getPosts(tags: SimpleMap<TagDataClass>, pageNumber = 0, minScore = 0) {\r\n    const res = await fetch(buildPostUrl(pageNumber, tags, minScore));\r\n\r\n    return await res.json();\r\n  },\r\n\r\n  async getAliases(tagName: string) {\r\n    const res = await fetch(`${activeApi}/alias/${tagName}`);\r\n\r\n    return await res.json();\r\n  },\r\n};\r\n\r\nfunction buildPostUrl(\r\n  page: number,\r\n  tags: SimpleMap<TagDataClass>,\r\n  minScore: number\r\n) {\r\n  const tagString = Object.values(tags)\r\n    .map(\r\n      (tag) =>\r\n        `${tag.modifier === \"-\" ? \"-\" : \"\"}${encodeURIComponent(tag.name)}`\r\n    )\r\n    .join(\"+\");\r\n\r\n  let url = `${activeApi}/posts?pid=${page}&limit=${pageSize}&tags=${tagString}`;\r\n\r\n  if (minScore > 0) {\r\n    url += `+${encodeURIComponent(\"score:>=\" + minScore)}`;\r\n  }\r\n\r\n  return url;\r\n}\r\n","import { RatingType, PostType } from \"./types\";\r\nimport TagDataClass from \"./Tag\";\r\n\r\nexport default class PostDataClass {\r\n  id: number;\r\n\r\n  score: number;\r\n  rating: RatingType;\r\n  source: string;\r\n  tags: TagDataClass[];\r\n\r\n  media_type: PostType;\r\n\r\n  thumbnail_src: string;\r\n  small_src: string;\r\n  big_src: string;\r\n\r\n  width: number;\r\n  height: number;\r\n\r\n  creator_id: number;\r\n  creator_url: string;\r\n\r\n  status: string;\r\n  parent_id: number;\r\n  has_children: boolean;\r\n  has_comments: boolean;\r\n  comments_url: string;\r\n  has_notes: boolean;\r\n  created_at: string;\r\n  change: string;\r\n\r\n  constructor(\r\n    id: number,\r\n    score: number,\r\n    rating: string,\r\n    source: string,\r\n    tags: TagDataClass[],\r\n    media_type: string,\r\n    media_src: any,\r\n    file_url: any,\r\n    thumbnail_src: string,\r\n    width: number,\r\n    height: number,\r\n    creator_id: number,\r\n    creator_url: string,\r\n    status: string,\r\n    parent_id: number,\r\n    has_children: boolean,\r\n    has_comments: boolean,\r\n    comments_url: string,\r\n    has_notes: boolean,\r\n    created_at: string,\r\n    change: string\r\n  ) {\r\n    this.id = id;\r\n\r\n    this.score = score;\r\n    this.rating = rating as RatingType;\r\n    this.source = source;\r\n    this.tags = tags;\r\n\r\n    this.media_type = media_type as PostType;\r\n    this.small_src = media_src;\r\n    this.big_src = file_url;\r\n    this.thumbnail_src = thumbnail_src;\r\n\r\n    this.width = width;\r\n    this.height = height;\r\n\r\n    this.creator_id = creator_id;\r\n    this.creator_url = creator_url;\r\n\r\n    this.status = status;\r\n    this.parent_id = parent_id;\r\n    this.has_children = has_children;\r\n    this.has_comments = has_comments;\r\n    this.comments_url = comments_url;\r\n    this.has_notes = has_notes;\r\n    this.created_at = created_at;\r\n    this.change = change;\r\n  }\r\n}\r\n","import { TagType, Modifier } from \"./types\";\r\n\r\nexport default class TagDataClass {\r\n  name: string;\r\n  count?: number | null;\r\n  types?: TagType[];\r\n  modifier?: Modifier;\r\n\r\n  constructor(\r\n    name: string,\r\n    types: TagType[] = [],\r\n    count: number | null = null,\r\n    modifier: Modifier = \"+\"\r\n  ) {\r\n    this.name = name;\r\n    this.types = types;\r\n    this.count = count;\r\n    this.modifier = modifier;\r\n  }\r\n}\r\n","import PostDataClass from \"../data/Post\";\r\nimport TagDataClass from \"../data/Tag\";\r\nimport { TagType, Modifier, RatingType } from \"../data/types\";\r\n\r\ninterface DirtyTag {\r\n  name: string;\r\n  types: string[];\r\n  count: string;\r\n  modifier: string;\r\n}\r\n\r\ninterface DirtyPost {\r\n  id: string;\r\n  type: string;\r\n  score: string;\r\n  rating: string;\r\n  source: string;\r\n  tags: string[];\r\n  file_url: string;\r\n  width: string;\r\n  height: string;\r\n  creator_id: string;\r\n  creator_url: string;\r\n  sample_url: string;\r\n  preview_url: string;\r\n  status: string;\r\n  parent_id: string;\r\n  has_children: string;\r\n  has_comments: string;\r\n  comments_url: string;\r\n  has_notes: string;\r\n  created_at: string;\r\n  change: string;\r\n}\r\n\r\nexport function prepareTag(dirtyTag: DirtyTag) {\r\n  const { name, types, count, modifier } = dirtyTag;\r\n\r\n  return new TagDataClass(\r\n    name,\r\n    types as TagType[],\r\n    Number(count),\r\n    modifier as Modifier\r\n  );\r\n}\r\n\r\nexport function preparePost(post: DirtyPost) {\r\n  const {\r\n    id,\r\n    type,\r\n    score,\r\n    rating,\r\n    source,\r\n    tags,\r\n    file_url,\r\n    width,\r\n    height,\r\n    creator_id,\r\n    creator_url,\r\n    sample_url,\r\n    preview_url,\r\n    status,\r\n    parent_id,\r\n    has_children,\r\n    has_comments,\r\n    comments_url,\r\n    has_notes,\r\n    created_at,\r\n    change,\r\n  } = post;\r\n  return new PostDataClass(\r\n    Number(id),\r\n    Number(score),\r\n    rating as RatingType,\r\n    source,\r\n    tags ? tags.map((t) => new TagDataClass(t)) : [],\r\n    type,\r\n    sample_url,\r\n    file_url,\r\n    preview_url,\r\n    Number(width),\r\n    Number(height),\r\n    Number(creator_id),\r\n    creator_url,\r\n    status,\r\n    Number(parent_id),\r\n    Boolean(has_children),\r\n    Boolean(has_comments),\r\n    comments_url,\r\n    Boolean(has_notes),\r\n    created_at,\r\n    change\r\n  );\r\n}\r\n","import { MiddlewareAPI } from \"redux\";\r\nimport { Dispatch } from \"react\";\r\nimport {\r\n  AppAction,\r\n  GET_RESULTS,\r\n  GET_MORE_RESULTS,\r\n  addPosts,\r\n  setPosts,\r\n} from \"../actions\";\r\nimport api from \"../../misc/api\";\r\nimport { preparePost } from \"../../misc/prepare\";\r\nimport {\r\n  selectActiveTags,\r\n  selectPreferences,\r\n  selectPageNumber,\r\n  selectOutOfResults,\r\n} from \"../selectors\";\r\n\r\nexport default (store: MiddlewareAPI<any>) => (next: Dispatch<AppAction>) => (\r\n  action: AppAction\r\n) => {\r\n  if (action.type === GET_RESULTS) {\r\n    const activeTags = selectActiveTags(store.getState());\r\n    const { rated, ratedTreshold } = selectPreferences(store.getState());\r\n    api.getPosts(activeTags, 0, rated ? ratedTreshold : 0).then((res) => {\r\n      store.dispatch(setPosts(res.posts.map(preparePost), res.count));\r\n    });\r\n  }\r\n\r\n  const isOutOfResults = selectOutOfResults(store.getState());\r\n  if (action.type === GET_MORE_RESULTS && !isOutOfResults) {\r\n    const activeTags = selectActiveTags(store.getState());\r\n    const pageNumber = selectPageNumber(store.getState());\r\n    const { rated, ratedTreshold } = selectPreferences(store.getState());\r\n\r\n    api\r\n      .getPosts(activeTags, pageNumber + 1, rated ? ratedTreshold : 0)\r\n      .then((res) => {\r\n        store.dispatch(addPosts(res.posts.map(preparePost)));\r\n      });\r\n  }\r\n\r\n  next(action);\r\n};\r\n","import { createStore, applyMiddleware } from \"redux\";\r\nimport { persistStore, persistReducer } from \"redux-persist\";\r\nimport storage from \"redux-persist/lib/storage\";\r\nimport rootReducer from \"./reducers\";\r\nimport eventLogging from \"./middleware/eventLogging\";\r\nimport apiRequests from \"./middleware/apiRequests\";\r\nimport { composeWithDevTools } from \"redux-devtools-extension\";\r\n\r\nconst persistConfig = {\r\n  key: \"appstate\",\r\n  storage,\r\n  blacklist: [\"results\"],\r\n};\r\n\r\nconst persistedReducer = persistReducer(persistConfig, rootReducer);\r\n\r\nexport const store = createStore(\r\n  persistedReducer,\r\n  composeWithDevTools(applyMiddleware(eventLogging, apiRequests))\r\n);\r\nexport const persistor = persistStore(store);\r\n","import styled, { css } from \"styled-components\";\r\n\r\nexport default styled.h2`\r\n  font-size: 24px;\r\n  font-weight: lighter;\r\n  text-align: center;\r\n`;\r\n\r\nexport const BigTitle = styled.h1`\r\n  display: flex;\r\n  justify-content: center;\r\n  font-size: 24px;\r\n  font-weight: lighter;\r\n  text-align: center;\r\n`;\r\n\r\nexport const SmallTitle = styled.h3(\r\n  (props) => css`\r\n    font-size: ${props.theme.fontSizes.content};\r\n  `\r\n);\r\n","import styled, { css } from \"styled-components\";\r\n\r\nexport default styled.div(\r\n  (props) => css`\r\n    display: grid;\r\n    padding: ${props.theme.dimensions.gutter};\r\n    background: ${props.theme.misc.layer};\r\n    ${props.theme.shadow.box};\r\n    border-radius: ${props.theme.dimensions.borderRadius};\r\n    width: 100%;\r\n    gap: ${props.theme.dimensions.gutter};\r\n  `\r\n);\r\n\r\nexport const Line = styled.div(\r\n  (props) => css`\r\n    width: 100%;\r\n    height: 1px;\r\n    background: ${props.theme.misc.layer};\r\n  `\r\n);\r\n","import React, { MouseEventHandler } from \"react\";\r\nimport styled, { css } from \"styled-components\";\r\nimport { ButtonType, BLOCK, INVISIBLE, MODIFIER, ADD } from \"../../data/types\";\r\n\r\nconst BasicButton = styled.button(\r\n  ({ theme }) => css`\r\n    font-size: ${theme.fontSizes.content};\r\n  `\r\n);\r\n\r\nconst InvisibleButton = styled(BasicButton)(\r\n  ({ theme }) => css`\r\n    background-color: transparent;\r\n    border: none;\r\n    padding: ${theme.dimensions.spacing};\r\n    filter: ${theme.shadow.drop};\r\n\r\n    svg {\r\n      transition: all ${theme.timings.transitionTime} ease-in-out;\r\n    }\r\n\r\n    :hover {\r\n      svg {\r\n        transform: scale(1.1);\r\n      }\r\n    }\r\n  `\r\n);\r\n\r\nconst RedButton = styled(BasicButton)(\r\n  ({ theme }) => css`\r\n    height: ${theme.dimensions.blockHeight};\r\n    font-size: ${theme.fontSizes.content};\r\n    color: ${theme.colors.accentColor};\r\n    background: ${theme.colors.backgroundColor};\r\n    border: ${theme.colors.accentColor} ${theme.dimensions.borderWidth} solid;\r\n    border-radius: ${theme.dimensions.borderRadius};\r\n    padding: 0 ${theme.dimensions.bigSpacing};\r\n\r\n    transition: border-color ${theme.timings.longTransitionTime} ease-in-out;\r\n    transition: color ${theme.timings.longTransitionTime} ease-in-out;\r\n    transition: background-color ${theme.timings.longTransitionTime} ease-in-out;\r\n\r\n    :hover {\r\n      background-color: ${theme.colors.accentColor};\r\n      color: ${theme.colors.backgroundColor};\r\n    }\r\n\r\n    :active,\r\n    :focus {\r\n      color: ${theme.colors.backgroundColor2};\r\n\r\n      border-color: ${theme.colors.backgroundColor2};\r\n      cursor: pointer;\r\n    }\r\n  `\r\n);\r\n\r\nexport const BlockButton = styled(RedButton)(\r\n  ({ theme }) => css`\r\n    width: 100%;\r\n  `\r\n);\r\n\r\nexport const AddButton = styled(RedButton)(\r\n  ({ theme }) => css`\r\n    border-left-width: 0;\r\n    border-radius: 0 ${theme.dimensions.borderRadius}\r\n      ${theme.dimensions.borderRadius} 0;\r\n  `\r\n);\r\n\r\nexport const ModifierButton = styled(BasicButton)(\r\n  ({ theme }) => css`\r\n    background-color: transparent;\r\n    min-width: 48px;\r\n    border: ${theme.colors.accentColor} ${theme.dimensions.borderWidth} solid;\r\n    border-right-width: 0;\r\n    border-radius: ${theme.dimensions.borderRadius} 0 0\r\n      ${theme.dimensions.borderRadius};\r\n    font-weight: bold;\r\n  `\r\n);\r\n\r\nconst getButtonByType = (type: ButtonType, active: boolean) => {\r\n  switch (type) {\r\n    case INVISIBLE:\r\n      return InvisibleButton;\r\n    case BLOCK:\r\n      return BlockButton;\r\n    case MODIFIER:\r\n      return ModifierButton;\r\n    case ADD:\r\n      return AddButton;\r\n    default:\r\n      return RedButton;\r\n  }\r\n};\r\n\r\ninterface ButtonProps {\r\n  type: ButtonType;\r\n  children: JSX.Element | string;\r\n  onClick: MouseEventHandler;\r\n  active?: boolean;\r\n  disabled?: boolean;\r\n  label: string;\r\n  className?: string;\r\n}\r\n\r\nfunction Button(props: ButtonProps) {\r\n  const {\r\n    type,\r\n    children,\r\n    onClick,\r\n    active = false,\r\n    disabled = false,\r\n    label,\r\n    className = \"\",\r\n  } = props;\r\n  const TypedButton = getButtonByType(type, active);\r\n\r\n  return (\r\n    <TypedButton\r\n      onClick={onClick}\r\n      disabled={disabled}\r\n      aria-label={label}\r\n      className={className}\r\n    >\r\n      {children}\r\n    </TypedButton>\r\n  );\r\n}\r\n\r\nexport default Button;\r\n","import React from \"react\";\r\nimport styled, { css } from \"styled-components\";\r\n\r\nconst Input = styled.input(\r\n  (props) => css`\r\n    width: 100%;\r\n    border: none;\r\n    outline: none;\r\n    background: none;\r\n    font-size: ${props.theme.fontSizes.content};\r\n    border-top: ${props.theme.colors.accentColor}\r\n      ${props.theme.dimensions.borderWidth} solid;\r\n    border-bottom: ${props.theme.colors.accentColor}\r\n      ${props.theme.dimensions.borderWidth} solid;\r\n  `\r\n);\r\n\r\ninterface TagInputProps {\r\n  value: string;\r\n  setValue: (newValue: string) => void;\r\n}\r\n\r\nexport default function TagInput(props: TagInputProps) {\r\n  const { value, setValue } = props;\r\n  return (\r\n    <Input\r\n      id=\"tag-input\"\r\n      value={value}\r\n      onChange={(event) => setValue(event.target.value)}\r\n      placeholder=\"Search for tags\"\r\n      aria-label=\"Search\"\r\n    />\r\n  );\r\n}\r\n","export function prettifyTagname(tagname: string) {\r\n  return tagname.replace(/_/g, \" \");\r\n}\r\n\r\nexport function normalizeTagname(tagname: string) {\r\n  return tagname.toLowerCase().replace(/ /g, \"_\");\r\n}\r\n","export const formatCount = (numberString: number) => {\r\n  const number = numberString;\r\n\r\n  if (number >= 1e6) {\r\n    return `${(number / 1e6).toFixed(0)}M`;\r\n  }\r\n\r\n  if (number >= 1e3) {\r\n    return `${(number / 1e3).toFixed(0)}K`;\r\n  }\r\n\r\n  return number;\r\n};\r\n\r\n/**\r\n * @param {String} sourceString\r\n */\r\nexport const formatSource = (sourceString: string) => {\r\n  if (\r\n    sourceString.includes(\"http:\") ||\r\n    sourceString.includes(\"https:\") ||\r\n    sourceString.includes(\"www.\") ||\r\n    sourceString.includes(\".com\")\r\n  ) {\r\n    let semiSanitized = sourceString\r\n      .replace(/https?:\\/\\//, \"\")\r\n      .replace(/ww[w\\d]\\./, \"\")\r\n      .replace(\".com\", \"\")\r\n      .replace(\".org\", \"\")\r\n      .replace(\".net\", \"\");\r\n\r\n    return semiSanitized.substring(0, semiSanitized.indexOf(\"/\"));\r\n  } else {\r\n    return sourceString;\r\n  }\r\n};\r\n","import { useCallback, useState } from \"react\";\r\n\r\nexport default function useToggle(\r\n  initialValue = false\r\n): [boolean, () => void, () => void] {\r\n  const [value, setValue] = useState<boolean>(initialValue);\r\n  const toggleValue = useCallback(() => setValue(!value), [value]);\r\n  const resetValue = useCallback(() => setValue(initialValue), [initialValue]);\r\n\r\n  return [value, toggleValue, resetValue];\r\n}\r\n","import React, { useEffect, MouseEventHandler } from \"react\";\r\nimport styled, { css } from \"styled-components\";\r\nimport \"./Tag.css\";\r\nimport api from \"../../misc/api\";\r\nimport TypeIcon from \"../../icons/TypeIcon\";\r\nimport { ArrowIcon } from \"../../icons/Icons\";\r\nimport { prettifyTagname } from \"./tagUtils\";\r\nimport { formatCount } from \"../../misc/formatting\";\r\nimport TagDataClass from \"../../data/Tag\";\r\nimport { useDispatch, useSelector } from \"react-redux\";\r\nimport {\r\n  selectActiveTags,\r\n  selectAliasesByTagName,\r\n} from \"../../redux/selectors\";\r\nimport { addAliases, removeTag, addTag } from \"../../redux/actions\";\r\nimport { ThemeType } from \"../../misc/theme\";\r\nimport useToggle from \"../../misc/useToggle\";\r\n\r\nconst dropdownBorderRadius = (collapsed: boolean, theme: ThemeType) =>\r\n  collapsed\r\n    ? theme.dimensions.borderRadius\r\n    : `${theme.dimensions.borderRadius} ${theme.dimensions.borderRadius} 0 0`;\r\n\r\nconst switchingColors = (active: boolean, theme: ThemeType) => {\r\n  const fg = active ? theme.colors.backgroundColor : theme.colors.accentColor;\r\n  const bg = active ? theme.colors.accentColor : theme.colors.backgroundColor;\r\n\r\n  return css`\r\n    color: ${fg};\r\n    background-color: ${bg};\r\n    border: ${theme.colors.accentColor} ${theme.dimensions.borderWidth} solid;\r\n    transition: background-color 0.4s ease-in-out;\r\n\r\n    cursor: pointer;\r\n\r\n    :hover,\r\n    :focus,\r\n    :active {\r\n      border-color: ${theme.colors.backgroundColor2};\r\n      color: ${theme.colors.backgroundColor2};\r\n\r\n      i {\r\n        color: ${theme.colors.backgroundColor2};\r\n      }\r\n    }\r\n  `;\r\n};\r\n\r\nexport const TagWrapper = styled.div(\r\n  (props: {\r\n    active: boolean;\r\n    collapsed: boolean;\r\n    onMouseLeave: MouseEventHandler;\r\n    theme: ThemeType;\r\n  }) =>\r\n    css`\r\n      display: inline-block;\r\n      padding: 0.25rem;\r\n      border-radius: ${dropdownBorderRadius(props.collapsed, props.theme)};\r\n      font-size: ${props.theme.fontSizes.content};\r\n      line-height: 1.2;\r\n      vertical-align: baseline;\r\n      margin: ${props.theme.dimensions.spacing};\r\n      ${switchingColors(props.active, props.theme)}\r\n    `\r\n);\r\n\r\nconst IconWrapper = styled.span(\r\n  (props: { left?: boolean; right?: boolean }) => css`\r\n    ${props.left ? \"margin-right: 5px;\" : \"\"}\r\n    ${props.right ? \"margin-left: 5px;\" : \"\"}\r\n  `\r\n);\r\n\r\ninterface TagProps extends TagDataClass {\r\n  loadAliases: boolean;\r\n}\r\n\r\ntype TagLike = {\r\n  name: string;\r\n  posts: number;\r\n};\r\n\r\nfunction Tag(props: TagProps) {\r\n  const { name, count, modifier, types, loadAliases } = props;\r\n  const activeTags = useSelector(selectActiveTags);\r\n  const aliases = useSelector(selectAliasesByTagName(name));\r\n  const [collapsed, toggleCollapsed, resetCollapsed] = useToggle(true);\r\n  const dispatch = useDispatch();\r\n\r\n  useEffect(() => {\r\n    if (loadAliases && activeTags[name])\r\n      api.getAliases(name).then((newAliases: TagLike[]) => {\r\n        newAliases.sort((a, b) => b.posts - a.posts);\r\n        const filtered = newAliases\r\n          .filter((alias) => !activeTags[alias.name])\r\n          .map((alias) => new TagDataClass(alias.name, [], alias.posts));\r\n        dispatch(addAliases(filtered, name));\r\n      });\r\n  }, [loadAliases, name, activeTags, dispatch]);\r\n\r\n  const isActive = Boolean(activeTags[name]);\r\n  const showAliases = loadAliases && aliases && aliases.length > 0;\r\n\r\n  return (\r\n    <TagWrapper\r\n      active={isActive}\r\n      collapsed={collapsed}\r\n      onMouseLeave={resetCollapsed}\r\n    >\r\n      <TypeIcon types={types} left />\r\n      <TagText name={name} count={count} modifier={modifier} types={types} />\r\n      {showAliases && (\r\n        <>\r\n          <IconWrapper right onClick={toggleCollapsed}>\r\n            <ArrowIcon />\r\n          </IconWrapper>\r\n          <div className={\"dropdown-list\" + (!collapsed ? \" visible\" : \"\")}>\r\n            {aliases.map(({ name: aname, count: acount }) => (\r\n              <Alias key={\"t_\" + aname} name={aname} count={acount} />\r\n            ))}\r\n          </div>\r\n        </>\r\n      )}\r\n    </TagWrapper>\r\n  );\r\n}\r\n\r\nfunction TagText(props: TagDataClass) {\r\n  const { name, count, modifier, types } = props;\r\n  const dispatch = useDispatch();\r\n  const tagname = prettifyTagname(name);\r\n  const text = count ? `${tagname} (${formatCount(count)})` : tagname;\r\n  const activeTags = useSelector(selectActiveTags);\r\n\r\n  const onClick: MouseEventHandler = (event) => {\r\n    event.stopPropagation();\r\n    if (activeTags[name])\r\n      dispatch(removeTag(new TagDataClass(name, types, count)));\r\n    else dispatch(addTag(new TagDataClass(name, types, count)));\r\n  };\r\n\r\n  return (\r\n    <span onClick={onClick}>{modifier === \"-\" ? <s>{text}</s> : text}</span>\r\n  );\r\n}\r\n\r\nfunction Alias(props: TagDataClass) {\r\n  const { name, count } = props;\r\n  return (\r\n    <div className=\"alias\">\r\n      <TagText name={name} count={count} />\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default Tag;\r\n","import React, { MouseEventHandler, memo } from \"react\";\r\nimport styled, { css } from \"styled-components\";\r\nimport { TagWrapper } from \"../components/tag/Tag\";\r\nimport { ThemeType } from \"../misc/theme\";\r\n\r\nexport const StyledIcon = styled.i(\r\n  (props: { color: string; size: number; theme: ThemeType }) => css`\r\n    color: ${props.color};\r\n    min-width: ${props.size}px;\r\n    height: ${props.size}px;\r\n\r\n    ${TagWrapper}:hover & {\r\n      color: ${props.theme.colors.accentColor};\r\n    }\r\n\r\n    ${TagWrapper}:active & ,  ${TagWrapper}:focus & {\r\n      color: ${props.theme.colors.backgroundColor2};\r\n    }\r\n  `\r\n);\r\n\r\nconst StyledSvg = styled.svg(\r\n  (props: { size: number } & JSX.IntrinsicAttributes) => css`\r\n    width: ${props.size}px;\r\n    height: ${props.size}px;\r\n  `\r\n);\r\n\r\nconst IconWrapper = styled.span(\r\n  (props: { left: boolean; right: boolean }) => css``\r\n);\r\n\r\ninterface IconProps {\r\n  icon: string;\r\n  className?: string;\r\n  color?: string;\r\n  size?: number;\r\n  onClick?: MouseEventHandler;\r\n  left?: boolean;\r\n  right?: boolean;\r\n  prefix?: string;\r\n}\r\n\r\nconst Icon = (props: IconProps) => {\r\n  const {\r\n    icon,\r\n    className = \"\",\r\n    color = \"black\",\r\n    size = 14,\r\n    onClick = () => {},\r\n    left = false,\r\n    right = false,\r\n    prefix = \"fas\",\r\n  } = props;\r\n  return (\r\n    <IconWrapper onClick={onClick} left={left} right={right}>\r\n      <StyledIcon\r\n        className={`${prefix} ${icon} ${className}`}\r\n        color={color}\r\n        size={size}\r\n      />\r\n    </IconWrapper>\r\n  );\r\n};\r\n\r\nexport const CharacterIcon = styled(Icon).attrs({\r\n  icon: \"fa-user\",\r\n})``;\r\n\r\nexport const ArtistIcon = styled(Icon).attrs({\r\n  icon: \"fa-pen\",\r\n})``;\r\n\r\nexport const CopyrightIcon = styled(Icon).attrs({\r\n  icon: \"fa-copyright\",\r\n})``;\r\n\r\nexport const PlusIcon = styled(Icon).attrs({\r\n  icon: \"fa-plus-circle\",\r\n})``;\r\n\r\nexport const MinusIcon = styled(Icon).attrs({\r\n  icon: \"fa-minus-circle\",\r\n})``;\r\n\r\nexport const CloseIcon = styled(Icon).attrs({\r\n  icon: \"fa-times\",\r\n})``;\r\n\r\nexport const ExpandIcon = memo(\r\n  styled(Icon).attrs({\r\n    icon: \"fa-expand\",\r\n  })``\r\n);\r\n\r\nexport const ArrowIcon = styled(Icon).attrs({\r\n  icon: \"fa-caret-down\",\r\n})``;\r\n\r\nexport const ExternalLinkIcon = styled(Icon).attrs({\r\n  icon: \"fa-external-link-alt\",\r\n})``;\r\n\r\nexport const SourceIcon = styled(Icon).attrs({\r\n  icon: \"fa-hashtag\",\r\n})``;\r\n\r\nexport const RatingIcon = styled(Icon).attrs({\r\n  icon: \"fa-registered\",\r\n})``;\r\n\r\nexport const HeartIcon = styled(Icon).attrs({\r\n  icon: \"fa-heart\",\r\n})``;\r\n\r\nexport const TwitterIcon = styled(Icon).attrs({\r\n  prefix: \"fab\",\r\n  icon: \"fa-twitter\",\r\n})``;\r\n\r\nexport const LinkIcon = styled(Icon).attrs({\r\n  icon: \"fa-link\",\r\n})``;\r\n\r\nexport const PlayIcon = memo(\r\n  styled(Icon).attrs({\r\n    icon: \"fa-play\",\r\n  })``\r\n);\r\n\r\nexport const PauseIcon = memo(\r\n  styled(Icon).attrs({\r\n    icon: \"fa-pause\",\r\n  })``\r\n);\r\n\r\nexport const ArrowUp = styled(Icon).attrs({\r\n  icon: \"fa-caret-down\",\r\n})``;\r\n\r\nexport const ArrowDown = styled(Icon).attrs({\r\n  icon: \"fa-caret-up\",\r\n})``;\r\n\r\nexport const PixivIcon = (props: Omit<IconProps, \"icon\">) => {\r\n  const {\r\n    color = \"black\",\r\n    size = 14,\r\n    onClick = () => {},\r\n    left = false,\r\n    right = false,\r\n  } = props;\r\n\r\n  return (\r\n    <IconWrapper onClick={onClick} left={left} right={right}>\r\n      <StyledSvg\r\n        viewBox=\"0 0 24 24\"\r\n        xmlns=\"http://www.w3.org/2000/svg\"\r\n        size={size}\r\n      >\r\n        <path\r\n          fill={color}\r\n          d=\"M4.935 0A4.924 4.924 0 0 0 0 4.935v14.13A4.924 4.924 0 0 0 4.935 24h14.13A4.924 4.924 0 0 0 24 19.065V4.935A4.924 4.924 0 0 0 19.065 0zm7.81 4.547c2.181 0 4.058.676 5.399 1.847a6.118 6.118 0 0 1 2.116 4.66c.005 1.854-.88 3.476-2.257 4.563-1.375 1.092-3.225 1.697-5.258 1.697-2.314 0-4.46-.842-4.46-.842v2.718c.397.116 1.048.365.635.779H5.79c-.41-.41.19-.65.644-.779V7.666c-1.053.81-1.593 1.51-1.868 2.031.32 1.02-.284.969-.284.969l-1.09-1.73s3.868-4.39 9.553-4.39zm-.19.971c-1.423-.003-3.184.473-4.27 1.244v8.646c.988.487 2.484.832 4.26.832h.01c1.596 0 2.98-.593 3.93-1.533.952-.948 1.486-2.183 1.492-3.683-.005-1.54-.504-2.864-1.42-3.86-.918-.992-2.274-1.645-4.002-1.646Z\"\r\n        />\r\n      </StyledSvg>\r\n    </IconWrapper>\r\n  );\r\n};\r\n","export const PICTURE = \"picture\";\r\nexport const GIF = \"gif\";\r\nexport const VIDEO = \"video\";\r\n\r\nexport const NO_OP = () => {};\r\n","import React, { MouseEventHandler } from \"react\";\r\nimport { CharacterIcon, CopyrightIcon, ArtistIcon } from \"./Icons\";\r\nimport { NO_OP } from \"../data/constants\";\r\n\r\ninterface TypeIconProps {\r\n  types?: string[];\r\n  className?: string;\r\n  color?: string;\r\n  size?: number;\r\n  onClick?: MouseEventHandler;\r\n  left?: boolean;\r\n  right?: boolean;\r\n}\r\n\r\nexport default function TypeIcon(props: TypeIconProps) {\r\n  const { types = [], className = \"\", onClick = NO_OP } = props;\r\n  const interestingType = types.find((t) => !t.match(/^[general|ambiguous]$/));\r\n\r\n  switch (interestingType) {\r\n    case \"character\":\r\n      return <CharacterIcon className={className} onClick={onClick} left />;\r\n    case \"copyright\":\r\n      return <CopyrightIcon className={className} onClick={onClick} left />;\r\n    case \"artist\":\r\n      return <ArtistIcon className={className} onClick={onClick} left />;\r\n    default:\r\n      return <div className={className}></div>;\r\n  }\r\n}\r\n","import React, { MouseEventHandler } from \"react\";\r\nimport styled, { css } from \"styled-components\";\r\nimport TypeIcon from \"../../icons/TypeIcon\";\r\nimport { formatCount } from \"../../misc/formatting\";\r\nimport { prettifyTagname } from \"../tag/tagUtils\";\r\nimport TagDataClass from \"../../data/Tag\";\r\nimport { TagType } from \"../../data/types\";\r\nimport { ThemeType } from \"../../misc/theme\";\r\n\r\nfunction sizeAndPosition(tagSelector: HTMLDivElement | null) {\r\n  if (tagSelector) {\r\n    const { offsetTop, clientHeight, offsetLeft, clientWidth } = tagSelector;\r\n\r\n    return css`\r\n      position: absolute;\r\n      top: ${offsetTop + clientHeight - 2}px;\r\n      left: ${offsetLeft}px;\r\n      width: ${clientWidth}px;\r\n      max-height: 50vh;\r\n      overflow-y: scroll;\r\n    `;\r\n  }\r\n\r\n  return \"\";\r\n}\r\n\r\nexport const ListWrapper = styled.div(\r\n  (props: { tagSelectorRef: HTMLDivElement | null; theme: ThemeType }) => css`\r\n    ${sizeAndPosition(props.tagSelectorRef)};\r\n    background: white;\r\n    box-sizing: border-box;\r\n    border: ${props.theme.dimensions.borderWidth}\r\n      ${props.theme.colors.accentColor} solid;\r\n    border-radius: 0 0 3px 3px;\r\n    color: black;\r\n    z-index: 1;\r\n  `\r\n);\r\n\r\ninterface DropdownListProps {\r\n  tagSelectorRef: HTMLDivElement | null;\r\n  entries: {\r\n    name: string;\r\n    posts: number;\r\n    types: TagType[];\r\n  }[];\r\n  onClick: (entry: TagDataClass) => void;\r\n}\r\n\r\nexport default function DropdownList(props: DropdownListProps) {\r\n  const { tagSelectorRef, entries, onClick } = props;\r\n\r\n  return entries && entries.length > 0 ? (\r\n    <ListWrapper tagSelectorRef={tagSelectorRef}>\r\n      {entries.map((entry) => (\r\n        <Entry\r\n          key={entry.name}\r\n          onClick={() => onClick(entry)}\r\n          {...entry}\r\n        ></Entry>\r\n      ))}\r\n    </ListWrapper>\r\n  ) : null;\r\n}\r\n\r\nconst EntryWrapper = styled.div`\r\n  display: flex;\r\n  height: 28px;\r\n\r\n  > * {\r\n    margin: auto;\r\n  }\r\n\r\n  &:not(:last-child) {\r\n    border-bottom: 1px grey solid;\r\n  }\r\n\r\n  :focus {\r\n    text-decoration: underline;\r\n  }\r\n`;\r\n\r\nconst TypeWrapper = styled.span`\r\n  flex: 0 0 48px;\r\n  text-align: center;\r\n`;\r\n\r\ninterface EntryProps {\r\n  name: string;\r\n  posts: number;\r\n  types: TagType[];\r\n  onClick: MouseEventHandler;\r\n}\r\n\r\nconst Entry = (props: EntryProps) => {\r\n  const { name, posts, types, onClick } = props;\r\n\r\n  return (\r\n    <EntryWrapper onClick={onClick}>\r\n      <TypeWrapper>\r\n        <TypeIcon types={types} />\r\n      </TypeWrapper>\r\n\r\n      <span style={{ flexGrow: 1 }}>{prettifyTagname(name)}</span>\r\n      <span style={{ paddingRight: 5 }}>{formatCount(posts)} posts</span>\r\n    </EntryWrapper>\r\n  );\r\n};\r\n","import React, { useState, useEffect, useCallback } from \"react\";\r\nimport styled, { css } from \"styled-components\";\r\nimport api from \"../../misc/api\";\r\nimport { prepareTag } from \"../../misc/prepare\";\r\nimport Button, { AddButton, ModifierButton } from \"../common/Button\";\r\nimport TagInput from \"./TagInput\";\r\nimport DropdownList from \"./DropdownList\";\r\nimport { normalizeTagname } from \"../tag/tagUtils\";\r\nimport { useDispatch, useSelector } from \"react-redux\";\r\nimport { addTag } from \"../../redux/actions\";\r\nimport { ThemeType } from \"../../misc/theme\";\r\nimport { selectPreferences } from \"../../redux/selectors\";\r\n\r\nexport const TagSelectorWrapper = styled.div(\r\n  (props: {\r\n    closed: boolean;\r\n    ref: (ref: HTMLInputElement) => void;\r\n    theme: ThemeType;\r\n  }) => css`\r\n    display: flex;\r\n    background: white;\r\n    ${props.closed\r\n      ? `border-radius: ${props.theme.dimensions.borderRadius};`\r\n      : `\r\n        border-radius: ${props.theme.dimensions.borderRadius} ${props.theme.dimensions.borderRadius} 0 0;\r\n\r\n        > ${AddButton} {\r\n          border-radius: 0 ${props.theme.dimensions.borderRadius} 0 0;\r\n        }\r\n\r\n        > ${ModifierButton} {\r\n          border-radius: ${props.theme.dimensions.borderRadius} 0 0 0;\r\n        }\r\n      `}\r\n  `\r\n);\r\n\r\nexport default function TagSelector() {\r\n  const dispatch = useDispatch();\r\n  const [value, setValue] = useState(\"\");\r\n  const [modifier, setModifier] = useState(\"+\");\r\n  const [suggestions, setSuggestions] = useState([]);\r\n  const { tagSuggestionsCount } = useSelector(selectPreferences);\r\n\r\n  const [tagSelectorRef, setTagSelectorRef] = useState<HTMLDivElement | null>(\r\n    null\r\n  );\r\n\r\n  const activateTag = useCallback(\r\n    (suggestion) => {\r\n      dispatch(\r\n        addTag(\r\n          prepareTag({\r\n            name: suggestion.name,\r\n            modifier: modifier,\r\n            count: suggestion.posts,\r\n            types: suggestion.types,\r\n          })\r\n        )\r\n      );\r\n\r\n      setValue(\"\");\r\n      setSuggestions([]);\r\n    },\r\n    [dispatch, modifier]\r\n  );\r\n\r\n  useEffect(() => {\r\n    const handle = setTimeout(() => {\r\n      if (!value) {\r\n        setSuggestions([]);\r\n        return;\r\n      }\r\n\r\n      api\r\n        .getTags(normalizeTagname(value), tagSuggestionsCount)\r\n        .then((newSuggestions) => {\r\n          setSuggestions(newSuggestions);\r\n        });\r\n    }, 300);\r\n\r\n    return () => clearTimeout(handle);\r\n  }, [tagSuggestionsCount, value]);\r\n\r\n  const onModifierClick = useCallback(\r\n    () => setModifier(modifier === \"+\" ? \"-\" : \"+\"),\r\n    [modifier, setModifier]\r\n  );\r\n\r\n  const onAddClick = useCallback(() => {\r\n    if (value && value.trim() !== \"\") {\r\n      const suggestion =\r\n        suggestions.find((s: { name: string }) => s.name === value) || {};\r\n      activateTag({ ...suggestion, name: value });\r\n    }\r\n  }, [value, activateTag, suggestions]);\r\n\r\n  return (\r\n    <TagSelectorWrapper\r\n      ref={setTagSelectorRef}\r\n      closed={suggestions.length === 0}\r\n    >\r\n      <Button type=\"modifier\" onClick={onModifierClick} label=\"Tag Modifier\">\r\n        {modifier}\r\n      </Button>\r\n      <TagInput value={value} setValue={setValue} />\r\n      <Button type=\"add\" onClick={onAddClick} label=\"Add Tag\">\r\n        Add\r\n      </Button>\r\n      {suggestions.length > 0 && (\r\n        <DropdownList\r\n          tagSelectorRef={tagSelectorRef}\r\n          entries={suggestions}\r\n          onClick={(entry) => activateTag(entry)}\r\n        />\r\n      )}\r\n    </TagSelectorWrapper>\r\n  );\r\n}\r\n","import React, { MouseEventHandler } from \"react\";\r\nimport styled, { css } from \"styled-components\";\r\nimport { ThemeType } from \"../../misc/theme\";\r\n\r\nconst Wrapper = styled.div(\r\n  (props) => css`\r\n    border-radius: 30px;\r\n    width: 50px;\r\n    border: ${props.theme.dimensions.borderWidth} solid\r\n      ${props.theme.colors.accentColor};\r\n    background-color: ${props.theme.colors.backgroundColor};\r\n    transition: transform 0.4s ease-in-out;\r\n  `\r\n);\r\n\r\nconst Thumb = styled.div(\r\n  (props: { value: boolean; theme: ThemeType }) => css`\r\n    width: 20px;\r\n    height: 20px;\r\n    background-color: ${props.value\r\n      ? props.theme.colors.accentColor\r\n      : props.theme.colors.backgroundColor2};\r\n    border-radius: 50%;\r\n    transition: all 0.2s ease-in-out;\r\n    transform: translate(${props.value ? \"30px\" : \"0px\"});\r\n  `\r\n);\r\n\r\ninterface ToggleProps {\r\n  value: boolean;\r\n  onToggle: MouseEventHandler;\r\n}\r\n\r\nexport default function Toggle(props: ToggleProps) {\r\n  const { value, onToggle } = props;\r\n\r\n  return (\r\n    <Wrapper onClick={onToggle}>\r\n      <Thumb value={value} />\r\n    </Wrapper>\r\n  );\r\n}\r\n","import React, { MouseEventHandler } from \"react\";\r\nimport styled, { css } from \"styled-components\";\r\nimport Toggle from \"./Toggle\";\r\n\r\nconst ToggleWrapper = styled.label(\r\n  ({ theme }) => css`\r\n    display: flex;\r\n    align-items: center;\r\n    gap: ${theme.dimensions.gutter};\r\n  `\r\n);\r\n\r\ninterface LabeledToggleProps {\r\n  children: JSX.Element | string;\r\n  value: boolean;\r\n  onToggle: MouseEventHandler;\r\n}\r\n\r\nexport default function LabeledToggle(props: LabeledToggleProps) {\r\n  const { children, value, onToggle } = props;\r\n\r\n  return (\r\n    <ToggleWrapper>\r\n      <Toggle value={value} onToggle={onToggle} />\r\n      <span>{children}</span>\r\n    </ToggleWrapper>\r\n  );\r\n}\r\n","import React, { useCallback, useState } from \"react\";\r\nimport styled, { css } from \"styled-components\";\r\nimport LabeledToggle from \"../common/LabeledToggle\";\r\nimport { useDispatch, useSelector } from \"react-redux\";\r\nimport { selectPreferences } from \"../../redux/selectors\";\r\nimport { setOption } from \"../../redux/actions\";\r\nimport { ThemeType } from \"../../misc/theme\";\r\nimport { RATED, RATEDTRESHOLD } from \"../../data/types\";\r\n\r\nconst OptionsWrapper = styled.div(\r\n  (props) => css`\r\n    > *:not(:last-child) {\r\n      margin-bottom: ${props.theme.dimensions.gutter};\r\n    }\r\n  `\r\n);\r\n\r\nconst StyledInput = styled.input(\r\n  (props: { value: number; theme: ThemeType }) => css`\r\n    background: none;\r\n    border: none;\r\n    outline: none;\r\n    color: ${props.theme.colors.accentColor};\r\n    width: ${0.65 * String(props.value).length}em;\r\n    text-align: right;\r\n    font-size: ${props.theme.fontSizes.content};\r\n    margin: -1px 0.2em 0 0.2em;\r\n\r\n    ::-webkit-inner-spin-button,\r\n    ::-webkit-outer-spin-button {\r\n      -webkit-appearance: none;\r\n      margin: 0;\r\n    }\r\n    -moz-appearance: textfield;\r\n  `\r\n);\r\n\r\nexport default function Options() {\r\n  const dispatch = useDispatch();\r\n  const { rated, ratedTreshold } = useSelector(selectPreferences);\r\n\r\n  const [ratedInputValue, setRatedInputValue] = useState(ratedTreshold);\r\n\r\n  const toggleRated = useCallback(() => dispatch(setOption(RATED, !rated)), [\r\n    dispatch,\r\n    rated,\r\n  ]);\r\n\r\n  const setRatedThreshold = useCallback(\r\n    () => dispatch(setOption(RATEDTRESHOLD, ratedInputValue)),\r\n    [dispatch, ratedInputValue]\r\n  );\r\n\r\n  return (\r\n    <OptionsWrapper>\r\n      <LabeledToggle value={rated} onToggle={toggleRated}>\r\n        {rated ? (\r\n          <div style={{ display: \"flex\" }}>\r\n            <span>More than</span>\r\n            <StyledInput\r\n              type=\"number\"\r\n              value={ratedInputValue}\r\n              onChange={(event) =>\r\n                setRatedInputValue(Number(event.target.value))\r\n              }\r\n              onBlur={setRatedThreshold}\r\n            />\r\n            <span>likes</span>\r\n          </div>\r\n        ) : (\r\n          \"Only show Rated Posts\"\r\n        )}\r\n      </LabeledToggle>\r\n    </OptionsWrapper>\r\n  );\r\n}\r\n","import React from \"react\";\r\nimport styled, { css } from \"styled-components\";\r\nimport TagDataClass from \"../../data/Tag\";\r\nimport Tag from \"./Tag\";\r\nimport { SimpleMap } from \"../../data/types\";\r\nimport { ThemeType } from \"../../misc/theme\";\r\n\r\nexport const TagListWrapper = styled.div(\r\n  (props: { padding: boolean; theme: ThemeType }) => css`\r\n    display: inline-flex;\r\n    flex-wrap: wrap;\r\n    margin: calc(\r\n      ${props.padding ? props.theme.dimensions.gutter : \"0px\"} -\r\n        ${props.theme.dimensions.spacing}\r\n    );\r\n  `\r\n);\r\n\r\ninterface TagListProps {\r\n  tags: SimpleMap<TagDataClass>;\r\n  loadAliases?: boolean;\r\n  padding?: boolean;\r\n}\r\n\r\nexport default function TagList(props: TagListProps) {\r\n  const { tags, loadAliases = false, padding = false } = props;\r\n\r\n  return (\r\n    <div>\r\n      <TagListWrapper padding={padding}>\r\n        {Object.entries(tags).map(([key, tag]) => (\r\n          <Tag key={key} {...tag} loadAliases={loadAliases} />\r\n        ))}\r\n      </TagListWrapper>\r\n    </div>\r\n  );\r\n}\r\n","import React from \"react\";\r\nimport { ThemeType } from \"../misc/theme\";\r\nimport { useTheme } from \"styled-components\";\r\n\r\nexport default function R34Icon(props: { size: number }) {\r\n  const theme = useTheme() as ThemeType;\r\n\r\n  return (\r\n    <svg\r\n      xmlns=\"http://www.w3.org/2000/svg\"\r\n      width={props.size}\r\n      height={props.size}\r\n      viewBox=\"0 0 12.7 12.7\"\r\n    >\r\n      <g transform=\"translate(0,-284.3)\">\r\n        <circle\r\n          id=\"path18\"\r\n          cx=\"6.3499999\"\r\n          cy=\"290.65002\"\r\n          fill=\"none\"\r\n          stroke={theme.colors.accentColor}\r\n          strokeWidth=\"0.50848764\"\r\n          strokeMiterlimit=\"4\"\r\n          strokeDasharray=\"none\"\r\n          strokeOpacity=\"1\"\r\n          r=\"6.0957561\"\r\n        />\r\n        <text\r\n          fontStyle=\"normal\"\r\n          fontWeight=\"normal\"\r\n          fontSize=\"8.3113203px\"\r\n          fontFamily=\"sansSerif\"\r\n          letterSpacing=\"0px\"\r\n          wordSpacing=\"0px\"\r\n          fill={theme.colors.accentColor}\r\n          fillOpacity=\"1\"\r\n          x=\"2.1363549\"\r\n          y=\"289.02704\"\r\n          id=\"text4533\"\r\n          transform=\"scale(0.98538224,1.0148346)\"\r\n        >\r\n          <tspan\r\n            id=\"tspan4531\"\r\n            x=\"2\"\r\n            y=\"289.1\"\r\n            fontStyle=\"normal\"\r\n            fontVariant=\"normal\"\r\n            fontWeight=\"300\"\r\n            fontStretch=\"normal\"\r\n            fontFamily=\"Calibri\"\r\n            fill={theme.colors.accentColor}\r\n            fillOpacity=\"1\"\r\n          >\r\n            34\r\n          </tspan>\r\n        </text>\r\n      </g>\r\n    </svg>\r\n  );\r\n}\r\n","import React, { RefAttributes } from \"react\";\r\nimport { Link, LinkProps, useLocation } from \"react-router-dom\";\r\nimport styled, { css, ThemeProps } from \"styled-components\";\r\nimport R34Icon from \"../../icons/R34Icon\";\r\nimport { BigTitle } from \"../common/Title\";\r\n\r\nconst HeaderWrapper = styled.header(\r\n  ({ theme }) => css`\r\n    display: flex;\r\n    flex-direction: column;\r\n    gap: ${theme.dimensions.bigSpacing};\r\n  `\r\n);\r\n\r\nconst Divider = styled.div(\r\n  ({ theme }) => css`\r\n    width: 1px;\r\n    height: 32px;\r\n    margin: 0 ${theme.dimensions.gutter};\r\n    background: ${theme.colors.backgroundColor2};\r\n  `\r\n);\r\n\r\nconst TitleBar = styled.div(\r\n  ({ theme }) => css`\r\n    display: flex;\r\n    align-items: center;\r\n    justify-content: center;\r\n    background: ${theme.misc.layer};\r\n    padding: ${theme.dimensions.gutter} 0;\r\n    ${theme.shadow.box};\r\n  `\r\n);\r\n\r\nconst MenuBar = styled.nav(\r\n  ({ theme }) => css`\r\n    display: flex;\r\n    justify-content: center;\r\n    gap: ${theme.dimensions.bigSpacing};\r\n  `\r\n);\r\n\r\ntype LocationStyledLinkProps = LinkProps<unknown> &\r\n  RefAttributes<HTMLAnchorElement> &\r\n  ThemeProps<any> & { current: string };\r\n\r\nconst LocationStyledLink = styled(Link)(\r\n  ({ to, current, theme }: LocationStyledLinkProps) => css`\r\n    color: ${to === current\r\n      ? theme.colors.accentColor\r\n      : theme.colors.backgroundColor2};\r\n  `\r\n);\r\n\r\nexport default function Header() {\r\n  const current = useLocation().pathname;\r\n\r\n  return (\r\n    <HeaderWrapper role=\"cell\">\r\n      <TitleBar>\r\n        <R34Icon size={32} />\r\n        <Divider />\r\n        <BigTitle>\r\n          Browse <a href=\"https://rule34.xxx\">Rule34</a>\r\n        </BigTitle>\r\n      </TitleBar>\r\n\r\n      <MenuBar role=\"cell\">\r\n        <LocationStyledLink current={current} to=\"/\">\r\n          Search\r\n        </LocationStyledLink>\r\n        <LocationStyledLink current={current} to=\"/help\">\r\n          Help\r\n        </LocationStyledLink>\r\n        <LocationStyledLink current={current} to=\"/settings\">\r\n          Settings\r\n        </LocationStyledLink>\r\n      </MenuBar>\r\n    </HeaderWrapper>\r\n  );\r\n}\r\n","import React from \"react\";\r\nimport styled, { css } from \"styled-components\";\r\n\r\nconst FotterWrapper = styled.footer(\r\n  (props) => css`\r\n    display: grid;\r\n    grid-template-columns: 1fr 1px 1fr 1px 1fr;\r\n    justify-content: space-around;\r\n    padding: ${props.theme.dimensions.spacing};\r\n  `\r\n);\r\n\r\nconst Divider = styled.div(\r\n  (props) => css`\r\n    width: 1px;\r\n    height: 20px;\r\n    background: ${props.theme.colors.backgroundColor2};\r\n  `\r\n);\r\n\r\nconst CenteredA = styled.a`\r\n  text-align: center;\r\n`;\r\n\r\nexport default function Footer() {\r\n  return (\r\n    <FotterWrapper>\r\n      <CenteredA href=\"https://github.com/kurozenzen/r34-react/issues/new?template=bug_report.md\">\r\n        Report a bug\r\n      </CenteredA>\r\n      <Divider />\r\n      <CenteredA href=\"https://github.com/kurozenzen/r34-react\">\r\n        Github\r\n      </CenteredA>\r\n      <Divider />\r\n      <CenteredA href=\"https://github.com/kurozenzen/r34-react/issues/new?template=feature_request.md\">\r\n        Feature request\r\n      </CenteredA>\r\n    </FotterWrapper>\r\n  );\r\n}\r\n","import styled, { css } from \"styled-components\";\r\n\r\nconst FlexColumn = styled.div`\r\n  display: flex;\r\n  flex-direction: column;\r\n  width: 100%;\r\n  min-height: 100%;\r\n`;\r\n\r\nexport default FlexColumn;\r\n\r\nexport const FlexColumnWithSpacing = styled(FlexColumn)(\r\n  ({ theme }) => css`\r\n    gap: ${theme.dimensions.gutter};\r\n    padding: ${theme.dimensions.gutter};\r\n  `\r\n);\r\n","import React from \"react\";\r\nimport Title from \"../components/common/Title\";\r\nimport Surface, { Line } from \"../components/common/Surface\";\r\nimport TagSelector from \"../components/tagSelector/TagSelector\";\r\nimport Options from \"../components/features/Options\";\r\nimport TagList from \"../components/tag/TagList\";\r\nimport Header from \"../components/features/Header\";\r\nimport Footer from \"../components/features/Footer\";\r\nimport FlexColumn, {\r\n  FlexColumnWithSpacing,\r\n} from \"../components/common/FlexColumn\";\r\nimport styled, { css } from \"styled-components\";\r\n\r\nconst StyledOl = styled.ol(\r\n  ({ theme }) => css`\r\n    padding-left: 1rem;\r\n    display: flex;\r\n    flex-direction: column;\r\n    gap: ${theme.dimensions.spacing};\r\n  `\r\n);\r\n\r\nexport default function Help() {\r\n  return (\r\n    <FlexColumn>\r\n      <Header />\r\n      <FlexColumnWithSpacing>\r\n        <Title>Help</Title>\r\n        <Surface>\r\n          <Title>Searching for Tags</Title>\r\n          <Line />\r\n          <TagSelector />\r\n          <Line />\r\n          <p>\r\n            You can use the Tag Selector to look for tags you like.The Tag\r\n            Selector has 4 parts.\r\n          </p>\r\n          <StyledOl>\r\n            <li>\r\n              The modifier (left) determines wether posts must match a tag or\r\n              not. Putting \"-\" will hide all posts with this tag\r\n            </li>\r\n            <li>\r\n              The Search Box (center) allows you to search for tags. As soon as\r\n              you start typing the Tag Selector will show you relevant tags to\r\n              choose from (4).\r\n            </li>\r\n            <li>\r\n              The Add Button (right) Allows you to add any tag to the current\r\n              filter. Usefull when using wildcards.\r\n            </li>\r\n            <li>\r\n              The Tag Dropdown (left) automatically shows tags that start with\r\n              your input. It also includes The number of posts tagged, to allow\r\n              you to weigh tags against each other.\r\n            </li>\r\n          </StyledOl>\r\n        </Surface>\r\n        <Surface>\r\n          <Title>Options</Title>\r\n          <Line />\r\n          <Options />\r\n          <Line />\r\n          <p>\r\n            Options allow you to customize your experience in various ways.\r\n            There are 3 options available\r\n          </p>\r\n          <StyledOl>\r\n            <li>\r\n              Infinite Scrolling automatically loads new posts when you get\r\n              close to the bottom of the page.\r\n            </li>\r\n            <li>\r\n              Only show Rated posts filters out posts below the specified amount\r\n              of posts.\r\n            </li>\r\n            <li>\r\n              Load original sizes always loads the highest quality of an image.\r\n              This can easily cause extreme data consumption. Don't use with\r\n              mobile data.\r\n            </li>\r\n          </StyledOl>\r\n        </Surface>\r\n        <Surface>\r\n          <Title>Tags</Title>\r\n          <Line />\r\n          <TagList\r\n            tags={{\r\n              \"Tag 1\": { name: \"Tag 1\" },\r\n              \"Tag 2\": { name: \"Tag 2\", types: [\"character\"] },\r\n              \"Tag 3\": {\r\n                name: \"Tag 3\",\r\n                modifier: \"-\",\r\n                types: [\"copyright\"],\r\n                count: 1020,\r\n              },\r\n            }}\r\n          />\r\n          <Line />\r\n          <p>\r\n            This whole application is based on tags. Every Post has multiple\r\n            tags. Usually you can enable/disable a tag just by tapping it. If a\r\n            tag is red it means its active. The icons next to the name show what\r\n            type of tag it is. Not every tag has a type. The number on the right\r\n            shows how many posts there are with that tag.\r\n          </p>\r\n        </Surface>\r\n      </FlexColumnWithSpacing>\r\n\r\n      <Footer />\r\n    </FlexColumn>\r\n  );\r\n}\r\n","import React from \"react\";\r\nimport styled, { css } from \"styled-components\";\r\nimport { SmallTitle } from \"./Title\";\r\n\r\nconst SettingGrid = styled.div(\r\n  ({ theme }) => css`\r\n    display: grid;\r\n    grid-template-columns: 1fr auto;\r\n    grid-template-rows: auto auto;\r\n    gap: ${theme.dimensions.spacing};\r\n  `\r\n);\r\n\r\nconst SettingTitle = styled(SmallTitle)(\r\n  ({ theme }) => css`\r\n    grid-column: 1/2;\r\n    grid-row: 1/2;\r\n  `\r\n);\r\n\r\nconst SettingBody = styled.p(\r\n  ({ theme }) => css`\r\n    grid-column: 1/2;\r\n    grid-row: 2/3;\r\n    opacity: 0.5;\r\n  `\r\n);\r\n\r\nconst SettingControl = styled.div(\r\n  ({ theme }) => css`\r\n    grid-column: 2/3;\r\n    grid-row: 1/3;\r\n  `\r\n);\r\n\r\ninterface SettingProps {\r\n  title: string;\r\n  description: string;\r\n  children: JSX.Element;\r\n}\r\n\r\nexport default function Setting({\r\n  title,\r\n  description,\r\n  children,\r\n}: SettingProps) {\r\n  return (\r\n    <SettingGrid>\r\n      <SettingTitle>{title}</SettingTitle>\r\n      <SettingBody>{description}</SettingBody>\r\n      <SettingControl>{children}</SettingControl>\r\n    </SettingGrid>\r\n  );\r\n}\r\n","import React from \"react\";\r\nimport styled, { css } from \"styled-components\";\r\n\r\nconst TextInput = styled.input(\r\n  ({ theme }) => css`\r\n    width: 50px;\r\n    border: ${theme.dimensions.borderWidth} solid ${theme.colors.accentColor};\r\n    background-color: ${theme.colors.backgroundColor2};\r\n    padding: ${theme.dimensions.spacing};\r\n    border-radius: ${theme.dimensions.borderRadius};\r\n    text-align: right;\r\n  `\r\n);\r\n\r\ninterface SmallTextInputProps {\r\n  type: string;\r\n  value: string | number;\r\n  onChange: (event: any) => void;\r\n}\r\n\r\nexport default function SmallTextInput({\r\n  type,\r\n  value,\r\n  onChange,\r\n}: SmallTextInputProps) {\r\n  return <TextInput type={type} value={value} onChange={onChange} />;\r\n}\r\n","import React, { useCallback } from \"react\";\r\nimport { useDispatch, useSelector } from \"react-redux\";\r\nimport { BlockButton } from \"../components/common/Button\";\r\nimport FlexColumn, {\r\n  FlexColumnWithSpacing,\r\n} from \"../components/common/FlexColumn\";\r\nimport Setting from \"../components/common/Setting\";\r\nimport SmallTextInput from \"../components/common/SmallTextInput\";\r\nimport Surface, { Line } from \"../components/common/Surface\";\r\nimport Title from \"../components/common/Title\";\r\nimport Toggle from \"../components/common/Toggle\";\r\nimport Footer from \"../components/features/Footer\";\r\nimport Header from \"../components/features/Header\";\r\nimport { PRELOAD_VIDEOS, TAG_SUGGESTION_COUNT, ORIGINALS } from \"../data/types\";\r\nimport { setOption } from \"../redux/actions\";\r\nimport { selectPreferences } from \"../redux/selectors\";\r\n\r\nexport default function Settings() {\r\n  const dispatch = useDispatch();\r\n  const { preloadVideos, tagSuggestionsCount, originals } = useSelector(\r\n    selectPreferences\r\n  );\r\n  const togglePreloadVideos = useCallback(\r\n    () => dispatch(setOption(PRELOAD_VIDEOS, !preloadVideos)),\r\n    [dispatch, preloadVideos]\r\n  );\r\n  const toggleOriginals = useCallback(\r\n    () => dispatch(setOption(ORIGINALS, !originals)),\r\n    [dispatch, originals]\r\n  );\r\n  const setTagSuggestionCount = useCallback(\r\n    (event) => dispatch(setOption(TAG_SUGGESTION_COUNT, event.target.value)),\r\n    [dispatch]\r\n  );\r\n\r\n  const reset = useCallback(() => {\r\n    localStorage.clear();\r\n    window.location.reload();\r\n  }, []);\r\n\r\n  return (\r\n    <FlexColumn>\r\n      <Header />\r\n      <FlexColumnWithSpacing>\r\n        <Title>Settings</Title>\r\n        <Surface>\r\n          <Title>General</Title>\r\n          <Line />\r\n          <Setting\r\n            title=\"Preload Videos\"\r\n            description=\"Start loading videos immediately instead of just-in-time. This can improve the viewing experience but will consume a LOT of data. Only use with WIFI.\"\r\n          >\r\n            <Toggle value={preloadVideos} onToggle={togglePreloadVideos} />\r\n          </Setting>\r\n          <Line />\r\n          <Setting\r\n            title=\"Load original sizes\"\r\n            description=\"Display images and videos at their original resolution. This will consume more data but provides a nicer experience.\"\r\n          >\r\n            <Toggle value={originals} onToggle={toggleOriginals} />\r\n          </Setting>\r\n          <Line />\r\n          <Setting\r\n            title=\"Number of Tag suggestions\"\r\n            description=\"Controls the number of tags displayed when searching. Increase this when searching for niche tags.\"\r\n          >\r\n            <SmallTextInput\r\n              type=\"number\"\r\n              value={tagSuggestionsCount}\r\n              onChange={setTagSuggestionCount}\r\n            />\r\n          </Setting>\r\n          <Line />\r\n          <Title>Developer</Title>\r\n          <BlockButton onClick={reset}>Reset Application</BlockButton>\r\n        </Surface>\r\n      </FlexColumnWithSpacing>\r\n      <Footer />\r\n    </FlexColumn>\r\n  );\r\n}\r\n","import React, { useCallback, useEffect, useMemo, useState } from \"react\";\r\nimport {\r\n  CellMeasurer,\r\n  CellMeasurerCache,\r\n  IndexRange,\r\n  InfiniteLoader,\r\n  List,\r\n} from \"react-virtualized\";\r\nimport LayoutElementProps from \"./LayoutElementProps\";\r\n\r\ninterface InfiniteColumnProps<T> {\r\n  Header?: (props: LayoutElementProps) => JSX.Element;\r\n  OutOfItems?: (props: LayoutElementProps) => JSX.Element;\r\n  items?: T[];\r\n  LoadingItem: (props: LayoutElementProps) => JSX.Element;\r\n  hasMoreRows: boolean;\r\n  loadMore: () => void;\r\n  ItemComponent: (props: T & LayoutElementProps) => JSX.Element;\r\n  isLoading: boolean;\r\n  setLoading: (value: boolean) => void;\r\n}\r\n\r\nexport default function InifinteColumn<T>(props: InfiniteColumnProps<T>) {\r\n  const {\r\n    Header,\r\n    items = [],\r\n    LoadingItem,\r\n    hasMoreRows,\r\n    ItemComponent,\r\n    loadMore,\r\n    OutOfItems,\r\n    isLoading,\r\n    setLoading,\r\n  } = props;\r\n\r\n  const [listRef, setListRef] = useState<List | null>(null);\r\n\r\n  const cache = useMemo(\r\n    () =>\r\n      new CellMeasurerCache({\r\n        fixedWidth: true,\r\n      }),\r\n    []\r\n  );\r\n\r\n  const prependedRows = Header ? 1 : 0;\r\n  const loadingRows = 1;\r\n\r\n  const rowCount = items.length + prependedRows + loadingRows;\r\n\r\n  const isRowLoaded = useCallback(\r\n    ({ index }: { index: number }) =>\r\n      index < prependedRows + items.length + (hasMoreRows ? 0 : 1),\r\n    [hasMoreRows, items.length, prependedRows]\r\n  );\r\n\r\n  useEffect(() => {\r\n    if (listRef) {\r\n      const listener = () => {\r\n        listRef.measureAllRows();\r\n        listRef.recomputeRowHeights();\r\n        listRef.forceUpdateGrid();\r\n      };\r\n\r\n      window.addEventListener(\"resize\", listener);\r\n\r\n      return () => {\r\n        window.removeEventListener(\"resize\", listener);\r\n      };\r\n    }\r\n  }, [listRef]);\r\n\r\n  const rowRenderer = useCallback(\r\n    ({\r\n      index,\r\n      key,\r\n      parent,\r\n      style,\r\n    }: {\r\n      index: number;\r\n      key: any;\r\n      parent: any;\r\n      style: any;\r\n    }) => {\r\n      return (\r\n        <CellMeasurer\r\n          cache={cache}\r\n          columnIndex={0}\r\n          key={key}\r\n          rowIndex={index}\r\n          parent={parent}\r\n        >\r\n          {({ measure, registerChild }) => {\r\n            // Index 0\r\n            if (Header && index < prependedRows) {\r\n              return (\r\n                <Header\r\n                  style={style}\r\n                  virtualRef={registerChild}\r\n                  onLoad={measure}\r\n                />\r\n              );\r\n            }\r\n\r\n            // Index 1\r\n            if (index < prependedRows + items.length) {\r\n              return (\r\n                <ItemComponent\r\n                  style={style}\r\n                  virtualRef={registerChild}\r\n                  onLoad={measure}\r\n                  {...items[index - prependedRows]}\r\n                />\r\n              );\r\n            }\r\n\r\n            // Index 2\r\n            if (index < prependedRows + items.length + loadingRows) {\r\n              return hasMoreRows || isLoading ? (\r\n                <LoadingItem\r\n                  style={style}\r\n                  virtualRef={registerChild}\r\n                  onLoad={measure}\r\n                />\r\n              ) : OutOfItems && items.length > 0 ? (\r\n                <OutOfItems\r\n                  style={style}\r\n                  virtualRef={registerChild}\r\n                  onLoad={measure}\r\n                />\r\n              ) : (\r\n                <div></div>\r\n              );\r\n            }\r\n\r\n            console.warn(\"index not found / out of bounds. INDEX:\", index);\r\n            return null;\r\n          }}\r\n        </CellMeasurer>\r\n      );\r\n    },\r\n    [cache, Header, prependedRows, items, hasMoreRows, isLoading, OutOfItems]\r\n  );\r\n\r\n  const loadMoreRows = (params: IndexRange) => {\r\n    if (isLoading || !hasMoreRows) {\r\n      return Promise.reject(0);\r\n    }\r\n\r\n    setLoading(true);\r\n    loadMore();\r\n\r\n    return new Promise((resolve) => {\r\n      setTimeout(() => {\r\n        setLoading(false);\r\n        resolve(1);\r\n      }, 1000);\r\n    });\r\n  };\r\n\r\n  return (\r\n    <InfiniteLoader\r\n      isRowLoaded={isRowLoaded}\r\n      loadMoreRows={loadMoreRows}\r\n      rowCount={rowCount}\r\n    >\r\n      {({ onRowsRendered, registerChild }) => {\r\n        const registerChildHereAswell = (child: List) => {\r\n          setListRef(child);\r\n          registerChild(child);\r\n        };\r\n        return (\r\n          <List\r\n            ref={registerChildHereAswell}\r\n            onRowsRendered={onRowsRendered}\r\n            rowRenderer={rowRenderer}\r\n            deferredMeasurementCache={cache}\r\n            overscanRowCount={0}\r\n            rowCount={items.length + prependedRows + loadingRows}\r\n            rowHeight={cache.rowHeight}\r\n            width={window.innerWidth}\r\n            height={window.innerHeight}\r\n          />\r\n        );\r\n      }}\r\n    </InfiniteLoader>\r\n  );\r\n}\r\n","import React from \"react\";\r\nimport styled, { css } from \"styled-components\";\r\n\r\ninterface IconAndTextProps {\r\n  children: [JSX.Element, JSX.Element];\r\n}\r\n\r\nconst Wrapper = styled.div(\r\n  ({ theme }) => css`\r\n    display: flex;\r\n    gap: ${theme.dimensions.spacing};\r\n  `\r\n);\r\n\r\nexport default function IconAndText({ children }: IconAndTextProps) {\r\n  return <Wrapper>{children}</Wrapper>;\r\n}\r\n","import { RatingType } from \"../../../data/types\";\r\nimport React from \"react\";\r\nimport { RatingIcon } from \"../../../icons/Icons\";\r\nimport IconAndText from \"../../common/IconAndText\";\r\n\r\nexport default (props: { value: RatingType }) => (\r\n  <IconAndText>\r\n    <RatingIcon color=\"white\" />\r\n    <span>{props.value[0].toUpperCase()}</span>\r\n  </IconAndText>\r\n);\r\n","import React from \"react\";\r\nimport { HeartIcon } from \"../../../icons/Icons\";\r\nimport IconAndText from \"../../common/IconAndText\";\r\n\r\nexport default (props: { value: number }) => (\r\n  <IconAndText>\r\n    <HeartIcon color=\"white\" />\r\n    <span>{props.value}</span>\r\n  </IconAndText>\r\n);\r\n","import React from \"react\";\r\nimport { formatSource } from \"../../../misc/formatting\";\r\nimport {\r\n  LinkIcon,\r\n  PixivIcon,\r\n  SourceIcon,\r\n  TwitterIcon,\r\n} from \"../../../icons/Icons\";\r\nimport styled, { css } from \"styled-components\";\r\nimport IconAndText from \"../../common/IconAndText\";\r\n\r\nconst ColoredA = styled.a(\r\n  (props) => css`\r\n    color: ${props.color} !important;\r\n    display: flex;\r\n    gap: 5px;\r\n  `\r\n);\r\n\r\ninterface SourceProps {\r\n  value: string;\r\n}\r\n\r\nexport default ({ value }: SourceProps) => {\r\n  if (value.startsWith(\"http\")) {\r\n    if (value.includes(\"twitter\")) {\r\n      return <TwitterLink value={value} />;\r\n    }\r\n\r\n    if (value.includes(\"pixiv\")) {\r\n      return <PixivSource value={value} />;\r\n    }\r\n\r\n    return <DefaultLink value={value} />;\r\n  }\r\n\r\n  return <FallbackSource value={value} />;\r\n};\r\n\r\nconst FallbackSource = ({ value }: SourceProps) => {\r\n  return (\r\n    <IconAndText>\r\n      <SourceIcon color=\"white\" left />\r\n      <span>{value}</span>\r\n    </IconAndText>\r\n  );\r\n};\r\n\r\nconst DefaultLink = ({ value }: SourceProps) => {\r\n  return (\r\n    <a\r\n      href={value}\r\n      target=\"_blank\"\r\n      rel=\"noopener noreferrer\"\r\n      className=\"source\"\r\n    >\r\n      <LinkIcon color=\"red\" left />\r\n      {formatSource(value)}\r\n    </a>\r\n  );\r\n};\r\n\r\nconst TwitterLink = ({ value }: SourceProps) => {\r\n  return (\r\n    <ColoredA\r\n      href={value}\r\n      target=\"_blank\"\r\n      rel=\"noopener noreferrer\"\r\n      className=\"source\"\r\n      color=\"rgb(29, 161, 242)\"\r\n    >\r\n      <TwitterIcon color=\"rgb(29, 161, 242)\" left />\r\n      {value.split(\"twitter.com/\")[1].split(\" \")[0].split(\"?\")[0].split(\"/\")[0]}\r\n    </ColoredA>\r\n  );\r\n};\r\n\r\nconst PixivSource = ({ value }: SourceProps) => {\r\n  return (\r\n    <ColoredA\r\n      href={value}\r\n      target=\"_blank\"\r\n      rel=\"noopener noreferrer\"\r\n      className=\"source\"\r\n      color=\"rgb(29, 161, 242)\"\r\n    >\r\n      <PixivIcon color=\"rgb(29, 161, 242)\" left />\r\n      <span>Pixiv</span>\r\n    </ColoredA>\r\n  );\r\n};\r\n","import React, { useMemo } from \"react\";\r\nimport styled, { css } from \"styled-components\";\r\nimport TagList from \"../tag/TagList\";\r\nimport { RatingType } from \"../../data/types\";\r\nimport TagDataClass from \"../../data/Tag\";\r\nimport { listToMap } from \"../../data/utils\";\r\nimport Rating from \"./widgets/Rating\";\r\nimport Score from \"./widgets/Score\";\r\nimport Source from \"./widgets/Source\";\r\n\r\nconst Bar = styled.div(\r\n  ({ theme: { dimensions, misc, shadow } }) => css`\r\n    grid-row: 2/3;\r\n    display: flex;\r\n    flex-wrap: wrap;\r\n    justify-content: space-between;\r\n    background: ${misc.layer};\r\n    padding: ${dimensions.bigSpacing};\r\n    ${shadow.box};\r\n    border-radius: 0 0 ${dimensions.borderRadius} ${dimensions.borderRadius};\r\n  `\r\n);\r\n\r\nconst DetailsTagList = styled(TagList)`\r\n  grid-row: 3/4;\r\n`;\r\n\r\ninterface DetailsProps {\r\n  rating: RatingType;\r\n  score: number;\r\n  source: string;\r\n  tags: TagDataClass[];\r\n}\r\n\r\nexport default function Details(props: DetailsProps) {\r\n  const { rating, score, source, tags } = props;\r\n  const tagsForRendering = useMemo(() => listToMap(tags, \"name\"), [tags]);\r\n\r\n  return (\r\n    <>\r\n      <Bar>\r\n        {!!rating && <Rating value={rating} />}\r\n        {!!score && <Score value={score} />}\r\n        {!!source && <Source value={source} />}\r\n      </Bar>\r\n      <DetailsTagList tags={tagsForRendering} padding loadAliases={false} />\r\n    </>\r\n  );\r\n}\r\n","import { SimpleMap } from \"./types\";\r\n\r\nexport const listToMap = <T>(list: T[], keyProp: string): SimpleMap<T> => {\r\n  return list.reduce((result: SimpleMap<T>, current: any) => {\r\n    result[current[keyProp]] = current;\r\n    return result;\r\n  }, {});\r\n};\r\n","import styled from \"styled-components\";\r\n\r\nconst FlexVideo = styled.video`\r\n  width: 100%;\r\n  height: 100%;\r\n  display: block;\r\n  object-fit: contain;\r\n  grid-area: 1/1/2/2;\r\n`;\r\n\r\nexport default FlexVideo;\r\n","import { keyframes } from \"styled-components\";\r\n\r\nexport const fadeOut = keyframes`\r\n  from {\r\n    opacity: 1;\r\n  }\r\n\r\n  to {\r\n    opacity: 0;\r\n  }\r\n`;\r\n","import React, { MouseEventHandler } from \"react\";\r\nimport Button from \"../common/Button\";\r\nimport {\r\n  ExpandIcon,\r\n  PlayIcon,\r\n  PauseIcon,\r\n  ExternalLinkIcon,\r\n} from \"../../icons/Icons\";\r\nimport styled, { css } from \"styled-components\";\r\nimport { NO_OP } from \"../../data/constants\";\r\nimport useToggle from \"../../misc/useToggle\";\r\nimport { fadeOut } from \"../styled/animations\";\r\n\r\nconst Wrapper = styled.div(\r\n  (props: { isVisible: boolean }) => css`\r\n    grid-area: 1/1/2/2;\r\n    display: grid;\r\n    grid-template-columns: repeat(3, 1fr);\r\n    grid-template-rows: auto 1fr auto auto;\r\n\r\n    ${!props.isVisible\r\n      ? css`\r\n          opacity: 0;\r\n          animation: ${fadeOut} 0.4s ease-in-out;\r\n        `\r\n      : \"\"};\r\n  `\r\n);\r\n\r\nconst ProgressBar = styled.div(\r\n  (props) => css`\r\n    grid-area: 4/5/4/4;\r\n    height: 5px;\r\n    background-color: ${props.theme.colors.accentColor};\r\n  `\r\n);\r\n\r\nconst OverlayButton = styled(Button).attrs({ type: \"invisible\" })(\r\n  (props) => css`\r\n    width: max-content;\r\n    height: max-content;\r\n    padding: ${props.theme.dimensions.bigSpacing};\r\n  `\r\n);\r\n\r\nconst FullScreenButton = styled(OverlayButton)`\r\n  grid-area: 1/1/2/2;\r\n  place-self: start start;\r\n`;\r\n\r\nconst OpenExternalButton = styled(OverlayButton)`\r\n  grid-area: 3/1/4/1;\r\n  place-self: end start;\r\n`;\r\n\r\nconst PlayButton = styled(OverlayButton)`\r\n  grid-area: 2/2/3/3;\r\n  place-self: center center;\r\n`;\r\n\r\ninterface OverlayProps {\r\n  onFullscreen?: MouseEventHandler;\r\n  openInNewTab: MouseEventHandler;\r\n  togglePlay?: MouseEventHandler;\r\n  isPaused?: boolean;\r\n  isPlayable: boolean;\r\n  currentTime?: number;\r\n  duration?: number;\r\n}\r\n\r\nfunction Overlay(props: OverlayProps) {\r\n  const {\r\n    onFullscreen = NO_OP,\r\n    togglePlay = NO_OP,\r\n    isPaused = true,\r\n    isPlayable = false,\r\n    currentTime = 0,\r\n    duration = null,\r\n    openInNewTab,\r\n  } = props;\r\n\r\n  const [isVisible, toggleVisible] = useToggle();\r\n\r\n  return (\r\n    <Wrapper isVisible={isPaused || isVisible} onClick={toggleVisible}>\r\n      {onFullscreen && (\r\n        <FullScreenButton onClick={onFullscreen} label=\"Open Fullscreen\">\r\n          <ExpandIcon color=\"white\" />\r\n        </FullScreenButton>\r\n      )}\r\n\r\n      <OpenExternalButton onClick={openInNewTab} label=\"Open In New Tab\">\r\n        <ExternalLinkIcon color=\"white\" />\r\n      </OpenExternalButton>\r\n\r\n      {isPlayable && (\r\n        <>\r\n          <PlayButton onClick={togglePlay} label=\"Play/Pause\">\r\n            {isPaused ? (\r\n              <PlayIcon color=\"white\" size={50} />\r\n            ) : (\r\n              <PauseIcon color=\"white\" size={50} />\r\n            )}\r\n          </PlayButton>\r\n          {!!duration && !!currentTime && (\r\n            <ProgressBar\r\n              style={{ width: `${(currentTime / duration) * 100}%` }}\r\n            />\r\n          )}\r\n        </>\r\n      )}\r\n    </Wrapper>\r\n  );\r\n}\r\n\r\nexport default Overlay;\r\n","import React, { useState, useCallback, MouseEventHandler } from \"react\";\r\nimport { useSelector } from \"react-redux\";\r\nimport { selectPreferences } from \"../../redux/selectors\";\r\nimport FlexVideo from \"./FlexVideo\";\r\nimport Overlay from \"./Overlay\";\r\nimport { openFullscreen } from \"./utils\";\r\n\r\ninterface VideoProps {\r\n  src: string;\r\n  thumbnail_src: string;\r\n  onLoad: () => void;\r\n  openInNewTab: MouseEventHandler;\r\n}\r\n\r\nexport default function Video(props: VideoProps) {\r\n  const { src, onLoad, openInNewTab } = props;\r\n\r\n  const [videoRef, setVideoRef] = useState<HTMLVideoElement | null>(null);\r\n\r\n  const [, setTime] = useState(Date.now());\r\n  const [intervalId, setIntervalId] = useState<NodeJS.Timeout | null>(null);\r\n\r\n  const play = useCallback(() => {\r\n    videoRef && videoRef.play();\r\n\r\n    // ~30 fps\r\n    const id = setInterval(() => {\r\n      setTime(Date.now());\r\n    }, 34);\r\n\r\n    setIntervalId(id);\r\n  }, [videoRef]);\r\n\r\n  const pause = useCallback(() => {\r\n    videoRef && videoRef.pause();\r\n    clearInterval(intervalId as NodeJS.Timeout);\r\n    setIntervalId(null);\r\n  }, [videoRef, intervalId]);\r\n\r\n  const onFullscreen = useCallback(() => videoRef && openFullscreen(videoRef), [\r\n    videoRef,\r\n  ]);\r\n\r\n  const togglePlay = useCallback(\r\n    (event) => {\r\n      event.stopPropagation();\r\n      videoRef && (videoRef.paused ? play() : pause());\r\n    },\r\n    [videoRef, play, pause]\r\n  );\r\n\r\n  const { preloadVideos } = useSelector(selectPreferences);\r\n\r\n  return (\r\n    <>\r\n      <FlexVideo\r\n        controls={false}\r\n        loop\r\n        src={src}\r\n        preload={preloadVideos ? \"auto\" : \"metadata\"}\r\n        ref={setVideoRef}\r\n        onLoadedMetadata={onLoad}\r\n      />\r\n      <Overlay\r\n        isPaused={videoRef ? videoRef.paused : true}\r\n        currentTime={videoRef ? videoRef.currentTime : undefined}\r\n        duration={videoRef ? videoRef.duration : undefined}\r\n        onFullscreen={onFullscreen}\r\n        togglePlay={togglePlay}\r\n        openInNewTab={openInNewTab}\r\n        isPlayable\r\n      />\r\n    </>\r\n  );\r\n}\r\n","import { PostType, VIDEO, GIF, PICTURE } from \"../../data/types\";\r\n\r\nexport const openFullscreen = (elem: HTMLVideoElement) => {\r\n  elem.requestFullscreen();\r\n};\r\n\r\nexport const getMediaType = (type: PostType, src: string) => {\r\n  if (type === VIDEO) {\r\n    return VIDEO;\r\n  }\r\n\r\n  // can't use .endsWith because of queryString\r\n  if (src.includes(\".gif\")) {\r\n    return GIF;\r\n  }\r\n\r\n  return PICTURE;\r\n};\r\n","import styled from \"styled-components\";\r\n\r\nconst FlexImage = styled.img`\r\n  width: 100%;\r\n  height: 100%;\r\n  display: block;\r\n  object-fit: contain;\r\n  grid-area: 1/1/2/2;\r\n`;\r\n\r\nexport default FlexImage;\r\n","import React, { MouseEventHandler, useState } from \"react\";\r\nimport FlexImage from \"./FlexImage\";\r\nimport Overlay from \"./Overlay\";\r\n\r\ninterface GifProps {\r\n  src: string;\r\n  thumbnail_src: string;\r\n  onLoad: () => void;\r\n  openInNewTab: MouseEventHandler;\r\n}\r\n\r\nexport default function Gif(props: GifProps) {\r\n  const { src, thumbnail_src, onLoad, openInNewTab } = props;\r\n\r\n  const [isPaused, setPaused] = useState(true);\r\n  const usedSource = isPaused ? thumbnail_src : src;\r\n\r\n  return (\r\n    <>\r\n      <FlexImage\r\n        src={usedSource}\r\n        alt={usedSource}\r\n        loading=\"lazy\"\r\n        onLoad={onLoad}\r\n      />\r\n      <Overlay\r\n        isPlayable\r\n        isPaused={isPaused}\r\n        togglePlay={(event) => {\r\n          event.stopPropagation();\r\n          setPaused(!isPaused);\r\n        }}\r\n        openInNewTab={openInNewTab}\r\n      />\r\n    </>\r\n  );\r\n}\r\n","import React, { MouseEventHandler } from \"react\";\r\nimport FlexImage from \"./FlexImage\";\r\nimport Overlay from \"./Overlay\";\r\n\r\ninterface PictureProps {\r\n  src: string;\r\n  onLoad: () => void;\r\n  openInNewTab: MouseEventHandler;\r\n}\r\n\r\nexport default function Picture(props: PictureProps) {\r\n  const { src, onLoad, openInNewTab } = props;\r\n\r\n  return (\r\n    <>\r\n      <FlexImage src={src} alt={src} onLoad={onLoad} loading=\"lazy\" />\r\n      <Overlay isPlayable={false} openInNewTab={openInNewTab} />\r\n    </>\r\n  );\r\n}\r\n","import React, { MouseEventHandler, useCallback, useMemo } from \"react\";\r\nimport Video from \"./Video\";\r\nimport Gif from \"./Gif\";\r\nimport Picture from \"./Picture\";\r\nimport { VIDEO, GIF } from \"../../data/constants\";\r\nimport { getMediaType } from \"./utils\";\r\nimport { PostType } from \"../../data/types\";\r\n\r\ninterface PlayerProps {\r\n  type: PostType;\r\n  src: string;\r\n  thumbnail_src: string;\r\n  onLoad: () => void;\r\n}\r\n\r\nconst getMedia = (type: PostType, src: string) => {\r\n  switch (getMediaType(type, src)) {\r\n    case VIDEO:\r\n      return Video;\r\n    case GIF:\r\n      return Gif;\r\n    default:\r\n      return Picture;\r\n  }\r\n};\r\n\r\nexport default function Player(props: PlayerProps) {\r\n  const { type, src, thumbnail_src, onLoad } = props;\r\n\r\n  const openInNewTab: MouseEventHandler = useCallback(\r\n    (event) => {\r\n      event.stopPropagation();\r\n      const url = new URL(src).searchParams\r\n        .get(\"url\")\r\n        ?.replace(\"//\", \"/\")\r\n        .split(\"?\")[0];\r\n      if (url) window.open(url);\r\n    },\r\n    [src]\r\n  );\r\n\r\n  const media = useMemo(() => {\r\n    const MediaComponent = getMedia(type, src);\r\n    return (\r\n      <MediaComponent\r\n        src={src}\r\n        thumbnail_src={thumbnail_src}\r\n        onLoad={onLoad}\r\n        openInNewTab={openInNewTab}\r\n      />\r\n    );\r\n  }, [type, src, thumbnail_src, onLoad, openInNewTab]);\r\n\r\n  return <>{media}</>;\r\n}\r\n","import { css } from \"styled-components\";\r\n\r\nexport default css`\r\n  padding: 0 10px;\r\n  width: 100%;\r\n  max-width: 1000px;\r\n  margin: auto;\r\n`;\r\n","import React, { useState, useCallback, useMemo } from \"react\";\r\nimport styled, { css } from \"styled-components\";\r\nimport Details from \"./Details\";\r\nimport Player from \"../player/Player\";\r\nimport { useSelector } from \"react-redux\";\r\nimport { selectOriginals } from \"../../redux/selectors\";\r\nimport PostDataClass from \"../../data/Post\";\r\nimport MaxWidthStyle from \"../common/MaxWidthStyle\";\r\n\r\nconst ItemWrapper = styled.div`\r\n  padding-top: 10px;\r\n`;\r\n\r\nconst PositonWrapper = styled.div`\r\n  ${MaxWidthStyle}\r\n`;\r\n\r\nconst PostWrapper = styled.div(\r\n  ({ theme }) => css`\r\n    display: grid;\r\n    grid-template-columns: 1fr;\r\n    grid-template-rows: auto auto auto;\r\n    border-radius: ${theme.dimensions.borderRadius};\r\n    overflow: hidden;\r\n    ${theme.misc.layer};\r\n  `\r\n);\r\n\r\nexport function getCorrectSource(\r\n  loadOriginal: boolean,\r\n  big_src: string,\r\n  small_src: string,\r\n  id: number\r\n) {\r\n  let src;\r\n  if (loadOriginal) {\r\n    src = big_src;\r\n  } else {\r\n    src = `${small_src}?${id}`;\r\n    if (src.includes(\"//images\")) {\r\n      src = src.replace(\"//images\", \"/images\");\r\n    }\r\n  }\r\n\r\n  return src;\r\n}\r\n\r\nexport default function Post(\r\n  props: PostDataClass & { style: any; onLoad: () => void; virtualRef: any }\r\n) {\r\n  const {\r\n    id,\r\n    media_type,\r\n    small_src,\r\n    big_src,\r\n    thumbnail_src,\r\n    rating,\r\n    score,\r\n    source,\r\n    tags,\r\n    style,\r\n    onLoad,\r\n    virtualRef,\r\n  } = props;\r\n  const originals = useSelector(selectOriginals);\r\n  const media_src = getCorrectSource(originals, big_src, small_src, id);\r\n  const [collapsed, setCollapsed] = useState(true);\r\n\r\n  const toggleDetails = useCallback(() => {\r\n    setCollapsed(!collapsed);\r\n    setTimeout(onLoad, 100);\r\n  }, [collapsed, onLoad]);\r\n\r\n  const details = useMemo(\r\n    () => <Details rating={rating} score={score} source={source} tags={tags} />,\r\n    [rating, score, source, tags]\r\n  );\r\n\r\n  return (\r\n    <ItemWrapper style={style} ref={virtualRef} className=\"list-div\">\r\n      <PositonWrapper>\r\n        <PostWrapper onClick={toggleDetails} role=\"row\">\r\n          <Player\r\n            onLoad={onLoad}\r\n            type={media_type}\r\n            src={media_src}\r\n            thumbnail_src={thumbnail_src}\r\n          />\r\n          {!collapsed && details}\r\n        </PostWrapper>\r\n      </PositonWrapper>\r\n    </ItemWrapper>\r\n  );\r\n}\r\n","import React, { useCallback } from \"react\";\r\nimport { useDispatch } from \"react-redux\";\r\nimport { BLOCK } from \"../../data/types\";\r\nimport { getResults } from \"../../redux/actions\";\r\nimport Button from \"../common/Button\";\r\n\r\nexport default function SearchButton() {\r\n  const dispatch = useDispatch();\r\n  const search = useCallback(() => dispatch(getResults()), [dispatch]);\r\n\r\n  return (\r\n    <Button type={BLOCK} onClick={search} label=\"Search\">\r\n      Search\r\n    </Button>\r\n  );\r\n}\r\n","import React, { useEffect } from \"react\";\r\nimport { useSelector } from \"react-redux\";\r\nimport { selectActiveTags } from \"../../redux/selectors\";\r\nimport TagList from \"../tag/TagList\";\r\n\r\nexport default function ActiveTags({ onChange }: { onChange: () => void }) {\r\n  const activeTags = useSelector(selectActiveTags);\r\n\r\n  useEffect(() => {\r\n    onChange();\r\n  }, [onChange, activeTags]);\r\n\r\n  return Object.keys(activeTags).length > 0 ? (\r\n    <TagList tags={activeTags} loadAliases />\r\n  ) : null;\r\n}\r\n","import React from \"react\";\r\nimport styled, { css } from \"styled-components\";\r\nimport TagSelector from \"../tagSelector/TagSelector\";\r\nimport Options from \"./Options\";\r\nimport Title from \"../common/Title\";\r\nimport Surface from \"../common/Surface\";\r\nimport SearchButton from \"./SearchButton\";\r\nimport ActiveTags from \"./ActiveTags\";\r\nimport MaxWidthStyle from \"../common/MaxWidthStyle\";\r\n\r\nconst ConfigWrapper = styled.section(\r\n  (props) => css`\r\n    display: grid;\r\n    gap: ${props.theme.dimensions.gutter};\r\n    ${MaxWidthStyle}\r\n  `\r\n);\r\n\r\nexport default function Config(props: { onLoad: () => void }) {\r\n  const { onLoad } = props;\r\n\r\n  return (\r\n    <ConfigWrapper>\r\n      <Title>\r\n        <label htmlFor=\"tag-input\">Search</label>\r\n      </Title>\r\n      <Surface>\r\n        <TagSelector />\r\n        <ActiveTags onChange={onLoad} />\r\n        <Options />\r\n        <SearchButton />\r\n      </Surface>\r\n    </ConfigWrapper>\r\n  );\r\n}\r\n","import React, { useEffect } from \"react\";\r\nimport { useSelector } from \"react-redux\";\r\nimport { formatCount } from \"../../misc/formatting\";\r\nimport useToggle from \"../../misc/useToggle\";\r\nimport { selectCount } from \"../../redux/selectors\";\r\nimport Title from \"../common/Title\";\r\nimport Config from \"../features/Config\";\r\nimport Header from \"../features/Header\";\r\nimport LayoutElementProps from \"./LayoutElementProps\";\r\n\r\nexport default function LayoutHeader({\r\n  onLoad,\r\n  virtualRef,\r\n  style,\r\n}: LayoutElementProps) {\r\n  const [fullNumber, toggleFullNumber] = useToggle();\r\n  const count = useSelector(selectCount);\r\n\r\n  useEffect(() => {\r\n    if (count > 0) onLoad();\r\n  }, [count, onLoad]);\r\n\r\n  return (\r\n    <div onLoad={onLoad} ref={virtualRef} style={style} role=\"row\">\r\n      <Header />\r\n      <Config onLoad={onLoad} />\r\n      {count > 0 && (\r\n        <Title onClick={toggleFullNumber}>\r\n          {(fullNumber ? count.toLocaleString() : formatCount(count)) +\r\n            \" results\"}\r\n        </Title>\r\n      )}\r\n    </div>\r\n  );\r\n}\r\n","import React, { useMemo } from \"react\";\r\nimport Surface, { Line } from \"../common/Surface\";\r\nimport Title from \"../common/Title\";\r\nimport TagList from \"../tag/TagList\";\r\nimport outOfResultsPicture from \"../../icons/OutOfResults.png\";\r\nimport { useSelector } from \"react-redux\";\r\nimport { selectAliases } from \"../../redux/selectors\";\r\nimport TagDataClass from \"../../data/Tag\";\r\nimport { SimpleMap } from \"../../data/types\";\r\nimport LayoutElementProps from \"./LayoutElementProps\";\r\n\r\nexport default function LayoutOutOfItems({\r\n  onLoad,\r\n  virtualRef,\r\n  style,\r\n}: LayoutElementProps) {\r\n  const aliases = useSelector(selectAliases);\r\n  const aliasesForRendering = useMemo(\r\n    () =>\r\n      aliases.reduce((result: SimpleMap<TagDataClass>, alias) => {\r\n        result[alias.name] = alias;\r\n        return result;\r\n      }, {}),\r\n    [aliases]\r\n  );\r\n\r\n  return (\r\n    <div style={style} ref={virtualRef} onLoad={onLoad} role=\"row\">\r\n      <Surface>\r\n        <img\r\n          src={outOfResultsPicture}\r\n          alt={outOfResultsPicture}\r\n          style={{ width: \"100%\" }}\r\n        />\r\n        <Line />\r\n        <Title>You have reached the end!</Title>\r\n        <p style={{ textAlign: \"center\" }}>Go look for something else!</p>\r\n        {aliases.length > 0 && (\r\n          <>\r\n            <p style={{ textAlign: \"center\" }}>How about some of these?</p>\r\n            <TagList tags={aliasesForRendering} padding />\r\n          </>\r\n        )}\r\n      </Surface>\r\n    </div>\r\n  );\r\n}\r\n","import React from \"react\";\r\nimport styled from \"styled-components\";\r\n\r\nconst StyledSvg = styled.svg`\r\n  height: 35px;\r\n  padding: 10px;\r\n`;\r\n\r\nexport default function Loading() {\r\n  return (\r\n    <StyledSvg\r\n      version=\"1.1\"\r\n      xmlns=\"http://www.w3.org/2000/svg\"\r\n      xmlnsXlink=\"http://www.w3.org/1999/xlink\"\r\n      viewBox=\"0 0 50 20\"\r\n      enable-background=\"new 0 0 0 0\"\r\n      xmlSpace=\"preserve\"\r\n    >\r\n      <circle fill=\"#fff\" stroke=\"none\" cx=\"6\" cy=\"10\" r=\"6\">\r\n        <animate\r\n          attributeName=\"opacity\"\r\n          dur=\"1s\"\r\n          values=\"0;1;0\"\r\n          repeatCount=\"indefinite\"\r\n          begin=\"0.1\"\r\n        />\r\n      </circle>\r\n      <circle fill=\"#fff\" stroke=\"none\" cx=\"26\" cy=\"10\" r=\"6\">\r\n        <animate\r\n          attributeName=\"opacity\"\r\n          dur=\"1s\"\r\n          values=\"0;1;0\"\r\n          repeatCount=\"indefinite\"\r\n          begin=\"0.2\"\r\n        />\r\n      </circle>\r\n      <circle fill=\"#fff\" stroke=\"none\" cx=\"46\" cy=\"10\" r=\"6\">\r\n        <animate\r\n          attributeName=\"opacity\"\r\n          dur=\"1s\"\r\n          values=\"0;1;0\"\r\n          repeatCount=\"indefinite\"\r\n          begin=\"0.3\"\r\n        />\r\n      </circle>\r\n    </StyledSvg>\r\n  );\r\n}\r\n","import React from \"react\";\r\nimport LayoutElementProps from \"./LayoutElementProps\";\r\nimport LoadingIcon from \"../../icons/Loading\";\r\nimport styled from \"styled-components\";\r\n\r\nconst Wrapper = styled.div`\r\n  display: grid;\r\n  place-items: center;\r\n`;\r\n\r\nexport default function LayoutLoadingItem({\r\n  onLoad,\r\n  virtualRef,\r\n  style,\r\n}: LayoutElementProps) {\r\n  return (\r\n    <Wrapper onLoad={onLoad} ref={virtualRef} style={style} role=\"row\">\r\n      <LoadingIcon />\r\n    </Wrapper>\r\n  );\r\n}\r\n","import React, { useCallback, useState } from \"react\";\r\nimport { useDispatch, useSelector } from \"react-redux\";\r\nimport InifinteColumn from \"../components/layout/InfiniteColumn\";\r\nimport Post from \"../components/post/Post\";\r\nimport { getMoreResults } from \"../redux/actions\";\r\nimport { selectOutOfResults, selectPosts } from \"../redux/selectors\";\r\nimport LayoutHeader from \"../components/layout/LayoutHeader\";\r\nimport LayoutOutOfItems from \"../components/layout/LayoutOutOfItems\";\r\nimport LayoutLoadingItem from \"../components/layout/LayoutLoadingItem\";\r\n\r\nexport default function Search() {\r\n  const dispatch = useDispatch();\r\n  const posts = useSelector(selectPosts);\r\n  const hasMorePosts = !useSelector(selectOutOfResults);\r\n  const loadMore = useCallback(() => dispatch(getMoreResults()), [dispatch]);\r\n  const [isLoading, setLoading] = useState(false);\r\n\r\n  return (\r\n    <>\r\n      <InifinteColumn\r\n        Header={LayoutHeader}\r\n        OutOfItems={LayoutOutOfItems}\r\n        items={posts}\r\n        LoadingItem={LayoutLoadingItem}\r\n        hasMoreRows={hasMorePosts}\r\n        ItemComponent={Post}\r\n        loadMore={loadMore}\r\n        isLoading={isLoading}\r\n        setLoading={setLoading}\r\n      />\r\n    </>\r\n  );\r\n}\r\n","import React from \"react\";\r\nimport styled, { css } from \"styled-components\";\r\nimport Button from \"../common/Button\";\r\nimport { RED } from \"../../data/types\";\r\nimport { useSelector } from \"react-redux\";\r\nimport { allowCookiesAction } from \"../../redux/actions\";\r\nimport { selectCookies } from \"../../redux/selectors\";\r\nimport useAction from \"../../hooks/useAction\";\r\n\r\nconst CookieWrapper = styled.div(\r\n  ({ theme }) => css`\r\n    position: fixed;\r\n    bottom: 0;\r\n    left: 0;\r\n    width: 100%;\r\n    display: flex;\r\n    align-items: center;\r\n    justify-content: space-between;\r\n\r\n    color: ${theme.colors.text};\r\n    background: ${theme.misc.layer};\r\n\r\n    padding: ${theme.dimensions.gutter};\r\n  `\r\n);\r\n\r\nconst StyledSpan = styled.span`\r\n  height: min-content;\r\n`;\r\n\r\nexport default function CookieConfirmation() {\r\n  const cookies = useSelector(selectCookies);\r\n  const onClick = useAction(allowCookiesAction);\r\n\r\n  return cookies ? null : (\r\n    <CookieWrapper>\r\n      <StyledSpan>This website uses cookies.</StyledSpan>\r\n      <Button type={RED} onClick={onClick} label=\"Allow Cookies\">\r\n        Cool\r\n      </Button>\r\n    </CookieWrapper>\r\n  );\r\n}\r\n","import { useCallback } from \"react\";\r\nimport { useDispatch } from \"react-redux\";\r\nimport { AnyAction } from \"redux\";\r\n\r\nexport default function useAction(actionCreator: () => AnyAction) {\r\n  const dispatch = useDispatch();\r\n\r\n  return useCallback(() => {\r\n    dispatch(actionCreator());\r\n  }, [actionCreator, dispatch]);\r\n}\r\n","import React from \"react\";\r\nimport Help from \"./pages/Help\";\r\nimport Settings from \"./pages/Settings\";\r\nimport Search from \"./pages/Search\";\r\nimport CookieConfirmation from \"./components/features/CookieConfirmation\";\r\nimport { Switch, Route, HashRouter } from \"react-router-dom\";\r\n\r\nexport default function AppContent() {\r\n  return (\r\n    <HashRouter basename=\"/r34-react\">\r\n      <Switch>\r\n        <Route path=\"/help\">\r\n          <Help />\r\n        </Route>\r\n        <Route path=\"/settings\">\r\n          <Settings />\r\n        </Route>\r\n        <Route path=\"/\">\r\n          <Search />\r\n        </Route>\r\n      </Switch>\r\n\r\n      <CookieConfirmation />\r\n    </HashRouter>\r\n  );\r\n}\r\n","const theme = {\r\n  dimensions: {\r\n    borderRadius: \"3px\",\r\n    borderWidth: \"2px\",\r\n    spacing: \"4px\",\r\n    bigSpacing: \"8px\",\r\n    appMargin: \"16px\",\r\n    gutter: \"8px\",\r\n    blockHeight: \"32px\",\r\n  },\r\n  colors: {\r\n    accentColor: \"#ee3344\",\r\n    hoverAccent: \"#ee3344\",\r\n    backgroundColor: \"#121212\",\r\n    backgroundColor2: \"#fff\",\r\n  },\r\n  shadow: {\r\n    box: \"box-shadow: 0 0 8px #000\",\r\n    drop: \"drop-shadow(0 0 4px #000)\",\r\n  },\r\n  timings: {\r\n    transistionTime: \"0.2s\",\r\n    longTransistionTime: \"0.2s\",\r\n  },\r\n  misc: {\r\n    layer:\r\n      \"#ffffff11; :hover { background: #ffffff16;} transition: background-color 0.2s ease-in-out\",\r\n  },\r\n  fontSizes: {\r\n    content: \"15px\",\r\n  },\r\n};\r\n\r\nexport default theme;\r\n\r\nexport type ThemeType = typeof theme;\r\n","import { createGlobalStyle, css } from \"styled-components\";\r\nimport { ThemeType } from \"./misc/theme\";\r\n\r\nexport default createGlobalStyle(\r\n  (props: { theme: ThemeType }) => css`\r\n    * {\r\n      margin: 0;\r\n      padding: 0;\r\n      box-sizing: border-box;\r\n\r\n      font-family: \"Raleway\", sans-serif;\r\n      -webkit-font-smoothing: antialiased;\r\n      -moz-osx-font-smoothing: grayscale;\r\n\r\n      :focus {\r\n        outline: none;\r\n      }\r\n    }\r\n\r\n    html,\r\n    body,\r\n    #app-root {\r\n      width: 100%;\r\n      height: 100%;\r\n    }\r\n\r\n    body {\r\n      font-size: ${props.theme.fontSizes.content};\r\n      color: ${props.theme.colors.backgroundColor2};\r\n      background-color: ${props.theme.colors.backgroundColor};\r\n    }\r\n\r\n    a {\r\n      color: ${props.theme.colors.accentColor};\r\n      text-decoration: none;\r\n    }\r\n  `\r\n);\r\n","import React from \"react\";\r\nimport { Provider } from \"react-redux\";\r\nimport { store, persistor } from \"./redux/store\";\r\nimport { PersistGate } from \"redux-persist/integration/react\";\r\nimport AppContent from \"./AppContent\";\r\nimport { ThemeProvider } from \"styled-components\";\r\nimport theme from \"./misc/theme\";\r\nimport GlobalStyles from \"./GlobalStyles\";\r\n\r\nexport default function App() {\r\n  return (\r\n    <Provider store={store}>\r\n      <PersistGate loading={null} persistor={persistor}>\r\n        <ThemeProvider theme={theme}>\r\n          <GlobalStyles />\r\n          <AppContent />\r\n        </ThemeProvider>\r\n      </PersistGate>\r\n    </Provider>\r\n  );\r\n}\r\n","import React from \"react\";\r\nimport ReactDOM from \"react-dom\";\r\nimport App from \"./App\";\r\n\r\nReactDOM.render(<App />, document.getElementById(\"app-root\"));\r\n"],"sourceRoot":""}